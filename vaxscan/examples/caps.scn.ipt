program
 MODULE
 id
  process_basic_identifiers
 opt_ident
  ;
 module_statement_list
  module_statement_list
   module_statement_list
    module_statement_list
     module_statement_list
      module_statement_list
       module_statement
        set_declaration
         SET
         id
          alpha
         (
         set_exp
          set_exp
           set_term
            set_primary
             set_item
              string_literal
               'a'
              ..
              string_literal
               'z'
          OR
          set_term
           set_primary
            set_item
             string_literal
              'A'
             ..
             string_literal
              'Z'
         )
       ;
      module_statement
       set_declaration
        SET
        id
         other
        (
        set_exp
         set_exp
          set_exp
           set_exp
            set_exp
             set_exp
              set_term
               set_primary
                set_item
                 id
                  alpha
             OR
             set_term
              set_primary
               set_item
                string_literal
                 '0'
                ..
                string_literal
                 '9'
            OR
            set_term
             set_primary
              set_item
               string_literal
                '$'
           OR
           set_term
            set_primary
             set_item
              string_literal
               '_'
          OR
          set_term
           set_primary
            set_item
             string_literal
              '.'
         OR
         set_term
          set_primary
           set_item
            string_literal
             '%'
        )
      ;
     module_statement
      token_declaration
       TOKEN
       id
        id
       token_attrs
       {
       token_exp
        token_exp1
         token_exp1
          token_exp2
           token_exp3
            id
             alpha
         token_exp2
          token_exp3
           [
           token_exp
            token_exp1
             token_exp2
              token_exp3
               id
                other
           ]
          ...
       }
     ;
    module_statement
     declaration
      variable_declaration
       DECLARE
       name_list
        pic_id
         id
          keyword
       :
       type_dec
        TREE
        (
        level_types
         level_type
          string
        )
        OF
        type_dec
         common_type_dec
          INTEGER
    ;
   module_statement
    macro_declaration
     MACRO
     id
      match_id
     macro_type
      TRIGGER
     opt_macro_attrs
     {
     opt_picture
      picture
       pic1
        pic2
         pic3
          pic4
           id
            id_text
           :
           macro_item
            id
             id
     }
     ;
     body
      statement_list
       statement
        executable
         keyword_statement
          if_statement
           IF
           exp
            exp1
             exp2
              exp3
               exp4
                exp5
                 exp6
                  exp7
                   exp8
                    exp9
                     ref
                      ref
                       id
                        EXISTS
                      argument_list
                       (
                       arg_list
                        arg
                         exp
                          exp1
                           exp2
                            exp3
                             exp4
                              exp5
                               exp6
                                exp7
                                 exp8
                                  exp9
                                   ref
                                    ref
                                     id
                                      keyword
                                    argument_list
                                     (
                                     arg_list
                                      arg
                                       exp
                                        exp1
                                         exp2
                                          exp3
                                           exp4
                                            exp5
                                             exp6
                                              exp7
                                               exp8
                                                exp9
                                                 ref
                                                  ref
                                                   id
                                                    UPPER
                                                  argument_list
                                                   (
                                                   arg_list
                                                    arg
                                                     exp
                                                      exp1
                                                       exp2
                                                        exp3
                                                         exp4
                                                          exp5
                                                           exp6
                                                            exp7
                                                             exp8
                                                              exp9
                                                               ref
                                                                id
                                                                 id_text
                                                   )
                                     )
                       )
           THEN
           executable_list
            executable
             keyword_statement
              answer_statement
               ANSWER
               exp_list
                exp
                 exp1
                  exp2
                   exp3
                    exp4
                     exp5
                      exp6
                       exp7
                        exp8
                         exp9
                          ref
                           ref
                            id
                             UPPER
                           argument_list
                            (
                            arg_list
                             arg
                              exp
                               exp1
                                exp2
                                 exp3
                                  exp4
                                   exp5
                                    exp6
                                     exp7
                                      exp8
                                       exp9
                                        ref
                                         id
                                          id_text
                            )
            ;
           opt_else_statement
            ELSE
            executable_list
             executable
              keyword_statement
               answer_statement
                ANSWER
                exp_list
                 exp
                  exp1
                   exp2
                    exp3
                     exp4
                      exp5
                       exp6
                        exp7
                         exp8
                          exp9
                           ref
                            ref
                             id
                              LOWER
                            argument_list
                             (
                             arg_list
                              arg
                               exp
                                exp1
                                 exp2
                                  exp3
                                   exp4
                                    exp5
                                     exp6
                                      exp7
                                       exp8
                                        exp9
                                         ref
                                          id
                                           id_text
                             )
             ;
           END
           IF
        ;
     END
     MACRO
   ;
  module_statement
   procedure_declaration
    proc_start
     PROCEDURE
     id
      process_ids
     opt_proc_attr
      MAIN
    ;
    body
     statement_list
      statement_list
       statement_list
        statement_list
         statement_list
          statement_list
           statement_list
            statement_list
             statement_list
              statement_list
               statement_list
                statement_list
                 statement_list
                  statement_list
                   statement_list
                    statement_list
                     statement_list
                      statement_list
                       statement_list
                        statement_list
                         statement_list
                          statement_list
                           statement_list
                            statement_list
                             statement_list
                              statement_list
                               statement_list
                                statement_list
                                 statement_list
                                  statement_list
                                   statement_list
                                    statement_list
                                     statement_list
                                      statement_list
                                       statement
                                        executable
                                         variable_ref
                                          var_ref
                                           var_ref
                                            write_id
                                             id
                                              keyword
                                           argument_list
                                            (
                                            arg_list
                                             arg
                                              exp
                                               exp1
                                                exp2
                                                 exp3
                                                  exp4
                                                   exp5
                                                    exp6
                                                     exp7
                                                      exp8
                                                       exp9
                                                        string_literal
                                                         'TYPE'
                                            )
                                         =
                                         exp
                                          exp1
                                           exp2
                                            exp3
                                             exp4
                                              exp5
                                               exp6
                                                exp7
                                                 exp8
                                                  exp9
                                                   0
                                        ;
                                      statement
                                       executable
                                        variable_ref
                                         var_ref
                                          var_ref
                                           write_id
                                            id
                                             keyword
                                          argument_list
                                           (
                                           arg_list
                                            arg
                                             exp
                                              exp1
                                               exp2
                                                exp3
                                                 exp4
                                                  exp5
                                                   exp6
                                                    exp7
                                                     exp8
                                                      exp9
                                                       string_literal
                                                        'EXPLICIT'
                                           )
                                        =
                                        exp
                                         exp1
                                          exp2
                                           exp3
                                            exp4
                                             exp5
                                              exp6
                                               exp7
                                                exp8
                                                 exp9
                                                  0
                                       ;
                                     statement
                                      executable
                                       variable_ref
                                        var_ref
                                         var_ref
                                          write_id
                                           id
                                            keyword
                                         argument_list
                                          (
                                          arg_list
                                           arg
                                            exp
                                             exp1
                                              exp2
                                               exp3
                                                exp4
                                                 exp5
                                                  exp6
                                                   exp7
                                                    exp8
                                                     exp9
                                                      string_literal
                                                       'DECLARE'
                                          )
                                       =
                                       exp
                                        exp1
                                         exp2
                                          exp3
                                           exp4
                                            exp5
                                             exp6
                                              exp7
                                               exp8
                                                exp9
                                                 0
                                      ;
                                    statement
                                     executable
                                      variable_ref
                                       var_ref
                                        var_ref
                                         write_id
                                          id
                                           keyword
                                        argument_list
                                         (
                                         arg_list
                                          arg
                                           exp
                                            exp1
                                             exp2
                                              exp3
                                               exp4
                                                exp5
                                                 exp6
                                                  exp7
                                                   exp8
                                                    exp9
                                                     string_literal
                                                      'INTEGER'
                                         )
                                      =
                                      exp
                                       exp1
                                        exp2
                                         exp3
                                          exp4
                                           exp5
                                            exp6
                                             exp7
                                              exp8
                                               exp9
                                                0
                                     ;
                                   statement
                                    executable
                                     variable_ref
                                      var_ref
                                       var_ref
                                        write_id
                                         id
                                          keyword
                                       argument_list
                                        (
                                        arg_list
                                         arg
                                          exp
                                           exp1
                                            exp2
                                             exp3
                                              exp4
                                               exp5
                                                exp6
                                                 exp7
                                                  exp8
                                                   exp9
                                                    string_literal
                                                     'CONSTANT'
                                        )
                                     =
                                     exp
                                      exp1
                                       exp2
                                        exp3
                                         exp4
                                          exp5
                                           exp6
                                            exp7
                                             exp8
                                              exp9
                                               0
                                    ;
                                  statement
                                   executable
                                    variable_ref
                                     var_ref
                                      var_ref
                                       write_id
                                        id
                                         keyword
                                      argument_list
                                       (
                                       arg_list
                                        arg
                                         exp
                                          exp1
                                           exp2
                                            exp3
                                             exp4
                                              exp5
                                               exp6
                                                exp7
                                                 exp8
                                                  exp9
                                                   string_literal
                                                    'STRING'
                                       )
                                    =
                                    exp
                                     exp1
                                      exp2
                                       exp3
                                        exp4
                                         exp5
                                          exp6
                                           exp7
                                            exp8
                                             exp9
                                              0
                                   ;
                                 statement
                                  executable
                                   variable_ref
                                    var_ref
                                     var_ref
                                      write_id
                                       id
                                        keyword
                                     argument_list
                                      (
                                      arg_list
                                       arg
                                        exp
                                         exp1
                                          exp2
                                           exp3
                                            exp4
                                             exp5
                                              exp6
                                               exp7
                                                exp8
                                                 exp9
                                                  string_literal
                                                   'EDIT$'
                                      )
                                   =
                                   exp
                                    exp1
                                     exp2
                                      exp3
                                       exp4
                                        exp5
                                         exp6
                                          exp7
                                           exp8
                                            exp9
                                             0
                                  ;
                                statement
                                 executable
                                  variable_ref
                                   var_ref
                                    var_ref
                                     write_id
                                      id
                                       keyword
                                    argument_list
                                     (
                                     arg_list
                                      arg
                                       exp
                                        exp1
                                         exp2
                                          exp3
                                           exp4
                                            exp5
                                             exp6
                                              exp7
                                               exp8
                                                exp9
                                                 string_literal
                                                  'ON'
                                     )
                                  =
                                  exp
                                   exp1
                                    exp2
                                     exp3
                                      exp4
                                       exp5
                                        exp6
                                         exp7
                                          exp8
                                           exp9
                                            0
                                 ;
                               statement
                                executable
                                 variable_ref
                                  var_ref
                                   var_ref
                                    write_id
                                     id
                                      keyword
                                   argument_list
                                    (
                                    arg_list
                                     arg
                                      exp
                                       exp1
                                        exp2
                                         exp3
                                          exp4
                                           exp5
                                            exp6
                                             exp7
                                              exp8
                                               exp9
                                                string_literal
                                                 'ERROR'
                                    )
                                 =
                                 exp
                                  exp1
                                   exp2
                                    exp3
                                     exp4
                                      exp5
                                       exp6
                                        exp7
                                         exp8
                                          exp9
                                           0
                                ;
                              statement
                               executable
                                variable_ref
                                 var_ref
                                  var_ref
                                   write_id
                                    id
                                     keyword
                                  argument_list
                                   (
                                   arg_list
                                    arg
                                     exp
                                      exp1
                                       exp2
                                        exp3
                                         exp4
                                          exp5
                                           exp6
                                            exp7
                                             exp8
                                              exp9
                                               string_literal
                                                'GOTO'
                                   )
                                =
                                exp
                                 exp1
                                  exp2
                                   exp3
                                    exp4
                                     exp5
                                      exp6
                                       exp7
                                        exp8
                                         exp9
                                          0
                               ;
                             statement
                              executable
                               variable_ref
                                var_ref
                                 var_ref
                                  write_id
                                   id
                                    keyword
                                 argument_list
                                  (
                                  arg_list
                                   arg
                                    exp
                                     exp1
                                      exp2
                                       exp3
                                        exp4
                                         exp5
                                          exp6
                                           exp7
                                            exp8
                                             exp9
                                              string_literal
                                               'OPEN'
                                  )
                               =
                               exp
                                exp1
                                 exp2
                                  exp3
                                   exp4
                                    exp5
                                     exp6
                                      exp7
                                       exp8
                                        exp9
                                         0
                              ;
                            statement
                             executable
                              variable_ref
                               var_ref
                                var_ref
                                 write_id
                                  id
                                   keyword
                                argument_list
                                 (
                                 arg_list
                                  arg
                                   exp
                                    exp1
                                     exp2
                                      exp3
                                       exp4
                                        exp5
                                         exp6
                                          exp7
                                           exp8
                                            exp9
                                             string_literal
                                              'FOR'
                                 )
                              =
                              exp
                               exp1
                                exp2
                                 exp3
                                  exp4
                                   exp5
                                    exp6
                                     exp7
                                      exp8
                                       exp9
                                        0
                             ;
                           statement
                            executable
                             variable_ref
                              var_ref
                               var_ref
                                write_id
                                 id
                                  keyword
                               argument_list
                                (
                                arg_list
                                 arg
                                  exp
                                   exp1
                                    exp2
                                     exp3
                                      exp4
                                       exp5
                                        exp6
                                         exp7
                                          exp8
                                           exp9
                                            string_literal
                                             'INPUT'
                                )
                             =
                             exp
                              exp1
                               exp2
                                exp3
                                 exp4
                                  exp5
                                   exp6
                                    exp7
                                     exp8
                                      exp9
                                       0
                            ;
                          statement
                           executable
                            variable_ref
                             var_ref
                              var_ref
                               write_id
                                id
                                 keyword
                              argument_list
                               (
                               arg_list
                                arg
                                 exp
                                  exp1
                                   exp2
                                    exp3
                                     exp4
                                      exp5
                                       exp6
                                        exp7
                                         exp8
                                          exp9
                                           string_literal
                                            'AS'
                               )
                            =
                            exp
                             exp1
                              exp2
                               exp3
                                exp4
                                 exp5
                                  exp6
                                   exp7
                                    exp8
                                     exp9
                                      0
                           ;
                         statement
                          executable
                           variable_ref
                            var_ref
                             var_ref
                              write_id
                               id
                                keyword
                             argument_list
                              (
                              arg_list
                               arg
                                exp
                                 exp1
                                  exp2
                                   exp3
                                    exp4
                                     exp5
                                      exp6
                                       exp7
                                        exp8
                                         exp9
                                          string_literal
                                           'OUTPUT'
                              )
                           =
                           exp
                            exp1
                             exp2
                              exp3
                               exp4
                                exp5
                                 exp6
                                  exp7
                                   exp8
                                    exp9
                                     0
                          ;
                        statement
                         executable
                          variable_ref
                           var_ref
                            var_ref
                             write_id
                              id
                               keyword
                            argument_list
                             (
                             arg_list
                              arg
                               exp
                                exp1
                                 exp2
                                  exp3
                                   exp4
                                    exp5
                                     exp6
                                      exp7
                                       exp8
                                        exp9
                                         string_literal
                                          'NOMARGIN'
                             )
                          =
                          exp
                           exp1
                            exp2
                             exp3
                              exp4
                               exp5
                                exp6
                                 exp7
                                  exp8
                                   exp9
                                    0
                         ;
                       statement
                        executable
                         variable_ref
                          var_ref
                           var_ref
                            write_id
                             id
                              keyword
                           argument_list
                            (
                            arg_list
                             arg
                              exp
                               exp1
                                exp2
                                 exp3
                                  exp4
                                   exp5
                                    exp6
                                     exp7
                                      exp8
                                       exp9
                                        string_literal
                                         'WHILE'
                            )
                         =
                         exp
                          exp1
                           exp2
                            exp3
                             exp4
                              exp5
                               exp6
                                exp7
                                 exp8
                                  exp9
                                   0
                        ;
                      statement
                       executable
                        variable_ref
                         var_ref
                          var_ref
                           write_id
                            id
                             keyword
                          argument_list
                           (
                           arg_list
                            arg
                             exp
                              exp1
                               exp2
                                exp3
                                 exp4
                                  exp5
                                   exp6
                                    exp7
                                     exp8
                                      exp9
                                       string_literal
                                        'LINPUT'
                           )
                        =
                        exp
                         exp1
                          exp2
                           exp3
                            exp4
                             exp5
                              exp6
                               exp7
                                exp8
                                 exp9
                                  0
                       ;
                     statement
                      executable
                       variable_ref
                        var_ref
                         var_ref
                          write_id
                           id
                            keyword
                         argument_list
                          (
                          arg_list
                           arg
                            exp
                             exp1
                              exp2
                               exp3
                                exp4
                                 exp5
                                  exp6
                                   exp7
                                    exp8
                                     exp9
                                      string_literal
                                       'OR'
                          )
                       =
                       exp
                        exp1
                         exp2
                          exp3
                           exp4
                            exp5
                             exp6
                              exp7
                               exp8
                                exp9
                                 0
                      ;
                    statement
                     executable
                      variable_ref
                       var_ref
                        var_ref
                         write_id
                          id
                           keyword
                        argument_list
                         (
                         arg_list
                          arg
                           exp
                            exp1
                             exp2
                              exp3
                               exp4
                                exp5
                                 exp6
                                  exp7
                                   exp8
                                    exp9
                                     string_literal
                                      'POS'
                         )
                      =
                      exp
                       exp1
                        exp2
                         exp3
                          exp4
                           exp5
                            exp6
                             exp7
                              exp8
                               exp9
                                0
                     ;
                   statement
                    executable
                     variable_ref
                      var_ref
                       var_ref
                        write_id
                         id
                          keyword
                       argument_list
                        (
                        arg_list
                         arg
                          exp
                           exp1
                            exp2
                             exp3
                              exp4
                               exp5
                                exp6
                                 exp7
                                  exp8
                                   exp9
                                    string_literal
                                     'LEFT$'
                        )
                     =
                     exp
                      exp1
                       exp2
                        exp3
                         exp4
                          exp5
                           exp6
                            exp7
                             exp8
                              exp9
                               0
                    ;
                  statement
                   executable
                    variable_ref
                     var_ref
                      var_ref
                       write_id
                        id
                         keyword
                      argument_list
                       (
                       arg_list
                        arg
                         exp
                          exp1
                           exp2
                            exp3
                             exp4
                              exp5
                               exp6
                                exp7
                                 exp8
                                  exp9
                                   string_literal
                                    'RIGHT$'
                       )
                    =
                    exp
                     exp1
                      exp2
                       exp3
                        exp4
                         exp5
                          exp6
                           exp7
                            exp8
                             exp9
                              0
                   ;
                 statement
                  executable
                   variable_ref
                    var_ref
                     var_ref
                      write_id
                       id
                        keyword
                     argument_list
                      (
                      arg_list
                       arg
                        exp
                         exp1
                          exp2
                           exp3
                            exp4
                             exp5
                              exp6
                               exp7
                                exp8
                                 exp9
                                  string_literal
                                   'SEG$'
                      )
                   =
                   exp
                    exp1
                     exp2
                      exp3
                       exp4
                        exp5
                         exp6
                          exp7
                           exp8
                            exp9
                             0
                  ;
                statement
                 executable
                  variable_ref
                   var_ref
                    var_ref
                     write_id
                      id
                       keyword
                    argument_list
                     (
                     arg_list
                      arg
                       exp
                        exp1
                         exp2
                          exp3
                           exp4
                            exp5
                             exp6
                              exp7
                               exp8
                                exp9
                                 string_literal
                                  'LEN'
                     )
                  =
                  exp
                   exp1
                    exp2
                     exp3
                      exp4
                       exp5
                        exp6
                         exp7
                          exp8
                           exp9
                            0
                 ;
               statement
                executable
                 variable_ref
                  var_ref
                   var_ref
                    write_id
                     id
                      keyword
                   argument_list
                    (
                    arg_list
                     arg
                      exp
                       exp1
                        exp2
                         exp3
                          exp4
                           exp5
                            exp6
                             exp7
                              exp8
                               exp9
                                string_literal
                                 'END'
                    )
                 =
                 exp
                  exp1
                   exp2
                    exp3
                     exp4
                      exp5
                       exp6
                        exp7
                         exp8
                          exp9
                           0
                ;
              statement
               executable
                variable_ref
                 var_ref
                  var_ref
                   write_id
                    id
                     keyword
                  argument_list
                   (
                   arg_list
                    arg
                     exp
                      exp1
                       exp2
                        exp3
                         exp4
                          exp5
                           exp6
                            exp7
                             exp8
                              exp9
                               string_literal
                                'NEXT'
                   )
                =
                exp
                 exp1
                  exp2
                   exp3
                    exp4
                     exp5
                      exp6
                       exp7
                        exp8
                         exp9
                          0
               ;
             statement
              executable
               variable_ref
                var_ref
                 var_ref
                  write_id
                   id
                    keyword
                 argument_list
                  (
                  arg_list
                   arg
                    exp
                     exp1
                      exp2
                       exp3
                        exp4
                         exp5
                          exp6
                           exp7
                            exp8
                             exp9
                              string_literal
                               'PRINT'
                  )
               =
               exp
                exp1
                 exp2
                  exp3
                   exp4
                    exp5
                     exp6
                      exp7
                       exp8
                        exp9
                         0
              ;
            statement
             executable
              variable_ref
               var_ref
                var_ref
                 write_id
                  id
                   keyword
                argument_list
                 (
                 arg_list
                  arg
                   exp
                    exp1
                     exp2
                      exp3
                       exp4
                        exp5
                         exp6
                          exp7
                           exp8
                            exp9
                             string_literal
                              'CLOSE'
                 )
              =
              exp
               exp1
                exp2
                 exp3
                  exp4
                   exp5
                    exp6
                     exp7
                      exp8
                       exp9
                        0
             ;
           statement
            executable
             variable_ref
              var_ref
               var_ref
                write_id
                 id
                  keyword
               argument_list
                (
                arg_list
                 arg
                  exp
                   exp1
                    exp2
                     exp3
                      exp4
                       exp5
                        exp6
                         exp7
                          exp8
                           exp9
                            string_literal
                             'RESUME'
                )
             =
             exp
              exp1
               exp2
                exp3
                 exp4
                  exp5
                   exp6
                    exp7
                     exp8
                      exp9
                       0
            ;
          statement
           executable
            variable_ref
             var_ref
              var_ref
               write_id
                id
                 keyword
              argument_list
               (
               arg_list
                arg
                 exp
                  exp1
                   exp2
                    exp3
                     exp4
                      exp5
                       exp6
                        exp7
                         exp8
                          exp9
                           string_literal
                            'OPTION'
               )
            =
            exp
             exp1
              exp2
               exp3
                exp4
                 exp5
                  exp6
                   exp7
                    exp8
                     exp9
                      0
           ;
         statement
          executable
           variable_ref
            var_ref
             var_ref
              write_id
               id
                keyword
             argument_list
              (
              arg_list
               arg
                exp
                 exp1
                  exp2
                   exp3
                    exp4
                     exp5
                      exp6
                       exp7
                        exp8
                         exp9
                          string_literal
                           'IF'
              )
           =
           exp
            exp1
             exp2
              exp3
               exp4
                exp5
                 exp6
                  exp7
                   exp8
                    exp9
                     0
          ;
        statement
         executable
          variable_ref
           var_ref
            var_ref
             write_id
              id
               keyword
            argument_list
             (
             arg_list
              arg
               exp
                exp1
                 exp2
                  exp3
                   exp4
                    exp5
                     exp6
                      exp7
                       exp8
                        exp9
                         string_literal
                          'THEN'
             )
          =
          exp
           exp1
            exp2
             exp3
              exp4
               exp5
                exp6
                 exp7
                  exp8
                   exp9
                    0
         ;
       statement
        executable
         variable_ref
          var_ref
           var_ref
            write_id
             id
              keyword
           argument_list
            (
            arg_list
             arg
              exp
               exp1
                exp2
                 exp3
                  exp4
                   exp5
                    exp6
                     exp7
                      exp8
                       exp9
                        string_literal
                         'ELSE'
            )
         =
         exp
          exp1
           exp2
            exp3
             exp4
              exp5
               exp6
                exp7
                 exp8
                  exp9
                   0
        ;
      statement
       executable
        keyword_statement
         start_scan_statement
          START
          SCAN
          scan_attr_list
           scan_attr_list
            scan_attr
             INPUT
             FILE
             exp
              exp1
               exp2
                exp3
                 exp4
                  exp5
                   exp6
                    exp7
                     exp8
                      exp9
                       string_literal
                        'caps.bas'
           scan_attr
            OUTPUT
            FILE
            exp
             exp1
              exp2
               exp3
                exp4
                 exp5
                  exp6
                   exp7
                    exp8
                     exp9
                      string_literal
                       'new_caps.bas'
       ;
    END
    PROCEDURE
  ;
 end_module
  END
  MODULE
 ;
 <EOF>
