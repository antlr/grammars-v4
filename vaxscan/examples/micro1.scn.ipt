program
 MODULE
 id
  micro_trans
 opt_ident
  IDENT
  ident_string
   'V1.0'
  ;
 module_statement_list
  module_statement_list
   module_statement_list
    module_statement_list
     module_statement_list
      module_statement_list
       module_statement_list
        module_statement_list
         module_statement_list
          module_statement_list
           module_statement_list
            module_statement_list
             module_statement_list
              module_statement_list
               module_statement_list
                module_statement_list
                 module_statement_list
                  module_statement_list
                   module_statement_list
                    module_statement_list
                     module_statement_list
                      module_statement_list
                       module_statement_list
                        module_statement_list
                         module_statement_list
                          module_statement_list
                           module_statement_list
                            module_statement_list
                             module_statement_list
                              module_statement
                               directive
                                include_directive
                                 INCLUDE
                                 FILE
                                 exp
                                  exp1
                                   exp2
                                    exp3
                                     exp4
                                      exp5
                                       exp6
                                        exp7
                                         exp8
                                          exp9
                                           string_literal
                                            'keys.inc'
                              ;
                             module_statement
                              declaration
                               procedure_form_decl
                                proc_name
                                 FORWARD
                                 PROCEDURE
                                 id
                                  process_id
                                opt_formal_list
                                 (
                                 formal_list
                                  formal
                                   type_dec
                                    string
                                 )
                             ;
                            module_statement
                             set_declaration
                              SET
                              id
                               alpha
                              (
                              set_exp
                               set_exp
                                set_term
                                 set_primary
                                  set_item
                                   string_literal
                                    'a'
                                   ..
                                   string_literal
                                    'z'
                               OR
                               set_term
                                set_primary
                                 set_item
                                  string_literal
                                   'A'
                                  ..
                                  string_literal
                                   'Z'
                              )
                            ;
                           module_statement
                            set_declaration
                             SET
                             id
                              digit
                             (
                             set_exp
                              set_term
                               set_primary
                                set_item
                                 string_literal
                                  '0'
                                 ..
                                 string_literal
                                  '9'
                             )
                           ;
                          module_statement
                           set_declaration
                            SET
                            id
                             other
                            (
                            set_exp
                             set_exp
                              set_exp
                               set_term
                                set_primary
                                 set_item
                                  id
                                   alpha
                              OR
                              set_term
                               set_primary
                                set_item
                                 id
                                  digit
                             OR
                             set_term
                              set_primary
                               set_item
                                string_literal
                                 '.'
                            )
                          ;
                         module_statement
                          set_declaration
                           SET
                           id
                            typer
                           (
                           set_exp
                            set_exp
                             set_exp
                              set_exp
                               set_term
                                set_primary
                                 set_item
                                  string_literal
                                   '$'
                              OR
                              set_term
                               set_primary
                                set_item
                                 string_literal
                                  '%'
                             OR
                             set_term
                              set_primary
                               set_item
                                string_literal
                                 '!'
                            or
                            set_term
                             set_primary
                              set_item
                               string_literal
                                '#'
                           )
                         ;
                        module_statement
                         set_declaration
                          SET
                          id
                           non_quote
                          (
                          set_exp
                           set_term
                            set_primary
                             NOT
                             set_item
                              (
                              set_exp
                               set_term
                                set_primary
                                 set_item
                                  string_literal
                                   '"'
                              )
                          )
                        ;
                       module_statement
                        set_declaration
                         SET
                         id
                          non_eol
                         (
                         set_exp
                          set_term
                           set_primary
                            NOT
                            set_item
                             (
                             set_exp
                              set_exp
                               set_term
                                set_primary
                                 set_item
                                  string_literal
                                   s'eol'
                              OR
                              set_term
                               set_primary
                                set_item
                                 string_literal
                                  ':'
                             )
                         )
                       ;
                      module_statement
                       set_declaration
                        SET
                        id
                         hex_digit
                        (
                        set_exp
                         set_exp
                          set_term
                           set_primary
                            set_item
                             id
                              digit
                         OR
                         set_term
                          set_primary
                           set_item
                            string_literal
                             'A'
                            ..
                            string_literal
                             'F'
                        )
                      ;
                     module_statement
                      token_declaration
                       TOKEN
                       id
                        start_line
                       token_attrs
                       {
                       token_exp
                        token_exp
                         token_exp1
                          token_exp2
                           token_exp3
                            string_literal
                             s'sos'
                        alt_
                         |
                        token_exp1
                         token_exp2
                          token_exp3
                           string_literal
                            s'eol'
                       }
                     ;
                    module_statement
                     token_declaration
                      TOKEN
                      id
                       line_number
                      token_attrs
                      {
                      token_exp
                       token_exp1
                        token_exp1
                         token_exp2
                          token_exp3
                           {
                           token_exp
                            token_exp
                             token_exp1
                              token_exp2
                               token_exp3
                                string_literal
                                 s'sos'
                            alt_
                             |
                            token_exp1
                             token_exp2
                              token_exp3
                               string_literal
                                s'eol'
                           }
                        token_exp2
                         token_exp3
                          id
                           digit
                         ...
                      }
                    ;
                   module_statement
                    token_declaration
                     TOKEN
                     id
                      id
                     token_attrs
                     {
                     token_exp
                      token_exp1
                       token_exp1
                        token_exp1
                         token_exp2
                          token_exp3
                           id
                            alpha
                        token_exp2
                         token_exp3
                          [
                          token_exp
                           token_exp1
                            token_exp2
                             token_exp3
                              id
                               other
                             ...
                          ]
                       token_exp2
                        token_exp3
                         [
                         token_exp
                          token_exp1
                           token_exp2
                            token_exp3
                             id
                              typer
                         ]
                     }
                   ;
                  module_statement
                   token_declaration
                    TOKEN
                    id
                     str
                    token_attrs
                    {
                    token_exp
                     token_exp1
                      token_exp1
                       token_exp1
                        token_exp2
                         token_exp3
                          string_literal
                           '"'
                       token_exp2
                        token_exp3
                         [
                         token_exp
                          token_exp1
                           token_exp2
                            token_exp3
                             id
                              non_quote
                            ...
                         ]
                      token_exp2
                       token_exp3
                        string_literal
                         '"'
                    }
                  ;
                 module_statement
                  token_declaration
                   TOKEN
                   id
                    int
                   token_attrs
                   {
                   token_exp
                    token_exp1
                     token_exp2
                      token_exp3
                       id
                        digit
                      ...
                   }
                 ;
                module_statement
                 token_declaration
                  TOKEN
                  id
                   real
                  token_attrs
                  {
                  token_exp
                   token_exp1
                    token_exp1
                     token_exp1
                      token_exp1
                       token_exp1
                        token_exp2
                         token_exp3
                          [
                          token_exp
                           token_exp1
                            token_exp2
                             token_exp3
                              id
                               digit
                             ...
                          ]
                       token_exp2
                        token_exp3
                         string_literal
                          '.'
                      token_exp2
                       token_exp3
                        [
                        token_exp
                         token_exp1
                          token_exp2
                           token_exp3
                            id
                             digit
                           ...
                        ]
                     token_exp2
                      token_exp3
                       [
                       token_exp
                        token_exp1
                         token_exp1
                          token_exp1
                           token_exp2
                            token_exp3
                             {
                             token_exp
                              token_exp
                               token_exp1
                                token_exp2
                                 token_exp3
                                  string_literal
                                   'D'
                              alt_
                               |
                              token_exp1
                               token_exp2
                                token_exp3
                                 string_literal
                                  'E'
                             }
                          token_exp2
                           token_exp3
                            {
                            token_exp
                             token_exp
                              token_exp1
                               token_exp2
                                token_exp3
                                 string_literal
                                  '+'
                             alt_
                              |
                             token_exp1
                              token_exp2
                               token_exp3
                                string_literal
                                 '-'
                            }
                         token_exp2
                          token_exp3
                           id
                            digit
                          ...
                       ]
                    token_exp2
                     token_exp3
                      [
                      token_exp
                       token_exp1
                        token_exp2
                         token_exp3
                          {
                          token_exp
                           token_exp
                            token_exp1
                             token_exp2
                              token_exp3
                               string_literal
                                '!'
                           alt_
                            |
                           token_exp1
                            token_exp2
                             token_exp3
                              string_literal
                               '#'
                          }
                      ]
                  }
                ;
               module_statement
                token_declaration
                 TOKEN
                 id
                  radix
                 token_attrs
                 {
                 token_exp
                  token_exp1
                   token_exp1
                    token_exp1
                     token_exp2
                      token_exp3
                       string_literal
                        '&'
                    token_exp2
                     token_exp3
                      {
                      token_exp
                       token_exp
                        token_exp1
                         token_exp2
                          token_exp3
                           string_literal
                            'H'
                       alt_
                        |
                       token_exp1
                        token_exp2
                         token_exp3
                          string_literal
                           'O'
                      }
                   token_exp2
                    token_exp3
                     id
                      hex_digit
                    ...
                 }
               ;
              module_statement
               token_declaration
                TOKEN
                id
                 colon
                token_attrs
                 token_attr_list
                  token_attr
                   ALIAS
                   ':'
                {
                token_exp
                 token_exp1
                  token_exp2
                   token_exp3
                    string_literal
                     ':'
                }
              ;
             module_statement
              token_declaration
               TOKEN
               id
                amp
               token_attrs
                token_attr_list
                 token_attr
                  ALIAS
                  '&'
               {
               token_exp
                token_exp1
                 token_exp2
                  token_exp3
                   string_literal
                    '&'
               }
             ;
            module_statement
             token_declaration
              TOKEN
              id
               comment
              token_attrs
              {
              token_exp
               token_exp1
                token_exp1
                 token_exp2
                  token_exp3
                   {
                   token_exp
                    token_exp
                     token_exp1
                      token_exp2
                       token_exp3
                        string_literal
                         ''''
                    alt_
                     |
                    token_exp1
                     token_exp2
                      token_exp3
                       string_literal
                        '!'
                   }
                token_exp2
                 token_exp3
                  [
                  token_exp
                   token_exp1
                    token_exp2
                     token_exp3
                      id
                       non_eol
                     ...
                  ]
              }
            ;
           module_statement
            token_declaration
             TOKEN
             id
              space
             token_attrs
              token_attr_list
               token_attr
                IGNORE
             {
             token_exp
              token_exp1
               token_exp2
                token_exp3
                 {
                 token_exp
                  token_exp
                   token_exp1
                    token_exp2
                     token_exp3
                      string_literal
                       ' '
                  alt_
                   |
                  token_exp1
                   token_exp2
                    token_exp3
                     string_literal
                      ctrl_char_literal
                       s'ht'
                 }
                ...
             }
           ;
          module_statement
           token_declaration
            TOKEN
            id
             punct
            token_attrs
            {
            token_exp
             token_exp
              token_exp
               token_exp
                token_exp
                 token_exp
                  token_exp
                   token_exp
                    token_exp
                     token_exp
                      token_exp
                       token_exp
                        token_exp
                         token_exp
                          token_exp
                           token_exp
                            token_exp1
                             token_exp2
                              token_exp3
                               string_literal
                                ';'
                           alt_
                            |
                           token_exp1
                            token_exp2
                             token_exp3
                              string_literal
                               '='
                          alt_
                           |
                          token_exp1
                           token_exp2
                            token_exp3
                             string_literal
                              '+'
                         alt_
                          |
                         token_exp1
                          token_exp2
                           token_exp3
                            string_literal
                             '-'
                        alt_
                         |
                        token_exp1
                         token_exp2
                          token_exp3
                           string_literal
                            '*'
                       alt_
                        |
                       token_exp1
                        token_exp2
                         token_exp3
                          string_literal
                           '/'
                      alt_
                       |
                      token_exp1
                       token_exp1
                        token_exp2
                         token_exp3
                          string_literal
                           '^'
                       token_exp2
                        token_exp3
                         string_literal
                          '('
                     alt_
                      |
                     token_exp1
                      token_exp2
                       token_exp3
                        string_literal
                         ')'
                    alt_
                     |
                    token_exp1
                     token_exp2
                      token_exp3
                       string_literal
                        '['
                   alt_
                    |
                   token_exp1
                    token_exp2
                     token_exp3
                      string_literal
                       ']'
                  alt_
                   |
                  token_exp1
                   token_exp2
                    token_exp3
                     string_literal
                      ','
                 alt_
                  |
                 token_exp1
                  token_exp2
                   token_exp3
                    string_literal
                     '?'
                alt_
                 |
                token_exp1
                 token_exp1
                  token_exp2
                   token_exp3
                    string_literal
                     '<'
                 token_exp2
                  token_exp3
                   string_literal
                    '>'
               alt_
                |
               token_exp1
                token_exp2
                 token_exp3
                  string_literal
                   '\'
              alt_
               |
              token_exp1
               token_exp2
                token_exp3
                 string_literal
                  '@'
             alt_
              |
             token_exp1
              token_exp2
               token_exp3
                string_literal
                 '_'
            }
          ;
         module_statement
          group_declaration
           GROUP
           id
            rest
           (
           group_exp
            group_term
             group_primary
              NOT
              group_item
               (
               group_exp
                group_exp
                 group_exp
                  group_term
                   group_primary
                    group_item
                     id
                      line_number
                 OR
                 group_term
                  group_primary
                   group_item
                    id
                     start_line
                OR
                group_term
                 group_primary
                  group_item
                   token_alias
                    ':'
               )
           )
         ;
        module_statement
         macro_declaration
          MACRO
          id
           new_line
          macro_type
           TRIGGER
          opt_macro_attrs
          {
          opt_picture
           picture
            pic1
             pic2
              pic3
               pic4
                id
                 l
                :
                macro_item
                 {
                 picture
                  pic1
                   pic2
                    pic2
                     pic3
                      pic4
                       macro_item
                        id
                         line_number
                    pic3
                     pic4
                      macro_item
                       id
                        stmt
                 }
          }
          ;
          body
           statement_list
            statement
             executable
              keyword_statement
               answer_statement
                ANSWER
                exp_list
                 exp
                  exp1
                   exp2
                    exp3
                     exp4
                      exp5
                       exp6
                        exp7
                         exp8
                          exp9
                           ref
                            id
                             l
             ;
          END
          MACRO
        ;
       module_statement
        macro_declaration
         MACRO
         id
          new_stmt
         macro_type
          TRIGGER
         opt_macro_attrs
         {
         opt_picture
          picture
           pic1
            pic2
             pic2
              pic3
               pic4
                macro_item
                 token_alias
                  ':'
             pic3
              pic4
               id
                s
               :
               macro_item
                id
                 stmt
         }
         ;
         body
          statement_list
           statement
            executable
             keyword_statement
              answer_statement
               ANSWER
               exp_list
                exp_list
                 exp
                  exp1
                   exp2
                    exp3
                     exp4
                      exp5
                       exp6
                        exp7
                         exp8
                          exp9
                           string_literal
                            s'eol'
                ,
                exp
                 exp1
                  exp2
                   exp3
                    exp4
                     exp5
                      exp6
                       exp7
                        exp8
                         exp9
                          ref
                           id
                            s
            ;
         END
         MACRO
       ;
      module_statement
       macro_declaration
        MACRO
        id
         comment_line
        macro_type
         TRIGGER
        opt_macro_attrs
        {
        opt_picture
         picture
          pic1
           pic2
            pic2
             pic3
              pic4
               id
                l
               :
               macro_item
                id
                 line_number
            pic3
             pic4
              id
               c
              :
              macro_item
               id
                comment
        }
        ;
        body
         statement_list
          statement
           executable
            keyword_statement
             answer_statement
              ANSWER
              exp_list
               exp_list
                exp_list
                 exp
                  exp1
                   exp2
                    exp3
                     exp4
                      exp5
                       exp6
                        exp7
                         exp8
                          exp9
                           ref
                            id
                             l
                ,
                exp
                 exp1
                  exp2
                   exp3
                    exp4
                     exp5
                      exp6
                       exp7
                        exp8
                         exp9
                          string_literal
                           ctrl_char_literal
                            s'ht'
               ,
               exp
                exp1
                 exp2
                  exp3
                   exp4
                    exp5
                     exp6
                      exp7
                       exp8
                        exp9
                         ref
                          id
                           c
           ;
        END
        MACRO
      ;
     module_statement
      macro_declaration
       MACRO
       id
        number_at_start_line
       macro_type
        TRIGGER
       opt_macro_attrs
       {
       opt_picture
        picture
         pic1
          pic2
           pic3
            pic4
             id
              l
             :
             macro_item
              id
               line_number
       }
       ;
       body
        statement_list
         statement
          executable
           keyword_statement
            answer_statement
             ANSWER
             exp_list
              exp_list
               exp
                exp1
                 exp2
                  exp3
                   exp4
                    exp5
                     exp6
                      exp7
                       exp8
                        exp9
                         string_literal
                          ' '
              ,
              exp
               exp1
                exp2
                 exp3
                  exp4
                   exp5
                    exp6
                     exp7
                      exp8
                       exp9
                        ref
                         id
                          l
                       [
                       part_ref
                        exp
                         exp1
                          exp2
                           exp3
                            exp4
                             exp5
                              exp6
                               exp7
                                exp8
                                 exp9
                                  2
                        rest_of_part_ref
                         ..
                         ]
          ;
       END
       MACRO
     ;
    module_statement
     macro_declaration
      MACRO
      id
       stmt
      macro_type
       SYNTAX
      opt_macro_attrs
      {
      opt_picture
       picture
        pic1
         pic2
          pic2
           pic3
            pic4
             id
              i
             :
             macro_item
              {
              picture
               picture
                pic1
                 pic2
                  pic3
                   pic4
                    macro_item
                     id
                      id
               alt_
                |
               pic1
                pic2
                 pic3
                  pic4
                   macro_item
                    token_alias
                     '&'
              }
          pic3
           pic4
            macro_item
             [
             picture
              pic1
               pic2
                pic3
                 pic4
                  macro_item
                   {
                   picture
                    picture
                     pic1
                      pic2
                       pic3
                        pic4
                         id
                          r
                         :
                         macro_item
                          id
                           rest
                    alt_
                     |
                    pic1
                     pic2
                      pic3
                       pic4
                        macro_item
                         id
                          start_line
                   }
                 ...
             ]
      }
      ;
      body
       statement_list
        statement_list
         statement_list
          statement_list
           statement_list
            statement_list
             statement_list
              statement_list
               statement_list
                statement
                 declaration
                  variable_declaration
                   DECLARE
                   name_list
                    pic_id
                     id
                      p
                   :
                   type_dec
                    common_type_dec
                     TREEPTR
                     (
                     level_type
                      INTEGER
                     )
                     TO
                     type_dec
                      DYNAMIC
                      STRING
                 ;
               statement
                declaration
                 variable_declaration
                  DECLARE
                  name_list
                   name_list
                    pic_id
                     id
                      rest
                   ,
                   pic_id
                    id
                     id
                  :
                  type_dec
                   DYNAMIC
                   STRING
                ;
              statement
               declaration
                variable_declaration
                 DECLARE
                 name_list
                  pic_id
                   id
                    pos
                 :
                 type_dec
                  common_type_dec
                   INTEGER
               ;
             statement
              executable
               variable_ref
                var_ref
                 write_id
                  id
                   i
               =
               exp
                exp1
                 exp2
                  exp3
                   exp4
                    exp5
                     exp6
                      exp7
                       exp8
                        exp9
                         ref
                          ref
                           id
                            trim
                          argument_list
                           (
                           arg_list
                            arg
                             exp
                              exp1
                               exp2
                                exp3
                                 exp4
                                  exp5
                                   exp6
                                    exp7
                                     exp8
                                      exp9
                                       ref
                                        id
                                         i
                           )
              ;
            statement
             executable
              keyword_statement
               if_statement
                IF
                exp
                 exp1
                  exp2
                   exp3
                    exp3
                     exp4
                      exp5
                       exp6
                        exp7
                         exp8
                          exp9
                           ref
                            id
                             i
                    =
                    exp4
                     exp5
                      exp6
                       exp7
                        exp8
                         exp9
                          string_literal
                           '&'
                THEN
                executable_list
                 executable
                  variable_ref
                   var_ref
                    write_id
                     id
                      i
                  =
                  exp
                   exp1
                    exp2
                     exp3
                      exp4
                       exp5
                        exp6
                         exp7
                          exp8
                           exp9
                            string_literal
                             'PRINT'
                 ;
                opt_else_statement
                END
                IF
             ;
           statement
            executable
             keyword_statement
              call_statement
               CALL
               id
                process_id
               argument_list
                (
                arg_list
                 arg
                  exp
                   exp1
                    exp2
                     exp3
                      exp4
                       exp5
                        exp6
                         exp7
                          exp8
                           exp9
                            ref
                             id
                              i
                )
            ;
          statement
           executable
            variable_ref
             var_ref
              write_id
               id
                p
            =
            exp
             exp1
              exp2
               exp3
                exp4
                 exp5
                  exp6
                   exp7
                    exp8
                     exp9
                      ref
                       ref
                        id
                         first
                       argument_list
                        (
                        arg_list
                         arg
                          exp
                           exp1
                            exp2
                             exp3
                              exp4
                               exp5
                                exp6
                                 exp7
                                  exp8
                                   exp9
                                    ref
                                     id
                                      r
                        )
           ;
         statement
          executable
           keyword_statement
            while_statement
             WHILE
             exp
              exp1
               exp2
                exp3
                 exp3
                  exp4
                   exp5
                    exp6
                     exp7
                      exp8
                       exp9
                        ref
                         id
                          p
                 <>
                 exp4
                  exp5
                   exp6
                    exp7
                     exp8
                      exp9
                       NIL
             ;
             executable_list
              executable_list
               executable_list
                executable_list
                 executable_list
                  executable
                   variable_ref
                    var_ref
                     write_id
                      id
                       id
                   =
                   exp
                    exp1
                     exp2
                      exp3
                       exp4
                        exp5
                         exp6
                          exp7
                           exp8
                            exp9
                             ref
                              ref
                               id
                                trim
                              argument_list
                               (
                               arg_list
                                arg
                                 exp
                                  exp1
                                   exp2
                                    exp3
                                     exp4
                                      exp5
                                       exp6
                                        exp7
                                         exp8
                                          exp9
                                           ref
                                            ref
                                             id
                                              value
                                            argument_list
                                             (
                                             arg_list
                                              arg
                                               exp
                                                exp1
                                                 exp2
                                                  exp3
                                                   exp4
                                                    exp5
                                                     exp6
                                                      exp7
                                                       exp8
                                                        exp9
                                                         ref
                                                          id
                                                           p
                                             )
                               )
                  ;
                 executable
                  keyword_statement
                   if_statement
                    IF
                    exp
                     exp1
                      exp2
                       exp3
                        exp3
                         exp4
                          exp5
                           exp6
                            exp7
                             exp8
                              exp9
                               ref
                                ref
                                 id
                                  member
                                argument_list
                                 (
                                 arg_list
                                  arg_list
                                   arg
                                    exp
                                     exp1
                                      exp2
                                       exp3
                                        exp4
                                         exp5
                                          exp6
                                           exp7
                                            exp8
                                             exp9
                                              ref
                                               id
                                                id
                                             [
                                             part_ref
                                              exp
                                               exp1
                                                exp2
                                                 exp3
                                                  exp4
                                                   exp5
                                                    exp6
                                                     exp7
                                                      exp8
                                                       exp9
                                                        1
                                              rest_of_part_ref
                                               ]
                                  ,
                                  arg
                                   exp
                                    exp1
                                     exp2
                                      exp3
                                       exp4
                                        exp4
                                         exp5
                                          exp6
                                           exp7
                                            exp8
                                             exp9
                                              string_literal
                                               'abcdefghijklmnopqrstuvwxyz'
                                        &
                                        exp5
                                         exp6
                                          exp7
                                           exp8
                                            exp9
                                             string_literal
                                              'ABCDEFGHIJKLMNOPQRSTUVWXYZ'
                                 )
                        =
                        exp4
                         exp5
                          exp6
                           exp7
                            exp8
                             exp9
                              1
                    THEN
                    executable_list
                     executable
                      keyword_statement
                       call_statement
                        CALL
                        id
                         process_id
                        argument_list
                         (
                         arg_list
                          arg
                           exp
                            exp1
                             exp2
                              exp3
                               exp4
                                exp5
                                 exp6
                                  exp7
                                   exp8
                                    exp9
                                     ref
                                      id
                                       id
                         )
                     ;
                    opt_else_statement
                    END
                    IF
                 ;
                executable
                 keyword_statement
                  if_statement
                   IF
                   exp
                    exp1
                     exp2
                      exp3
                       exp3
                        exp4
                         exp5
                          exp6
                           exp7
                            exp8
                             exp9
                              ref
                               id
                                id
                       =
                       exp4
                        exp5
                         exp6
                          exp7
                           exp8
                            exp9
                             string_literal
                              '&'
                   THEN
                   executable_list
                    executable
                     variable_ref
                      var_ref
                       write_id
                        id
                         id
                     =
                     exp
                      exp1
                       exp2
                        exp3
                         exp4
                          exp5
                           exp6
                            exp7
                             exp8
                              exp9
                               string_literal
                                'PRINT'
                    ;
                   opt_else_statement
                   END
                   IF
                ;
               executable
                variable_ref
                 var_ref
                  write_id
                   id
                    rest
                =
                exp
                 exp1
                  exp2
                   exp3
                    exp4
                     exp4
                      exp4
                       exp5
                        exp6
                         exp7
                          exp8
                           exp9
                            ref
                             id
                              rest
                      &
                      exp5
                       exp6
                        exp7
                         exp8
                          exp9
                           string_literal
                            ' '
                     &
                     exp5
                      exp6
                       exp7
                        exp8
                         exp9
                          ref
                           id
                            id
               ;
              executable
               variable_ref
                var_ref
                 write_id
                  id
                   p
               =
               exp
                exp1
                 exp2
                  exp3
                   exp4
                    exp5
                     exp6
                      exp7
                       exp8
                        exp9
                         ref
                          ref
                           id
                            NEXT
                          argument_list
                           (
                           arg_list
                            arg
                             exp
                              exp1
                               exp2
                                exp3
                                 exp4
                                  exp5
                                   exp6
                                    exp7
                                     exp8
                                      exp9
                                       ref
                                        id
                                         p
                           )
              ;
             END
             WHILE
          ;
        statement
         executable
          keyword_statement
           answer_statement
            ANSWER
            exp_list
             exp_list
              exp_list
               exp
                exp1
                 exp2
                  exp3
                   exp4
                    exp5
                     exp6
                      exp7
                       exp8
                        exp9
                         string_literal
                          ctrl_char_literal
                           s'ht'
              ,
              exp
               exp1
                exp2
                 exp3
                  exp4
                   exp5
                    exp6
                     exp7
                      exp8
                       exp9
                        ref
                         id
                          i
             ,
             exp
              exp1
               exp2
                exp3
                 exp4
                  exp5
                   exp6
                    exp7
                     exp8
                      exp9
                       ref
                        id
                         rest
         ;
      END
      MACRO
    ;
   module_statement
    procedure_declaration
     proc_start
      PROCEDURE
      id
       main
      opt_proc_attr
       MAIN
     ;
     body
      statement_list
       statement
        executable
         keyword_statement
          start_scan_statement
           START
           SCAN
           scan_attr_list
            scan_attr_list
             scan_attr
              INPUT
              FILE
              exp
               exp1
                exp2
                 exp3
                  exp4
                   exp5
                    exp6
                     exp7
                      exp8
                       exp9
                        string_literal
                         'micro.dat'
            scan_attr
             OUTPUT
             FILE
             exp
              exp1
               exp2
                exp3
                 exp4
                  exp5
                   exp6
                    exp7
                     exp8
                      exp9
                       string_literal
                        'micro.tm1'
        ;
     END
     PROCEDURE
   ;
  module_statement
   procedure_declaration
    proc_start
     PROCEDURE
     id
      process_id
    opt_parameter_list
     (
     parameter_list
      parameter
       id
        id
       :
       type_dec
        string
     )
    ;
    body
     statement_list
      statement_list
       statement_list
        statement_list
         statement_list
          statement
           declaration
            variable_declaration
             DECLARE
             name_list
              name_list
               pic_id
                id
                 i
              ,
              pic_id
               id
                p
             :
             type_dec
              common_type_dec
               INTEGER
           ;
         statement
          declaration
           variable_declaration
            DECLARE
            name_list
             pic_id
              id
               key
            :
            type_dec
             common_type_dec
              VARYING
              STRING
              length
               (
               int_ct_exp
                exp
                 exp1
                  exp2
                   exp3
                    exp4
                     exp5
                      exp6
                       exp7
                        exp8
                         exp9
                          ref
                           id
                            key_length
               )
          ;
        statement
         executable
          variable_ref
           var_ref
            write_id
             id
              id
          =
          exp
           exp1
            exp2
             exp3
              exp4
               exp4
                exp5
                 exp6
                  exp7
                   exp8
                    exp9
                     ref
                      ref
                       id
                        lower
                      argument_list
                       (
                       arg_list
                        arg
                         exp
                          exp1
                           exp2
                            exp3
                             exp4
                              exp5
                               exp6
                                exp7
                                 exp8
                                  exp9
                                   ref
                                    id
                                     id
                       )
               &
               exp5
                exp6
                 exp7
                  exp8
                   exp9
                    string_literal
                     ' '
         ;
       statement
        executable
         keyword_statement
          for_statement
           start_for_loop
            FOR
            id
             i
            =
            exp
             exp1
              exp2
               exp3
                exp4
                 exp5
                  exp6
                   exp7
                    exp8
                     exp9
                      1
            TO
            exp
             exp1
              exp2
               exp3
                exp4
                 exp5
                  exp6
                   exp7
                    exp8
                     exp9
                      ref
                       ref
                        id
                         LENGTH
                       argument_list
                        (
                        arg_list
                         arg
                          exp
                           exp1
                            exp2
                             exp3
                              exp4
                               exp5
                                exp6
                                 exp7
                                  exp8
                                   exp9
                                    ref
                                     id
                                      keyword
                        )
            STEP
            exp
             exp1
              exp2
               exp3
                exp4
                 exp5
                  exp6
                   exp7
                    exp8
                     exp9
                      ref
                       id
                        key_length
           ;
           executable_list
            executable_list
             executable_list
              executable
               variable_ref
                var_ref
                 write_id
                  id
                   key
               =
               exp
                exp1
                 exp2
                  exp3
                   exp4
                    exp5
                     exp6
                      exp7
                       exp8
                        exp9
                         ref
                          ref
                           id
                            trim
                          argument_list
                           (
                           arg_list
                            arg
                             exp
                              exp1
                               exp2
                                exp3
                                 exp4
                                  exp5
                                   exp6
                                    exp7
                                     exp8
                                      exp9
                                       ref
                                        id
                                         keyword
                                      [
                                      part_ref
                                       exp
                                        exp1
                                         exp2
                                          exp3
                                           exp4
                                            exp5
                                             exp6
                                              exp7
                                               exp8
                                                exp9
                                                 ref
                                                  id
                                                   i
                                       rest_of_part_ref
                                        ..
                                        exp
                                         exp1
                                          exp2
                                           exp3
                                            exp4
                                             exp5
                                              exp5
                                               exp5
                                                exp6
                                                 exp7
                                                  exp8
                                                   exp9
                                                    ref
                                                     id
                                                      i
                                               +
                                               exp6
                                                exp7
                                                 exp8
                                                  exp9
                                                   ref
                                                    id
                                                     key_length
                                              -
                                              exp6
                                               exp7
                                                exp8
                                                 exp9
                                                  1
                                        ]
                           )
              ;
             executable
              keyword_statement
               while_statement
                WHILE
                exp
                 exp1
                  exp2
                   exp3
                    exp4
                     exp5
                      exp6
                       exp7
                        exp8
                         exp9
                          true
                ;
                executable_list
                 executable_list
                  executable_list
                   executable
                    variable_ref
                     var_ref
                      write_id
                       id
                        p
                    =
                    exp
                     exp1
                      exp2
                       exp3
                        exp4
                         exp5
                          exp6
                           exp7
                            exp8
                             exp9
                              ref
                               ref
                                id
                                 index
                               argument_list
                                (
                                arg_list
                                 arg_list
                                  arg
                                   exp
                                    exp1
                                     exp2
                                      exp3
                                       exp4
                                        exp5
                                         exp6
                                          exp7
                                           exp8
                                            exp9
                                             ref
                                              id
                                               id
                                 ,
                                 arg
                                  exp
                                   exp1
                                    exp2
                                     exp3
                                      exp4
                                       exp5
                                        exp6
                                         exp7
                                          exp8
                                           exp9
                                            ref
                                             id
                                              key
                                )
                   ;
                  executable
                   keyword_statement
                    if_statement
                     IF
                     exp
                      exp1
                       exp2
                        exp3
                         exp3
                          exp4
                           exp5
                            exp6
                             exp7
                              exp8
                               exp9
                                ref
                                 id
                                  p
                         =
                         exp4
                          exp5
                           exp6
                            exp7
                             exp8
                              exp9
                               0
                     THEN
                     executable_list
                      executable
                       keyword_statement
                        goto_statement
                         GOTO
                         id
                          next_key
                      ;
                     opt_else_statement
                     END
                     IF
                  ;
                 executable
                  variable_ref
                   var_ref
                    write_id
                     id
                      id
                  =
                  exp
                   exp1
                    exp2
                     exp3
                      exp4
                       exp4
                        exp4
                         exp4
                          exp4
                           exp5
                            exp6
                             exp7
                              exp8
                               exp9
                                ref
                                 id
                                  id
                               [
                               part_ref
                                exp
                                 exp1
                                  exp2
                                   exp3
                                    exp4
                                     exp5
                                      exp6
                                       exp7
                                        exp8
                                         exp9
                                          1
                                rest_of_part_ref
                                 ..
                                 exp
                                  exp1
                                   exp2
                                    exp3
                                     exp4
                                      exp5
                                       exp5
                                        exp6
                                         exp7
                                          exp8
                                           exp9
                                            ref
                                             id
                                              p
                                       -
                                       exp6
                                        exp7
                                         exp8
                                          exp9
                                           1
                                 ]
                          &
                          exp5
                           exp6
                            exp7
                             exp8
                              exp9
                               string_literal
                                ' '
                         &
                         exp5
                          exp6
                           exp7
                            exp8
                             exp9
                              ref
                               ref
                                id
                                 upper
                               argument_list
                                (
                                arg_list
                                 arg
                                  exp
                                   exp1
                                    exp2
                                     exp3
                                      exp4
                                       exp5
                                        exp6
                                         exp7
                                          exp8
                                           exp9
                                            ref
                                             id
                                              key
                                )
                        &
                        exp5
                         exp6
                          exp7
                           exp8
                            exp9
                             string_literal
                              ' '
                       &
                       exp5
                        exp6
                         exp7
                          exp8
                           exp9
                            ref
                             id
                              id
                           [
                           part_ref
                            exp
                             exp1
                              exp2
                               exp3
                                exp4
                                 exp5
                                  exp5
                                   exp6
                                    exp7
                                     exp8
                                      exp9
                                       ref
                                        id
                                         p
                                  +
                                  exp6
                                   exp7
                                    exp8
                                     exp9
                                      ref
                                       ref
                                        id
                                         length
                                       argument_list
                                        (
                                        arg_list
                                         arg
                                          exp
                                           exp1
                                            exp2
                                             exp3
                                              exp4
                                               exp5
                                                exp6
                                                 exp7
                                                  exp8
                                                   exp9
                                                    ref
                                                     id
                                                      key
                                        )
                            rest_of_part_ref
                             ..
                             ]
                 ;
                END
                WHILE
             ;
            executable
             label
              id
               next_key
             :
             executable
            ;
           END
           FOR
        ;
      statement
       executable
        variable_ref
         var_ref
          write_id
           id
            id
        =
        exp
         exp1
          exp2
           exp3
            exp4
             exp5
              exp6
               exp7
                exp8
                 exp9
                  ref
                   ref
                    id
                     trim
                   argument_list
                    (
                    arg_list
                     arg
                      exp
                       exp1
                        exp2
                         exp3
                          exp4
                           exp5
                            exp6
                             exp7
                              exp8
                               exp9
                                ref
                                 id
                                  id
                    )
       ;
    END
    PROCEDURE
  ;
 end_module
  END
  MODULE
 ;
 <EOF>
