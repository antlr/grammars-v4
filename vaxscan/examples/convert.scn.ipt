program
 MODULE
 id
  use_braces
 opt_ident
  ;
 module_statement_list
  module_statement_list
   module_statement_list
    module_statement_list
     module_statement_list
      module_statement_list
       module_statement_list
        module_statement_list
         module_statement_list
          module_statement_list
           module_statement_list
            module_statement_list
             module_statement_list
              module_statement_list
               module_statement_list
                module_statement_list
                 module_statement_list
                  module_statement_list
                   module_statement_list
                    module_statement_list
                     module_statement_list
                      module_statement_list
                       module_statement_list
                        module_statement_list
                         module_statement_list
                          module_statement_list
                           module_statement_list
                            module_statement_list
                             module_statement_list
                              module_statement_list
                               module_statement_list
                                module_statement_list
                                 module_statement_list
                                  module_statement_list
                                   module_statement_list
                                    module_statement_list
                                     module_statement_list
                                      module_statement_list
                                       module_statement_list
                                        module_statement_list
                                         module_statement_list
                                          module_statement_list
                                           module_statement_list
                                            module_statement_list
                                             module_statement_list
                                              module_statement_list
                                               module_statement_list
                                                module_statement_list
                                                 module_statement_list
                                                  module_statement_list
                                                   module_statement_list
                                                    module_statement_list
                                                     module_statement
                                                      declaration
                                                       procedure_form_decl
                                                        proc_name
                                                         EXTERNAL
                                                         PROCEDURE
                                                         id
                                                          lib$find_file
                                                        opt_formal_list
                                                         (
                                                         formal_list
                                                          formal_list
                                                           formal_list
                                                            formal
                                                             type_dec
                                                              STRING
                                                           ,
                                                           formal
                                                            type_dec
                                                             STRING
                                                          ,
                                                          formal
                                                           type_dec
                                                            common_type_dec
                                                             INTEGER
                                                         )
                                                        opt_result
                                                         OF
                                                         type_dec
                                                          common_type_dec
                                                           INTEGER
                                                     ;
                                                    module_statement
                                                     declaration
                                                      procedure_form_decl
                                                       proc_name
                                                        EXTERNAL
                                                        PROCEDURE
                                                        id
                                                         lib$find_file_end
                                                       opt_formal_list
                                                        (
                                                        formal_list
                                                         formal
                                                          type_dec
                                                           common_type_dec
                                                            INTEGER
                                                        )
                                                       opt_result
                                                        OF
                                                        type_dec
                                                         common_type_dec
                                                          INTEGER
                                                    ;
                                                   module_statement
                                                    set_declaration
                                                     SET
                                                     id
                                                      alpha
                                                     (
                                                     set_exp
                                                      set_term
                                                       set_primary
                                                        set_item
                                                         string_literal
                                                          'a'
                                                         ..
                                                         string_literal
                                                          'z'
                                                     )
                                                   ;
                                                  module_statement
                                                   set_declaration
                                                    SET
                                                    id
                                                     other
                                                    (
                                                    set_exp
                                                     set_exp
                                                      set_exp
                                                       set_term
                                                        set_primary
                                                         set_item
                                                          string_literal
                                                           '0'
                                                          ..
                                                          string_literal
                                                           '9'
                                                      OR
                                                      set_term
                                                       set_primary
                                                        set_item
                                                         string_literal
                                                          '$'
                                                     OR
                                                     set_term
                                                      set_primary
                                                       set_item
                                                        string_literal
                                                         '_'
                                                    )
                                                  ;
                                                 module_statement
                                                  set_declaration
                                                   SET
                                                   id
                                                    quote
                                                   (
                                                   set_exp
                                                    set_term
                                                     set_primary
                                                      set_item
                                                       string_literal
                                                        ''''
                                                   )
                                                 ;
                                                module_statement
                                                 set_declaration
                                                  SET
                                                  id
                                                   non_quote
                                                  (
                                                  set_exp
                                                   set_term
                                                    set_primary
                                                     NOT
                                                     set_item
                                                      id
                                                       quote
                                                  )
                                                ;
                                               module_statement
                                                set_declaration
                                                 SET
                                                 id
                                                  non_eol
                                                 (
                                                 set_exp
                                                  set_term
                                                   set_primary
                                                    NOT
                                                    set_item
                                                     string_literal
                                                      s'eol'
                                                 )
                                               ;
                                              module_statement
                                               set_declaration
                                                SET
                                                id
                                                 non_star
                                                (
                                                set_exp
                                                 set_term
                                                  set_primary
                                                   NOT
                                                   set_item
                                                    (
                                                    set_exp
                                                     set_exp
                                                      set_term
                                                       set_primary
                                                        set_item
                                                         string_literal
                                                          '*'
                                                     OR
                                                     set_term
                                                      set_primary
                                                       set_item
                                                        string_literal
                                                         s'eol'
                                                    )
                                                )
                                              ;
                                             module_statement
                                              token_declaration
                                               TOKEN
                                               id
                                                lp
                                               token_attrs
                                                token_attr_list
                                                 token_attr
                                                  ALIAS
                                                  '('
                                               {
                                               token_exp
                                                token_exp1
                                                 token_exp2
                                                  token_exp3
                                                   string_literal
                                                    '('
                                               }
                                             ;
                                            module_statement
                                             token_declaration
                                              TOKEN
                                              id
                                               rp
                                              token_attrs
                                               token_attr_list
                                                token_attr
                                                 ALIAS
                                                 ')'
                                              {
                                              token_exp
                                               token_exp1
                                                token_exp2
                                                 token_exp3
                                                  string_literal
                                                   ')'
                                              }
                                            ;
                                           module_statement
                                            token_declaration
                                             TOKEN
                                             id
                                              semi
                                             token_attrs
                                              token_attr_list
                                               token_attr
                                                ALIAS
                                                ';'
                                             {
                                             token_exp
                                              token_exp1
                                               token_exp2
                                                token_exp3
                                                 string_literal
                                                  ';'
                                             }
                                           ;
                                          module_statement
                                           token_declaration
                                            TOKEN
                                            id
                                             comma
                                            token_attrs
                                             token_attr_list
                                              token_attr
                                               ALIAS
                                               ','
                                            {
                                            token_exp
                                             token_exp1
                                              token_exp2
                                               token_exp3
                                                string_literal
                                                 ','
                                            }
                                          ;
                                         module_statement
                                          token_declaration
                                           TOKEN
                                           id
                                            colon
                                           token_attrs
                                            token_attr_list
                                             token_attr
                                              ALIAS
                                              ':'
                                           {
                                           token_exp
                                            token_exp1
                                             token_exp2
                                              token_exp3
                                               string_literal
                                                ':'
                                           }
                                         ;
                                        module_statement
                                         token_declaration
                                          TOKEN
                                          id
                                           declare_key
                                          token_attrs
                                           token_attr_list
                                            token_attr
                                             CASELESS
                                          {
                                          token_exp
                                           token_exp1
                                            token_exp2
                                             token_exp3
                                              string_literal
                                               'declare'
                                          }
                                        ;
                                       module_statement
                                        token_declaration
                                         TOKEN
                                         id
                                          common_key
                                         token_attrs
                                          token_attr_list
                                           token_attr
                                            CASELESS
                                         {
                                         token_exp
                                          token_exp1
                                           token_exp2
                                            token_exp3
                                             string_literal
                                              'common'
                                         }
                                       ;
                                      module_statement
                                       token_declaration
                                        TOKEN
                                        id
                                         module_key
                                        token_attrs
                                         token_attr_list
                                          token_attr
                                           CASELESS
                                        {
                                        token_exp
                                         token_exp1
                                          token_exp2
                                           token_exp3
                                            string_literal
                                             'module'
                                        }
                                      ;
                                     module_statement
                                      token_declaration
                                       TOKEN
                                       id
                                        macro_key
                                       token_attrs
                                        token_attr_list
                                         token_attr
                                          CASELESS
                                       {
                                       token_exp
                                        token_exp1
                                         token_exp2
                                          token_exp3
                                           string_literal
                                            'macro'
                                       }
                                     ;
                                    module_statement
                                     token_declaration
                                      TOKEN
                                      id
                                       token_key
                                      token_attrs
                                       token_attr_list
                                        token_attr
                                         CASELESS
                                      {
                                      token_exp
                                       token_exp1
                                        token_exp2
                                         token_exp3
                                          string_literal
                                           'token'
                                      }
                                    ;
                                   module_statement
                                    token_declaration
                                     TOKEN
                                     id
                                      trigger_key
                                     token_attrs
                                      token_attr_list
                                       token_attr
                                        CASELESS
                                     {
                                     token_exp
                                      token_exp1
                                       token_exp2
                                        token_exp3
                                         string_literal
                                          'trigger'
                                     }
                                   ;
                                  module_statement
                                   token_declaration
                                    TOKEN
                                    id
                                     syntax_key
                                    token_attrs
                                     token_attr_list
                                      token_attr
                                       CASELESS
                                    {
                                    token_exp
                                     token_exp1
                                      token_exp2
                                       token_exp3
                                        string_literal
                                         'syntax'
                                    }
                                  ;
                                 module_statement
                                  token_declaration
                                   TOKEN
                                   id
                                    expose_key
                                   token_attrs
                                    token_attr_list
                                     token_attr
                                      CASELESS
                                   {
                                   token_exp
                                    token_exp1
                                     token_exp2
                                      token_exp3
                                       string_literal
                                        'expose'
                                   }
                                 ;
                                module_statement
                                 token_declaration
                                  TOKEN
                                  id
                                   open_key
                                  token_attrs
                                   token_attr_list
                                    token_attr
                                     CASELESS
                                  {
                                  token_exp
                                   token_exp1
                                    token_exp2
                                     token_exp3
                                      string_literal
                                       'open'
                                  }
                                ;
                               module_statement
                                token_declaration
                                 TOKEN
                                 id
                                  close_key
                                 token_attrs
                                  token_attr_list
                                   token_attr
                                    CASELESS
                                 {
                                 token_exp
                                  token_exp1
                                   token_exp2
                                    token_exp3
                                     string_literal
                                      'close'
                                 }
                               ;
                              module_statement
                               token_declaration
                                TOKEN
                                id
                                 read_key
                                token_attrs
                                 token_attr_list
                                  token_attr
                                   CASELESS
                                {
                                token_exp
                                 token_exp1
                                  token_exp2
                                   token_exp3
                                    string_literal
                                     'read'
                                }
                              ;
                             module_statement
                              token_declaration
                               TOKEN
                               id
                                write_key
                               token_attrs
                                token_attr_list
                                 token_attr
                                  CASELESS
                               {
                               token_exp
                                token_exp1
                                 token_exp2
                                  token_exp3
                                   string_literal
                                    'write'
                               }
                             ;
                            module_statement
                             token_declaration
                              TOKEN
                              id
                               file_key
                              token_attrs
                               token_attr_list
                                token_attr
                                 CASELESS
                              {
                              token_exp
                               token_exp1
                                token_exp2
                                 token_exp3
                                  string_literal
                                   'file'
                              }
                            ;
                           module_statement
                            token_declaration
                             TOKEN
                             id
                              endfile_key
                             token_attrs
                              token_attr_list
                               token_attr
                                CASELESS
                             {
                             token_exp
                              token_exp1
                               token_exp2
                                token_exp3
                                 string_literal
                                  'endfile'
                             }
                           ;
                          module_statement
                           token_declaration
                            TOKEN
                            id
                             treeptr_key
                            token_attrs
                             token_attr_list
                              token_attr
                               CASELESS
                            {
                            token_exp
                             token_exp1
                              token_exp2
                               token_exp3
                                string_literal
                                 'treeptr'
                            }
                          ;
                         module_statement
                          token_declaration
                           TOKEN
                           id
                            tree_key
                           token_attrs
                            token_attr_list
                             token_attr
                              CASELESS
                           {
                           token_exp
                            token_exp1
                             token_exp2
                              token_exp3
                               string_literal
                                'tree'
                           }
                         ;
                        module_statement
                         token_declaration
                          TOKEN
                          id
                           to_key
                          token_attrs
                           token_attr_list
                            token_attr
                             CASELESS
                          {
                          token_exp
                           token_exp1
                            token_exp2
                             token_exp3
                              string_literal
                               'to'
                          }
                        ;
                       module_statement
                        token_declaration
                         TOKEN
                         id
                          of_key
                         token_attrs
                          token_attr_list
                           token_attr
                            CASELESS
                         {
                         token_exp
                          token_exp1
                           token_exp2
                            token_exp3
                             string_literal
                              'of'
                         }
                       ;
                      module_statement
                       token_declaration
                        TOKEN
                        id
                         id
                        token_attrs
                         token_attr_list
                          token_attr
                           CASELESS
                        {
                        token_exp
                         token_exp1
                          token_exp1
                           token_exp2
                            token_exp3
                             id
                              alpha
                          token_exp2
                           token_exp3
                            [
                            token_exp
                             token_exp
                              token_exp1
                               token_exp2
                                token_exp3
                                 id
                                  alpha
                             alt_
                              |
                             token_exp1
                              token_exp2
                               token_exp3
                                id
                                 other
                            ]
                           ...
                        }
                      ;
                     module_statement
                      token_declaration
                       TOKEN
                       id
                        str
                       token_attrs
                       {
                       token_exp
                        token_exp1
                         token_exp1
                          token_exp1
                           token_exp2
                            token_exp3
                             id
                              quote
                          token_exp2
                           token_exp3
                            [
                            token_exp
                             token_exp
                              token_exp1
                               token_exp2
                                token_exp3
                                 id
                                  non_quote
                             alt_
                              |
                             token_exp1
                              token_exp1
                               token_exp2
                                token_exp3
                                 id
                                  quote
                              token_exp2
                               token_exp3
                                id
                                 quote
                            ]
                           ...
                         token_exp2
                          token_exp3
                           id
                            quote
                       }
                     ;
                    module_statement
                     token_declaration
                      TOKEN
                      id
                       spaces
                      token_attrs
                       token_attr_list
                        token_attr
                         IGNORE
                      {
                      token_exp
                       token_exp1
                        token_exp2
                         token_exp3
                          {
                          token_exp
                           token_exp
                            token_exp1
                             token_exp2
                              token_exp3
                               string_literal
                                ' '
                           alt_
                            |
                           token_exp1
                            token_exp2
                             token_exp3
                              string_literal
                               ctrl_char_literal
                                s'ht'
                          }
                         ...
                      }
                    ;
                   module_statement
                    token_declaration
                     TOKEN
                     id
                      com1
                     token_attrs
                      token_attr_list
                       token_attr
                        IGNORE
                     {
                     token_exp
                      token_exp1
                       token_exp1
                        token_exp2
                         token_exp3
                          string_literal
                           '!'
                       token_exp2
                        token_exp3
                         id
                          non_eol
                        ...
                     }
                   ;
                  module_statement
                   token_declaration
                    TOKEN
                    id
                     com2
                    token_attrs
                     token_attr_list
                      token_attr
                       IGNORE
                    {
                    token_exp
                     token_exp1
                      token_exp1
                       token_exp1
                        token_exp2
                         token_exp3
                          string_literal
                           '/*'
                       token_exp2
                        token_exp3
                         [
                         token_exp
                          token_exp
                           token_exp1
                            token_exp2
                             token_exp3
                              id
                               non_star
                             ...
                          alt_
                           |
                          token_exp1
                           token_exp2
                            token_exp3
                             string_literal
                              '*'
                         ]
                        ...
                      token_exp2
                       token_exp3
                        {
                        token_exp
                         token_exp
                          token_exp1
                           token_exp2
                            token_exp3
                             string_literal
                              s'eol'
                         alt_
                          |
                         token_exp1
                          token_exp2
                           token_exp3
                            string_literal
                             '*/'
                        }
                    }
                  ;
                 module_statement
                  group_declaration
                   GROUP
                   id
                    non_semi
                   (
                   group_exp
                    group_term
                     group_primary
                      NOT
                      group_item
                       token_alias
                        ';'
                   )
                 ;
                module_statement
                 declaration
                  variable_declaration
                   DECLARE
                   name_list
                    pic_id
                     id
                      depth
                   :
                   opt_storage_attr
                    STATIC
                   type_dec
                    common_type_dec
                     INTEGER
                ;
               module_statement
                declaration
                 variable_declaration
                  DECLARE
                  name_list
                   pic_id
                    id
                     files
                  :
                  type_dec
                   TREE
                   (
                   level_types
                    level_type
                     STRING
                   )
                   OF
                   type_dec
                    common_type_dec
                     INTEGER
               ;
              module_statement
               declaration
                variable_declaration
                 DECLARE
                 name_list
                  pic_id
                   id
                    changed
                 :
                 type_dec
                  common_type_dec
                   BOOLEAN
              ;
             module_statement
              macro_declaration
               MACRO
               id
                macro_stmt
               macro_type
                TRIGGER
               opt_macro_attrs
               {
               opt_picture
                picture
                 pic1
                  pic2
                   pic2
                    pic3
                     pic4
                      id
                       x
                      :
                      macro_item
                       {
                       picture
                        pic1
                         pic2
                          pic2
                           pic3
                            pic4
                             macro_item
                              id
                               macro_key
                          pic3
                           pic4
                            macro_item
                             id
                              id
                       }
                   pic3
                    pic4
                     id
                      y
                     :
                     macro_item
                      {
                      picture
                       pic1
                        pic2
                         pic3
                          pic4
                           macro_item
                            [
                            picture
                             picture
                              picture
                               pic1
                                pic2
                                 pic3
                                  pic4
                                   id
                                    t
                                   :
                                   macro_item
                                    id
                                     trigger_key
                              alt_
                               |
                              pic1
                               pic2
                                pic3
                                 pic4
                                  id
                                   s
                                  :
                                  macro_item
                                   id
                                    syntax_key
                             alt_
                              |
                             pic1
                              pic2
                               pic3
                                pic4
                                 id
                                  e
                                 :
                                 macro_item
                                  id
                                   expose_key
                            ]
                          ...
                      }
               }
               ;
               body
                statement_list
                 statement_list
                  statement_list
                   statement_list
                    statement
                     executable
                      keyword_statement
                       answer_statement
                        ANSWER
                        exp_list
                         exp
                          exp1
                           exp2
                            exp3
                             exp4
                              exp5
                               exp6
                                exp7
                                 exp8
                                  exp9
                                   ref
                                    id
                                     x
                     ;
                   statement
                    executable
                     keyword_statement
                      if_statement
                       IF
                       exp
                        exp1
                         exp1
                          exp2
                           exp3
                            exp4
                             exp5
                              exp6
                               exp7
                                exp8
                                 exp9
                                  (
                                  exp
                                   exp1
                                    exp2
                                     exp3
                                      exp3
                                       exp4
                                        exp5
                                         exp6
                                          exp7
                                           exp8
                                            exp9
                                             ref
                                              ref
                                               id
                                                FIRST
                                              argument_list
                                               (
                                               arg_list
                                                arg
                                                 exp
                                                  exp1
                                                   exp2
                                                    exp3
                                                     exp4
                                                      exp5
                                                       exp6
                                                        exp7
                                                         exp8
                                                          exp9
                                                           ref
                                                            id
                                                             t
                                               )
                                      =
                                      exp4
                                       exp5
                                        exp6
                                         exp7
                                          exp8
                                           exp9
                                            NIL
                                  )
                         AND
                         exp2
                          exp3
                           exp4
                            exp5
                             exp6
                              exp7
                               exp8
                                exp9
                                 (
                                 exp
                                  exp1
                                   exp2
                                    exp3
                                     exp3
                                      exp4
                                       exp5
                                        exp6
                                         exp7
                                          exp8
                                           exp9
                                            ref
                                             ref
                                              id
                                               FIRST
                                             argument_list
                                              (
                                              arg_list
                                               arg
                                                exp
                                                 exp1
                                                  exp2
                                                   exp3
                                                    exp4
                                                     exp5
                                                      exp6
                                                       exp7
                                                        exp8
                                                         exp9
                                                          ref
                                                           id
                                                            s
                                              )
                                     =
                                     exp4
                                      exp5
                                       exp6
                                        exp7
                                         exp8
                                          exp9
                                           NIL
                                 )
                       THEN
                       executable_list
                        executable_list
                         executable
                          keyword_statement
                           answer_statement
                            ANSWER
                            exp_list
                             exp
                              exp1
                               exp2
                                exp3
                                 exp4
                                  exp5
                                   exp6
                                    exp7
                                     exp8
                                      exp9
                                       string_literal
                                        ' syntax'
                         ;
                        executable
                         variable_ref
                          var_ref
                           write_id
                            id
                             changed
                         =
                         exp
                          exp1
                           exp2
                            exp3
                             exp4
                              exp5
                               exp6
                                exp7
                                 exp8
                                  exp9
                                   true
                        ;
                       opt_else_statement
                       END
                       IF
                    ;
                  statement
                   executable
                    keyword_statement
                     answer_statement
                      ANSWER
                      exp_list
                       exp
                        exp1
                         exp2
                          exp3
                           exp4
                            exp5
                             exp6
                              exp7
                               exp8
                                exp9
                                 ref
                                  id
                                   y
                   ;
                 statement
                  executable
                   variable_ref
                    var_ref
                     write_id
                      id
                       depth
                   =
                   exp
                    exp1
                     exp2
                      exp3
                       exp4
                        exp5
                         exp5
                          exp6
                           exp7
                            exp8
                             exp9
                              ref
                               id
                                depth
                         +
                         exp6
                          exp7
                           exp8
                            exp9
                             1
                  ;
               END
               MACRO
             ;
            module_statement
             macro_declaration
              MACRO
              id
               token_stmt
              macro_type
               TRIGGER
              opt_macro_attrs
              {
              opt_picture
               picture
                pic1
                 pic2
                  pic3
                   pic4
                    id
                     x
                    :
                    macro_item
                     {
                     picture
                      pic1
                       pic2
                        pic2
                         pic3
                          pic4
                           macro_item
                            id
                             token_key
                        pic3
                         pic4
                          macro_item
                           id
                            id
                     }
              }
              ;
              body
               statement_list
                statement_list
                 statement
                  executable
                   variable_ref
                    var_ref
                     write_id
                      id
                       depth
                   =
                   exp
                    exp1
                     exp2
                      exp3
                       exp4
                        exp5
                         exp5
                          exp6
                           exp7
                            exp8
                             exp9
                              ref
                               id
                                depth
                         +
                         exp6
                          exp7
                           exp8
                            exp9
                             1
                  ;
                statement
                 executable
                  keyword_statement
                   answer_statement
                    ANSWER
                    exp_list
                     exp
                      exp1
                       exp2
                        exp3
                         exp4
                          exp5
                           exp6
                            exp7
                             exp8
                              exp9
                               ref
                                id
                                 x
                 ;
              END
              MACRO
            ;
           module_statement
            macro_declaration
             MACRO
             id
              left_paren
             macro_type
              TRIGGER
             opt_macro_attrs
             {
             opt_picture
              picture
               pic1
                pic2
                 pic3
                  pic4
                   macro_item
                    token_alias
                     '('
             }
             ;
             body
              statement_list
               statement
                executable
                 keyword_statement
                  if_statement
                   IF
                   exp
                    exp1
                     exp2
                      exp3
                       exp3
                        exp4
                         exp5
                          exp6
                           exp7
                            exp8
                             exp9
                              ref
                               id
                                depth
                       >
                       exp4
                        exp5
                         exp6
                          exp7
                           exp8
                            exp9
                             0
                   THEN
                   executable_list
                    executable_list
                     executable
                      keyword_statement
                       answer_statement
                        ANSWER
                        exp_list
                         exp
                          exp1
                           exp2
                            exp3
                             exp4
                              exp5
                               exp6
                                exp7
                                 exp8
                                  exp9
                                   string_literal
                                    '{'
                     ;
                    executable
                     variable_ref
                      var_ref
                       write_id
                        id
                         changed
                     =
                     exp
                      exp1
                       exp2
                        exp3
                         exp4
                          exp5
                           exp6
                            exp7
                             exp8
                              exp9
                               true
                    ;
                   opt_else_statement
                    ELSE
                    executable_list
                     executable
                      keyword_statement
                       answer_statement
                        ANSWER
                        exp_list
                         exp
                          exp1
                           exp2
                            exp3
                             exp4
                              exp5
                               exp6
                                exp7
                                 exp8
                                  exp9
                                   string_literal
                                    '('
                     ;
                   END
                   IF
                ;
             END
             MACRO
           ;
          module_statement
           macro_declaration
            MACRO
            id
             right_paren
            macro_type
             TRIGGER
            opt_macro_attrs
            {
            opt_picture
             picture
              pic1
               pic2
                pic3
                 pic4
                  macro_item
                   token_alias
                    ')'
            }
            ;
            body
             statement_list
              statement
               executable
                keyword_statement
                 if_statement
                  IF
                  exp
                   exp1
                    exp2
                     exp3
                      exp3
                       exp4
                        exp5
                         exp6
                          exp7
                           exp8
                            exp9
                             ref
                              id
                               depth
                      >
                      exp4
                       exp5
                        exp6
                         exp7
                          exp8
                           exp9
                            0
                  THEN
                  executable_list
                   executable_list
                    executable
                     keyword_statement
                      answer_statement
                       ANSWER
                       exp_list
                        exp
                         exp1
                          exp2
                           exp3
                            exp4
                             exp5
                              exp6
                               exp7
                                exp8
                                 exp9
                                  string_literal
                                   '}'
                    ;
                   executable
                    variable_ref
                     var_ref
                      write_id
                       id
                        changed
                    =
                    exp
                     exp1
                      exp2
                       exp3
                        exp4
                         exp5
                          exp6
                           exp7
                            exp8
                             exp9
                              true
                   ;
                  opt_else_statement
                   ELSE
                   executable_list
                    executable
                     keyword_statement
                      answer_statement
                       ANSWER
                       exp_list
                        exp
                         exp1
                          exp2
                           exp3
                            exp4
                             exp5
                              exp6
                               exp7
                                exp8
                                 exp9
                                  string_literal
                                   ')'
                    ;
                  END
                  IF
               ;
            END
            MACRO
          ;
         module_statement
          macro_declaration
           MACRO
           id
            semicolon
           macro_type
            TRIGGER
           opt_macro_attrs
           {
           opt_picture
            picture
             pic1
              pic2
               pic3
                pic4
                 macro_item
                  token_alias
                   ';'
           }
           ;
           body
            statement_list
             statement_list
              statement
               executable
                keyword_statement
                 if_statement
                  IF
                  exp
                   exp1
                    exp2
                     exp3
                      exp3
                       exp4
                        exp5
                         exp6
                          exp7
                           exp8
                            exp9
                             ref
                              id
                               depth
                      >
                      exp4
                       exp5
                        exp6
                         exp7
                          exp8
                           exp9
                            0
                  THEN
                  executable_list
                   executable
                    variable_ref
                     var_ref
                      write_id
                       id
                        depth
                    =
                    exp
                     exp1
                      exp2
                       exp3
                        exp4
                         exp5
                          exp5
                           exp6
                            exp7
                             exp8
                              exp9
                               ref
                                id
                                 depth
                          -
                          exp6
                           exp7
                            exp8
                             exp9
                              1
                   ;
                  opt_else_statement
                  END
                  IF
               ;
             statement
              executable
               keyword_statement
                answer_statement
                 ANSWER
                 exp_list
                  exp
                   exp1
                    exp2
                     exp3
                      exp4
                       exp5
                        exp6
                         exp7
                          exp8
                           exp9
                            string_literal
                             ';'
              ;
           END
           MACRO
         ;
        module_statement
         macro_declaration
          MACRO
          id
           open_statement
          macro_type
           TRIGGER
          opt_macro_attrs
          {
          opt_picture
           picture
            pic1
             pic2
              pic2
               pic3
                pic4
                 id
                  k
                 :
                 macro_item
                  {
                  picture
                   picture
                    pic1
                     pic2
                      pic3
                       pic4
                        macro_item
                         id
                          open_key
                   alt_
                    |
                   pic1
                    pic2
                     pic3
                      pic4
                       macro_item
                        id
                         close_key
                  }
              pic3
               pic4
                id
                 i
                :
                macro_item
                 id
                  id
          }
          ;
          body
           statement_list
            statement_list
             statement_list
              statement_list
               statement
                executable
                 keyword_statement
                  answer_statement
                   ANSWER
                   exp_list
                    exp_list
                     exp_list
                      exp_list
                       exp
                        exp1
                         exp2
                          exp3
                           exp4
                            exp5
                             exp6
                              exp7
                               exp8
                                exp9
                                 ref
                                  id
                                   k
                      ,
                      exp
                       exp1
                        exp2
                         exp3
                          exp4
                           exp5
                            exp6
                             exp7
                              exp8
                               exp9
                                string_literal
                                 ' file( '
                     ,
                     exp
                      exp1
                       exp2
                        exp3
                         exp4
                          exp5
                           exp6
                            exp7
                             exp8
                              exp9
                               ref
                                id
                                 i
                    ,
                    exp
                     exp1
                      exp2
                       exp3
                        exp4
                         exp5
                          exp6
                           exp7
                            exp8
                             exp9
                              string_literal
                               ' )'
                ;
              statement
               executable
                variable_ref
                 var_ref
                  write_id
                   id
                    changed
                =
                exp
                 exp1
                  exp2
                   exp3
                    exp4
                     exp5
                      exp6
                       exp7
                        exp8
                         exp9
                          true
               ;
             statement
              executable
               variable_ref
                var_ref
                 write_id
                  id
                   i
               =
               exp
                exp1
                 exp2
                  exp3
                   exp4
                    exp5
                     exp6
                      exp7
                       exp8
                        exp9
                         ref
                          ref
                           id
                            lower
                          argument_list
                           (
                           arg_list
                            arg
                             exp
                              exp1
                               exp2
                                exp3
                                 exp4
                                  exp5
                                   exp6
                                    exp7
                                     exp8
                                      exp9
                                       ref
                                        id
                                         i
                           )
              ;
            statement
             executable
              keyword_statement
               if_statement
                IF
                exp
                 exp1
                  exp2
                   NOT
                   exp2
                    exp3
                     exp4
                      exp5
                       exp6
                        exp7
                         exp8
                          exp9
                           ref
                            ref
                             id
                              exists
                            argument_list
                             (
                             arg_list
                              arg
                               exp
                                exp1
                                 exp2
                                  exp3
                                   exp4
                                    exp5
                                     exp6
                                      exp7
                                       exp8
                                        exp9
                                         ref
                                          ref
                                           id
                                            files
                                          argument_list
                                           (
                                           arg_list
                                            arg
                                             exp
                                              exp1
                                               exp2
                                                exp3
                                                 exp4
                                                  exp5
                                                   exp6
                                                    exp7
                                                     exp8
                                                      exp9
                                                       ref
                                                        id
                                                         i
                                           )
                             )
                THEN
                executable_list
                 executable
                  variable_ref
                   var_ref
                    var_ref
                     write_id
                      id
                       files
                    argument_list
                     (
                     arg_list
                      arg
                       exp
                        exp1
                         exp2
                          exp3
                           exp4
                            exp5
                             exp6
                              exp7
                               exp8
                                exp9
                                 ref
                                  ref
                                   id
                                    lower
                                  argument_list
                                   (
                                   arg_list
                                    arg
                                     exp
                                      exp1
                                       exp2
                                        exp3
                                         exp4
                                          exp5
                                           exp6
                                            exp7
                                             exp8
                                              exp9
                                               ref
                                                id
                                                 i
                                   )
                     )
                  =
                  exp
                   exp1
                    exp2
                     exp3
                      exp4
                       exp5
                        exp6
                         exp7
                          exp8
                           exp9
                            0
                 ;
                opt_else_statement
                END
                IF
             ;
          END
          MACRO
        ;
       module_statement
        macro_declaration
         MACRO
         id
          read_statement
         macro_type
          TRIGGER
         opt_macro_attrs
         {
         opt_picture
          picture
           pic1
            pic2
             pic2
              pic2
               pic3
                pic4
                 id
                  k
                 :
                 macro_item
                  {
                  picture
                   picture
                    pic1
                     pic2
                      pic3
                       pic4
                        macro_item
                         id
                          read_key
                   alt_
                    |
                   pic1
                    pic2
                     pic3
                      pic4
                       macro_item
                        id
                         write_key
                  }
              pic3
               pic4
                macro_item
                 id
                  file_key
             pic3
              pic4
               id
                i
               :
               macro_item
                id
                 id
         }
         ;
         body
          statement_list
           statement_list
            statement_list
             statement_list
              statement
               executable
                keyword_statement
                 answer_statement
                  ANSWER
                  exp_list
                   exp_list
                    exp_list
                     exp_list
                      exp
                       exp1
                        exp2
                         exp3
                          exp4
                           exp5
                            exp6
                             exp7
                              exp8
                               exp9
                                ref
                                 id
                                  k
                     ,
                     exp
                      exp1
                       exp2
                        exp3
                         exp4
                          exp5
                           exp6
                            exp7
                             exp8
                              exp9
                               string_literal
                                ' file( '
                    ,
                    exp
                     exp1
                      exp2
                       exp3
                        exp4
                         exp5
                          exp6
                           exp7
                            exp8
                             exp9
                              ref
                               id
                                i
                   ,
                   exp
                    exp1
                     exp2
                      exp3
                       exp4
                        exp5
                         exp6
                          exp7
                           exp8
                            exp9
                             string_literal
                              ' )'
               ;
             statement
              executable
               variable_ref
                var_ref
                 write_id
                  id
                   i
               =
               exp
                exp1
                 exp2
                  exp3
                   exp4
                    exp5
                     exp6
                      exp7
                       exp8
                        exp9
                         ref
                          ref
                           id
                            lower
                          argument_list
                           (
                           arg_list
                            arg
                             exp
                              exp1
                               exp2
                                exp3
                                 exp4
                                  exp5
                                   exp6
                                    exp7
                                     exp8
                                      exp9
                                       ref
                                        id
                                         i
                           )
              ;
            statement
             executable
              keyword_statement
               if_statement
                IF
                exp
                 exp1
                  exp2
                   NOT
                   exp2
                    exp3
                     exp4
                      exp5
                       exp6
                        exp7
                         exp8
                          exp9
                           ref
                            ref
                             id
                              exists
                            argument_list
                             (
                             arg_list
                              arg
                               exp
                                exp1
                                 exp2
                                  exp3
                                   exp4
                                    exp5
                                     exp6
                                      exp7
                                       exp8
                                        exp9
                                         ref
                                          ref
                                           id
                                            files
                                          argument_list
                                           (
                                           arg_list
                                            arg
                                             exp
                                              exp1
                                               exp2
                                                exp3
                                                 exp4
                                                  exp5
                                                   exp6
                                                    exp7
                                                     exp8
                                                      exp9
                                                       ref
                                                        id
                                                         i
                                           )
                             )
                THEN
                executable_list
                 executable
                  variable_ref
                   var_ref
                    var_ref
                     write_id
                      id
                       files
                    argument_list
                     (
                     arg_list
                      arg
                       exp
                        exp1
                         exp2
                          exp3
                           exp4
                            exp5
                             exp6
                              exp7
                               exp8
                                exp9
                                 ref
                                  ref
                                   id
                                    lower
                                  argument_list
                                   (
                                   arg_list
                                    arg
                                     exp
                                      exp1
                                       exp2
                                        exp3
                                         exp4
                                          exp5
                                           exp6
                                            exp7
                                             exp8
                                              exp9
                                               ref
                                                id
                                                 i
                                   )
                     )
                  =
                  exp
                   exp1
                    exp2
                     exp3
                      exp4
                       exp5
                        exp6
                         exp7
                          exp8
                           exp9
                            0
                 ;
                opt_else_statement
                END
                IF
             ;
           statement
            executable
             variable_ref
              var_ref
               write_id
                id
                 changed
             =
             exp
              exp1
               exp2
                exp3
                 exp4
                  exp5
                   exp6
                    exp7
                     exp8
                      exp9
                       true
            ;
         END
         MACRO
       ;
      module_statement
       macro_declaration
        MACRO
        id
         endfile_bif
        macro_type
         TRIGGER
        opt_macro_attrs
        {
        opt_picture
         picture
          pic1
           pic2
            pic3
             pic4
              id
               k
              :
              macro_item
               {
               picture
                pic1
                 pic2
                  pic2
                   pic2
                    pic2
                     pic3
                      pic4
                       macro_item
                        id
                         endfile_key
                    pic3
                     pic4
                      macro_item
                       token_alias
                        '('
                   pic3
                    pic4
                     id
                      i
                     :
                     macro_item
                      id
                       id
                  pic3
                   pic4
                    macro_item
                     token_alias
                      ')'
               }
        }
        ;
        body
         statement_list
          statement_list
           statement_list
            statement_list
             statement
              executable
               keyword_statement
                answer_statement
                 ANSWER
                 exp_list
                  exp
                   exp1
                    exp2
                     exp3
                      exp4
                       exp5
                        exp6
                         exp7
                          exp8
                           exp9
                            ref
                             id
                              k
              ;
            statement
             executable
              variable_ref
               var_ref
                write_id
                 id
                  i
              =
              exp
               exp1
                exp2
                 exp3
                  exp4
                   exp5
                    exp6
                     exp7
                      exp8
                       exp9
                        ref
                         ref
                          id
                           lower
                         argument_list
                          (
                          arg_list
                           arg
                            exp
                             exp1
                              exp2
                               exp3
                                exp4
                                 exp5
                                  exp6
                                   exp7
                                    exp8
                                     exp9
                                      ref
                                       id
                                        i
                          )
             ;
           statement
            executable
             keyword_statement
              if_statement
               IF
               exp
                exp1
                 exp2
                  NOT
                  exp2
                   exp3
                    exp4
                     exp5
                      exp6
                       exp7
                        exp8
                         exp9
                          ref
                           ref
                            id
                             exists
                           argument_list
                            (
                            arg_list
                             arg
                              exp
                               exp1
                                exp2
                                 exp3
                                  exp4
                                   exp5
                                    exp6
                                     exp7
                                      exp8
                                       exp9
                                        ref
                                         ref
                                          id
                                           files
                                         argument_list
                                          (
                                          arg_list
                                           arg
                                            exp
                                             exp1
                                              exp2
                                               exp3
                                                exp4
                                                 exp5
                                                  exp6
                                                   exp7
                                                    exp8
                                                     exp9
                                                      ref
                                                       id
                                                        i
                                          )
                            )
               THEN
               executable_list
                executable
                 variable_ref
                  var_ref
                   var_ref
                    write_id
                     id
                      files
                   argument_list
                    (
                    arg_list
                     arg
                      exp
                       exp1
                        exp2
                         exp3
                          exp4
                           exp5
                            exp6
                             exp7
                              exp8
                               exp9
                                ref
                                 ref
                                  id
                                   lower
                                 argument_list
                                  (
                                  arg_list
                                   arg
                                    exp
                                     exp1
                                      exp2
                                       exp3
                                        exp4
                                         exp5
                                          exp6
                                           exp7
                                            exp8
                                             exp9
                                              ref
                                               id
                                                i
                                  )
                    )
                 =
                 exp
                  exp1
                   exp2
                    exp3
                     exp4
                      exp5
                       exp6
                        exp7
                         exp8
                          exp9
                           0
                ;
               opt_else_statement
               END
               IF
            ;
          statement
           executable
            variable_ref
             var_ref
              write_id
               id
                changed
            =
            exp
             exp1
              exp2
               exp3
                exp4
                 exp5
                  exp6
                   exp7
                    exp8
                     exp9
                      true
           ;
        END
        MACRO
      ;
     module_statement
      macro_declaration
       MACRO
       id
        dcl_file
       macro_type
        TRIGGER
       opt_macro_attrs
       {
       opt_picture
        picture
         pic1
          pic2
           pic3
            pic4
             id
              k
             :
             macro_item
              {
              picture
               pic1
                pic2
                 pic2
                  pic2
                   pic2
                    pic2
                     pic2
                      pic3
                       pic4
                        macro_item
                         id
                          declare_key
                     pic3
                      pic4
                       id
                        i
                       :
                       macro_item
                        id
                         id
                    pic3
                     pic4
                      macro_item
                       token_alias
                        ':'
                   pic3
                    pic4
                     macro_item
                      id
                       common_key
                  pic3
                   pic4
                    macro_item
                     id
                      file_key
                 pic3
                  pic4
                   macro_item
                    token_alias
                     ';'
              }
       }
       ;
       body
        statement_list
         statement_list
          statement_list
           statement_list
            statement
             executable
              keyword_statement
               answer_statement
                ANSWER
                exp_list
                 exp
                  exp1
                   exp2
                    exp3
                     exp4
                      exp5
                       exp6
                        exp7
                         exp8
                          exp9
                           ref
                            id
                             k
             ;
           statement
            executable
             variable_ref
              var_ref
               write_id
                id
                 i
             =
             exp
              exp1
               exp2
                exp3
                 exp4
                  exp5
                   exp6
                    exp7
                     exp8
                      exp9
                       ref
                        ref
                         id
                          lower
                        argument_list
                         (
                         arg_list
                          arg
                           exp
                            exp1
                             exp2
                              exp3
                               exp4
                                exp5
                                 exp6
                                  exp7
                                   exp8
                                    exp9
                                     ref
                                      id
                                       i
                         )
            ;
          statement
           executable
            variable_ref
             var_ref
              var_ref
               write_id
                id
                 files
              argument_list
               (
               arg_list
                arg
                 exp
                  exp1
                   exp2
                    exp3
                     exp4
                      exp5
                       exp6
                        exp7
                         exp8
                          exp9
                           ref
                            ref
                             id
                              lower
                            argument_list
                             (
                             arg_list
                              arg
                               exp
                                exp1
                                 exp2
                                  exp3
                                   exp4
                                    exp5
                                     exp6
                                      exp7
                                       exp8
                                        exp9
                                         ref
                                          id
                                           i
                             )
               )
            =
            exp
             exp1
              exp2
               exp3
                exp4
                 exp5
                  exp6
                   exp7
                    exp8
                     exp9
                      1
           ;
         statement
          executable
           variable_ref
            var_ref
             write_id
              id
               changed
           =
           exp
            exp1
             exp2
              exp3
               exp4
                exp5
                 exp6
                  exp7
                   exp8
                    exp9
                     true
          ;
       END
       MACRO
     ;
    module_statement
     macro_declaration
      MACRO
      id
       treeptr_dcl
      macro_type
       TRIGGER
      opt_macro_attrs
      {
      opt_picture
       picture
        pic1
         pic2
          pic2
           pic2
            pic2
             pic2
              pic2
               pic2
                pic3
                 pic4
                  id
                   k1
                  :
                  macro_item
                   id
                    treeptr_key
               pic3
                pic4
                 id
                  k2
                 :
                 macro_item
                  id
                   to_key
              pic3
               pic4
                id
                 k3
                :
                macro_item
                 id
                  tree_key
             pic3
              pic4
               macro_item
                token_alias
                 '('
            pic3
             pic4
              macro_item
               {
               picture
                pic1
                 pic2
                  pic3
                   pic4
                    id
                     i
                    :
                    macro_item
                     id
                      id
                 \
                 pic2
                  pic3
                   pic4
                    macro_item
                     token_alias
                      ','
               }
           pic3
            pic4
             macro_item
              token_alias
               ')'
          pic3
           pic4
            id
             k4
            :
            macro_item
             id
              of_key
      }
      ;
      body
       statement_list
        statement_list
         statement_list
          statement_list
           statement_list
            statement
             declaration
              variable_declaration
               DECLARE
               name_list
                pic_id
                 id
                  ip
               :
               type_dec
                common_type_dec
                 TREEPTR
                 (
                 level_type
                  INTEGER
                 )
                 TO
                 type_dec
                  STRING
             ;
           statement
            executable
             keyword_statement
              answer_statement
               ANSWER
               exp_list
                exp_list
                 exp_list
                  exp_list
                   exp_list
                    exp
                     exp1
                      exp2
                       exp3
                        exp4
                         exp5
                          exp6
                           exp7
                            exp8
                             exp9
                              ref
                               id
                                k1
                   ,
                   exp
                    exp1
                     exp2
                      exp3
                       exp4
                        exp5
                         exp6
                          exp7
                           exp8
                            exp9
                             string_literal
                              '( '
                  ,
                  exp
                   exp1
                    exp2
                     exp3
                      exp4
                       exp5
                        exp6
                         exp7
                          exp8
                           exp9
                            ref
                             ref
                              id
                               i
                             argument_list
                              (
                              arg_list
                               arg
                                exp
                                 exp1
                                  exp2
                                   exp3
                                    exp4
                                     exp5
                                      exp6
                                       exp7
                                        exp8
                                         exp9
                                          1
                              )
                 ,
                 exp
                  exp1
                   exp2
                    exp3
                     exp4
                      exp5
                       exp6
                        exp7
                         exp8
                          exp9
                           string_literal
                            ' ) '
                ,
                exp
                 exp1
                  exp2
                   exp3
                    exp4
                     exp5
                      exp6
                       exp7
                        exp8
                         exp9
                          ref
                           id
                            k2
            ;
          statement
           executable
            variable_ref
             var_ref
              write_id
               id
                ip
            =
            exp
             exp1
              exp2
               exp3
                exp4
                 exp5
                  exp6
                   exp7
                    exp8
                     exp9
                      ref
                       ref
                        id
                         next
                       argument_list
                        (
                        arg_list
                         arg
                          exp
                           exp1
                            exp2
                             exp3
                              exp4
                               exp5
                                exp6
                                 exp7
                                  exp8
                                   exp9
                                    ref
                                     ref
                                      id
                                       i
                                     argument_list
                                      (
                                      arg_list
                                       arg
                                        exp
                                         exp1
                                          exp2
                                           exp3
                                            exp4
                                             exp5
                                              exp6
                                               exp7
                                                exp8
                                                 exp9
                                                  1
                                      )
                        )
           ;
         statement
          executable
           keyword_statement
            if_statement
             IF
             exp
              exp1
               exp2
                exp3
                 exp3
                  exp4
                   exp5
                    exp6
                     exp7
                      exp8
                       exp9
                        ref
                         id
                          ip
                 ><
                 exp4
                  exp5
                   exp6
                    exp7
                     exp8
                      exp9
                       nil
             THEN
             executable_list
              executable_list
               executable_list
                executable
                 keyword_statement
                  answer_statement
                   ANSWER
                   exp_list
                    exp_list
                     exp_list
                      exp
                       exp1
                        exp2
                         exp3
                          exp4
                           exp5
                            exp6
                             exp7
                              exp8
                               exp9
                                string_literal
                                 ' '
                     ,
                     exp
                      exp1
                       exp2
                        exp3
                         exp4
                          exp5
                           exp6
                            exp7
                             exp8
                              exp9
                               ref
                                id
                                 k3
                    ,
                    exp
                     exp1
                      exp2
                       exp3
                        exp4
                         exp5
                          exp6
                           exp7
                            exp8
                             exp9
                              string_literal
                               '( '
                ;
               executable
                keyword_statement
                 while_statement
                  WHILE
                  exp
                   exp1
                    exp2
                     exp3
                      exp4
                       exp5
                        exp6
                         exp7
                          exp8
                           exp9
                            true
                  ;
                  executable_list
                   executable_list
                    executable_list
                     executable_list
                      executable
                       keyword_statement
                        answer_statement
                         ANSWER
                         exp_list
                          exp
                           exp1
                            exp2
                             exp3
                              exp4
                               exp5
                                exp6
                                 exp7
                                  exp8
                                   exp9
                                    ref
                                     ref
                                      id
                                       value
                                     argument_list
                                      (
                                      arg_list
                                       arg
                                        exp
                                         exp1
                                          exp2
                                           exp3
                                            exp4
                                             exp5
                                              exp6
                                               exp7
                                                exp8
                                                 exp9
                                                  ref
                                                   id
                                                    ip
                                      )
                      ;
                     executable
                      variable_ref
                       var_ref
                        write_id
                         id
                          ip
                      =
                      exp
                       exp1
                        exp2
                         exp3
                          exp4
                           exp5
                            exp6
                             exp7
                              exp8
                               exp9
                                ref
                                 ref
                                  id
                                   NEXT
                                 argument_list
                                  (
                                  arg_list
                                   arg
                                    exp
                                     exp1
                                      exp2
                                       exp3
                                        exp4
                                         exp5
                                          exp6
                                           exp7
                                            exp8
                                             exp9
                                              ref
                                               id
                                                ip
                                  )
                     ;
                    executable
                     keyword_statement
                      if_statement
                       IF
                       exp
                        exp1
                         exp2
                          exp3
                           exp3
                            exp4
                             exp5
                              exp6
                               exp7
                                exp8
                                 exp9
                                  ref
                                   id
                                    ip
                           =
                           exp4
                            exp5
                             exp6
                              exp7
                               exp8
                                exp9
                                 NIL
                       THEN
                       executable_list
                        executable
                         keyword_statement
                          goto_statement
                           goto
                           id
                            done
                        ;
                       opt_else_statement
                       END
                       IF
                    ;
                   executable
                    keyword_statement
                     answer_statement
                      ANSWER
                      exp_list
                       exp
                        exp1
                         exp2
                          exp3
                           exp4
                            exp5
                             exp6
                              exp7
                               exp8
                                exp9
                                 string_literal
                                  ','
                   ;
                  END
                  WHILE
               ;
              executable
               label
                id
                 done
               :
               executable
                keyword_statement
                 answer_statement
                  ANSWER
                  exp_list
                   exp_list
                    exp
                     exp1
                      exp2
                       exp3
                        exp4
                         exp5
                          exp6
                           exp7
                            exp8
                             exp9
                              string_literal
                               ' ) '
                   ,
                   exp
                    exp1
                     exp2
                      exp3
                       exp4
                        exp5
                         exp6
                          exp7
                           exp8
                            exp9
                             ref
                              id
                               k4
              ;
             opt_else_statement
             END
             IF
          ;
        statement
         executable
          variable_ref
           var_ref
            write_id
             id
              changed
          =
          exp
           exp1
            exp2
             exp3
              exp4
               exp5
                exp6
                 exp7
                  exp8
                   exp9
                    true
         ;
      END
      MACRO
    ;
   module_statement
    macro_declaration
     MACRO
     id
      module_statement
     macro_type
      TRIGGER
     opt_macro_attrs
     {
     opt_picture
      picture
       pic1
        pic2
         pic3
          pic4
           id
            s
           :
           macro_item
            {
            picture
             pic1
              pic2
               pic2
                pic2
                 pic2
                  pic3
                   pic4
                    macro_item
                     id
                      module_key
                 pic3
                  pic4
                   macro_item
                    id
                     id
                pic3
                 pic4
                  macro_item
                   [
                   picture
                    pic1
                     pic2
                      pic3
                       pic4
                        macro_item
                         id
                          non_semi
                   ]
                 ...
               pic3
                pic4
                 macro_item
                  token_alias
                   ';'
            }
     }
     ;
     body
      statement_list
       statement_list
        statement_list
         statement_list
          statement
           declaration
            variable_declaration
             DECLARE
             name_list
              pic_id
               id
                i
             :
             type_dec
              common_type_dec
               treeptr
               (
               level_type
                string
               )
               to
               type_dec
                common_type_dec
                 integer
           ;
         statement
          executable
           keyword_statement
            answer_statement
             ANSWER
             exp_list
              exp
               exp1
                exp2
                 exp3
                  exp4
                   exp5
                    exp6
                     exp7
                      exp8
                       exp9
                        ref
                         id
                          s
          ;
        statement
         executable
          variable_ref
           var_ref
            write_id
             id
              i
          =
          exp
           exp1
            exp2
             exp3
              exp4
               exp5
                exp6
                 exp7
                  exp8
                   exp9
                    ref
                     ref
                      id
                       first
                     argument_list
                      (
                      arg_list
                       arg
                        exp
                         exp1
                          exp2
                           exp3
                            exp4
                             exp5
                              exp6
                               exp7
                                exp8
                                 exp9
                                  ref
                                   id
                                    files
                      )
         ;
       statement
        executable
         keyword_statement
          while_statement
           WHILE
           exp
            exp1
             exp2
              exp3
               exp3
                exp4
                 exp5
                  exp6
                   exp7
                    exp8
                     exp9
                      ref
                       id
                        i
               <>
               exp4
                exp5
                 exp6
                  exp7
                   exp8
                    exp9
                     NIL
           ;
           executable_list
            executable_list
             executable
              keyword_statement
               if_statement
                IF
                exp
                 exp1
                  exp2
                   exp3
                    exp3
                     exp4
                      exp5
                       exp6
                        exp7
                         exp8
                          exp9
                           ref
                            ref
                             id
                              value
                            argument_list
                             (
                             arg_list
                              arg
                               exp
                                exp1
                                 exp2
                                  exp3
                                   exp4
                                    exp5
                                     exp6
                                      exp7
                                       exp8
                                        exp9
                                         ref
                                          id
                                           i
                             )
                    =
                    exp4
                     exp5
                      exp6
                       exp7
                        exp8
                         exp9
                          0
                THEN
                executable_list
                 executable
                  keyword_statement
                   answer_statement
                    ANSWER
                    exp_list
                     exp_list
                      exp_list
                       exp
                        exp1
                         exp2
                          exp3
                           exp4
                            exp4
                             exp5
                              exp6
                               exp7
                                exp8
                                 exp9
                                  string_literal
                                   s'eol'
                            &
                            exp5
                             exp6
                              exp7
                               exp8
                                exp9
                                 string_literal
                                  '    declare '
                      ,
                      exp
                       exp1
                        exp2
                         exp3
                          exp4
                           exp5
                            exp6
                             exp7
                              exp8
                               exp9
                                ref
                                 ref
                                  id
                                   subscript
                                 argument_list
                                  (
                                  arg_list
                                   arg
                                    exp
                                     exp1
                                      exp2
                                       exp3
                                        exp4
                                         exp5
                                          exp6
                                           exp7
                                            exp8
                                             exp9
                                              ref
                                               id
                                                i
                                  )
                     ,
                     exp
                      exp1
                       exp2
                        exp3
                         exp4
                          exp5
                           exp6
                            exp7
                             exp8
                              exp9
                               string_literal
                                ': common file;'
                 ;
                opt_else_statement
                END
                IF
             ;
            executable
             variable_ref
              var_ref
               write_id
                id
                 i
             =
             exp
              exp1
               exp2
                exp3
                 exp4
                  exp5
                   exp6
                    exp7
                     exp8
                      exp9
                       ref
                        ref
                         id
                          next
                        argument_list
                         (
                         arg_list
                          arg
                           exp
                            exp1
                             exp2
                              exp3
                               exp4
                                exp5
                                 exp6
                                  exp7
                                   exp8
                                    exp9
                                     ref
                                      id
                                       i
                         )
            ;
           END
           WHILE
        ;
     END
     MACRO
   ;
  module_statement
   procedure_declaration
    proc_start
     PROCEDURE
     id
      main
     opt_proc_attr
      MAIN
    ;
    body
     statement_list
      statement_list
       statement_list
        statement_list
         statement_list
          statement_list
           statement
            declaration
             variable_declaration
              DECLARE
              name_list
               name_list
                pic_id
                 id
                  file_spec
               ,
               pic_id
                id
                 full_file_name
              :
              type_dec
               STRING
            ;
          statement
           declaration
            variable_declaration
             DECLARE
             name_list
              pic_id
               id
                context
             :
             type_dec
              common_type_dec
               INTEGER
           ;
         statement
          executable
           keyword_statement
            read_statement
             READ
             prompt
              PROMPT
              (
              exp
               exp1
                exp2
                 exp3
                  exp4
                   exp5
                    exp6
                     exp7
                      exp8
                       exp9
                        string_literal
                         'file spec to process:'
              )
             variable_ref
              var_ref
               write_id
                id
                 file_spec
          ;
        statement
         executable
          variable_ref
           var_ref
            write_id
             id
              context
          =
          exp
           exp1
            exp2
             exp3
              exp4
               exp5
                exp6
                 exp7
                  exp8
                   exp9
                    0
         ;
       statement
        executable
         keyword_statement
          while_statement
           WHILE
           exp
            exp1
             exp2
              exp3
               exp3
                exp4
                 exp5
                  exp6
                   exp7
                    exp8
                     exp9
                      (
                      exp
                       exp1
                        exp1
                         exp2
                          exp3
                           exp4
                            exp5
                             exp6
                              exp7
                               exp8
                                exp9
                                 ref
                                  ref
                                   id
                                    lib$find_file
                                  argument_list
                                   (
                                   arg_list
                                    arg_list
                                     arg_list
                                      arg
                                       exp
                                        exp1
                                         exp2
                                          exp3
                                           exp4
                                            exp5
                                             exp6
                                              exp7
                                               exp8
                                                exp9
                                                 ref
                                                  id
                                                   file_spec
                                     ,
                                     arg
                                      exp
                                       exp1
                                        exp2
                                         exp3
                                          exp4
                                           exp5
                                            exp6
                                             exp7
                                              exp8
                                               exp9
                                                ref
                                                 id
                                                  full_file_name
                                    ,
                                    arg
                                     exp
                                      exp1
                                       exp2
                                        exp3
                                         exp4
                                          exp5
                                           exp6
                                            exp7
                                             exp8
                                              exp9
                                               ref
                                                id
                                                 context
                                   )
                        AND
                        exp2
                         exp3
                          exp4
                           exp5
                            exp6
                             exp7
                              exp8
                               exp9
                                1
                      )
               =
               exp4
                exp5
                 exp6
                  exp7
                   exp8
                    exp9
                     1
           ;
           executable_list
            executable_list
             executable_list
              executable_list
               executable_list
                executable_list
                 executable
                  variable_ref
                   var_ref
                    write_id
                     id
                      changed
                  =
                  exp
                   exp1
                    exp2
                     exp3
                      exp4
                       exp5
                        exp6
                         exp7
                          exp8
                           exp9
                            false
                 ;
                executable
                 keyword_statement
                  write_statement
                   WRITE
                   exp_list
                    exp_list
                     exp
                      exp1
                       exp2
                        exp3
                         exp4
                          exp5
                           exp6
                            exp7
                             exp8
                              exp9
                               string_literal
                                'processing: '
                    ,
                    exp
                     exp1
                      exp2
                       exp3
                        exp4
                         exp5
                          exp6
                           exp7
                            exp8
                             exp9
                              ref
                               id
                                full_file_name
                ;
               executable
                variable_ref
                 var_ref
                  write_id
                   id
                    full_file_name
                =
                exp
                 exp1
                  exp2
                   exp3
                    exp4
                     exp5
                      exp6
                       exp7
                        exp8
                         exp9
                          ref
                           id
                            full_file_name
                         [
                         part_ref
                          exp
                           exp1
                            exp2
                             exp3
                              exp4
                               exp5
                                exp6
                                 exp7
                                  exp8
                                   exp9
                                    1
                          rest_of_part_ref
                           ..
                           exp
                            exp1
                             exp2
                              exp3
                               exp4
                                exp5
                                 exp5
                                  exp6
                                   exp7
                                    exp8
                                     exp9
                                      ref
                                       ref
                                        id
                                         index
                                       argument_list
                                        (
                                        arg_list
                                         arg_list
                                          arg
                                           exp
                                            exp1
                                             exp2
                                              exp3
                                               exp4
                                                exp5
                                                 exp6
                                                  exp7
                                                   exp8
                                                    exp9
                                                     ref
                                                      id
                                                       full_file_name
                                         ,
                                         arg
                                          exp
                                           exp1
                                            exp2
                                             exp3
                                              exp4
                                               exp5
                                                exp6
                                                 exp7
                                                  exp8
                                                   exp9
                                                    string_literal
                                                     ';'
                                        )
                                 -
                                 exp6
                                  exp7
                                   exp8
                                    exp9
                                     1
                           ]
               ;
              executable
               keyword_statement
                start_scan_statement
                 START
                 SCAN
                 scan_attr_list
                  scan_attr_list
                   scan_attr
                    INPUT
                    FILE
                    exp
                     exp1
                      exp2
                       exp3
                        exp4
                         exp5
                          exp6
                           exp7
                            exp8
                             exp9
                              ref
                               id
                                full_file_name
                  scan_attr
                   OUTPUT
                   FILE
                   exp
                    exp1
                     exp2
                      exp3
                       exp4
                        exp5
                         exp6
                          exp7
                           exp8
                            exp9
                             ref
                              id
                               full_file_name
              ;
             executable
              keyword_statement
               if_statement
                IF
                exp
                 exp1
                  exp2
                   exp3
                    exp3
                     exp4
                      exp5
                       exp6
                        exp7
                         exp8
                          exp9
                           ref
                            ref
                             id
                              first
                            argument_list
                             (
                             arg_list
                              arg
                               exp
                                exp1
                                 exp2
                                  exp3
                                   exp4
                                    exp5
                                     exp6
                                      exp7
                                       exp8
                                        exp9
                                         ref
                                          id
                                           files
                             )
                    <>
                    exp4
                     exp5
                      exp6
                       exp7
                        exp8
                         exp9
                          NIL
                THEN
                executable_list
                 executable_list
                  executable
                   keyword_statement
                    start_scan_statement
                     START
                     SCAN
                     scan_attr_list
                      scan_attr_list
                       scan_attr
                        INPUT
                        FILE
                        exp
                         exp1
                          exp2
                           exp3
                            exp4
                             exp5
                              exp6
                               exp7
                                exp8
                                 exp9
                                  ref
                                   id
                                    full_file_name
                      scan_attr
                       OUTPUT
                       FILE
                       exp
                        exp1
                         exp2
                          exp3
                           exp4
                            exp5
                             exp6
                              exp7
                               exp8
                                exp9
                                 ref
                                  id
                                   full_file_name
                  ;
                 executable
                  keyword_statement
                   prune_statement
                    PRUNE
                    prune_list
                     exp
                      exp1
                       exp2
                        exp3
                         exp4
                          exp5
                           exp6
                            exp7
                             exp8
                              exp9
                               ref
                                id
                                 files
                 ;
                opt_else_statement
                END
                IF
             ;
            executable
             keyword_statement
              if_statement
               IF
               exp
                exp1
                 exp2
                  exp3
                   exp4
                    exp5
                     exp6
                      exp7
                       exp8
                        exp9
                         ref
                          id
                           changed
               THEN
               executable_list
                executable
                 keyword_statement
                  write_statement
                   WRITE
                   exp_list
                    exp_list
                     exp
                      exp1
                       exp2
                        exp3
                         exp4
                          exp5
                           exp6
                            exp7
                             exp8
                              exp9
                               ref
                                id
                                 full_file_name
                    ,
                    exp
                     exp1
                      exp2
                       exp3
                        exp4
                         exp5
                          exp6
                           exp7
                            exp8
                             exp9
                              string_literal
                               ' was modified'
                ;
               opt_else_statement
               END
               IF
            ;
           END
           WHILE
        ;
      statement
       executable
        keyword_statement
         if_statement
          IF
          exp
           exp1
            exp2
             exp3
              exp3
               exp4
                exp5
                 exp6
                  exp7
                   exp8
                    exp9
                     (
                     exp
                      exp1
                       exp1
                        exp2
                         exp3
                          exp4
                           exp5
                            exp6
                             exp7
                              exp8
                               exp9
                                ref
                                 ref
                                  id
                                   lib$find_file_end
                                 argument_list
                                  (
                                  arg_list
                                   arg
                                    exp
                                     exp1
                                      exp2
                                       exp3
                                        exp4
                                         exp5
                                          exp6
                                           exp7
                                            exp8
                                             exp9
                                              ref
                                               id
                                                context
                                  )
                       AND
                       exp2
                        exp3
                         exp4
                          exp5
                           exp6
                            exp7
                             exp8
                              exp9
                               1
                     )
              <>
              exp4
               exp5
                exp6
                 exp7
                  exp8
                   exp9
                    1
          THEN
          executable_list
           executable
            keyword_statement
             write_statement
              WRITE
              exp_list
               exp
                exp1
                 exp2
                  exp3
                   exp4
                    exp5
                     exp6
                      exp7
                       exp8
                        exp9
                         string_literal
                          'Error freeing the find_file context.'
           ;
          opt_else_statement
          END
          IF
       ;
    END
    PROCEDURE
  ;
 end_module
  END
  MODULE
 ;
 <EOF>
