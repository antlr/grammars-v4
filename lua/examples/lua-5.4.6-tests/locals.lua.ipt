start_
 chunk
  block
   stat
    functioncall
     print
     args
      (
      explist
       exp
        string
         'testing local variables and environments'
      )
   stat
    local
    attnamelist
     debug
     attrib
    =
    explist
     exp
      prefixexp
       functioncall
        require
        args
         string
          "debug"
   stat
    local
    attnamelist
     tracegc
     attrib
    =
    explist
     exp
      prefixexp
       functioncall
        require
        args
         string
          "tracegc"
   stat
    local
    function
    f
    funcbody
     (
     parlist
      namelist
       x
     )
     block
      stat
       varlist
        var
         x
       =
       explist
        exp
         nil
      stat
       ;
      retstat
       return
       explist
        exp
         prefixexp
          x
     end
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         prefixexp
          functioncall
           f
           args
            (
            explist
             exp
              number
               10
            )
        ==
        exp
         nil
      )
   stat
    local
    function
    f
    funcbody
     (
     parlist
     )
     block
      stat
       local
       attnamelist
        x
        attrib
      stat
       ;
      retstat
       return
       explist
        exp
         prefixexp
          x
     end
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         prefixexp
          functioncall
           f
           args
            (
            explist
             exp
              number
               10
            )
        ==
        exp
         nil
      )
   stat
    local
    function
    f
    funcbody
     (
     parlist
      namelist
       x
     )
     block
      stat
       varlist
        var
         x
       =
       explist
        exp
         nil
      stat
       ;
      stat
       local
       attnamelist
        y
        attrib
      stat
       ;
      retstat
       return
       explist
        exp
         prefixexp
          x
        ,
        exp
         prefixexp
          y
     end
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         exp
          prefixexp
           functioncall
            f
            args
             (
             explist
              exp
               number
                10
             )
         ==
         exp
          nil
        and
        exp
         exp
          prefixexp
           functioncall
            select
            args
             (
             explist
              exp
               number
                2
              ,
              exp
               prefixexp
                functioncall
                 f
                 args
                  (
                  explist
                   exp
                    number
                     20
                  )
             )
         ==
         exp
          nil
      )
   stat
    do
    block
     stat
      local
      attnamelist
       i
       attrib
      =
      explist
       exp
        number
         10
     stat
      do
      block
       stat
        local
        attnamelist
         i
         attrib
        =
        explist
         exp
          number
           100
       stat
        ;
       stat
        functioncall
         assert
         args
          (
          explist
           exp
            exp
             prefixexp
              i
            ==
            exp
             number
              100
          )
      end
     stat
      do
      block
       stat
        local
        attnamelist
         i
         attrib
        =
        explist
         exp
          number
           1000
       stat
        ;
       stat
        functioncall
         assert
         args
          (
          explist
           exp
            exp
             prefixexp
              i
            ==
            exp
             number
              1000
          )
      end
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           prefixexp
            i
          ==
          exp
           number
            10
        )
     stat
      if
      exp
       exp
        prefixexp
         i
       ~=
       exp
        number
         10
      then
      block
       stat
        local
        attnamelist
         i
         attrib
        =
        explist
         exp
          number
           20
      else
      block
       stat
        local
        attnamelist
         i
         attrib
        =
        explist
         exp
          number
           30
       stat
        functioncall
         assert
         args
          (
          explist
           exp
            exp
             prefixexp
              i
            ==
            exp
             number
              30
          )
      end
    end
   stat
    varlist
     var
      f
    =
    explist
     exp
      nil
   stat
    local
    attnamelist
     f
     attrib
   stat
    local
    attnamelist
     x
     attrib
    =
    explist
     exp
      number
       1
   stat
    varlist
     var
      a
    =
    explist
     exp
      nil
   stat
    functioncall
     functioncall
      load
      args
       (
       explist
        exp
         string
          'local a = {}'
       )
     args
      (
      )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         prefixexp
          a
        ==
        exp
         nil
      )
   stat
    function
    funcname
     f
    funcbody
     (
     parlist
      namelist
       a
     )
     block
      stat
       local
       attnamelist
        _1
        attrib
        ,
        _2
        attrib
        ,
        _3
        attrib
        ,
        _4
        attrib
        ,
        _5
        attrib
      stat
       local
       attnamelist
        _6
        attrib
        ,
        _7
        attrib
        ,
        _8
        attrib
        ,
        _9
        attrib
        ,
        _10
        attrib
      stat
       local
       attnamelist
        x
        attrib
       =
       explist
        exp
         number
          3
      stat
       local
       attnamelist
        b
        attrib
       =
       explist
        exp
         prefixexp
          a
      stat
       local
       attnamelist
        c
        attrib
        ,
        d
        attrib
       =
       explist
        exp
         prefixexp
          a
        ,
        exp
         prefixexp
          b
      stat
       if
       exp
        prefixexp
         (
         exp
          exp
           prefixexp
            d
          ==
          exp
           prefixexp
            b
         )
       then
       block
        stat
         local
         attnamelist
          x
          attrib
         =
         explist
          exp
           string
            'q'
        stat
         varlist
          var
           x
         =
         explist
          exp
           prefixexp
            b
        stat
         functioncall
          assert
          args
           (
           explist
            exp
             exp
              prefixexp
               x
             ==
             exp
              number
               2
           )
       else
       block
        stat
         functioncall
          assert
          args
           (
           explist
            exp
             nil
           )
       end
      stat
       functioncall
        assert
        args
         (
         explist
          exp
           exp
            prefixexp
             x
           ==
           exp
            number
             3
         )
      stat
       local
       attnamelist
        f
        attrib
       =
       explist
        exp
         number
          10
     end
   stat
    local
    attnamelist
     b
     attrib
    =
    explist
     exp
      number
       10
   stat
    local
    attnamelist
     a
     attrib
   stat
    ;
   stat
    repeat
    block
     stat
      local
      attnamelist
       b
       attrib
     stat
      ;
     stat
      varlist
       var
        a
       ,
       var
        b
      =
      explist
       exp
        number
         1
       ,
       exp
        number
         2
     stat
      ;
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           exp
            prefixexp
             a
           +
           exp
            number
             1
          ==
          exp
           prefixexp
            b
        )
     stat
      ;
    until
    exp
     exp
      exp
       prefixexp
        a
      +
      exp
       prefixexp
        b
     ==
     exp
      number
       3
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         prefixexp
          x
        ==
        exp
         number
          1
      )
   stat
    functioncall
     f
     args
      (
      explist
       exp
        number
         2
      )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         prefixexp
          functioncall
           type
           args
            (
            explist
             exp
              prefixexp
               f
            )
        ==
        exp
         string
          'function'
      )
   stat
    local
    function
    getenv
    funcbody
     (
     parlist
      namelist
       f
     )
     block
      stat
       local
       attnamelist
        a
        attrib
        ,
        b
        attrib
       =
       explist
        exp
         prefixexp
          functioncall
           debug
           .
           getupvalue
           args
            (
            explist
             exp
              prefixexp
               f
             ,
             exp
              number
               1
            )
      stat
       functioncall
        assert
        args
         (
         explist
          exp
           exp
            prefixexp
             a
           ==
           exp
            string
             '_ENV'
         )
      retstat
       return
       explist
        exp
         prefixexp
          b
     end
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         prefixexp
          functioncall
           getenv
           args
            (
            explist
             exp
              prefixexp
               functioncall
                load
                args
                 string
                  "a=3"
            )
        ==
        exp
         prefixexp
          _G
      )
   stat
    local
    attnamelist
     c
     attrib
    =
    explist
     exp
      tableconstructor
       {
       }
   stat
    ;
   stat
    local
    attnamelist
     f
     attrib
    =
    explist
     exp
      prefixexp
       functioncall
        load
        args
         (
         explist
          exp
           string
            "a = 3"
          ,
          exp
           nil
          ,
          exp
           nil
          ,
          exp
           prefixexp
            c
         )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         prefixexp
          functioncall
           getenv
           args
            (
            explist
             exp
              prefixexp
               f
            )
        ==
        exp
         prefixexp
          c
      )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         prefixexp
          c
          .
          a
        ==
        exp
         nil
      )
   stat
    functioncall
     f
     args
      (
      )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         prefixexp
          c
          .
          a
        ==
        exp
         number
          3
      )
   stat
    do
    block
     stat
      local
      attnamelist
       i
       attrib
      =
      explist
       exp
        number
         2
     stat
      local
      attnamelist
       p
       attrib
      =
      explist
       exp
        number
         4
     stat
      repeat
      block
       stat
        for
        j
        =
        exp
         -
         exp
          number
           3
        ,
        exp
         number
          3
        do
        block
         stat
          functioncall
           functioncall
            assert
            args
             (
             explist
              exp
               prefixexp
                functioncall
                 load
                 args
                  (
                  explist
                   exp
                    prefixexp
                     functioncall
                      string
                      .
                      format
                      args
                       (
                       explist
                        exp
                         string
                          [[local a=%s;\n                                        a=a+%s;\n                                        assert(a ==2^%s)]]
                        ,
                        exp
                         prefixexp
                          j
                        ,
                        exp
                         exp
                          prefixexp
                           p
                         -
                         exp
                          prefixexp
                           j
                        ,
                        exp
                         prefixexp
                          i
                       )
                   ,
                   exp
                    string
                     ''
                  )
             )
           args
            (
            )
         stat
          functioncall
           functioncall
            assert
            args
             (
             explist
              exp
               prefixexp
                functioncall
                 load
                 args
                  (
                  explist
                   exp
                    prefixexp
                     functioncall
                      string
                      .
                      format
                      args
                       (
                       explist
                        exp
                         string
                          [[local a=%s;\n                                        a=a-%s;\n                                        assert(a==-2^%s)]]
                        ,
                        exp
                         -
                         exp
                          prefixexp
                           j
                        ,
                        exp
                         exp
                          prefixexp
                           p
                         -
                         exp
                          prefixexp
                           j
                        ,
                        exp
                         prefixexp
                          i
                       )
                   ,
                   exp
                    string
                     ''
                  )
             )
           args
            (
            )
         stat
          functioncall
           functioncall
            assert
            args
             (
             explist
              exp
               prefixexp
                functioncall
                 load
                 args
                  (
                  explist
                   exp
                    prefixexp
                     functioncall
                      string
                      .
                      format
                      args
                       (
                       explist
                        exp
                         string
                          [[local a,b=0,%s;\n                                        a=b-%s;\n                                        assert(a==-2^%s)]]
                        ,
                        exp
                         -
                         exp
                          prefixexp
                           j
                        ,
                        exp
                         exp
                          prefixexp
                           p
                         -
                         exp
                          prefixexp
                           j
                        ,
                        exp
                         prefixexp
                          i
                       )
                   ,
                   exp
                    string
                     ''
                  )
             )
           args
            (
            )
        end
       stat
        varlist
         var
          p
        =
        explist
         exp
          exp
           number
            2
          *
          exp
           prefixexp
            p
       stat
        ;
       stat
        varlist
         var
          i
        =
        explist
         exp
          exp
           prefixexp
            i
          +
          exp
           number
            1
      until
      exp
       exp
        prefixexp
         p
       <=
       exp
        number
         0
    end
   stat
    functioncall
     print
     args
      string
       '+'
   stat
    if
    exp
     prefixexp
      functioncall
       rawget
       args
        (
        explist
         exp
          prefixexp
           _G
         ,
         exp
          string
           "T"
        )
    then
    block
     stat
      functioncall
       collectgarbage
       args
        (
        explist
         exp
          string
           "stop"
        )
     stat
      local
      attnamelist
       a
       attrib
      =
      explist
       exp
        tableconstructor
         {
         fieldlist
          field
           [
           exp
            tableconstructor
             {
             }
           ]
           =
           exp
            number
             4
          fieldsep
           ,
          field
           [
           exp
            number
             3
           ]
           =
           exp
            number
             0
          fieldsep
           ,
          field
           alo
           =
           exp
            number
             1
          fieldsep
           ,
          field
           a1234567890123456789012345678901234567890
           =
           exp
            number
             10
         }
     stat
      local
      attnamelist
       t
       attrib
      =
      explist
       exp
        prefixexp
         functioncall
          T
          .
          querytab
          args
           (
           explist
            exp
             prefixexp
              a
           )
     stat
      for
      namelist
       k
       ,
       _
      in
      explist
       exp
        prefixexp
         functioncall
          pairs
          args
           (
           explist
            exp
             prefixexp
              a
           )
      do
      block
       stat
        varlist
         var
          prefixexp
           a
          [
          exp
           prefixexp
            k
          ]
        =
        explist
         exp
          prefixexp
           undef
      end
     stat
      functioncall
       collectgarbage
       args
        (
        )
     stat
      for
      i
      =
      exp
       number
        0
      ,
      exp
       exp
        prefixexp
         t
       -
       exp
        number
         1
      do
      block
       stat
        local
        attnamelist
         k
         attrib
        =
        explist
         exp
          prefixexp
           functioncall
            querytab
            args
             (
             explist
              exp
               prefixexp
                a
              ,
              exp
               prefixexp
                i
             )
       stat
        functioncall
         assert
         args
          (
          explist
           exp
            exp
             exp
              exp
               prefixexp
                k
              ==
              exp
               nil
             or
             exp
              exp
               prefixexp
                functioncall
                 type
                 args
                  (
                  explist
                   exp
                    prefixexp
                     k
                  )
              ==
              exp
               string
                'number'
            or
            exp
             exp
              prefixexp
               k
             ==
             exp
              string
               'alo'
          )
      end
     stat
      local
      attnamelist
       a
       attrib
      =
      explist
       exp
        tableconstructor
         {
         }
     stat
      local
      function
      additems
      funcbody
       (
       parlist
       )
       block
        stat
         varlist
          var
           prefixexp
            a
           .
           x
         =
         explist
          exp
           true
        stat
         ;
        stat
         varlist
          var
           prefixexp
            a
           .
           y
         =
         explist
          exp
           true
        stat
         ;
        stat
         varlist
          var
           prefixexp
            a
           .
           z
         =
         explist
          exp
           true
        stat
         varlist
          var
           prefixexp
            a
           [
           exp
            number
             1
           ]
         =
         explist
          exp
           true
        stat
         varlist
          var
           prefixexp
            a
           [
           exp
            number
             2
           ]
         =
         explist
          exp
           true
       end
     stat
      for
      i
      =
      exp
       number
        1
      ,
      exp
       prefixexp
        math
        .
        huge
      do
      block
       stat
        functioncall
         T
         .
         alloccount
         args
          (
          explist
           exp
            prefixexp
             i
          )
       stat
        local
        attnamelist
         st
         attrib
         ,
         msg
         attrib
        =
        explist
         exp
          prefixexp
           functioncall
            pcall
            args
             (
             explist
              exp
               prefixexp
                additems
             )
       stat
        functioncall
         T
         .
         alloccount
         args
          (
          )
       stat
        local
        attnamelist
         count
         attrib
        =
        explist
         exp
          number
           0
       stat
        for
        namelist
         k
         ,
         v
        in
        explist
         exp
          prefixexp
           functioncall
            pairs
            args
             (
             explist
              exp
               prefixexp
                a
             )
        do
        block
         stat
          functioncall
           assert
           args
            (
            explist
             exp
              exp
               prefixexp
                a
                [
                exp
                 prefixexp
                  k
                ]
              ==
              exp
               prefixexp
                v
            )
         stat
          varlist
           var
            count
          =
          explist
           exp
            exp
             prefixexp
              count
            +
            exp
             number
              1
        end
       stat
        if
        exp
         prefixexp
          st
        then
        block
         stat
          functioncall
           assert
           args
            (
            explist
             exp
              exp
               prefixexp
                count
              ==
              exp
               number
                5
            )
         stat
          ;
         stat
          break
        end
      end
    end
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         prefixexp
          _ENV
        ==
        exp
         prefixexp
          _G
      )
   stat
    do
    block
     stat
      local
      attnamelist
       dummy
       attrib
     stat
      local
      attnamelist
       _ENV
       attrib
      =
      explist
       exp
        prefixexp
         functioncall
          (
          exp
           functiondef
            function
            funcbody
             (
             parlist
              ...
             )
             block
              retstat
               return
               explist
                exp
                 ...
             end
          )
          args
           (
           explist
            exp
             prefixexp
              _G
            ,
            exp
             prefixexp
              dummy
           )
     stat
      do
      block
       stat
        local
        attnamelist
         _ENV
         attrib
        =
        explist
         exp
          tableconstructor
           {
           fieldlist
            field
             assert
             =
             exp
              prefixexp
               assert
           }
       stat
        ;
       stat
        functioncall
         assert
         args
          (
          explist
           exp
            true
          )
      end
     stat
      local
      attnamelist
       mt
       attrib
      =
      explist
       exp
        tableconstructor
         {
         fieldlist
          field
           _G
           =
           exp
            prefixexp
             _G
         }
     stat
      local
      attnamelist
       foo
       attrib
       ,
       x
       attrib
     stat
      varlist
       var
        A
      =
      explist
       exp
        false
     stat
      do
      block
       stat
        local
        attnamelist
         _ENV
         attrib
        =
        explist
         exp
          prefixexp
           mt
       stat
        function
        funcname
         foo
        funcbody
         (
         parlist
          namelist
           x
         )
         block
          stat
           varlist
            var
             A
           =
           explist
            exp
             prefixexp
              x
          stat
           do
           block
            stat
             local
             attnamelist
              _ENV
              attrib
             =
             explist
              exp
               prefixexp
                _G
            stat
             ;
            stat
             varlist
              var
               A
             =
             explist
              exp
               number
                1000
           end
          retstat
           return
           explist
            exp
             functiondef
              function
              funcbody
               (
               parlist
                namelist
                 x
               )
               block
                retstat
                 return
                 explist
                  exp
                   exp
                    prefixexp
                     A
                   ..
                   exp
                    prefixexp
                     x
               end
         end
      end
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           prefixexp
            functioncall
             getenv
             args
              (
              explist
               exp
                prefixexp
                 foo
              )
          ==
          exp
           prefixexp
            mt
        )
     stat
      varlist
       var
        x
      =
      explist
       exp
        prefixexp
         functioncall
          foo
          args
           (
           explist
            exp
             string
              'hi'
           )
     stat
      ;
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           exp
            prefixexp
             mt
             .
             A
           ==
           exp
            string
             'hi'
          and
          exp
           exp
            prefixexp
             A
           ==
           exp
            number
             1000
        )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           prefixexp
            functioncall
             x
             args
              (
              explist
               exp
                string
                 '*'
              )
          ==
          exp
           exp
            prefixexp
             mt
             .
             A
           ..
           exp
            string
             '*'
        )
     stat
      do
      block
       stat
        local
        attnamelist
         _ENV
         attrib
        =
        explist
         exp
          tableconstructor
           {
           fieldlist
            field
             assert
             =
             exp
              prefixexp
               assert
            fieldsep
             ,
            field
             A
             =
             exp
              number
               10
           }
       stat
        ;
       stat
        do
        block
         stat
          local
          attnamelist
           _ENV
           attrib
          =
          explist
           exp
            tableconstructor
             {
             fieldlist
              field
               assert
               =
               exp
                prefixexp
                 assert
              fieldsep
               ,
              field
               A
               =
               exp
                number
                 20
             }
         stat
          ;
         stat
          functioncall
           assert
           args
            (
            explist
             exp
              exp
               prefixexp
                A
              ==
              exp
               number
                20
            )
         stat
          ;
         stat
          varlist
           var
            x
          =
          explist
           exp
            prefixexp
             A
        end
       stat
        functioncall
         assert
         args
          (
          explist
           exp
            exp
             exp
              prefixexp
               A
             ==
             exp
              number
               10
            and
            exp
             exp
              prefixexp
               x
             ==
             exp
              number
               20
          )
      end
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           prefixexp
            x
          ==
          exp
           number
            20
        )
     stat
      varlist
       var
        A
      =
      explist
       exp
        nil
     stat
      do
      block
       stat
        local
        attnamelist
         a
         attrib
          <
          const
          >
         ,
         b
         attrib
         ,
         c
         attrib
          <
          const
          >
        =
        explist
         exp
          number
           10
         ,
         exp
          number
           20
         ,
         exp
          number
           30
       stat
        varlist
         var
          b
        =
        explist
         exp
          exp
           exp
            prefixexp
             a
           +
           exp
            prefixexp
             c
          +
          exp
           prefixexp
            b
       stat
        functioncall
         assert
         args
          (
          explist
           exp
            exp
             exp
              exp
               prefixexp
                a
              ==
              exp
               number
                10
             and
             exp
              exp
               prefixexp
                b
              ==
              exp
               number
                60
            and
            exp
             exp
              prefixexp
               c
             ==
             exp
              number
               30
          )
       stat
        local
        function
        checkro
        funcbody
         (
         parlist
          namelist
           name
           ,
           code
         )
         block
          stat
           local
           attnamelist
            st
            attrib
            ,
            msg
            attrib
           =
           explist
            exp
             prefixexp
              functioncall
               load
               args
                (
                explist
                 exp
                  prefixexp
                   code
                )
          stat
           local
           attnamelist
            gab
            attrib
           =
           explist
            exp
             prefixexp
              functioncall
               string
               .
               format
               args
                (
                explist
                 exp
                  string
                   "attempt to assign to const variable '%s'"
                 ,
                 exp
                  prefixexp
                   name
                )
          stat
           functioncall
            assert
            args
             (
             explist
              exp
               exp
                not
                exp
                 prefixexp
                  st
               and
               exp
                prefixexp
                 functioncall
                  string
                  .
                  find
                  args
                   (
                   explist
                    exp
                     prefixexp
                      msg
                    ,
                    exp
                     prefixexp
                      gab
                   )
             )
         end
       stat
        functioncall
         checkro
         args
          (
          explist
           exp
            string
             "y"
           ,
           exp
            string
             "local x, y <const>, z = 10, 20, 30; x = 11; y = 12"
          )
       stat
        functioncall
         checkro
         args
          (
          explist
           exp
            string
             "x"
           ,
           exp
            string
             "local x <const>, y, z <const> = 10, 20, 30; x = 11"
          )
       stat
        functioncall
         checkro
         args
          (
          explist
           exp
            string
             "z"
           ,
           exp
            string
             "local x <const>, y, z <const> = 10, 20, 30; y = 10; z = 11"
          )
       stat
        functioncall
         checkro
         args
          (
          explist
           exp
            string
             "foo"
           ,
           exp
            string
             "local foo <const> = 10; function foo() end"
          )
       stat
        functioncall
         checkro
         args
          (
          explist
           exp
            string
             "foo"
           ,
           exp
            string
             "local foo <const> = {}; function foo() end"
          )
       stat
        functioncall
         checkro
         args
          (
          explist
           exp
            string
             "z"
           ,
           exp
            string
             [[\n    local a, z <const>, b = 10;\n    function foo() a = 20; z = 32; end\n  ]]
          )
       stat
        functioncall
         checkro
         args
          (
          explist
           exp
            string
             "var1"
           ,
           exp
            string
             [[\n    local a, var1 <const> = 10;\n    function foo() a = 20; z = function () var1 = 12; end  end\n  ]]
          )
      end
     stat
      functioncall
       print
       args
        string
         "testing to-be-closed variables"
     stat
      local
      function
      stack
      funcbody
       (
       parlist
        namelist
         n
       )
       block
        stat
         varlist
          var
           n
         =
         explist
          exp
           prefixexp
            (
            exp
             exp
              prefixexp
               (
               exp
                exp
                 prefixexp
                  n
                ==
                exp
                 number
                  0
               )
             or
             exp
              prefixexp
               functioncall
                stack
                args
                 (
                 explist
                  exp
                   exp
                    prefixexp
                     n
                   -
                   exp
                    number
                     1
                 )
            )
       end
     stat
      local
      function
      func2close
      funcbody
       (
       parlist
        namelist
         f
         ,
         x
         ,
         y
       )
       block
        stat
         local
         attnamelist
          obj
          attrib
         =
         explist
          exp
           prefixexp
            functioncall
             setmetatable
             args
              (
              explist
               exp
                tableconstructor
                 {
                 }
               ,
               exp
                tableconstructor
                 {
                 fieldlist
                  field
                   __close
                   =
                   exp
                    prefixexp
                     f
                 }
              )
        stat
         if
         exp
          prefixexp
           x
         then
         block
          retstat
           return
           explist
            exp
             prefixexp
              x
            ,
            exp
             prefixexp
              obj
            ,
            exp
             prefixexp
              y
         else
         block
          retstat
           return
           explist
            exp
             prefixexp
              obj
         end
       end
     stat
      do
      block
       stat
        local
        attnamelist
         a
         attrib
        =
        explist
         exp
          tableconstructor
           {
           }
       stat
        do
        block
         stat
          local
          attnamelist
           b
           attrib
            <
            close
            >
          =
          explist
           exp
            false
         stat
          local
          attnamelist
           x
           attrib
            <
            close
            >
          =
          explist
           exp
            prefixexp
             functioncall
              setmetatable
              args
               (
               explist
                exp
                 tableconstructor
                  {
                  fieldlist
                   field
                    exp
                     string
                      "x"
                  }
                ,
                exp
                 tableconstructor
                  {
                  fieldlist
                   field
                    __close
                    =
                    exp
                     functiondef
                      function
                      funcbody
                       (
                       parlist
                        namelist
                         self
                       )
                       block
                        stat
                         varlist
                          var
                           prefixexp
                            a
                           [
                           exp
                            exp
                             #
                             exp
                              prefixexp
                               a
                            +
                            exp
                             number
                              1
                           ]
                         =
                         explist
                          exp
                           prefixexp
                            self
                            [
                            exp
                             number
                              1
                            ]
                       end
                  }
               )
         stat
          local
          attnamelist
           w
           attrib
           ,
           y
           attrib
            <
            close
            >
           ,
           z
           attrib
          =
          explist
           exp
            prefixexp
             functioncall
              func2close
              args
               (
               explist
                exp
                 functiondef
                  function
                  funcbody
                   (
                   parlist
                    namelist
                     self
                     ,
                     err
                   )
                   block
                    stat
                     functioncall
                      assert
                      args
                       (
                       explist
                        exp
                         exp
                          prefixexp
                           err
                         ==
                         exp
                          nil
                       )
                    stat
                     ;
                    stat
                     varlist
                      var
                       prefixexp
                        a
                       [
                       exp
                        exp
                         #
                         exp
                          prefixexp
                           a
                        +
                        exp
                         number
                          1
                       ]
                     =
                     explist
                      exp
                       string
                        "y"
                   end
                ,
                exp
                 number
                  10
                ,
                exp
                 number
                  20
               )
         stat
          local
          attnamelist
           c
           attrib
            <
            close
            >
          =
          explist
           exp
            nil
         stat
          varlist
           var
            prefixexp
             a
            [
            exp
             exp
              #
              exp
               prefixexp
                a
             +
             exp
              number
               1
            ]
          =
          explist
           exp
            string
             "in"
         stat
          functioncall
           assert
           args
            (
            explist
             exp
              exp
               exp
                prefixexp
                 w
               ==
               exp
                number
                 10
              and
              exp
               exp
                prefixexp
                 z
               ==
               exp
                number
                 20
            )
        end
       stat
        varlist
         var
          prefixexp
           a
          [
          exp
           exp
            #
            exp
             prefixexp
              a
           +
           exp
            number
             1
          ]
        =
        explist
         exp
          string
           "out"
       stat
        functioncall
         assert
         args
          (
          explist
           exp
            exp
             exp
              exp
               exp
                prefixexp
                 a
                 [
                 exp
                  number
                   1
                 ]
               ==
               exp
                string
                 "in"
              and
              exp
               exp
                prefixexp
                 a
                 [
                 exp
                  number
                   2
                 ]
               ==
               exp
                string
                 "y"
             and
             exp
              exp
               prefixexp
                a
                [
                exp
                 number
                  3
                ]
              ==
              exp
               string
                "x"
            and
            exp
             exp
              prefixexp
               a
               [
               exp
                number
                 4
               ]
             ==
             exp
              string
               "out"
          )
      end
     stat
      do
      block
       stat
        local
        attnamelist
         X
         attrib
        =
        explist
         exp
          false
       stat
        local
        attnamelist
         x
         attrib
         ,
         closescope
         attrib
        =
        explist
         exp
          prefixexp
           functioncall
            func2close
            args
             (
             explist
              exp
               functiondef
                function
                funcbody
                 (
                 parlist
                  namelist
                   _
                   ,
                   msg
                 )
                 block
                  stat
                   functioncall
                    stack
                    args
                     (
                     explist
                      exp
                       number
                        10
                     )
                  stat
                   ;
                  stat
                   functioncall
                    assert
                    args
                     (
                     explist
                      exp
                       exp
                        prefixexp
                         msg
                       ==
                       exp
                        nil
                     )
                  stat
                   varlist
                    var
                     X
                   =
                   explist
                    exp
                     true
                 end
              ,
              exp
               number
                100
             )
       stat
        functioncall
         assert
         args
          (
          explist
           exp
            exp
             prefixexp
              x
            ==
            exp
             number
              100
          )
       stat
        ;
       stat
        varlist
         var
          x
        =
        explist
         exp
          number
           101
       stat
        ;
       stat
        local
        function
        foo
        funcbody
         (
         parlist
          namelist
           x
         )
         block
          stat
           local
           attnamelist
            _
            attrib
             <
             close
             >
           =
           explist
            exp
             prefixexp
              closescope
          retstat
           return
           explist
            exp
             prefixexp
              x
            ,
            exp
             prefixexp
              X
            ,
            exp
             number
              23
         end
       stat
        local
        attnamelist
         a
         attrib
         ,
         b
         attrib
         ,
         c
         attrib
        =
        explist
         exp
          prefixexp
           functioncall
            foo
            args
             (
             explist
              exp
               number
                1.5
             )
       stat
        functioncall
         assert
         args
          (
          explist
           exp
            exp
             exp
              exp
               exp
                prefixexp
                 a
               ==
               exp
                number
                 1.5
              and
              exp
               exp
                prefixexp
                 b
               ==
               exp
                false
             and
             exp
              exp
               prefixexp
                c
              ==
              exp
               number
                23
            and
            exp
             exp
              prefixexp
               X
             ==
             exp
              true
          )
       stat
        varlist
         var
          X
        =
        explist
         exp
          false
       stat
        varlist
         var
          foo
        =
        explist
         exp
          functiondef
           function
           funcbody
            (
            parlist
             namelist
              x
            )
            block
             stat
              local
              attnamelist
               _
               attrib
                <
                close
                >
              =
              explist
               exp
                prefixexp
                 functioncall
                  func2close
                  args
                   (
                   explist
                    exp
                     functiondef
                      function
                      funcbody
                       (
                       parlist
                        namelist
                         _
                         ,
                         msg
                       )
                       block
                        stat
                         functioncall
                          assert
                          args
                           (
                           explist
                            exp
                             exp
                              prefixexp
                               functioncall
                                debug
                                .
                                getinfo
                                args
                                 (
                                 explist
                                  exp
                                   number
                                    2
                                 )
                               .
                               name
                             ==
                             exp
                              string
                               "foo"
                           )
                        stat
                         functioncall
                          assert
                          args
                           (
                           explist
                            exp
                             exp
                              prefixexp
                               msg
                             ==
                             exp
                              nil
                           )
                       end
                   )
             stat
              local
              attnamelist
               _
               attrib
                <
                close
                >
              =
              explist
               exp
                prefixexp
                 closescope
             stat
              local
              attnamelist
               y
               attrib
              =
              explist
               exp
                number
                 15
             retstat
              return
              explist
               exp
                prefixexp
                 y
            end
       stat
        functioncall
         assert
         args
          (
          explist
           exp
            exp
             exp
              prefixexp
               functioncall
                foo
                args
                 (
                 )
             ==
             exp
              number
               15
            and
            exp
             exp
              prefixexp
               X
             ==
             exp
              true
          )
       stat
        varlist
         var
          X
        =
        explist
         exp
          false
       stat
        varlist
         var
          foo
        =
        explist
         exp
          functiondef
           function
           funcbody
            (
            parlist
            )
            block
             stat
              local
              attnamelist
               x
               attrib
                <
                close
                >
              =
              explist
               exp
                prefixexp
                 closescope
             retstat
              return
              explist
               exp
                prefixexp
                 x
            end
       stat
        functioncall
         assert
         args
          (
          explist
           exp
            exp
             exp
              prefixexp
               functioncall
                foo
                args
                 (
                 )
             ==
             exp
              prefixexp
               closescope
            and
            exp
             exp
              prefixexp
               X
             ==
             exp
              true
          )
      end
     stat
      do
      block
       stat
        local
        attnamelist
         flag
         attrib
        =
        explist
         exp
          false
       stat
        local
        attnamelist
         x
         attrib
        =
        explist
         exp
          prefixexp
           functioncall
            setmetatable
            args
             (
             explist
              exp
               tableconstructor
                {
                }
              ,
              exp
               tableconstructor
                {
                fieldlist
                 field
                  __close
                  =
                  exp
                   functiondef
                    function
                    funcbody
                     (
                     parlist
                     )
                     block
                      stat
                       functioncall
                        assert
                        args
                         (
                         explist
                          exp
                           exp
                            prefixexp
                             flag
                           ==
                           exp
                            false
                         )
                      stat
                       ;
                      stat
                       varlist
                        var
                         flag
                       =
                       explist
                        exp
                         true
                     end
                }
             )
       stat
        local
        attnamelist
         y
         attrib
          <
          const
          >
        =
        explist
         exp
          nil
       stat
        local
        attnamelist
         z
         attrib
          <
          const
          >
        =
        explist
         exp
          nil
       stat
        do
        block
         stat
          local
          attnamelist
           a
           attrib
            <
            close
            >
          =
          explist
           exp
            prefixexp
             x
        end
       stat
        functioncall
         assert
         args
          (
          explist
           exp
            prefixexp
             flag
          )
      end
     stat
      do
      block
       stat
        local
        attnamelist
         flag
         attrib
        =
        explist
         exp
          false
       stat
        local
        attnamelist
         x
         attrib
        =
        explist
         exp
          prefixexp
           functioncall
            setmetatable
            args
             (
             explist
              exp
               tableconstructor
                {
                }
              ,
              exp
               tableconstructor
                {
                fieldlist
                 field
                  __close
                  =
                  exp
                   functiondef
                    function
                    funcbody
                     (
                     parlist
                     )
                     block
                      stat
                       functioncall
                        assert
                        args
                         (
                         explist
                          exp
                           exp
                            prefixexp
                             flag
                           ==
                           exp
                            false
                         )
                      stat
                       ;
                      stat
                       varlist
                        var
                         flag
                       =
                       explist
                        exp
                         true
                     end
                }
             )
       stat
        local
        function
        a
        funcbody
         (
         parlist
         )
         block
          retstat
           return
           explist
            exp
             prefixexp
              (
              exp
               functiondef
                function
                funcbody
                 (
                 parlist
                 )
                 block
                  retstat
                   return
                   explist
                    exp
                     nil
                 end
              )
            ,
            exp
             nil
            ,
            exp
             nil
            ,
            exp
             prefixexp
              x
         end
       stat
        local
        attnamelist
         v
         attrib
          <
          const
          >
        =
        explist
         exp
          number
           1
       stat
        local
        attnamelist
         w
         attrib
          <
          const
          >
        =
        explist
         exp
          number
           1
       stat
        local
        attnamelist
         x
         attrib
          <
          const
          >
        =
        explist
         exp
          number
           1
       stat
        local
        attnamelist
         y
         attrib
          <
          const
          >
        =
        explist
         exp
          number
           1
       stat
        local
        attnamelist
         z
         attrib
          <
          const
          >
        =
        explist
         exp
          number
           1
       stat
        for
        namelist
         k
        in
        explist
         exp
          prefixexp
           functioncall
            a
            args
             (
             )
        do
        block
         stat
          varlist
           var
            a
          =
          explist
           exp
            prefixexp
             k
        end
       stat
        functioncall
         assert
         args
          (
          explist
           exp
            prefixexp
             flag
          )
      end
     stat
      do
      block
       stat
        local
        attnamelist
         X
         attrib
         ,
         Y
         attrib
       stat
        local
        function
        foo
        funcbody
         (
         parlist
         )
         block
          stat
           local
           attnamelist
            _
            attrib
             <
             close
             >
           =
           explist
            exp
             prefixexp
              functioncall
               func2close
               args
                (
                explist
                 exp
                  functiondef
                   function
                   funcbody
                    (
                    parlist
                    )
                    block
                     stat
                      varlist
                       var
                        Y
                      =
                      explist
                       exp
                        number
                         10
                    end
                )
          stat
           functioncall
            assert
            args
             (
             explist
              exp
               exp
                exp
                 prefixexp
                  X
                ==
                exp
                 true
               and
               exp
                exp
                 prefixexp
                  Y
                ==
                exp
                 nil
             )
          retstat
           return
           explist
            exp
             number
              1
            ,
            exp
             number
              2
            ,
            exp
             number
              3
         end
       stat
        local
        function
        bar
        funcbody
         (
         parlist
         )
         block
          stat
           local
           attnamelist
            _
            attrib
             <
             close
             >
           =
           explist
            exp
             prefixexp
              functioncall
               func2close
               args
                (
                explist
                 exp
                  functiondef
                   function
                   funcbody
                    (
                    parlist
                    )
                    block
                     stat
                      varlist
                       var
                        X
                      =
                      explist
                       exp
                        false
                    end
                )
          stat
           varlist
            var
             X
           =
           explist
            exp
             true
          stat
           do
           block
            retstat
             return
             explist
              exp
               prefixexp
                functioncall
                 foo
                 args
                  (
                  )
           end
         end
       stat
        local
        attnamelist
         a
         attrib
         ,
         b
         attrib
         ,
         c
         attrib
         ,
         d
         attrib
        =
        explist
         exp
          prefixexp
           functioncall
            bar
            args
             (
             )
       stat
        functioncall
         assert
         args
          (
          explist
           exp
            exp
             exp
              exp
               exp
                exp
                 exp
                  prefixexp
                   a
                 ==
                 exp
                  number
                   1
                and
                exp
                 exp
                  prefixexp
                   b
                 ==
                 exp
                  number
                   2
               and
               exp
                exp
                 prefixexp
                  c
                ==
                exp
                 number
                  3
              and
              exp
               exp
                prefixexp
                 X
               ==
               exp
                false
             and
             exp
              exp
               prefixexp
                Y
              ==
              exp
               number
                10
            and
            exp
             exp
              prefixexp
               d
             ==
             exp
              nil
          )
      end
     stat
      do
      block
       stat
        local
        attnamelist
         closed
         attrib
        =
        explist
         exp
          false
       stat
        local
        function
        foo
        funcbody
         (
         parlist
         )
         block
          retstat
           return
           explist
            exp
             functiondef
              function
              funcbody
               (
               parlist
               )
               block
                retstat
                 return
                 explist
                  exp
                   true
               end
            ,
            exp
             number
              0
            ,
            exp
             number
              0
            ,
            exp
             prefixexp
              functioncall
               func2close
               args
                (
                explist
                 exp
                  functiondef
                   function
                   funcbody
                    (
                    parlist
                    )
                    block
                     stat
                      varlist
                       var
                        closed
                      =
                      explist
                       exp
                        true
                    end
                )
         end
       stat
        local
        function
        tail
        funcbody
         (
         parlist
         )
         block
          retstat
           return
           explist
            exp
             prefixexp
              closed
         end
       stat
        local
        function
        foo1
        funcbody
         (
         parlist
         )
         block
          stat
           for
           namelist
            k
           in
           explist
            exp
             prefixexp
              functioncall
               foo
               args
                (
                )
           do
           block
            retstat
             return
             explist
              exp
               prefixexp
                functioncall
                 tail
                 args
                  (
                  )
           end
         end
       stat
        functioncall
         assert
         args
          (
          explist
           exp
            exp
             prefixexp
              functioncall
               foo1
               args
                (
                )
            ==
            exp
             false
          )
       stat
        functioncall
         assert
         args
          (
          explist
           exp
            exp
             prefixexp
              closed
            ==
            exp
             true
          )
      end
     stat
      do
      block
       stat
        local
        attnamelist
         closed
         attrib
        =
        explist
         exp
          false
       stat
        local
        attnamelist
         o1
         attrib
        =
        explist
         exp
          prefixexp
           functioncall
            setmetatable
            args
             (
             explist
              exp
               tableconstructor
                {
                }
              ,
              exp
               tableconstructor
                {
                fieldlist
                 field
                  __close
                  =
                  exp
                   functiondef
                    function
                    funcbody
                     (
                     parlist
                     )
                     block
                      stat
                       varlist
                        var
                         closed
                       =
                       explist
                        exp
                         true
                     end
                }
             )
       stat
        local
        function
        test
        funcbody
         (
         parlist
         )
         block
          stat
           for
           namelist
            k
            ,
            v
           in
           explist
            exp
             prefixexp
              next
            ,
            exp
             tableconstructor
              {
              }
            ,
            exp
             nil
            ,
            exp
             prefixexp
              o1
           do
           block
            stat
             local
             function
             f
             funcbody
              (
              parlist
              )
              block
               retstat
                return
                explist
                 exp
                  prefixexp
                   k
              end
            stat
             break
           end
          stat
           functioncall
            assert
            args
             (
             explist
              exp
               prefixexp
                closed
             )
         end
       stat
        functioncall
         test
         args
          (
          )
      end
     stat
      do
      block
       stat
        functioncall
         print
         args
          (
          explist
           exp
            string
             "testing errors in __close"
          )
       stat
        local
        function
        foo
        funcbody
         (
         parlist
         )
         block
          stat
           local
           attnamelist
            x
            attrib
             <
             close
             >
           =
           explist
            exp
             prefixexp
              functioncall
               func2close
               args
                (
                explist
                 exp
                  functiondef
                   function
                   funcbody
                    (
                    parlist
                     namelist
                      self
                      ,
                      msg
                    )
                    block
                     stat
                      functioncall
                       assert
                       args
                        (
                        explist
                         exp
                          prefixexp
                           functioncall
                            string
                            .
                            find
                            args
                             (
                             explist
                              exp
                               prefixexp
                                msg
                              ,
                              exp
                               string
                                "@y"
                             )
                        )
                     stat
                      functioncall
                       error
                       args
                        (
                        explist
                         exp
                          string
                           "@x"
                        )
                    end
                )
          stat
           local
           attnamelist
            x1
            attrib
             <
             close
             >
           =
           explist
            exp
             prefixexp
              functioncall
               func2close
               args
                (
                explist
                 exp
                  functiondef
                   function
                   funcbody
                    (
                    parlist
                     namelist
                      self
                      ,
                      msg
                    )
                    block
                     stat
                      functioncall
                       assert
                       args
                        (
                        explist
                         exp
                          prefixexp
                           functioncall
                            string
                            .
                            find
                            args
                             (
                             explist
                              exp
                               prefixexp
                                msg
                              ,
                              exp
                               string
                                "@y"
                             )
                        )
                    end
                )
          stat
           local
           attnamelist
            gc
            attrib
             <
             close
             >
           =
           explist
            exp
             prefixexp
              functioncall
               func2close
               args
                (
                explist
                 exp
                  functiondef
                   function
                   funcbody
                    (
                    parlist
                    )
                    block
                     stat
                      functioncall
                       collectgarbage
                       args
                        (
                        )
                    end
                )
          stat
           local
           attnamelist
            y
            attrib
             <
             close
             >
           =
           explist
            exp
             prefixexp
              functioncall
               func2close
               args
                (
                explist
                 exp
                  functiondef
                   function
                   funcbody
                    (
                    parlist
                     namelist
                      self
                      ,
                      msg
                    )
                    block
                     stat
                      functioncall
                       assert
                       args
                        (
                        explist
                         exp
                          prefixexp
                           functioncall
                            string
                            .
                            find
                            args
                             (
                             explist
                              exp
                               prefixexp
                                msg
                              ,
                              exp
                               string
                                "@z"
                             )
                        )
                     stat
                      functioncall
                       error
                       args
                        (
                        explist
                         exp
                          string
                           "@y"
                        )
                    end
                )
          stat
           local
           attnamelist
            z
            attrib
             <
             close
             >
           =
           explist
            exp
             prefixexp
              functioncall
               func2close
               args
                (
                explist
                 exp
                  functiondef
                   function
                   funcbody
                    (
                    parlist
                     namelist
                      self
                      ,
                      msg
                    )
                    block
                     stat
                      functioncall
                       assert
                       args
                        (
                        explist
                         exp
                          exp
                           prefixexp
                            msg
                          ==
                          exp
                           nil
                        )
                     stat
                      functioncall
                       error
                       args
                        (
                        explist
                         exp
                          string
                           "@z"
                        )
                    end
                )
          retstat
           return
           explist
            exp
             number
              200
         end
       stat
        local
        attnamelist
         stat
         attrib
         ,
         msg
         attrib
        =
        explist
         exp
          prefixexp
           functioncall
            pcall
            args
             (
             explist
              exp
               prefixexp
                foo
              ,
              exp
               false
             )
       stat
        functioncall
         assert
         args
          (
          explist
           exp
            prefixexp
             functioncall
              string
              .
              find
              args
               (
               explist
                exp
                 prefixexp
                  msg
                ,
                exp
                 string
                  "@x"
               )
          )
       stat
        local
        function
        foo
        funcbody
         (
         parlist
         )
         block
          stat
           local
           attnamelist
            x
            attrib
             <
             close
             >
           =
           explist
            exp
             prefixexp
              functioncall
               func2close
               args
                (
                explist
                 exp
                  functiondef
                   function
                   funcbody
                    (
                    parlist
                     namelist
                      self
                      ,
                      msg
                    )
                    block
                     stat
                      functioncall
                       assert
                       args
                        (
                        explist
                         exp
                          exp
                           prefixexp
                            functioncall
                             debug
                             .
                             getinfo
                             args
                              (
                              explist
                               exp
                                number
                                 2
                              )
                            .
                            name
                          ==
                          exp
                           string
                            "pcall"
                        )
                     stat
                      functioncall
                       assert
                       args
                        (
                        explist
                         exp
                          prefixexp
                           functioncall
                            string
                            .
                            find
                            args
                             (
                             explist
                              exp
                               prefixexp
                                msg
                              ,
                              exp
                               string
                                "@x1"
                             )
                        )
                    end
                )
          stat
           local
           attnamelist
            x1
            attrib
             <
             close
             >
           =
           explist
            exp
             prefixexp
              functioncall
               func2close
               args
                (
                explist
                 exp
                  functiondef
                   function
                   funcbody
                    (
                    parlist
                     namelist
                      self
                      ,
                      msg
                    )
                    block
                     stat
                      functioncall
                       assert
                       args
                        (
                        explist
                         exp
                          exp
                           prefixexp
                            functioncall
                             debug
                             .
                             getinfo
                             args
                              (
                              explist
                               exp
                                number
                                 2
                              )
                            .
                            name
                          ==
                          exp
                           string
                            "pcall"
                        )
                     stat
                      functioncall
                       assert
                       args
                        (
                        explist
                         exp
                          prefixexp
                           functioncall
                            string
                            .
                            find
                            args
                             (
                             explist
                              exp
                               prefixexp
                                msg
                              ,
                              exp
                               string
                                "@y"
                             )
                        )
                     stat
                      functioncall
                       error
                       args
                        (
                        explist
                         exp
                          string
                           "@x1"
                        )
                    end
                )
          stat
           local
           attnamelist
            gc
            attrib
             <
             close
             >
           =
           explist
            exp
             prefixexp
              functioncall
               func2close
               args
                (
                explist
                 exp
                  functiondef
                   function
                   funcbody
                    (
                    parlist
                    )
                    block
                     stat
                      functioncall
                       collectgarbage
                       args
                        (
                        )
                    end
                )
          stat
           local
           attnamelist
            y
            attrib
             <
             close
             >
           =
           explist
            exp
             prefixexp
              functioncall
               func2close
               args
                (
                explist
                 exp
                  functiondef
                   function
                   funcbody
                    (
                    parlist
                     namelist
                      self
                      ,
                      msg
                    )
                    block
                     stat
                      functioncall
                       assert
                       args
                        (
                        explist
                         exp
                          exp
                           prefixexp
                            functioncall
                             debug
                             .
                             getinfo
                             args
                              (
                              explist
                               exp
                                number
                                 2
                              )
                            .
                            name
                          ==
                          exp
                           string
                            "pcall"
                        )
                     stat
                      functioncall
                       assert
                       args
                        (
                        explist
                         exp
                          prefixexp
                           functioncall
                            string
                            .
                            find
                            args
                             (
                             explist
                              exp
                               prefixexp
                                msg
                              ,
                              exp
                               string
                                "@z"
                             )
                        )
                     stat
                      functioncall
                       error
                       args
                        (
                        explist
                         exp
                          string
                           "@y"
                        )
                    end
                )
          stat
           local
           attnamelist
            first
            attrib
           =
           explist
            exp
             true
          stat
           local
           attnamelist
            z
            attrib
             <
             close
             >
           =
           explist
            exp
             prefixexp
              functioncall
               func2close
               args
                (
                explist
                 exp
                  functiondef
                   function
                   funcbody
                    (
                    parlist
                     namelist
                      self
                      ,
                      msg
                    )
                    block
                     stat
                      functioncall
                       assert
                       args
                        (
                        explist
                         exp
                          exp
                           prefixexp
                            functioncall
                             debug
                             .
                             getinfo
                             args
                              (
                              explist
                               exp
                                number
                                 2
                              )
                            .
                            name
                          ==
                          exp
                           string
                            "pcall"
                        )
                     stat
                      functioncall
                       assert
                       args
                        (
                        explist
                         exp
                          exp
                           prefixexp
                            first
                          and
                          exp
                           exp
                            prefixexp
                             msg
                           ==
                           exp
                            number
                             4
                        )
                     stat
                      varlist
                       var
                        first
                      =
                      explist
                       exp
                        false
                     stat
                      functioncall
                       error
                       args
                        (
                        explist
                         exp
                          string
                           "@z"
                        )
                    end
                )
          stat
           functioncall
            error
            args
             (
             explist
              exp
               number
                4
             )
         end
       stat
        local
        attnamelist
         stat
         attrib
         ,
         msg
         attrib
        =
        explist
         exp
          prefixexp
           functioncall
            pcall
            args
             (
             explist
              exp
               prefixexp
                foo
              ,
              exp
               true
             )
       stat
        functioncall
         assert
         args
          (
          explist
           exp
            prefixexp
             functioncall
              string
              .
              find
              args
               (
               explist
                exp
                 prefixexp
                  msg
                ,
                exp
                 string
                  "@x1"
               )
          )
       stat
        local
        function
        foo
        funcbody
         (
         parlist
          ...
         )
         block
          stat
           do
           block
            stat
             local
             attnamelist
              x1
              attrib
               <
               close
               >
             =
             explist
              exp
               prefixexp
                functioncall
                 func2close
                 args
                  (
                  explist
                   exp
                    functiondef
                     function
                     funcbody
                      (
                      parlist
                       namelist
                        self
                        ,
                        msg
                      )
                      block
                       stat
                        functioncall
                         assert
                         args
                          (
                          explist
                           exp
                            prefixexp
                             functioncall
                              string
                              .
                              find
                              args
                               (
                               explist
                                exp
                                 prefixexp
                                  msg
                                ,
                                exp
                                 string
                                  "@X"
                               )
                          )
                       stat
                        functioncall
                         error
                         args
                          (
                          explist
                           exp
                            string
                             "@Y"
                          )
                      end
                  )
            stat
             local
             attnamelist
              x123
              attrib
               <
               close
               >
             =
             explist
              exp
               prefixexp
                functioncall
                 func2close
                 args
                  (
                  explist
                   exp
                    functiondef
                     function
                     funcbody
                      (
                      parlist
                       namelist
                        _
                        ,
                        msg
                      )
                      block
                       stat
                        functioncall
                         assert
                         args
                          (
                          explist
                           exp
                            exp
                             prefixexp
                              msg
                            ==
                            exp
                             nil
                          )
                       stat
                        functioncall
                         error
                         args
                          (
                          explist
                           exp
                            string
                             "@X"
                          )
                      end
                  )
           end
          stat
           functioncall
            os
            .
            exit
            args
             (
             explist
              exp
               false
             )
         end
       stat
        local
        attnamelist
         st
         attrib
         ,
         msg
         attrib
        =
        explist
         exp
          prefixexp
           functioncall
            xpcall
            args
             (
             explist
              exp
               prefixexp
                foo
              ,
              exp
               prefixexp
                debug
                .
                traceback
             )
       stat
        functioncall
         assert
         args
          (
          explist
           exp
            prefixexp
             functioncall
              string
              .
              match
              args
               (
               explist
                exp
                 prefixexp
                  msg
                ,
                exp
                 string
                  "^[^ ]* @Y"
               )
          )
       stat
        local
        function
        foo
        funcbody
         (
         parlist
          ...
         )
         block
          stat
           local
           attnamelist
            x123
            attrib
             <
             close
             >
           =
           explist
            exp
             prefixexp
              functioncall
               func2close
               args
                (
                explist
                 exp
                  functiondef
                   function
                   funcbody
                    (
                    parlist
                    )
                    block
                     stat
                      functioncall
                       error
                       args
                        (
                        explist
                         exp
                          string
                           "@x123"
                        )
                    end
                )
         end
       stat
        local
        attnamelist
         st
         attrib
         ,
         msg
         attrib
        =
        explist
         exp
          prefixexp
           functioncall
            xpcall
            args
             (
             explist
              exp
               prefixexp
                foo
              ,
              exp
               prefixexp
                debug
                .
                traceback
             )
       stat
        functioncall
         assert
         args
          (
          explist
           exp
            prefixexp
             functioncall
              string
              .
              match
              args
               (
               explist
                exp
                 prefixexp
                  msg
                ,
                exp
                 string
                  "^[^ ]* @x123"
               )
          )
       stat
        functioncall
         assert
         args
          (
          explist
           exp
            prefixexp
             functioncall
              string
              .
              find
              args
               (
               explist
                exp
                 prefixexp
                  msg
                ,
                exp
                 string
                  "in metamethod 'close'"
               )
          )
      end
     stat
      do
      block
       stat
        local
        function
        foo
        funcbody
         (
         parlist
         )
         block
          stat
           local
           attnamelist
            x
            attrib
             <
             close
             >
           =
           explist
            exp
             tableconstructor
              {
              }
          stat
           functioncall
            os
            .
            exit
            args
             (
             explist
              exp
               false
             )
         end
       stat
        local
        attnamelist
         stat
         attrib
         ,
         msg
         attrib
        =
        explist
         exp
          prefixexp
           functioncall
            pcall
            args
             (
             explist
              exp
               prefixexp
                foo
             )
       stat
        functioncall
         assert
         args
          (
          explist
           exp
            exp
             not
             exp
              prefixexp
               stat
            and
            exp
             prefixexp
              functioncall
               string
               .
               find
               args
                (
                explist
                 exp
                  prefixexp
                   msg
                 ,
                 exp
                  string
                   "variable 'x' got a non%-closable value"
                )
          )
       stat
        local
        function
        foo
        funcbody
         (
         parlist
         )
         block
          stat
           local
           attnamelist
            xyz
            attrib
             <
             close
             >
           =
           explist
            exp
             prefixexp
              functioncall
               setmetatable
               args
                (
                explist
                 exp
                  tableconstructor
                   {
                   }
                 ,
                 exp
                  tableconstructor
                   {
                   fieldlist
                    field
                     __close
                     =
                     exp
                      prefixexp
                       print
                   }
                )
          stat
           varlist
            var
             prefixexp
              functioncall
               getmetatable
               args
                (
                explist
                 exp
                  prefixexp
                   xyz
                )
             .
             __close
           =
           explist
            exp
             nil
         end
       stat
        local
        attnamelist
         stat
         attrib
         ,
         msg
         attrib
        =
        explist
         exp
          prefixexp
           functioncall
            pcall
            args
             (
             explist
              exp
               prefixexp
                foo
             )
       stat
        functioncall
         assert
         args
          (
          explist
           exp
            exp
             not
             exp
              prefixexp
               stat
            and
            exp
             prefixexp
              functioncall
               string
               .
               find
               args
                (
                explist
                 exp
                  prefixexp
                   msg
                 ,
                 exp
                  string
                   "metamethod 'close'"
                )
          )
       stat
        local
        function
        foo
        funcbody
         (
         parlist
         )
         block
          stat
           local
           attnamelist
            a1
            attrib
             <
             close
             >
           =
           explist
            exp
             prefixexp
              functioncall
               func2close
               args
                (
                explist
                 exp
                  functiondef
                   function
                   funcbody
                    (
                    parlist
                     namelist
                      _
                      ,
                      msg
                    )
                    block
                     stat
                      functioncall
                       assert
                       args
                        (
                        explist
                         exp
                          prefixexp
                           functioncall
                            string
                            .
                            find
                            args
                             (
                             explist
                              exp
                               prefixexp
                                msg
                              ,
                              exp
                               string
                                "number value"
                             )
                        )
                     stat
                      functioncall
                       error
                       args
                        (
                        explist
                         exp
                          number
                           12
                        )
                    end
                )
          stat
           local
           attnamelist
            a2
            attrib
             <
             close
             >
           =
           explist
            exp
             prefixexp
              functioncall
               setmetatable
               args
                (
                explist
                 exp
                  tableconstructor
                   {
                   }
                 ,
                 exp
                  tableconstructor
                   {
                   fieldlist
                    field
                     __close
                     =
                     exp
                      prefixexp
                       print
                   }
                )
          stat
           local
           attnamelist
            a3
            attrib
             <
             close
             >
           =
           explist
            exp
             prefixexp
              functioncall
               func2close
               args
                (
                explist
                 exp
                  functiondef
                   function
                   funcbody
                    (
                    parlist
                     namelist
                      _
                      ,
                      msg
                    )
                    block
                     stat
                      functioncall
                       assert
                       args
                        (
                        explist
                         exp
                          exp
                           prefixexp
                            msg
                          ==
                          exp
                           nil
                        )
                     stat
                      functioncall
                       error
                       args
                        (
                        explist
                         exp
                          number
                           123
                        )
                    end
                )
          stat
           varlist
            var
             prefixexp
              functioncall
               getmetatable
               args
                (
                explist
                 exp
                  prefixexp
                   a2
                )
             .
             __close
           =
           explist
            exp
             number
              4
         end
       stat
        local
        attnamelist
         stat
         attrib
         ,
         msg
         attrib
        =
        explist
         exp
          prefixexp
           functioncall
            pcall
            args
             (
             explist
              exp
               prefixexp
                foo
             )
       stat
        functioncall
         assert
         args
          (
          explist
           exp
            exp
             not
             exp
              prefixexp
               stat
            and
            exp
             exp
              prefixexp
               msg
             ==
             exp
              number
               12
          )
      end
     stat
      do
      block
       stat
        local
        attnamelist
         track
         attrib
        =
        explist
         exp
          tableconstructor
           {
           }
       stat
        local
        function
        foo
        funcbody
         (
         parlist
         )
         block
          stat
           local
           attnamelist
            x
            attrib
             <
             close
             >
           =
           explist
            exp
             prefixexp
              functioncall
               func2close
               args
                (
                explist
                 exp
                  functiondef
                   function
                   funcbody
                    (
                    parlist
                    )
                    block
                     stat
                      local
                      attnamelist
                       xx
                       attrib
                        <
                        close
                        >
                      =
                      explist
                       exp
                        prefixexp
                         functioncall
                          func2close
                          args
                           (
                           explist
                            exp
                             functiondef
                              function
                              funcbody
                               (
                               parlist
                                namelist
                                 _
                                 ,
                                 msg
                               )
                               block
                                stat
                                 functioncall
                                  assert
                                  args
                                   (
                                   explist
                                    exp
                                     exp
                                      prefixexp
                                       msg
                                     ==
                                     exp
                                      nil
                                   )
                                stat
                                 varlist
                                  var
                                   prefixexp
                                    track
                                   [
                                   exp
                                    exp
                                     #
                                     exp
                                      prefixexp
                                       track
                                    +
                                    exp
                                     number
                                      1
                                   ]
                                 =
                                 explist
                                  exp
                                   string
                                    "xx"
                               end
                           )
                     stat
                      varlist
                       var
                        prefixexp
                         track
                        [
                        exp
                         exp
                          #
                          exp
                           prefixexp
                            track
                         +
                         exp
                          number
                           1
                        ]
                      =
                      explist
                       exp
                        string
                         "x"
                    end
                )
          stat
           varlist
            var
             prefixexp
              track
             [
             exp
              exp
               #
               exp
                prefixexp
                 track
              +
              exp
               number
                1
             ]
           =
           explist
            exp
             string
              "foo"
          retstat
           return
           explist
            exp
             number
              20
            ,
            exp
             number
              30
            ,
            exp
             number
              40
         end
       stat
        local
        attnamelist
         a
         attrib
         ,
         b
         attrib
         ,
         c
         attrib
         ,
         d
         attrib
        =
        explist
         exp
          prefixexp
           functioncall
            foo
            args
             (
             )
       stat
        functioncall
         assert
         args
          (
          explist
           exp
            exp
             exp
              exp
               exp
                prefixexp
                 a
               ==
               exp
                number
                 20
              and
              exp
               exp
                prefixexp
                 b
               ==
               exp
                number
                 30
             and
             exp
              exp
               prefixexp
                c
              ==
              exp
               number
                40
            and
            exp
             exp
              prefixexp
               d
             ==
             exp
              nil
          )
       stat
        functioncall
         assert
         args
          (
          explist
           exp
            exp
             exp
              exp
               prefixexp
                track
                [
                exp
                 number
                  1
                ]
              ==
              exp
               string
                "foo"
             and
             exp
              exp
               prefixexp
                track
                [
                exp
                 number
                  2
                ]
              ==
              exp
               string
                "x"
            and
            exp
             exp
              prefixexp
               track
               [
               exp
                number
                 3
               ]
             ==
             exp
              string
               "xx"
          )
       stat
        local
        attnamelist
         track
         attrib
        =
        explist
         exp
          tableconstructor
           {
           }
       stat
        local
        function
        foo
        funcbody
         (
         parlist
         )
         block
          stat
           local
           attnamelist
            x0
            attrib
             <
             close
             >
           =
           explist
            exp
             prefixexp
              functioncall
               func2close
               args
                (
                explist
                 exp
                  functiondef
                   function
                   funcbody
                    (
                    parlist
                     namelist
                      _
                      ,
                      msg
                    )
                    block
                     stat
                      functioncall
                       assert
                       args
                        (
                        explist
                         exp
                          exp
                           prefixexp
                            msg
                          ==
                          exp
                           number
                            202
                        )
                     stat
                      varlist
                       var
                        prefixexp
                         track
                        [
                        exp
                         exp
                          #
                          exp
                           prefixexp
                            track
                         +
                         exp
                          number
                           1
                        ]
                      =
                      explist
                       exp
                        string
                         "x0"
                    end
                )
          stat
           local
           attnamelist
            x
            attrib
             <
             close
             >
           =
           explist
            exp
             prefixexp
              functioncall
               func2close
               args
                (
                explist
                 exp
                  functiondef
                   function
                   funcbody
                    (
                    parlist
                    )
                    block
                     stat
                      local
                      attnamelist
                       xx
                       attrib
                        <
                        close
                        >
                      =
                      explist
                       exp
                        prefixexp
                         functioncall
                          func2close
                          args
                           (
                           explist
                            exp
                             functiondef
                              function
                              funcbody
                               (
                               parlist
                                namelist
                                 _
                                 ,
                                 msg
                               )
                               block
                                stat
                                 functioncall
                                  assert
                                  args
                                   (
                                   explist
                                    exp
                                     exp
                                      prefixexp
                                       msg
                                     ==
                                     exp
                                      number
                                       101
                                   )
                                stat
                                 varlist
                                  var
                                   prefixexp
                                    track
                                   [
                                   exp
                                    exp
                                     #
                                     exp
                                      prefixexp
                                       track
                                    +
                                    exp
                                     number
                                      1
                                   ]
                                 =
                                 explist
                                  exp
                                   string
                                    "xx"
                                stat
                                 functioncall
                                  error
                                  args
                                   (
                                   explist
                                    exp
                                     number
                                      202
                                   )
                               end
                           )
                     stat
                      varlist
                       var
                        prefixexp
                         track
                        [
                        exp
                         exp
                          #
                          exp
                           prefixexp
                            track
                         +
                         exp
                          number
                           1
                        ]
                      =
                      explist
                       exp
                        string
                         "x"
                     stat
                      functioncall
                       error
                       args
                        (
                        explist
                         exp
                          number
                           101
                        )
                    end
                )
          stat
           varlist
            var
             prefixexp
              track
             [
             exp
              exp
               #
               exp
                prefixexp
                 track
              +
              exp
               number
                1
             ]
           =
           explist
            exp
             string
              "foo"
          retstat
           return
           explist
            exp
             number
              20
            ,
            exp
             number
              30
            ,
            exp
             number
              40
         end
       stat
        local
        attnamelist
         st
         attrib
         ,
         msg
         attrib
        =
        explist
         exp
          prefixexp
           functioncall
            pcall
            args
             (
             explist
              exp
               prefixexp
                foo
             )
       stat
        functioncall
         assert
         args
          (
          explist
           exp
            exp
             not
             exp
              prefixexp
               st
            and
            exp
             exp
              prefixexp
               msg
             ==
             exp
              number
               202
          )
       stat
        functioncall
         assert
         args
          (
          explist
           exp
            exp
             exp
              exp
               exp
                prefixexp
                 track
                 [
                 exp
                  number
                   1
                 ]
               ==
               exp
                string
                 "foo"
              and
              exp
               exp
                prefixexp
                 track
                 [
                 exp
                  number
                   2
                 ]
               ==
               exp
                string
                 "x"
             and
             exp
              exp
               prefixexp
                track
                [
                exp
                 number
                  3
                ]
              ==
              exp
               string
                "xx"
            and
            exp
             exp
              prefixexp
               track
               [
               exp
                number
                 4
               ]
             ==
             exp
              string
               "x0"
          )
      end
     stat
      local
      function
      checktable
      funcbody
       (
       parlist
        namelist
         t1
         ,
         t2
       )
       block
        stat
         functioncall
          assert
          args
           (
           explist
            exp
             exp
              #
              exp
               prefixexp
                t1
             ==
             exp
              #
              exp
               prefixexp
                t2
           )
        stat
         for
         i
         =
         exp
          number
           1
         ,
         exp
          #
          exp
           prefixexp
            t1
         do
         block
          stat
           functioncall
            assert
            args
             (
             explist
              exp
               exp
                prefixexp
                 t1
                 [
                 exp
                  prefixexp
                   i
                 ]
               ==
               exp
                prefixexp
                 t2
                 [
                 exp
                  prefixexp
                   i
                 ]
             )
         end
       end
     stat
      do
      block
       stat
        local
        function
        overflow
        funcbody
         (
         parlist
          namelist
           n
         )
         block
          stat
           functioncall
            overflow
            args
             (
             explist
              exp
               exp
                prefixexp
                 n
               +
               exp
                number
                 1
             )
         end
       stat
        local
        function
        errorh
        funcbody
         (
         parlist
          namelist
           m
         )
         block
          stat
           functioncall
            assert
            args
             (
             explist
              exp
               prefixexp
                functioncall
                 string
                 .
                 find
                 args
                  (
                  explist
                   exp
                    prefixexp
                     m
                   ,
                   exp
                    string
                     "stack overflow"
                  )
             )
          stat
           local
           attnamelist
            x
            attrib
             <
             close
             >
           =
           explist
            exp
             prefixexp
              functioncall
               func2close
               args
                (
                explist
                 exp
                  functiondef
                   function
                   funcbody
                    (
                    parlist
                     namelist
                      o
                    )
                    block
                     stat
                      varlist
                       var
                        prefixexp
                         o
                        [
                        exp
                         number
                          1
                        ]
                      =
                      explist
                       exp
                        number
                         10
                    end
                )
          retstat
           return
           explist
            exp
             prefixexp
              x
         end
       stat
        local
        attnamelist
         flag
         attrib
       stat
        local
        attnamelist
         st
         attrib
         ,
         obj
         attrib
       stat
        local
        attnamelist
         co
         attrib
        =
        explist
         exp
          prefixexp
           functioncall
            coroutine
            .
            wrap
            args
             (
             explist
              exp
               functiondef
                function
                funcbody
                 (
                 parlist
                 )
                 block
                  stat
                   local
                   attnamelist
                    y
                    attrib
                     <
                     close
                     >
                   =
                   explist
                    exp
                     prefixexp
                      functioncall
                       func2close
                       args
                        (
                        explist
                         exp
                          functiondef
                           function
                           funcbody
                            (
                            parlist
                             namelist
                              obj
                              ,
                              msg
                            )
                            block
                             stat
                              functioncall
                               assert
                               args
                                (
                                explist
                                 exp
                                  exp
                                   prefixexp
                                    msg
                                  ==
                                  exp
                                   nil
                                )
                             stat
                              varlist
                               var
                                prefixexp
                                 obj
                                [
                                exp
                                 number
                                  1
                                ]
                              =
                              explist
                               exp
                                number
                                 100
                             stat
                              varlist
                               var
                                flag
                              =
                              explist
                               exp
                                prefixexp
                                 obj
                            end
                        )
                  stat
                   functioncall
                    tracegc
                    .
                    stop
                    args
                     (
                     )
                  stat
                   varlist
                    var
                     st
                    ,
                    var
                     obj
                   =
                   explist
                    exp
                     prefixexp
                      functioncall
                       xpcall
                       args
                        (
                        explist
                         exp
                          prefixexp
                           overflow
                         ,
                         exp
                          prefixexp
                           errorh
                         ,
                         exp
                          number
                           0
                        )
                  stat
                   functioncall
                    tracegc
                    .
                    start
                    args
                     (
                     )
                 end
             )
       stat
        functioncall
         co
         args
          (
          )
       stat
        functioncall
         assert
         args
          (
          explist
           exp
            exp
             exp
              not
              exp
               prefixexp
                st
             and
             exp
              exp
               prefixexp
                obj
                [
                exp
                 number
                  1
                ]
              ==
              exp
               number
                10
            and
            exp
             exp
              prefixexp
               flag
               [
               exp
                number
                 1
               ]
             ==
             exp
              number
               100
          )
      end
     stat
      if
      exp
       prefixexp
        functioncall
         rawget
         args
          (
          explist
           exp
            prefixexp
             _G
           ,
           exp
            string
             "T"
          )
      then
      block
       stat
        do
        block
         stat
          functioncall
           collectgarbage
           args
            (
            )
         stat
          ;
         stat
          functioncall
           collectgarbage
           args
            (
            )
         stat
          ;
         stat
          functioncall
           collectgarbage
           args
            (
            )
         stat
          local
          function
          loop
          funcbody
           (
           parlist
            namelist
             n
           )
           block
            stat
             if
             exp
              exp
               prefixexp
                n
              <
              exp
               number
                400
             then
             block
              stat
               functioncall
                loop
                args
                 (
                 explist
                  exp
                   exp
                    prefixexp
                     n
                   +
                   exp
                    number
                     1
                 )
             end
           end
         stat
          local
          attnamelist
           o
           attrib
          =
          explist
           exp
            prefixexp
             functioncall
              setmetatable
              args
               (
               explist
                exp
                 tableconstructor
                  {
                  }
                ,
                exp
                 tableconstructor
                  {
                  fieldlist
                   field
                    __close
                    =
                    exp
                     functiondef
                      function
                      funcbody
                       (
                       parlist
                       )
                       block
                        stat
                         functioncall
                          loop
                          args
                           (
                           explist
                            exp
                             number
                              0
                           )
                       end
                  }
               )
         stat
          local
          attnamelist
           script
           attrib
          =
          explist
           exp
            string
             [[toclose 2; settop 1; return 1]]
         stat
          functioncall
           assert
           args
            (
            explist
             exp
              exp
               prefixexp
                functioncall
                 T
                 .
                 testC
                 args
                  (
                  explist
                   exp
                    prefixexp
                     script
                   ,
                   exp
                    prefixexp
                     o
                  )
              ==
              exp
               prefixexp
                script
            )
        end
       stat
        local
        function
        foo
        funcbody
         (
         parlist
         )
         block
          stat
           local
           attnamelist
            y
            attrib
             <
             close
             >
           =
           explist
            exp
             prefixexp
              functioncall
               func2close
               args
                (
                explist
                 exp
                  functiondef
                   function
                   funcbody
                    (
                    parlist
                    )
                    block
                     stat
                      functioncall
                       T
                       .
                       alloccount
                       args
                        (
                        )
                    end
                )
          stat
           local
           attnamelist
            x
            attrib
             <
             close
             >
           =
           explist
            exp
             prefixexp
              functioncall
               setmetatable
               args
                (
                explist
                 exp
                  tableconstructor
                   {
                   }
                 ,
                 exp
                  tableconstructor
                   {
                   fieldlist
                    field
                     __close
                     =
                     exp
                      functiondef
                       function
                       funcbody
                        (
                        parlist
                        )
                        block
                         stat
                          functioncall
                           T
                           .
                           alloccount
                           args
                            (
                            explist
                             exp
                              number
                               0
                            )
                         stat
                          ;
                         stat
                          local
                          attnamelist
                           x
                           attrib
                          =
                          explist
                           exp
                            tableconstructor
                             {
                             }
                        end
                   }
                )
          stat
           functioncall
            error
            args
             (
             explist
              exp
               number
                1000
             )
         end
       stat
        functioncall
         stack
         args
          (
          explist
           exp
            number
             5
          )
       stat
        local
        attnamelist
         _
         attrib
         ,
         msg
         attrib
        =
        explist
         exp
          prefixexp
           functioncall
            pcall
            args
             (
             explist
              exp
               prefixexp
                foo
             )
       stat
        functioncall
         assert
         args
          (
          explist
           exp
            exp
             prefixexp
              msg
            ==
            exp
             string
              "not enough memory"
          )
       stat
        local
        attnamelist
         closemsg
         attrib
       stat
        local
        attnamelist
         close
         attrib
        =
        explist
         exp
          prefixexp
           functioncall
            func2close
            args
             (
             explist
              exp
               functiondef
                function
                funcbody
                 (
                 parlist
                  namelist
                   self
                   ,
                   msg
                 )
                 block
                  stat
                   functioncall
                    T
                    .
                    alloccount
                    args
                     (
                     )
                  stat
                   varlist
                    var
                     closemsg
                   =
                   explist
                    exp
                     prefixexp
                      msg
                 end
             )
       stat
        local
        function
        enter
        funcbody
         (
         parlist
          namelist
           count
         )
         block
          stat
           functioncall
            stack
            args
             (
             explist
              exp
               number
                10
             )
          stat
           functioncall
            T
            .
            alloccount
            args
             (
             explist
              exp
               prefixexp
                count
             )
          stat
           varlist
            var
             closemsg
           =
           explist
            exp
             nil
          retstat
           return
           explist
            exp
             prefixexp
              close
         end
       stat
        local
        function
        test
        funcbody
         (
         parlist
         )
         block
          stat
           local
           attnamelist
            x
            attrib
             <
             close
             >
           =
           explist
            exp
             prefixexp
              functioncall
               enter
               args
                (
                explist
                 exp
                  number
                   0
                )
          stat
           local
           attnamelist
            y
            attrib
           =
           explist
            exp
             tableconstructor
              {
              }
         end
       stat
        local
        attnamelist
         _
         attrib
         ,
         msg
         attrib
        =
        explist
         exp
          prefixexp
           functioncall
            pcall
            args
             (
             explist
              exp
               prefixexp
                test
             )
       stat
        functioncall
         assert
         args
          (
          explist
           exp
            exp
             exp
              prefixexp
               msg
             ==
             exp
              string
               "not enough memory"
            and
            exp
             exp
              prefixexp
               closemsg
             ==
             exp
              string
               "not enough memory"
          )
       stat
        local
        function
        test
        funcbody
         (
         parlist
         )
         block
          stat
           local
           attnamelist
            xxx
            attrib
             <
             close
             >
           =
           explist
            exp
             prefixexp
              functioncall
               func2close
               args
                (
                explist
                 exp
                  functiondef
                   function
                   funcbody
                    (
                    parlist
                     namelist
                      self
                      ,
                      msg
                    )
                    block
                     stat
                      functioncall
                       assert
                       args
                        (
                        explist
                         exp
                          exp
                           prefixexp
                            msg
                          ==
                          exp
                           string
                            "not enough memory"
                        )
                     stat
                      ;
                     stat
                      functioncall
                       error
                       args
                        (
                        explist
                         exp
                          number
                           1000
                        )
                    end
                )
          stat
           local
           attnamelist
            xx
            attrib
             <
             close
             >
           =
           explist
            exp
             prefixexp
              functioncall
               func2close
               args
                (
                explist
                 exp
                  functiondef
                   function
                   funcbody
                    (
                    parlist
                     namelist
                      self
                      ,
                      msg
                    )
                    block
                     stat
                      functioncall
                       assert
                       args
                        (
                        explist
                         exp
                          exp
                           prefixexp
                            msg
                          ==
                          exp
                           string
                            "not enough memory"
                        )
                     stat
                      ;
                    end
                )
          stat
           local
           attnamelist
            x
            attrib
             <
             close
             >
           =
           explist
            exp
             prefixexp
              functioncall
               enter
               args
                (
                explist
                 exp
                  number
                   0
                )
          stat
           local
           attnamelist
            y
            attrib
           =
           explist
            exp
             tableconstructor
              {
              }
         end
       stat
        local
        attnamelist
         _
         attrib
         ,
         msg
         attrib
        =
        explist
         exp
          prefixexp
           functioncall
            pcall
            args
             (
             explist
              exp
               prefixexp
                test
             )
       stat
        functioncall
         assert
         args
          (
          explist
           exp
            exp
             exp
              prefixexp
               msg
             ==
             exp
              number
               1000
            and
            exp
             exp
              prefixexp
               closemsg
             ==
             exp
              string
               "not enough memory"
          )
       stat
        do
        block
         stat
          functioncall
           collectgarbage
           args
            (
            )
         stat
          local
          attnamelist
           s
           attrib
          =
          explist
           exp
            prefixexp
             functioncall
              string
              .
              rep
              args
               (
               explist
                exp
                 string
                  'a'
                ,
                exp
                 number
                  10000
               )
         stat
          local
          attnamelist
           m
           attrib
          =
          explist
           exp
            prefixexp
             functioncall
              T
              .
              totalmem
              args
               (
               )
         stat
          functioncall
           collectgarbage
           args
            (
            explist
             exp
              string
               "stop"
            )
         stat
          varlist
           var
            s
          =
          explist
           exp
            prefixexp
             functioncall
              string
              .
              upper
              args
               (
               explist
                exp
                 prefixexp
                  s
               )
         stat
          functioncall
           assert
           args
            (
            explist
             exp
              exp
               exp
                prefixexp
                 functioncall
                  T
                  .
                  totalmem
                  args
                   (
                   )
               -
               exp
                prefixexp
                 m
              <=
              exp
               number
                11000
            )
         stat
          functioncall
           collectgarbage
           args
            (
            explist
             exp
              string
               "restart"
            )
        end
       stat
        do
        block
         stat
          local
          attnamelist
           lim
           attrib
          =
          explist
           exp
            number
             10000
         stat
          local
          attnamelist
           extra
           attrib
          =
          explist
           exp
            number
             2000
         stat
          local
          attnamelist
           s
           attrib
          =
          explist
           exp
            prefixexp
             functioncall
              string
              .
              rep
              args
               (
               explist
                exp
                 string
                  "a"
                ,
                exp
                 prefixexp
                  lim
               )
         stat
          local
          attnamelist
           a
           attrib
          =
          explist
           exp
            tableconstructor
             {
             fieldlist
              field
               exp
                prefixexp
                 s
              fieldsep
               ,
              field
               exp
                prefixexp
                 s
             }
         stat
          functioncall
           collectgarbage
           args
            (
            )
         stat
          ;
         stat
          functioncall
           collectgarbage
           args
            (
            )
         stat
          local
          attnamelist
           m
           attrib
          =
          explist
           exp
            prefixexp
             functioncall
              T
              .
              totalmem
              args
               (
               )
         stat
          functioncall
           collectgarbage
           args
            (
            explist
             exp
              string
               "stop"
            )
         stat
          functioncall
           T
           .
           totalmem
           args
            (
            explist
             exp
              exp
               prefixexp
                m
              +
              exp
               prefixexp
                extra
            )
         stat
          functioncall
           assert
           args
            (
            explist
             exp
              not
              exp
               prefixexp
                functioncall
                 pcall
                 args
                  (
                  explist
                   exp
                    prefixexp
                     table
                     .
                     concat
                   ,
                   exp
                    prefixexp
                     a
                  )
            )
         stat
          functioncall
           assert
           args
            (
            explist
             exp
              exp
               exp
                prefixexp
                 functioncall
                  T
                  .
                  totalmem
                  args
                   (
                   )
               -
               exp
                prefixexp
                 m
              <=
              exp
               prefixexp
                extra
            )
         stat
          functioncall
           T
           .
           totalmem
           args
            (
            explist
             exp
              exp
               exp
                prefixexp
                 m
               +
               exp
                prefixexp
                 lim
              +
              exp
               prefixexp
                extra
            )
         stat
          functioncall
           assert
           args
            (
            explist
             exp
              not
              exp
               prefixexp
                functioncall
                 pcall
                 args
                  (
                  explist
                   exp
                    prefixexp
                     table
                     .
                     concat
                   ,
                   exp
                    prefixexp
                     a
                  )
            )
         stat
          functioncall
           assert
           args
            (
            explist
             exp
              exp
               exp
                prefixexp
                 functioncall
                  T
                  .
                  totalmem
                  args
                   (
                   )
               -
               exp
                prefixexp
                 m
              <=
              exp
               prefixexp
                extra
            )
         stat
          functioncall
           T
           .
           totalmem
           args
            (
            explist
             exp
              exp
               exp
                prefixexp
                 m
               +
               exp
                exp
                 number
                  2
                *
                exp
                 prefixexp
                  lim
              +
              exp
               prefixexp
                extra
            )
         stat
          functioncall
           assert
           args
            (
            explist
             exp
              not
              exp
               prefixexp
                functioncall
                 pcall
                 args
                  (
                  explist
                   exp
                    prefixexp
                     table
                     .
                     concat
                   ,
                   exp
                    prefixexp
                     a
                  )
            )
         stat
          functioncall
           assert
           args
            (
            explist
             exp
              exp
               exp
                prefixexp
                 functioncall
                  T
                  .
                  totalmem
                  args
                   (
                   )
               -
               exp
                prefixexp
                 m
              <=
              exp
               prefixexp
                extra
            )
         stat
          functioncall
           T
           .
           totalmem
           args
            (
            explist
             exp
              exp
               exp
                prefixexp
                 m
               +
               exp
                exp
                 number
                  4
                *
                exp
                 prefixexp
                  lim
              +
              exp
               prefixexp
                extra
            )
         stat
          functioncall
           assert
           args
            (
            explist
             exp
              exp
               #
               exp
                prefixexp
                 functioncall
                  table
                  .
                  concat
                  args
                   (
                   explist
                    exp
                     prefixexp
                      a
                   )
              ==
              exp
               exp
                number
                 2
               *
               exp
                prefixexp
                 lim
            )
         stat
          functioncall
           T
           .
           totalmem
           args
            (
            explist
             exp
              number
               0
            )
         stat
          functioncall
           collectgarbage
           args
            (
            explist
             exp
              string
               "restart"
            )
         stat
          functioncall
           print
           args
            string
             '+'
        end
       stat
        do
        block
         stat
          local
          attnamelist
           trace
           attrib
          =
          explist
           exp
            tableconstructor
             {
             }
         stat
          local
          function
          hook
          funcbody
           (
           parlist
            namelist
             event
           )
           block
            stat
             varlist
              var
               prefixexp
                trace
               [
               exp
                exp
                 #
                 exp
                  prefixexp
                   trace
                +
                exp
                 number
                  1
               ]
             =
             explist
              exp
               exp
                prefixexp
                 event
               ..
               exp
                exp
                 string
                  " "
                ..
                exp
                 prefixexp
                  (
                  exp
                   exp
                    prefixexp
                     functioncall
                      debug
                      .
                      getinfo
                      args
                       (
                       explist
                        exp
                         number
                          2
                       )
                     .
                     name
                   or
                   exp
                    string
                     "?"
                  )
           end
         stat
          local
          attnamelist
           x
           attrib
          =
          explist
           exp
            prefixexp
             functioncall
              func2close
              args
               (
               explist
                exp
                 functiondef
                  function
                  funcbody
                   (
                   parlist
                    namelist
                     _
                     ,
                     msg
                   )
                   block
                    stat
                     varlist
                      var
                       prefixexp
                        trace
                       [
                       exp
                        exp
                         #
                         exp
                          prefixexp
                           trace
                        +
                        exp
                         number
                          1
                       ]
                     =
                     explist
                      exp
                       string
                        "x"
                   end
               )
         stat
          local
          attnamelist
           y
           attrib
          =
          explist
           exp
            prefixexp
             functioncall
              func2close
              args
               (
               explist
                exp
                 functiondef
                  function
                  funcbody
                   (
                   parlist
                    namelist
                     _
                     ,
                     msg
                   )
                   block
                    stat
                     varlist
                      var
                       prefixexp
                        trace
                       [
                       exp
                        exp
                         #
                         exp
                          prefixexp
                           trace
                        +
                        exp
                         number
                          1
                       ]
                     =
                     explist
                      exp
                       string
                        "y"
                   end
               )
         stat
          functioncall
           debug
           .
           sethook
           args
            (
            explist
             exp
              prefixexp
               hook
             ,
             exp
              string
               "r"
            )
         stat
          local
          attnamelist
           t
           attrib
          =
          explist
           exp
            tableconstructor
             {
             fieldlist
              field
               exp
                prefixexp
                 functioncall
                  T
                  .
                  testC
                  args
                   (
                   explist
                    exp
                     string
                      [[\n       toclose 2      # x\n       pushnum 10\n       pushint 20\n       toclose 3      # y\n       return 2\n    ]]
                    ,
                    exp
                     prefixexp
                      x
                    ,
                    exp
                     prefixexp
                      y
                   )
             }
         stat
          functioncall
           debug
           .
           sethook
           args
            (
            )
         stat
          functioncall
           checktable
           args
            (
            explist
             exp
              prefixexp
               trace
             ,
             exp
              tableconstructor
               {
               fieldlist
                field
                 exp
                  string
                   "return sethook"
                fieldsep
                 ,
                field
                 exp
                  string
                   "y"
                fieldsep
                 ,
                field
                 exp
                  string
                   "return ?"
                fieldsep
                 ,
                field
                 exp
                  string
                   "x"
                fieldsep
                 ,
                field
                 exp
                  string
                   "return ?"
                fieldsep
                 ,
                field
                 exp
                  string
                   "return testC"
               }
            )
         stat
          functioncall
           checktable
           args
            (
            explist
             exp
              prefixexp
               t
             ,
             exp
              tableconstructor
               {
               fieldlist
                field
                 exp
                  number
                   10
                fieldsep
                 ,
                field
                 exp
                  number
                   20
               }
            )
        end
      end
     stat
      do
      block
       stat
        local
        attnamelist
         trace
         attrib
        =
        explist
         exp
          tableconstructor
           {
           }
       stat
        local
        function
        hook
        funcbody
         (
         parlist
          namelist
           event
         )
         block
          stat
           varlist
            var
             prefixexp
              trace
             [
             exp
              exp
               #
               exp
                prefixexp
                 trace
              +
              exp
               number
                1
             ]
           =
           explist
            exp
             exp
              prefixexp
               event
             ..
             exp
              exp
               string
                " "
              ..
              exp
               prefixexp
                functioncall
                 debug
                 .
                 getinfo
                 args
                  (
                  explist
                   exp
                    number
                     2
                  )
                .
                name
         end
       stat
        local
        function
        foo
        funcbody
         (
         parlist
          ...
         )
         block
          stat
           local
           attnamelist
            x
            attrib
             <
             close
             >
           =
           explist
            exp
             prefixexp
              functioncall
               func2close
               args
                (
                explist
                 exp
                  functiondef
                   function
                   funcbody
                    (
                    parlist
                     namelist
                      _
                      ,
                      msg
                    )
                    block
                     stat
                      varlist
                       var
                        prefixexp
                         trace
                        [
                        exp
                         exp
                          #
                          exp
                           prefixexp
                            trace
                         +
                         exp
                          number
                           1
                        ]
                      =
                      explist
                       exp
                        string
                         "x"
                    end
                )
          stat
           local
           attnamelist
            y
            attrib
             <
             close
             >
           =
           explist
            exp
             prefixexp
              functioncall
               func2close
               args
                (
                explist
                 exp
                  functiondef
                   function
                   funcbody
                    (
                    parlist
                     namelist
                      _
                      ,
                      msg
                    )
                    block
                     stat
                      functioncall
                       debug
                       .
                       sethook
                       args
                        (
                        explist
                         exp
                          prefixexp
                           hook
                         ,
                         exp
                          string
                           "r"
                        )
                    end
                )
          retstat
           return
           explist
            exp
             ...
         end
       stat
        local
        attnamelist
         t
         attrib
        =
        explist
         exp
          tableconstructor
           {
           fieldlist
            field
             exp
              prefixexp
               functioncall
                foo
                args
                 (
                 explist
                  exp
                   number
                    10
                  ,
                  exp
                   number
                    20
                  ,
                  exp
                   number
                    30
                 )
           }
       stat
        functioncall
         debug
         .
         sethook
         args
          (
          )
       stat
        functioncall
         checktable
         args
          (
          explist
           exp
            prefixexp
             t
           ,
           exp
            tableconstructor
             {
             fieldlist
              field
               exp
                number
                 10
              fieldsep
               ,
              field
               exp
                number
                 20
              fieldsep
               ,
              field
               exp
                number
                 30
             }
          )
       stat
        functioncall
         checktable
         args
          (
          explist
           exp
            prefixexp
             trace
           ,
           exp
            tableconstructor
             {
             fieldlist
              field
               exp
                string
                 "return sethook"
              fieldsep
               ,
              field
               exp
                string
                 "return close"
              fieldsep
               ,
              field
               exp
                string
                 "x"
              fieldsep
               ,
              field
               exp
                string
                 "return close"
              fieldsep
               ,
              field
               exp
                string
                 "return foo"
             }
          )
      end
     stat
      functioncall
       print
       args
        string
         "to-be-closed variables in coroutines"
     stat
      do
      block
       stat
        local
        attnamelist
         trace
         attrib
        =
        explist
         exp
          tableconstructor
           {
           }
       stat
        local
        attnamelist
         co
         attrib
        =
        explist
         exp
          prefixexp
           functioncall
            coroutine
            .
            wrap
            args
             (
             explist
              exp
               functiondef
                function
                funcbody
                 (
                 parlist
                 )
                 block
                  stat
                   varlist
                    var
                     prefixexp
                      trace
                     [
                     exp
                      exp
                       #
                       exp
                        prefixexp
                         trace
                      +
                      exp
                       number
                        1
                     ]
                   =
                   explist
                    exp
                     string
                      "nowX"
                  stat
                   local
                   attnamelist
                    x
                    attrib
                     <
                     close
                     >
                   =
                   explist
                    exp
                     prefixexp
                      functioncall
                       func2close
                       args
                        (
                        explist
                         exp
                          functiondef
                           function
                           funcbody
                            (
                            parlist
                             namelist
                              _
                              ,
                              msg
                            )
                            block
                             stat
                              functioncall
                               assert
                               args
                                (
                                explist
                                 exp
                                  exp
                                   prefixexp
                                    msg
                                  ==
                                  exp
                                   nil
                                )
                             stat
                              varlist
                               var
                                prefixexp
                                 trace
                                [
                                exp
                                 exp
                                  #
                                  exp
                                   prefixexp
                                    trace
                                 +
                                 exp
                                  number
                                   1
                                ]
                              =
                              explist
                               exp
                                string
                                 "x1"
                             stat
                              functioncall
                               coroutine
                               .
                               yield
                               args
                                (
                                explist
                                 exp
                                  string
                                   "x"
                                )
                             stat
                              varlist
                               var
                                prefixexp
                                 trace
                                [
                                exp
                                 exp
                                  #
                                  exp
                                   prefixexp
                                    trace
                                 +
                                 exp
                                  number
                                   1
                                ]
                              =
                              explist
                               exp
                                string
                                 "x2"
                            end
                        )
                  retstat
                   return
                   explist
                    exp
                     prefixexp
                      functioncall
                       pcall
                       args
                        (
                        explist
                         exp
                          functiondef
                           function
                           funcbody
                            (
                            parlist
                            )
                            block
                             stat
                              do
                              block
                               stat
                                local
                                attnamelist
                                 z
                                 attrib
                                  <
                                  close
                                  >
                                =
                                explist
                                 exp
                                  prefixexp
                                   functioncall
                                    func2close
                                    args
                                     (
                                     explist
                                      exp
                                       functiondef
                                        function
                                        funcbody
                                         (
                                         parlist
                                          namelist
                                           _
                                           ,
                                           msg
                                         )
                                         block
                                          stat
                                           functioncall
                                            assert
                                            args
                                             (
                                             explist
                                              exp
                                               exp
                                                prefixexp
                                                 msg
                                               ==
                                               exp
                                                nil
                                             )
                                          stat
                                           varlist
                                            var
                                             prefixexp
                                              trace
                                             [
                                             exp
                                              exp
                                               #
                                               exp
                                                prefixexp
                                                 trace
                                              +
                                              exp
                                               number
                                                1
                                             ]
                                           =
                                           explist
                                            exp
                                             string
                                              "z1"
                                          stat
                                           functioncall
                                            coroutine
                                            .
                                            yield
                                            args
                                             (
                                             explist
                                              exp
                                               string
                                                "z"
                                             )
                                          stat
                                           varlist
                                            var
                                             prefixexp
                                              trace
                                             [
                                             exp
                                              exp
                                               #
                                               exp
                                                prefixexp
                                                 trace
                                              +
                                              exp
                                               number
                                                1
                                             ]
                                           =
                                           explist
                                            exp
                                             string
                                              "z2"
                                         end
                                     )
                              end
                             stat
                              varlist
                               var
                                prefixexp
                                 trace
                                [
                                exp
                                 exp
                                  #
                                  exp
                                   prefixexp
                                    trace
                                 +
                                 exp
                                  number
                                   1
                                ]
                              =
                              explist
                               exp
                                string
                                 "nowY"
                             stat
                              local
                              attnamelist
                               y
                               attrib
                                <
                                close
                                >
                              =
                              explist
                               exp
                                prefixexp
                                 functioncall
                                  func2close
                                  args
                                   (
                                   explist
                                    exp
                                     functiondef
                                      function
                                      funcbody
                                       (
                                       parlist
                                        namelist
                                         _
                                         ,
                                         msg
                                       )
                                       block
                                        stat
                                         functioncall
                                          assert
                                          args
                                           (
                                           explist
                                            exp
                                             exp
                                              prefixexp
                                               msg
                                             ==
                                             exp
                                              nil
                                           )
                                        stat
                                         varlist
                                          var
                                           prefixexp
                                            trace
                                           [
                                           exp
                                            exp
                                             #
                                             exp
                                              prefixexp
                                               trace
                                            +
                                            exp
                                             number
                                              1
                                           ]
                                         =
                                         explist
                                          exp
                                           string
                                            "y1"
                                        stat
                                         functioncall
                                          coroutine
                                          .
                                          yield
                                          args
                                           (
                                           explist
                                            exp
                                             string
                                              "y"
                                           )
                                        stat
                                         varlist
                                          var
                                           prefixexp
                                            trace
                                           [
                                           exp
                                            exp
                                             #
                                             exp
                                              prefixexp
                                               trace
                                            +
                                            exp
                                             number
                                              1
                                           ]
                                         =
                                         explist
                                          exp
                                           string
                                            "y2"
                                       end
                                   )
                             retstat
                              return
                              explist
                               exp
                                number
                                 10
                               ,
                               exp
                                number
                                 20
                               ,
                               exp
                                number
                                 30
                            end
                        )
                 end
             )
       stat
        functioncall
         assert
         args
          (
          explist
           exp
            exp
             prefixexp
              functioncall
               co
               args
                (
                )
            ==
            exp
             string
              "z"
          )
       stat
        functioncall
         assert
         args
          (
          explist
           exp
            exp
             prefixexp
              functioncall
               co
               args
                (
                )
            ==
            exp
             string
              "y"
          )
       stat
        functioncall
         assert
         args
          (
          explist
           exp
            exp
             prefixexp
              functioncall
               co
               args
                (
                )
            ==
            exp
             string
              "x"
          )
       stat
        functioncall
         checktable
         args
          (
          explist
           exp
            tableconstructor
             {
             fieldlist
              field
               exp
                prefixexp
                 functioncall
                  co
                  args
                   (
                   )
             }
           ,
           exp
            tableconstructor
             {
             fieldlist
              field
               exp
                true
              fieldsep
               ,
              field
               exp
                number
                 10
              fieldsep
               ,
              field
               exp
                number
                 20
              fieldsep
               ,
              field
               exp
                number
                 30
             }
          )
       stat
        functioncall
         checktable
         args
          (
          explist
           exp
            prefixexp
             trace
           ,
           exp
            tableconstructor
             {
             fieldlist
              field
               exp
                string
                 "nowX"
              fieldsep
               ,
              field
               exp
                string
                 "z1"
              fieldsep
               ,
              field
               exp
                string
                 "z2"
              fieldsep
               ,
              field
               exp
                string
                 "nowY"
              fieldsep
               ,
              field
               exp
                string
                 "y1"
              fieldsep
               ,
              field
               exp
                string
                 "y2"
              fieldsep
               ,
              field
               exp
                string
                 "x1"
              fieldsep
               ,
              field
               exp
                string
                 "x2"
             }
          )
      end
     stat
      do
      block
       stat
        local
        attnamelist
         extrares
         attrib
       stat
        local
        function
        check
        funcbody
         (
         parlist
          namelist
           body
           ,
           extra
          ,
          ...
         )
         block
          stat
           local
           attnamelist
            t
            attrib
           =
           explist
            exp
             prefixexp
              functioncall
               table
               .
               pack
               args
                (
                explist
                 exp
                  ...
                )
          stat
           local
           attnamelist
            co
            attrib
           =
           explist
            exp
             prefixexp
              functioncall
               coroutine
               .
               wrap
               args
                (
                explist
                 exp
                  prefixexp
                   body
                )
          stat
           if
           exp
            prefixexp
             extra
           then
           block
            stat
             varlist
              var
               extrares
             =
             explist
              exp
               prefixexp
                functioncall
                 co
                 args
                  (
                  )
           end
          stat
           local
           attnamelist
            res
            attrib
           =
           explist
            exp
             prefixexp
              functioncall
               table
               .
               pack
               args
                (
                explist
                 exp
                  prefixexp
                   functioncall
                    co
                    args
                     (
                     )
                )
          stat
           functioncall
            assert
            args
             (
             explist
              exp
               exp
                exp
                 prefixexp
                  res
                  .
                  n
                ==
                exp
                 number
                  2
               and
               exp
                exp
                 prefixexp
                  res
                  [
                  exp
                   number
                    2
                  ]
                ==
                exp
                 nil
             )
          stat
           local
           attnamelist
            res2
            attrib
           =
           explist
            exp
             prefixexp
              functioncall
               table
               .
               pack
               args
                (
                explist
                 exp
                  prefixexp
                   functioncall
                    co
                    args
                     (
                     )
                )
          stat
           functioncall
            assert
            args
             (
             explist
              exp
               exp
                prefixexp
                 res2
                 .
                 n
               ==
               exp
                prefixexp
                 t
                 .
                 n
             )
          stat
           for
           i
           =
           exp
            number
             1
           ,
           exp
            #
            exp
             prefixexp
              t
           do
           block
            stat
             if
             exp
              exp
               prefixexp
                t
                [
                exp
                 prefixexp
                  i
                ]
              ==
              exp
               string
                "x"
             then
             block
              stat
               functioncall
                assert
                args
                 (
                 explist
                  exp
                   exp
                    prefixexp
                     res2
                     [
                     exp
                      prefixexp
                       i
                     ]
                   ==
                   exp
                    prefixexp
                     res
                     [
                     exp
                      number
                       1
                     ]
                 )
             else
             block
              stat
               functioncall
                assert
                args
                 (
                 explist
                  exp
                   exp
                    prefixexp
                     res2
                     [
                     exp
                      prefixexp
                       i
                     ]
                   ==
                   exp
                    prefixexp
                     t
                     [
                     exp
                      prefixexp
                       i
                     ]
                 )
             end
           end
         end
       stat
        local
        function
        foo
        funcbody
         (
         parlist
         )
         block
          stat
           local
           attnamelist
            x
            attrib
             <
             close
             >
           =
           explist
            exp
             prefixexp
              functioncall
               func2close
               args
                (
                explist
                 exp
                  prefixexp
                   coroutine
                   .
                   yield
                )
          stat
           local
           attnamelist
            extra
            attrib
             <
             close
             >
           =
           explist
            exp
             prefixexp
              functioncall
               func2close
               args
                (
                explist
                 exp
                  functiondef
                   function
                   funcbody
                    (
                    parlist
                     namelist
                      self
                    )
                    block
                     stat
                      functioncall
                       assert
                       args
                        (
                        explist
                         exp
                          exp
                           prefixexp
                            self
                          ==
                          exp
                           prefixexp
                            extrares
                        )
                     stat
                      functioncall
                       coroutine
                       .
                       yield
                       args
                        (
                        explist
                         exp
                          number
                           100
                        )
                    end
                )
          stat
           varlist
            var
             extrares
           =
           explist
            exp
             prefixexp
              extra
          retstat
           return
           explist
            exp
             prefixexp
              functioncall
               table
               .
               unpack
               args
                tableconstructor
                 {
                 fieldlist
                  field
                   exp
                    number
                     10
                  fieldsep
                   ,
                  field
                   exp
                    prefixexp
                     x
                  fieldsep
                   ,
                  field
                   exp
                    number
                     30
                 }
         end
       stat
        functioncall
         check
         args
          (
          explist
           exp
            prefixexp
             foo
           ,
           exp
            true
           ,
           exp
            number
             10
           ,
           exp
            string
             "x"
           ,
           exp
            number
             30
          )
       stat
        functioncall
         assert
         args
          (
          explist
           exp
            exp
             prefixexp
              extrares
            ==
            exp
             number
              100
          )
       stat
        local
        function
        foo
        funcbody
         (
         parlist
         )
         block
          stat
           local
           attnamelist
            x
            attrib
             <
             close
             >
           =
           explist
            exp
             prefixexp
              functioncall
               func2close
               args
                (
                explist
                 exp
                  prefixexp
                   coroutine
                   .
                   yield
                )
          retstat
           return
         end
       stat
        functioncall
         check
         args
          (
          explist
           exp
            prefixexp
             foo
           ,
           exp
            false
          )
       stat
        local
        function
        foo
        funcbody
         (
         parlist
         )
         block
          stat
           local
           attnamelist
            x
            attrib
             <
             close
             >
           =
           explist
            exp
             prefixexp
              functioncall
               func2close
               args
                (
                explist
                 exp
                  prefixexp
                   coroutine
                   .
                   yield
                )
          stat
           local
           attnamelist
            y
            attrib
            ,
            z
            attrib
           =
           explist
            exp
             number
              20
            ,
            exp
             number
              30
          retstat
           return
           explist
            exp
             prefixexp
              x
         end
       stat
        functioncall
         check
         args
          (
          explist
           exp
            prefixexp
             foo
           ,
           exp
            false
           ,
           exp
            string
             "x"
          )
       stat
        local
        function
        foo
        funcbody
         (
         parlist
         )
         block
          stat
           local
           attnamelist
            x
            attrib
             <
             close
             >
           =
           explist
            exp
             prefixexp
              functioncall
               func2close
               args
                (
                explist
                 exp
                  prefixexp
                   coroutine
                   .
                   yield
                )
          stat
           local
           attnamelist
            extra
            attrib
             <
             close
             >
           =
           explist
            exp
             prefixexp
              functioncall
               func2close
               args
                (
                explist
                 exp
                  prefixexp
                   coroutine
                   .
                   yield
                )
          retstat
           return
           explist
            exp
             prefixexp
              functioncall
               table
               .
               unpack
               args
                (
                explist
                 exp
                  tableconstructor
                   {
                   }
                 ,
                 exp
                  number
                   1
                 ,
                 exp
                  number
                   100
                )
         end
       stat
        functioncall
         check
         args
          (
          explist
           exp
            prefixexp
             foo
           ,
           exp
            true
           ,
           exp
            prefixexp
             functioncall
              table
              .
              unpack
              args
               (
               explist
                exp
                 tableconstructor
                  {
                  }
                ,
                exp
                 number
                  1
                ,
                exp
                 number
                  100
               )
          )
      end
     stat
      do
      block
       stat
        local
        attnamelist
         co
         attrib
        =
        explist
         exp
          prefixexp
           functioncall
            coroutine
            .
            wrap
            args
             (
             explist
              exp
               functiondef
                function
                funcbody
                 (
                 parlist
                 )
                 block
                  stat
                   local
                   function
                   foo
                   funcbody
                    (
                    parlist
                     namelist
                      err
                    )
                    block
                     stat
                      local
                      attnamelist
                       z
                       attrib
                        <
                        close
                        >
                      =
                      explist
                       exp
                        prefixexp
                         functioncall
                          func2close
                          args
                           (
                           explist
                            exp
                             functiondef
                              function
                              funcbody
                               (
                               parlist
                                namelist
                                 _
                                 ,
                                 msg
                               )
                               block
                                stat
                                 functioncall
                                  assert
                                  args
                                   (
                                   explist
                                    exp
                                     exp
                                      exp
                                       prefixexp
                                        msg
                                      ==
                                      exp
                                       nil
                                     or
                                     exp
                                      exp
                                       prefixexp
                                        msg
                                      ==
                                      exp
                                       exp
                                        prefixexp
                                         err
                                       +
                                       exp
                                        number
                                         20
                                   )
                                stat
                                 functioncall
                                  coroutine
                                  .
                                  yield
                                  args
                                   (
                                   explist
                                    exp
                                     string
                                      "z"
                                   )
                                retstat
                                 return
                                 explist
                                  exp
                                   number
                                    100
                                  ,
                                  exp
                                   number
                                    200
                               end
                           )
                     stat
                      local
                      attnamelist
                       y
                       attrib
                        <
                        close
                        >
                      =
                      explist
                       exp
                        prefixexp
                         functioncall
                          func2close
                          args
                           (
                           explist
                            exp
                             functiondef
                              function
                              funcbody
                               (
                               parlist
                                namelist
                                 _
                                 ,
                                 msg
                               )
                               block
                                stat
                                 functioncall
                                  assert
                                  args
                                   (
                                   explist
                                    exp
                                     exp
                                      exp
                                       prefixexp
                                        msg
                                      ==
                                      exp
                                       prefixexp
                                        err
                                     or
                                     exp
                                      prefixexp
                                       (
                                       exp
                                        exp
                                         exp
                                          prefixexp
                                           msg
                                         ==
                                         exp
                                          nil
                                        and
                                        exp
                                         exp
                                          prefixexp
                                           err
                                         ==
                                         exp
                                          number
                                           1
                                       )
                                   )
                                stat
                                 functioncall
                                  coroutine
                                  .
                                  yield
                                  args
                                   (
                                   explist
                                    exp
                                     string
                                      "y"
                                   )
                                stat
                                 if
                                 exp
                                  prefixexp
                                   err
                                 then
                                 block
                                  stat
                                   functioncall
                                    error
                                    args
                                     (
                                     explist
                                      exp
                                       exp
                                        prefixexp
                                         err
                                       +
                                       exp
                                        number
                                         20
                                     )
                                 end
                               end
                           )
                     stat
                      local
                      attnamelist
                       x
                       attrib
                        <
                        close
                        >
                      =
                      explist
                       exp
                        prefixexp
                         functioncall
                          func2close
                          args
                           (
                           explist
                            exp
                             functiondef
                              function
                              funcbody
                               (
                               parlist
                                namelist
                                 _
                                 ,
                                 msg
                               )
                               block
                                stat
                                 functioncall
                                  assert
                                  args
                                   (
                                   explist
                                    exp
                                     exp
                                      exp
                                       prefixexp
                                        msg
                                      ==
                                      exp
                                       prefixexp
                                        err
                                     or
                                     exp
                                      prefixexp
                                       (
                                       exp
                                        exp
                                         exp
                                          prefixexp
                                           msg
                                         ==
                                         exp
                                          nil
                                        and
                                        exp
                                         exp
                                          prefixexp
                                           err
                                         ==
                                         exp
                                          number
                                           1
                                       )
                                   )
                                stat
                                 functioncall
                                  coroutine
                                  .
                                  yield
                                  args
                                   (
                                   explist
                                    exp
                                     string
                                      "x"
                                   )
                                retstat
                                 return
                                 explist
                                  exp
                                   number
                                    100
                                  ,
                                  exp
                                   number
                                    200
                               end
                           )
                     stat
                      if
                      exp
                       exp
                        prefixexp
                         err
                       ==
                       exp
                        number
                         10
                      then
                      block
                       stat
                        functioncall
                         error
                         args
                          (
                          explist
                           exp
                            prefixexp
                             err
                          )
                      else
                      block
                       retstat
                        return
                        explist
                         exp
                          number
                           10
                         ,
                         exp
                          number
                           20
                      end
                    end
                  stat
                   functioncall
                    coroutine
                    .
                    yield
                    args
                     (
                     explist
                      exp
                       prefixexp
                        functioncall
                         pcall
                         args
                          (
                          explist
                           exp
                            prefixexp
                             foo
                           ,
                           exp
                            nil
                          )
                     )
                  stat
                   functioncall
                    coroutine
                    .
                    yield
                    args
                     (
                     explist
                      exp
                       prefixexp
                        functioncall
                         pcall
                         args
                          (
                          explist
                           exp
                            prefixexp
                             foo
                           ,
                           exp
                            number
                             1
                          )
                     )
                  retstat
                   return
                   explist
                    exp
                     prefixexp
                      functioncall
                       pcall
                       args
                        (
                        explist
                         exp
                          prefixexp
                           foo
                         ,
                         exp
                          number
                           10
                        )
                 end
             )
       stat
        local
        attnamelist
         a
         attrib
         ,
         b
         attrib
        =
        explist
         exp
          prefixexp
           functioncall
            co
            args
             (
             )
       stat
        functioncall
         assert
         args
          (
          explist
           exp
            exp
             exp
              prefixexp
               a
             ==
             exp
              string
               "x"
            and
            exp
             exp
              prefixexp
               b
             ==
             exp
              nil
          )
       stat
        varlist
         var
          a
         ,
         var
          b
        =
        explist
         exp
          prefixexp
           functioncall
            co
            args
             (
             )
       stat
        functioncall
         assert
         args
          (
          explist
           exp
            exp
             exp
              prefixexp
               a
             ==
             exp
              string
               "y"
            and
            exp
             exp
              prefixexp
               b
             ==
             exp
              nil
          )
       stat
        varlist
         var
          a
         ,
         var
          b
        =
        explist
         exp
          prefixexp
           functioncall
            co
            args
             (
             )
       stat
        functioncall
         assert
         args
          (
          explist
           exp
            exp
             exp
              prefixexp
               a
             ==
             exp
              string
               "z"
            and
            exp
             exp
              prefixexp
               b
             ==
             exp
              nil
          )
       stat
        local
        attnamelist
         a
         attrib
         ,
         b
         attrib
         ,
         c
         attrib
        =
        explist
         exp
          prefixexp
           functioncall
            co
            args
             (
             )
       stat
        functioncall
         assert
         args
          (
          explist
           exp
            exp
             exp
              prefixexp
               a
             and
             exp
              exp
               prefixexp
                b
              ==
              exp
               number
                10
            and
            exp
             exp
              prefixexp
               c
             ==
             exp
              number
               20
          )
       stat
        local
        attnamelist
         a
         attrib
         ,
         b
         attrib
        =
        explist
         exp
          prefixexp
           functioncall
            co
            args
             (
             )
       stat
        functioncall
         assert
         args
          (
          explist
           exp
            exp
             exp
              prefixexp
               a
             ==
             exp
              string
               "x"
            and
            exp
             exp
              prefixexp
               b
             ==
             exp
              nil
          )
       stat
        varlist
         var
          a
         ,
         var
          b
        =
        explist
         exp
          prefixexp
           functioncall
            co
            args
             (
             )
       stat
        functioncall
         assert
         args
          (
          explist
           exp
            exp
             exp
              prefixexp
               a
             ==
             exp
              string
               "y"
            and
            exp
             exp
              prefixexp
               b
             ==
             exp
              nil
          )
       stat
        varlist
         var
          a
         ,
         var
          b
        =
        explist
         exp
          prefixexp
           functioncall
            co
            args
             (
             )
       stat
        functioncall
         assert
         args
          (
          explist
           exp
            exp
             exp
              prefixexp
               a
             ==
             exp
              string
               "z"
            and
            exp
             exp
              prefixexp
               b
             ==
             exp
              nil
          )
       stat
        local
        attnamelist
         st
         attrib
         ,
         msg
         attrib
        =
        explist
         exp
          prefixexp
           functioncall
            co
            args
             (
             )
       stat
        functioncall
         assert
         args
          (
          explist
           exp
            exp
             not
             exp
              prefixexp
               st
            and
            exp
             exp
              prefixexp
               msg
             ==
             exp
              number
               21
          )
       stat
        local
        attnamelist
         a
         attrib
         ,
         b
         attrib
        =
        explist
         exp
          prefixexp
           functioncall
            co
            args
             (
             )
       stat
        functioncall
         assert
         args
          (
          explist
           exp
            exp
             exp
              prefixexp
               a
             ==
             exp
              string
               "x"
            and
            exp
             exp
              prefixexp
               b
             ==
             exp
              nil
          )
       stat
        varlist
         var
          a
         ,
         var
          b
        =
        explist
         exp
          prefixexp
           functioncall
            co
            args
             (
             )
       stat
        functioncall
         assert
         args
          (
          explist
           exp
            exp
             exp
              prefixexp
               a
             ==
             exp
              string
               "y"
            and
            exp
             exp
              prefixexp
               b
             ==
             exp
              nil
          )
       stat
        varlist
         var
          a
         ,
         var
          b
        =
        explist
         exp
          prefixexp
           functioncall
            co
            args
             (
             )
       stat
        functioncall
         assert
         args
          (
          explist
           exp
            exp
             exp
              prefixexp
               a
             ==
             exp
              string
               "z"
            and
            exp
             exp
              prefixexp
               b
             ==
             exp
              nil
          )
       stat
        local
        attnamelist
         st
         attrib
         ,
         msg
         attrib
        =
        explist
         exp
          prefixexp
           functioncall
            co
            args
             (
             )
       stat
        functioncall
         assert
         args
          (
          explist
           exp
            exp
             not
             exp
              prefixexp
               st
            and
            exp
             exp
              prefixexp
               msg
             ==
             exp
              exp
               number
                10
              +
              exp
               number
                20
          )
      end
     stat
      do
      block
       stat
        local
        attnamelist
         x
         attrib
        =
        explist
         exp
          false
       stat
        local
        attnamelist
         y
         attrib
        =
        explist
         exp
          false
       stat
        local
        attnamelist
         co
         attrib
        =
        explist
         exp
          prefixexp
           functioncall
            coroutine
            .
            wrap
            args
             (
             explist
              exp
               functiondef
                function
                funcbody
                 (
                 parlist
                 )
                 block
                  stat
                   local
                   attnamelist
                    xv
                    attrib
                     <
                     close
                     >
                   =
                   explist
                    exp
                     prefixexp
                      functioncall
                       func2close
                       args
                        (
                        explist
                         exp
                          functiondef
                           function
                           funcbody
                            (
                            parlist
                            )
                            block
                             stat
                              varlist
                               var
                                x
                              =
                              explist
                               exp
                                true
                            end
                        )
                  stat
                   do
                   block
                    stat
                     local
                     attnamelist
                      yv
                      attrib
                       <
                       close
                       >
                     =
                     explist
                      exp
                       prefixexp
                        functioncall
                         func2close
                         args
                          (
                          explist
                           exp
                            functiondef
                             function
                             funcbody
                              (
                              parlist
                              )
                              block
                               stat
                                varlist
                                 var
                                  y
                                =
                                explist
                                 exp
                                  true
                              end
                          )
                    stat
                     functioncall
                      coroutine
                      .
                      yield
                      args
                       (
                       explist
                        exp
                         number
                          100
                       )
                   end
                  stat
                   functioncall
                    coroutine
                    .
                    yield
                    args
                     (
                     explist
                      exp
                       number
                        200
                     )
                  stat
                   functioncall
                    error
                    args
                     (
                     explist
                      exp
                       number
                        23
                     )
                 end
             )
       stat
        local
        attnamelist
         b
         attrib
        =
        explist
         exp
          prefixexp
           functioncall
            co
            args
             (
             )
       stat
        functioncall
         assert
         args
          (
          explist
           exp
            exp
             exp
              exp
               prefixexp
                b
              ==
              exp
               number
                100
             and
             exp
              not
              exp
               prefixexp
                x
            and
            exp
             not
             exp
              prefixexp
               y
          )
       stat
        varlist
         var
          b
        =
        explist
         exp
          prefixexp
           functioncall
            co
            args
             (
             )
       stat
        functioncall
         assert
         args
          (
          explist
           exp
            exp
             exp
              exp
               prefixexp
                b
              ==
              exp
               number
                200
             and
             exp
              not
              exp
               prefixexp
                x
            and
            exp
             prefixexp
              y
          )
       stat
        local
        attnamelist
         a
         attrib
         ,
         b
         attrib
        =
        explist
         exp
          prefixexp
           functioncall
            pcall
            args
             (
             explist
              exp
               prefixexp
                co
             )
       stat
        functioncall
         assert
         args
          (
          explist
           exp
            exp
             exp
              exp
               not
               exp
                prefixexp
                 a
              and
              exp
               exp
                prefixexp
                 b
               ==
               exp
                number
                 23
             and
             exp
              prefixexp
               x
            and
            exp
             prefixexp
              y
          )
      end
     stat
      do
      block
       stat
        local
        attnamelist
         x
         attrib
        =
        explist
         exp
          number
           0
       stat
        local
        attnamelist
         co
         attrib
        =
        explist
         exp
          prefixexp
           functioncall
            coroutine
            .
            wrap
            args
             (
             explist
              exp
               functiondef
                function
                funcbody
                 (
                 parlist
                 )
                 block
                  stat
                   local
                   attnamelist
                    xx
                    attrib
                     <
                     close
                     >
                   =
                   explist
                    exp
                     prefixexp
                      functioncall
                       func2close
                       args
                        (
                        explist
                         exp
                          functiondef
                           function
                           funcbody
                            (
                            parlist
                             namelist
                              _
                              ,
                              msg
                            )
                            block
                             stat
                              varlist
                               var
                                x
                              =
                              explist
                               exp
                                exp
                                 prefixexp
                                  x
                                +
                                exp
                                 number
                                  1
                             stat
                              ;
                             stat
                              functioncall
                               assert
                               args
                                (
                                explist
                                 exp
                                  prefixexp
                                   functioncall
                                    string
                                    .
                                    find
                                    args
                                     (
                                     explist
                                      exp
                                       prefixexp
                                        msg
                                      ,
                                      exp
                                       string
                                        "@XXX"
                                     )
                                )
                             stat
                              functioncall
                               error
                               args
                                (
                                explist
                                 exp
                                  string
                                   "@YYY"
                                )
                            end
                        )
                  stat
                   local
                   attnamelist
                    xv
                    attrib
                     <
                     close
                     >
                   =
                   explist
                    exp
                     prefixexp
                      functioncall
                       func2close
                       args
                        (
                        explist
                         exp
                          functiondef
                           function
                           funcbody
                            (
                            parlist
                            )
                            block
                             stat
                              varlist
                               var
                                x
                              =
                              explist
                               exp
                                exp
                                 prefixexp
                                  x
                                +
                                exp
                                 number
                                  1
                             stat
                              ;
                             stat
                              functioncall
                               error
                               args
                                (
                                explist
                                 exp
                                  string
                                   "@XXX"
                                )
                            end
                        )
                  stat
                   functioncall
                    coroutine
                    .
                    yield
                    args
                     (
                     explist
                      exp
                       number
                        100
                     )
                  stat
                   functioncall
                    error
                    args
                     (
                     explist
                      exp
                       number
                        200
                     )
                 end
             )
       stat
        functioncall
         assert
         args
          (
          explist
           exp
            exp
             prefixexp
              functioncall
               co
               args
                (
                )
            ==
            exp
             number
              100
          )
       stat
        ;
       stat
        functioncall
         assert
         args
          (
          explist
           exp
            exp
             prefixexp
              x
            ==
            exp
             number
              0
          )
       stat
        local
        attnamelist
         st
         attrib
         ,
         msg
         attrib
        =
        explist
         exp
          prefixexp
           functioncall
            pcall
            args
             (
             explist
              exp
               prefixexp
                co
             )
       stat
        ;
       stat
        functioncall
         assert
         args
          (
          explist
           exp
            exp
             prefixexp
              x
            ==
            exp
             number
              2
          )
       stat
        functioncall
         assert
         args
          (
          explist
           exp
            exp
             not
             exp
              prefixexp
               st
            and
            exp
             prefixexp
              functioncall
               string
               .
               find
               args
                (
                explist
                 exp
                  prefixexp
                   msg
                 ,
                 exp
                  string
                   "@YYY"
                )
          )
       stat
        local
        attnamelist
         x
         attrib
        =
        explist
         exp
          number
           0
       stat
        local
        attnamelist
         y
         attrib
        =
        explist
         exp
          number
           0
       stat
        varlist
         var
          co
        =
        explist
         exp
          prefixexp
           functioncall
            coroutine
            .
            wrap
            args
             (
             explist
              exp
               functiondef
                function
                funcbody
                 (
                 parlist
                 )
                 block
                  stat
                   local
                   attnamelist
                    xx
                    attrib
                     <
                     close
                     >
                   =
                   explist
                    exp
                     prefixexp
                      functioncall
                       func2close
                       args
                        (
                        explist
                         exp
                          functiondef
                           function
                           funcbody
                            (
                            parlist
                             namelist
                              _
                              ,
                              err
                            )
                            block
                             stat
                              varlist
                               var
                                y
                              =
                              explist
                               exp
                                exp
                                 prefixexp
                                  y
                                +
                                exp
                                 number
                                  1
                             stat
                              ;
                             stat
                              functioncall
                               assert
                               args
                                (
                                explist
                                 exp
                                  prefixexp
                                   functioncall
                                    string
                                    .
                                    find
                                    args
                                     (
                                     explist
                                      exp
                                       prefixexp
                                        err
                                      ,
                                      exp
                                       string
                                        "XXX"
                                     )
                                )
                             stat
                              functioncall
                               error
                               args
                                (
                                explist
                                 exp
                                  string
                                   "YYY"
                                )
                            end
                        )
                  stat
                   local
                   attnamelist
                    xv
                    attrib
                     <
                     close
                     >
                   =
                   explist
                    exp
                     prefixexp
                      functioncall
                       func2close
                       args
                        (
                        explist
                         exp
                          functiondef
                           function
                           funcbody
                            (
                            parlist
                            )
                            block
                             stat
                              varlist
                               var
                                x
                              =
                              explist
                               exp
                                exp
                                 prefixexp
                                  x
                                +
                                exp
                                 number
                                  1
                             stat
                              ;
                             stat
                              functioncall
                               error
                               args
                                (
                                explist
                                 exp
                                  string
                                   "XXX"
                                )
                            end
                        )
                  stat
                   functioncall
                    coroutine
                    .
                    yield
                    args
                     (
                     explist
                      exp
                       number
                        100
                     )
                  retstat
                   return
                   explist
                    exp
                     number
                      200
                 end
             )
       stat
        functioncall
         assert
         args
          (
          explist
           exp
            exp
             prefixexp
              functioncall
               co
               args
                (
                )
            ==
            exp
             number
              100
          )
       stat
        ;
       stat
        functioncall
         assert
         args
          (
          explist
           exp
            exp
             prefixexp
              x
            ==
            exp
             number
              0
          )
       stat
        local
        attnamelist
         st
         attrib
         ,
         msg
         attrib
        =
        explist
         exp
          prefixexp
           functioncall
            pcall
            args
             (
             explist
              exp
               prefixexp
                co
             )
       stat
        functioncall
         assert
         args
          (
          explist
           exp
            exp
             exp
              prefixexp
               x
             ==
             exp
              number
               1
            and
            exp
             exp
              prefixexp
               y
             ==
             exp
              number
               1
          )
       stat
        functioncall
         assert
         args
          (
          explist
           exp
            exp
             not
             exp
              prefixexp
               st
            and
            exp
             prefixexp
              functioncall
               string
               .
               find
               args
                (
                explist
                 exp
                  prefixexp
                   msg
                 ,
                 exp
                  string
                   "%w+%.%w+:%d+: YYY"
                )
          )
      end
     stat
      local
      attnamelist
       co
       attrib
     stat
      varlist
       var
        co
      =
      explist
       exp
        prefixexp
         functioncall
          coroutine
          .
          wrap
          args
           (
           explist
            exp
             functiondef
              function
              funcbody
               (
               parlist
               )
               block
                stat
                 local
                 attnamelist
                  x
                  attrib
                   <
                   close
                   >
                 =
                 explist
                  exp
                   prefixexp
                    functioncall
                     func2close
                     args
                      (
                      explist
                       exp
                        functiondef
                         function
                         funcbody
                          (
                          parlist
                          )
                          block
                           stat
                            functioncall
                             os
                             .
                             exit
                             args
                              (
                              explist
                               exp
                                false
                              )
                          end
                      )
                stat
                 varlist
                  var
                   co
                 =
                 explist
                  exp
                   nil
                stat
                 functioncall
                  coroutine
                  .
                  yield
                  args
                   (
                   )
               end
           )
     stat
      functioncall
       co
       args
        (
        )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           prefixexp
            co
          ==
          exp
           nil
        )
     stat
      functioncall
       collectgarbage
       args
        (
        )
     stat
      if
      exp
       prefixexp
        functioncall
         rawget
         args
          (
          explist
           exp
            prefixexp
             _G
           ,
           exp
            string
             "T"
          )
      then
      block
       stat
        functioncall
         print
         args
          (
          explist
           exp
            string
             "to-be-closed variables x coroutines in C"
          )
       stat
        do
        block
         stat
          local
          attnamelist
           token
           attrib
          =
          explist
           exp
            number
             0
         stat
          local
          attnamelist
           count
           attrib
          =
          explist
           exp
            number
             0
         stat
          local
          attnamelist
           f
           attrib
          =
          explist
           exp
            prefixexp
             functioncall
              T
              .
              makeCfunc
              args
               string
                [[\n      toclose 1\n      toclose 2\n      return .\n    ]]
         stat
          local
          attnamelist
           obj
           attrib
          =
          explist
           exp
            prefixexp
             functioncall
              func2close
              args
               (
               explist
                exp
                 functiondef
                  function
                  funcbody
                   (
                   parlist
                    namelist
                     _
                     ,
                     msg
                   )
                   block
                    stat
                     varlist
                      var
                       count
                     =
                     explist
                      exp
                       exp
                        prefixexp
                         count
                       +
                       exp
                        number
                         1
                    stat
                     varlist
                      var
                       token
                     =
                     explist
                      exp
                       prefixexp
                        functioncall
                         coroutine
                         .
                         yield
                         args
                          (
                          explist
                           exp
                            prefixexp
                             count
                           ,
                           exp
                            prefixexp
                             token
                          )
                   end
               )
         stat
          local
          attnamelist
           co
           attrib
          =
          explist
           exp
            prefixexp
             functioncall
              coroutine
              .
              wrap
              args
               (
               explist
                exp
                 prefixexp
                  f
               )
         stat
          local
          attnamelist
           ct
           attrib
           ,
           res
           attrib
          =
          explist
           exp
            prefixexp
             functioncall
              co
              args
               (
               explist
                exp
                 prefixexp
                  obj
                ,
                exp
                 prefixexp
                  obj
                ,
                exp
                 number
                  10
                ,
                exp
                 number
                  20
                ,
                exp
                 number
                  30
                ,
                exp
                 number
                  3
               )
         stat
          functioncall
           assert
           args
            (
            explist
             exp
              exp
               exp
                prefixexp
                 ct
               ==
               exp
                number
                 1
              and
              exp
               exp
                prefixexp
                 res
               ==
               exp
                number
                 0
            )
         stat
          varlist
           var
            ct
           ,
           var
            res
          =
          explist
           exp
            prefixexp
             functioncall
              co
              args
               (
               explist
                exp
                 number
                  100
               )
         stat
          functioncall
           assert
           args
            (
            explist
             exp
              exp
               exp
                prefixexp
                 ct
               ==
               exp
                number
                 2
              and
              exp
               exp
                prefixexp
                 res
               ==
               exp
                number
                 100
            )
         stat
          varlist
           var
            res
          =
          explist
           exp
            tableconstructor
             {
             fieldlist
              field
               exp
                prefixexp
                 functioncall
                  co
                  args
                   (
                   explist
                    exp
                     number
                      200
                   )
             }
         stat
          functioncall
           assert
           args
            (
            explist
             exp
              exp
               exp
                exp
                 exp
                  prefixexp
                   res
                   [
                   exp
                    number
                     1
                   ]
                 ==
                 exp
                  number
                   10
                and
                exp
                 exp
                  prefixexp
                   res
                   [
                   exp
                    number
                     2
                   ]
                 ==
                 exp
                  number
                   20
               and
               exp
                exp
                 prefixexp
                  res
                  [
                  exp
                   number
                    3
                  ]
                ==
                exp
                 number
                  30
              and
              exp
               exp
                prefixexp
                 res
                 [
                 exp
                  number
                   4
                 ]
               ==
               exp
                nil
            )
         stat
          functioncall
           assert
           args
            (
            explist
             exp
              exp
               prefixexp
                token
              ==
              exp
               number
                200
            )
        end
       stat
        do
        block
         stat
          local
          attnamelist
           f
           attrib
          =
          explist
           exp
            prefixexp
             functioncall
              T
              .
              makeCfunc
              args
               string
                [[\n      toclose 1\n      return .\n    ]]
         stat
          local
          attnamelist
           obj
           attrib
          =
          explist
           exp
            prefixexp
             functioncall
              func2close
              args
               (
               explist
                exp
                 functiondef
                  function
                  funcbody
                   (
                   parlist
                   )
                   block
                    stat
                     local
                     attnamelist
                      temp
                      attrib
                    stat
                     local
                     attnamelist
                      x
                      attrib
                       <
                       close
                       >
                     =
                     explist
                      exp
                       prefixexp
                        functioncall
                         func2close
                         args
                          (
                          explist
                           exp
                            functiondef
                             function
                             funcbody
                              (
                              parlist
                              )
                              block
                               stat
                                functioncall
                                 coroutine
                                 .
                                 yield
                                 args
                                  (
                                  explist
                                   exp
                                    prefixexp
                                     temp
                                  )
                               retstat
                                return
                                explist
                                 exp
                                  number
                                   1
                                 ,
                                 exp
                                  number
                                   2
                                 ,
                                 exp
                                  number
                                   3
                              end
                          )
                    stat
                     varlist
                      var
                       temp
                     =
                     explist
                      exp
                       prefixexp
                        functioncall
                         coroutine
                         .
                         yield
                         args
                          (
                          explist
                           exp
                            string
                             "closing obj"
                          )
                    retstat
                     return
                     explist
                      exp
                       number
                        1
                      ,
                      exp
                       number
                        2
                      ,
                      exp
                       number
                        3
                   end
               )
         stat
          local
          attnamelist
           co
           attrib
          =
          explist
           exp
            prefixexp
             functioncall
              coroutine
              .
              wrap
              args
               (
               explist
                exp
                 prefixexp
                  f
               )
         stat
          local
          attnamelist
           res
           attrib
          =
          explist
           exp
            prefixexp
             functioncall
              co
              args
               (
               explist
                exp
                 prefixexp
                  obj
                ,
                exp
                 number
                  10
                ,
                exp
                 number
                  30
                ,
                exp
                 number
                  1
               )
         stat
          functioncall
           assert
           args
            (
            explist
             exp
              exp
               prefixexp
                res
              ==
              exp
               string
                "closing obj"
            )
         stat
          varlist
           var
            res
          =
          explist
           exp
            prefixexp
             functioncall
              co
              args
               (
               explist
                exp
                 string
                  "closing x"
               )
         stat
          functioncall
           assert
           args
            (
            explist
             exp
              exp
               prefixexp
                res
              ==
              exp
               string
                "closing x"
            )
         stat
          varlist
           var
            res
          =
          explist
           exp
            tableconstructor
             {
             fieldlist
              field
               exp
                prefixexp
                 functioncall
                  co
                  args
                   (
                   )
             }
         stat
          functioncall
           assert
           args
            (
            explist
             exp
              exp
               exp
                prefixexp
                 res
                 [
                 exp
                  number
                   1
                 ]
               ==
               exp
                number
                 30
              and
              exp
               exp
                prefixexp
                 res
                 [
                 exp
                  number
                   2
                 ]
               ==
               exp
                nil
            )
        end
       stat
        do
        block
         stat
          local
          attnamelist
           f
           attrib
          =
          explist
           exp
            prefixexp
             functioncall
              T
              .
              makeCfunc
              args
               string
                [[\n      toclose 1\n      closeslot 1\n    ]]
         stat
          local
          attnamelist
           obj
           attrib
          =
          explist
           exp
            prefixexp
             functioncall
              func2close
              args
               (
               explist
                exp
                 prefixexp
                  coroutine
                  .
                  yield
               )
         stat
          local
          attnamelist
           co
           attrib
          =
          explist
           exp
            prefixexp
             functioncall
              coroutine
              .
              create
              args
               (
               explist
                exp
                 prefixexp
                  f
               )
         stat
          local
          attnamelist
           st
           attrib
           ,
           msg
           attrib
          =
          explist
           exp
            prefixexp
             functioncall
              coroutine
              .
              resume
              args
               (
               explist
                exp
                 prefixexp
                  co
                ,
                exp
                 prefixexp
                  obj
               )
         stat
          functioncall
           assert
           args
            (
            explist
             exp
              exp
               not
               exp
                prefixexp
                 st
              and
              exp
               prefixexp
                functioncall
                 string
                 .
                 find
                 args
                  (
                  explist
                   exp
                    prefixexp
                     msg
                   ,
                   exp
                    string
                     "attempt to yield across"
                  )
            )
         stat
          local
          attnamelist
           f
           attrib
          =
          explist
           exp
            prefixexp
             functioncall
              T
              .
              makeCfunc
              args
               string
                [[\n      toclose 1\n    ]]
         stat
          local
          attnamelist
           st
           attrib
           ,
           msg
           attrib
          =
          explist
           exp
            prefixexp
             functioncall
              pcall
              args
               (
               explist
                exp
                 prefixexp
                  f
                ,
                exp
                 prefixexp
                  obj
               )
         stat
          functioncall
           assert
           args
            (
            explist
             exp
              exp
               not
               exp
                prefixexp
                 st
              and
              exp
               prefixexp
                functioncall
                 string
                 .
                 find
                 args
                  (
                  explist
                   exp
                    prefixexp
                     msg
                   ,
                   exp
                    string
                     "attempt to yield from outside"
                  )
            )
        end
      end
     stat
      do
      block
       stat
        local
        attnamelist
         numopen
         attrib
        =
        explist
         exp
          number
           0
       stat
        local
        function
        open
        funcbody
         (
         parlist
          namelist
           x
         )
         block
          stat
           varlist
            var
             numopen
           =
           explist
            exp
             exp
              prefixexp
               numopen
             +
             exp
              number
               1
          retstat
           return
           explist
            exp
             functiondef
              function
              funcbody
               (
               parlist
               )
               block
                stat
                 varlist
                  var
                   x
                 =
                 explist
                  exp
                   exp
                    prefixexp
                     x
                   -
                   exp
                    number
                     1
                stat
                 if
                 exp
                  exp
                   prefixexp
                    x
                  >
                  exp
                   number
                    0
                 then
                 block
                  retstat
                   return
                   explist
                    exp
                     prefixexp
                      x
                 end
               end
            ,
            exp
             nil
            ,
            exp
             nil
            ,
            exp
             prefixexp
              functioncall
               func2close
               args
                (
                explist
                 exp
                  functiondef
                   function
                   funcbody
                    (
                    parlist
                    )
                    block
                     stat
                      varlist
                       var
                        numopen
                      =
                      explist
                       exp
                        exp
                         prefixexp
                          numopen
                        -
                        exp
                         number
                          1
                    end
                )
         end
       stat
        local
        attnamelist
         s
         attrib
        =
        explist
         exp
          number
           0
       stat
        for
        namelist
         i
        in
        explist
         exp
          prefixexp
           functioncall
            open
            args
             (
             explist
              exp
               number
                10
             )
        do
        block
         stat
          varlist
           var
            s
          =
          explist
           exp
            exp
             prefixexp
              s
            +
            exp
             prefixexp
              i
        end
       stat
        functioncall
         assert
         args
          (
          explist
           exp
            exp
             exp
              prefixexp
               s
             ==
             exp
              number
               45
            and
            exp
             exp
              prefixexp
               numopen
             ==
             exp
              number
               0
          )
       stat
        local
        attnamelist
         s
         attrib
        =
        explist
         exp
          number
           0
       stat
        for
        namelist
         i
        in
        explist
         exp
          prefixexp
           functioncall
            open
            args
             (
             explist
              exp
               number
                10
             )
        do
        block
         stat
          if
          exp
           exp
            prefixexp
             i
           <
           exp
            number
             5
          then
          block
           stat
            break
          end
         stat
          varlist
           var
            s
          =
          explist
           exp
            exp
             prefixexp
              s
            +
            exp
             prefixexp
              i
        end
       stat
        functioncall
         assert
         args
          (
          explist
           exp
            exp
             exp
              prefixexp
               s
             ==
             exp
              number
               35
            and
            exp
             exp
              prefixexp
               numopen
             ==
             exp
              number
               0
          )
       stat
        local
        attnamelist
         s
         attrib
        =
        explist
         exp
          number
           0
       stat
        for
        namelist
         i
        in
        explist
         exp
          prefixexp
           functioncall
            open
            args
             (
             explist
              exp
               number
                10
             )
        do
        block
         stat
          for
          namelist
           j
          in
          explist
           exp
            prefixexp
             functioncall
              open
              args
               (
               explist
                exp
                 number
                  10
               )
          do
          block
           stat
            if
            exp
             exp
              exp
               prefixexp
                i
              +
              exp
               prefixexp
                j
             <
             exp
              number
               5
            then
            block
             stat
              goto
              endloop
            end
           stat
            varlist
             var
              s
            =
            explist
             exp
              exp
               prefixexp
                s
              +
              exp
               prefixexp
                i
          end
        end
       stat
        label
         ::
         endloop
         ::
       stat
        functioncall
         assert
         args
          (
          explist
           exp
            exp
             exp
              prefixexp
               s
             ==
             exp
              number
               375
            and
            exp
             exp
              prefixexp
               numopen
             ==
             exp
              number
               0
          )
      end
     stat
      functioncall
       print
       args
        (
        explist
         exp
          string
           'OK'
        )
     retstat
      return
      explist
       exp
        number
         5
       ,
       exp
        prefixexp
         f
    end
 <EOF>
