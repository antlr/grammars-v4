start_
 chunk
  block
   stat
    if
    exp
     exp
      prefixexp
       T
     ==
     exp
      nil
    then
    block
     stat
      functioncall
       (
       exp
        exp
         prefixexp
          Message
        or
        exp
         prefixexp
          print
       )
       args
        (
        explist
         exp
          string
           '\n >>> testC not active: skipping API tests <<<\n'
        )
     retstat
      return
    end
   stat
    local
    attnamelist
     debug
     attrib
    =
    explist
     exp
      prefixexp
       functioncall
        require
        args
         string
          "debug"
   stat
    local
    attnamelist
     pack
     attrib
    =
    explist
     exp
      prefixexp
       table
       .
       pack
   stat
    local
    attnamelist
     MEMERRMSG
     attrib
    =
    explist
     exp
      string
       "not enough memory"
   stat
    local
    function
    tcheck
    funcbody
     (
     parlist
      namelist
       t1
       ,
       t2
     )
     block
      stat
       functioncall
        assert
        args
         (
         explist
          exp
           exp
            prefixexp
             t1
             .
             n
           ==
           exp
            exp
             prefixexp
              (
              exp
               exp
                prefixexp
                 t2
                 .
                 n
               or
               exp
                #
                exp
                 prefixexp
                  t2
              )
            +
            exp
             number
              1
         )
      stat
       for
       i
       =
       exp
        number
         2
       ,
       exp
        prefixexp
         t1
         .
         n
       do
       block
        stat
         functioncall
          assert
          args
           (
           explist
            exp
             exp
              prefixexp
               t1
               [
               exp
                prefixexp
                 i
               ]
             ==
             exp
              prefixexp
               t2
               [
               exp
                exp
                 prefixexp
                  i
                -
                exp
                 number
                  1
               ]
           )
       end
     end
   stat
    local
    function
    checkerr
    funcbody
     (
     parlist
      namelist
       msg
       ,
       f
      ,
      ...
     )
     block
      stat
       local
       attnamelist
        stat
        attrib
        ,
        err
        attrib
       =
       explist
        exp
         prefixexp
          functioncall
           pcall
           args
            (
            explist
             exp
              prefixexp
               f
             ,
             exp
              ...
            )
      stat
       functioncall
        assert
        args
         (
         explist
          exp
           exp
            not
            exp
             prefixexp
              stat
           and
           exp
            prefixexp
             functioncall
              string
              .
              find
              args
               (
               explist
                exp
                 prefixexp
                  err
                ,
                exp
                 prefixexp
                  msg
               )
         )
     end
   stat
    functioncall
     print
     args
      (
      explist
       exp
        string
         'testing C API'
      )
   stat
    local
    attnamelist
     a
     attrib
    =
    explist
     exp
      prefixexp
       functioncall
        T
        .
        testC
        args
         (
         explist
          exp
           string
            "pushvalue R; return 1"
         )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         prefixexp
          a
        ==
        exp
         prefixexp
          functioncall
           debug
           .
           getregistry
           args
            (
            )
      )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         prefixexp
          functioncall
           T
           .
           testC
           args
            (
            explist
             exp
              string
               "settop 10; absindex -1; return 1"
            )
        ==
        exp
         number
          10
      )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         prefixexp
          functioncall
           T
           .
           testC
           args
            (
            explist
             exp
              string
               "settop 5; absindex -5; return 1"
            )
        ==
        exp
         number
          1
      )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         prefixexp
          functioncall
           T
           .
           testC
           args
            (
            explist
             exp
              string
               "settop 10; absindex 1; return 1"
            )
        ==
        exp
         number
          1
      )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         prefixexp
          functioncall
           T
           .
           testC
           args
            (
            explist
             exp
              string
               "settop 10; absindex R; return 1"
            )
        <
        exp
         -
         exp
          number
           10
      )
   stat
    varlist
     var
      a
    =
    explist
     exp
      prefixexp
       functioncall
        T
        .
        d2s
        args
         (
         explist
          exp
           number
            12458954321123.0
         )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         prefixexp
          a
        ==
        exp
         prefixexp
          functioncall
           string
           .
           pack
           args
            (
            explist
             exp
              string
               "d"
             ,
             exp
              number
               12458954321123.0
            )
      )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         prefixexp
          functioncall
           T
           .
           s2d
           args
            (
            explist
             exp
              prefixexp
               a
            )
        ==
        exp
         number
          12458954321123.0
      )
   stat
    local
    attnamelist
     a
     attrib
     ,
     b
     attrib
     ,
     c
     attrib
    =
    explist
     exp
      prefixexp
       functioncall
        T
        .
        testC
        args
         (
         explist
          exp
           string
            "pushnum 1; pushnum 2; pushnum 3; return 2"
         )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         exp
          exp
           prefixexp
            a
          ==
          exp
           number
            2
         and
         exp
          exp
           prefixexp
            b
          ==
          exp
           number
            3
        and
        exp
         not
         exp
          prefixexp
           c
      )
   stat
    local
    attnamelist
     f
     attrib
    =
    explist
     exp
      prefixexp
       functioncall
        T
        .
        makeCfunc
        args
         (
         explist
          exp
           string
            "pushnum 1; pushnum 2; pushnum 3; return 2"
         )
   stat
    varlist
     var
      a
     ,
     var
      b
     ,
     var
      c
    =
    explist
     exp
      prefixexp
       functioncall
        f
        args
         (
         )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         exp
          exp
           prefixexp
            a
          ==
          exp
           number
            2
         and
         exp
          exp
           prefixexp
            b
          ==
          exp
           number
            3
        and
        exp
         not
         exp
          prefixexp
           c
      )
   stat
    varlist
     var
      a
     ,
     var
      b
     ,
     var
      c
    =
    explist
     exp
      prefixexp
       functioncall
        T
        .
        testC
        args
         (
         explist
          exp
           string
            "pushbool 1; pushbool 2; pushbool 0; return 3"
         )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         exp
          exp
           prefixexp
            a
          ==
          exp
           prefixexp
            b
         and
         exp
          exp
           prefixexp
            a
          ==
          exp
           true
        and
        exp
         exp
          prefixexp
           c
         ==
         exp
          false
      )
   stat
    varlist
     var
      a
     ,
     var
      b
     ,
     var
      c
    =
    explist
     exp
      prefixexp
       functioncall
        T
        .
        testC
        args
         string
          "pushbool 0; pushbool 10; pushnil;\\n                      tobool -3; tobool -3; tobool -3; return 3"
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         exp
          exp
           prefixexp
            a
          ==
          exp
           false
         and
         exp
          exp
           prefixexp
            b
          ==
          exp
           true
        and
        exp
         exp
          prefixexp
           c
         ==
         exp
          false
      )
   stat
    varlist
     var
      a
     ,
     var
      b
     ,
     var
      c
    =
    explist
     exp
      prefixexp
       functioncall
        T
        .
        testC
        args
         (
         explist
          exp
           string
            "gettop; return 2"
          ,
          exp
           number
            10
          ,
          exp
           number
            20
          ,
          exp
           number
            30
          ,
          exp
           number
            40
         )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         exp
          exp
           prefixexp
            a
          ==
          exp
           number
            40
         and
         exp
          exp
           prefixexp
            b
          ==
          exp
           number
            5
        and
        exp
         not
         exp
          prefixexp
           c
      )
   stat
    local
    attnamelist
     t
     attrib
    =
    explist
     exp
      prefixexp
       functioncall
        pack
        args
         (
         explist
          exp
           prefixexp
            functioncall
             T
             .
             testC
             args
              (
              explist
               exp
                string
                 "settop 5; return *"
               ,
               exp
                number
                 2
               ,
               exp
                number
                 3
              )
         )
   stat
    functioncall
     tcheck
     args
      (
      explist
       exp
        prefixexp
         t
       ,
       exp
        tableconstructor
         {
         fieldlist
          field
           n
           =
           exp
            number
             4
          fieldsep
           ,
          field
           exp
            number
             2
          fieldsep
           ,
          field
           exp
            number
             3
         }
      )
   stat
    varlist
     var
      t
    =
    explist
     exp
      prefixexp
       functioncall
        pack
        args
         (
         explist
          exp
           prefixexp
            functioncall
             T
             .
             testC
             args
              (
              explist
               exp
                string
                 "settop 0; settop 15; return 10"
               ,
               exp
                number
                 3
               ,
               exp
                number
                 1
               ,
               exp
                number
                 23
              )
         )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         exp
          exp
           prefixexp
            t
            .
            n
          ==
          exp
           number
            10
         and
         exp
          exp
           prefixexp
            t
            [
            exp
             number
              1
            ]
          ==
          exp
           nil
        and
        exp
         exp
          prefixexp
           t
           [
           exp
            number
             10
           ]
         ==
         exp
          nil
      )
   stat
    varlist
     var
      t
    =
    explist
     exp
      prefixexp
       functioncall
        pack
        args
         (
         explist
          exp
           prefixexp
            functioncall
             T
             .
             testC
             args
              (
              explist
               exp
                string
                 "remove -2; return *"
               ,
               exp
                number
                 2
               ,
               exp
                number
                 3
               ,
               exp
                number
                 4
              )
         )
   stat
    functioncall
     tcheck
     args
      (
      explist
       exp
        prefixexp
         t
       ,
       exp
        tableconstructor
         {
         fieldlist
          field
           n
           =
           exp
            number
             2
          fieldsep
           ,
          field
           exp
            number
             2
          fieldsep
           ,
          field
           exp
            number
             4
         }
      )
   stat
    varlist
     var
      t
    =
    explist
     exp
      prefixexp
       functioncall
        pack
        args
         (
         explist
          exp
           prefixexp
            functioncall
             T
             .
             testC
             args
              (
              explist
               exp
                string
                 "insert -1; return *"
               ,
               exp
                number
                 2
               ,
               exp
                number
                 3
              )
         )
   stat
    functioncall
     tcheck
     args
      (
      explist
       exp
        prefixexp
         t
       ,
       exp
        tableconstructor
         {
         fieldlist
          field
           n
           =
           exp
            number
             2
          fieldsep
           ,
          field
           exp
            number
             2
          fieldsep
           ,
          field
           exp
            number
             3
         }
      )
   stat
    varlist
     var
      t
    =
    explist
     exp
      prefixexp
       functioncall
        pack
        args
         (
         explist
          exp
           prefixexp
            functioncall
             T
             .
             testC
             args
              (
              explist
               exp
                string
                 "insert 3; return *"
               ,
               exp
                number
                 2
               ,
               exp
                number
                 3
               ,
               exp
                number
                 4
               ,
               exp
                number
                 5
              )
         )
   stat
    functioncall
     tcheck
     args
      (
      explist
       exp
        prefixexp
         t
       ,
       exp
        tableconstructor
         {
         fieldlist
          field
           n
           =
           exp
            number
             4
          fieldsep
           ,
          field
           exp
            number
             2
          fieldsep
           ,
          field
           exp
            number
             5
          fieldsep
           ,
          field
           exp
            number
             3
          fieldsep
           ,
          field
           exp
            number
             4
         }
      )
   stat
    varlist
     var
      t
    =
    explist
     exp
      prefixexp
       functioncall
        pack
        args
         (
         explist
          exp
           prefixexp
            functioncall
             T
             .
             testC
             args
              (
              explist
               exp
                string
                 "replace 2; return *"
               ,
               exp
                number
                 2
               ,
               exp
                number
                 3
               ,
               exp
                number
                 4
               ,
               exp
                number
                 5
              )
         )
   stat
    functioncall
     tcheck
     args
      (
      explist
       exp
        prefixexp
         t
       ,
       exp
        tableconstructor
         {
         fieldlist
          field
           n
           =
           exp
            number
             3
          fieldsep
           ,
          field
           exp
            number
             5
          fieldsep
           ,
          field
           exp
            number
             3
          fieldsep
           ,
          field
           exp
            number
             4
         }
      )
   stat
    varlist
     var
      t
    =
    explist
     exp
      prefixexp
       functioncall
        pack
        args
         (
         explist
          exp
           prefixexp
            functioncall
             T
             .
             testC
             args
              (
              explist
               exp
                string
                 "replace -2; return *"
               ,
               exp
                number
                 2
               ,
               exp
                number
                 3
               ,
               exp
                number
                 4
               ,
               exp
                number
                 5
              )
         )
   stat
    functioncall
     tcheck
     args
      (
      explist
       exp
        prefixexp
         t
       ,
       exp
        tableconstructor
         {
         fieldlist
          field
           n
           =
           exp
            number
             3
          fieldsep
           ,
          field
           exp
            number
             2
          fieldsep
           ,
          field
           exp
            number
             3
          fieldsep
           ,
          field
           exp
            number
             5
         }
      )
   stat
    varlist
     var
      t
    =
    explist
     exp
      prefixexp
       functioncall
        pack
        args
         (
         explist
          exp
           prefixexp
            functioncall
             T
             .
             testC
             args
              (
              explist
               exp
                string
                 "remove 3; return *"
               ,
               exp
                number
                 2
               ,
               exp
                number
                 3
               ,
               exp
                number
                 4
               ,
               exp
                number
                 5
              )
         )
   stat
    functioncall
     tcheck
     args
      (
      explist
       exp
        prefixexp
         t
       ,
       exp
        tableconstructor
         {
         fieldlist
          field
           n
           =
           exp
            number
             3
          fieldsep
           ,
          field
           exp
            number
             2
          fieldsep
           ,
          field
           exp
            number
             4
          fieldsep
           ,
          field
           exp
            number
             5
         }
      )
   stat
    varlist
     var
      t
    =
    explist
     exp
      prefixexp
       functioncall
        pack
        args
         (
         explist
          exp
           prefixexp
            functioncall
             T
             .
             testC
             args
              (
              explist
               exp
                string
                 "copy 3 4; return *"
               ,
               exp
                number
                 2
               ,
               exp
                number
                 3
               ,
               exp
                number
                 4
               ,
               exp
                number
                 5
              )
         )
   stat
    functioncall
     tcheck
     args
      (
      explist
       exp
        prefixexp
         t
       ,
       exp
        tableconstructor
         {
         fieldlist
          field
           n
           =
           exp
            number
             4
          fieldsep
           ,
          field
           exp
            number
             2
          fieldsep
           ,
          field
           exp
            number
             3
          fieldsep
           ,
          field
           exp
            number
             3
          fieldsep
           ,
          field
           exp
            number
             5
         }
      )
   stat
    varlist
     var
      t
    =
    explist
     exp
      prefixexp
       functioncall
        pack
        args
         (
         explist
          exp
           prefixexp
            functioncall
             T
             .
             testC
             args
              (
              explist
               exp
                string
                 "copy -3 -1; return *"
               ,
               exp
                number
                 2
               ,
               exp
                number
                 3
               ,
               exp
                number
                 4
               ,
               exp
                number
                 5
              )
         )
   stat
    functioncall
     tcheck
     args
      (
      explist
       exp
        prefixexp
         t
       ,
       exp
        tableconstructor
         {
         fieldlist
          field
           n
           =
           exp
            number
             4
          fieldsep
           ,
          field
           exp
            number
             2
          fieldsep
           ,
          field
           exp
            number
             3
          fieldsep
           ,
          field
           exp
            number
             4
          fieldsep
           ,
          field
           exp
            number
             3
         }
      )
   stat
    do
    block
     stat
      local
      attnamelist
       t
       attrib
      =
      explist
       exp
        tableconstructor
         {
         fieldlist
          field
           exp
            number
             10
          fieldsep
           ,
          field
           exp
            number
             20
          fieldsep
           ,
          field
           exp
            number
             30
          fieldsep
           ,
          field
           exp
            number
             40
          fieldsep
           ,
          field
           exp
            number
             50
          fieldsep
           ,
          field
           exp
            number
             60
         }
     stat
      for
      i
      =
      exp
       -
       exp
        number
         6
      ,
      exp
       number
        6
      do
      block
       stat
        local
        attnamelist
         s
         attrib
        =
        explist
         exp
          prefixexp
           functioncall
            string
            .
            format
            args
             (
             explist
              exp
               string
                "rotate 2 %d; return 7"
              ,
              exp
               prefixexp
                i
             )
       stat
        local
        attnamelist
         t1
         attrib
        =
        explist
         exp
          prefixexp
           functioncall
            pack
            args
             (
             explist
              exp
               prefixexp
                functioncall
                 T
                 .
                 testC
                 args
                  (
                  explist
                   exp
                    prefixexp
                     s
                   ,
                   exp
                    number
                     10
                   ,
                   exp
                    number
                     20
                   ,
                   exp
                    number
                     30
                   ,
                   exp
                    number
                     40
                   ,
                   exp
                    number
                     50
                   ,
                   exp
                    number
                     60
                  )
             )
       stat
        functioncall
         tcheck
         args
          (
          explist
           exp
            prefixexp
             t1
           ,
           exp
            prefixexp
             t
          )
       stat
        functioncall
         table
         .
         insert
         args
          (
          explist
           exp
            prefixexp
             t
           ,
           exp
            number
             1
           ,
           exp
            prefixexp
             functioncall
              table
              .
              remove
              args
               (
               explist
                exp
                 prefixexp
                  t
               )
          )
      end
     stat
      varlist
       var
        t
      =
      explist
       exp
        prefixexp
         functioncall
          pack
          args
           (
           explist
            exp
             prefixexp
              functioncall
               T
               .
               testC
               args
                (
                explist
                 exp
                  string
                   "rotate -2 1; return *"
                 ,
                 exp
                  number
                   10
                 ,
                 exp
                  number
                   20
                 ,
                 exp
                  number
                   30
                 ,
                 exp
                  number
                   40
                )
           )
     stat
      functioncall
       tcheck
       args
        (
        explist
         exp
          prefixexp
           t
         ,
         exp
          tableconstructor
           {
           fieldlist
            field
             exp
              number
               10
            fieldsep
             ,
            field
             exp
              number
               20
            fieldsep
             ,
            field
             exp
              number
               40
            fieldsep
             ,
            field
             exp
              number
               30
           }
        )
     stat
      varlist
       var
        t
      =
      explist
       exp
        prefixexp
         functioncall
          pack
          args
           (
           explist
            exp
             prefixexp
              functioncall
               T
               .
               testC
               args
                (
                explist
                 exp
                  string
                   "rotate -2 -1; return *"
                 ,
                 exp
                  number
                   10
                 ,
                 exp
                  number
                   20
                 ,
                 exp
                  number
                   30
                 ,
                 exp
                  number
                   40
                )
           )
     stat
      functioncall
       tcheck
       args
        (
        explist
         exp
          prefixexp
           t
         ,
         exp
          tableconstructor
           {
           fieldlist
            field
             exp
              number
               10
            fieldsep
             ,
            field
             exp
              number
               20
            fieldsep
             ,
            field
             exp
              number
               40
            fieldsep
             ,
            field
             exp
              number
               30
           }
        )
     stat
      varlist
       var
        t
      =
      explist
       exp
        prefixexp
         functioncall
          pack
          args
           (
           explist
            exp
             prefixexp
              functioncall
               T
               .
               testC
               args
                (
                explist
                 exp
                  string
                   "rotate -1 0; return *"
                 ,
                 exp
                  number
                   10
                 ,
                 exp
                  number
                   20
                 ,
                 exp
                  number
                   30
                 ,
                 exp
                  number
                   40
                )
           )
     stat
      functioncall
       tcheck
       args
        (
        explist
         exp
          prefixexp
           t
         ,
         exp
          tableconstructor
           {
           fieldlist
            field
             exp
              number
               10
            fieldsep
             ,
            field
             exp
              number
               20
            fieldsep
             ,
            field
             exp
              number
               30
            fieldsep
             ,
            field
             exp
              number
               40
           }
        )
     stat
      varlist
       var
        t
      =
      explist
       exp
        prefixexp
         functioncall
          pack
          args
           (
           explist
            exp
             prefixexp
              functioncall
               T
               .
               testC
               args
                (
                explist
                 exp
                  string
                   "rotate -1 1; return *"
                 ,
                 exp
                  number
                   10
                 ,
                 exp
                  number
                   20
                 ,
                 exp
                  number
                   30
                 ,
                 exp
                  number
                   40
                )
           )
     stat
      functioncall
       tcheck
       args
        (
        explist
         exp
          prefixexp
           t
         ,
         exp
          tableconstructor
           {
           fieldlist
            field
             exp
              number
               10
            fieldsep
             ,
            field
             exp
              number
               20
            fieldsep
             ,
            field
             exp
              number
               30
            fieldsep
             ,
            field
             exp
              number
               40
           }
        )
     stat
      varlist
       var
        t
      =
      explist
       exp
        prefixexp
         functioncall
          pack
          args
           (
           explist
            exp
             prefixexp
              functioncall
               T
               .
               testC
               args
                (
                explist
                 exp
                  string
                   "rotate 5 -1; return *"
                 ,
                 exp
                  number
                   10
                 ,
                 exp
                  number
                   20
                 ,
                 exp
                  number
                   30
                 ,
                 exp
                  number
                   40
                )
           )
     stat
      functioncall
       tcheck
       args
        (
        explist
         exp
          prefixexp
           t
         ,
         exp
          tableconstructor
           {
           fieldlist
            field
             exp
              number
               10
            fieldsep
             ,
            field
             exp
              number
               20
            fieldsep
             ,
            field
             exp
              number
               30
            fieldsep
             ,
            field
             exp
              number
               40
           }
        )
    end
   stat
    functioncall
     T
     .
     testC
     args
      (
      explist
       exp
        string
         [[\n  warningC "#This shold be a"\n  warningC " single "\n  warning "warning"\n  warningC "#This should be "\n  warning "another one"\n]]
      )
   stat
    do
    block
     stat
      local
      attnamelist
       f
       attrib
      =
      explist
       exp
        prefixexp
         functioncall
          T
          .
          makeCfunc
          args
           string
            [[\n    getglobal error\n    pushstring bola\n    pcall 1 1 1   # call 'error' with given handler\n    pushstatus\n    return 2     # return error message and status\n  ]]
     stat
      local
      attnamelist
       msg
       attrib
       ,
       st
       attrib
      =
      explist
       exp
        prefixexp
         functioncall
          f
          args
           (
           explist
            exp
             prefixexp
              string
              .
              upper
           )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           exp
            prefixexp
             st
           ==
           exp
            string
             "ERRRUN"
          and
          exp
           exp
            prefixexp
             msg
           ==
           exp
            string
             "BOLA"
        )
     stat
      local
      attnamelist
       msg
       attrib
       ,
       st
       attrib
      =
      explist
       exp
        prefixexp
         functioncall
          f
          args
           (
           explist
            exp
             prefixexp
              string
              .
              len
           )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           exp
            prefixexp
             st
           ==
           exp
            string
             "ERRRUN"
          and
          exp
           exp
            prefixexp
             msg
           ==
           exp
            number
             4
        )
    end
   stat
    varlist
     var
      t
    =
    explist
     exp
      prefixexp
       functioncall
        pack
        args
         (
         explist
          exp
           prefixexp
            functioncall
             T
             .
             testC
             args
              (
              explist
               exp
                string
                 "insert 3; pushvalue 3; remove 3; pushvalue 2; remove 2; \\n                  insert 2; pushvalue 1; remove 1; insert 1; \\n      insert -2; pushvalue -2; remove -3; return *"
               ,
               exp
                number
                 2
               ,
               exp
                number
                 3
               ,
               exp
                number
                 4
               ,
               exp
                number
                 5
               ,
               exp
                number
                 10
               ,
               exp
                number
                 40
               ,
               exp
                number
                 90
              )
         )
   stat
    functioncall
     tcheck
     args
      (
      explist
       exp
        prefixexp
         t
       ,
       exp
        tableconstructor
         {
         fieldlist
          field
           n
           =
           exp
            number
             7
          fieldsep
           ,
          field
           exp
            number
             2
          fieldsep
           ,
          field
           exp
            number
             3
          fieldsep
           ,
          field
           exp
            number
             4
          fieldsep
           ,
          field
           exp
            number
             5
          fieldsep
           ,
          field
           exp
            number
             10
          fieldsep
           ,
          field
           exp
            number
             40
          fieldsep
           ,
          field
           exp
            number
             90
         }
      )
   stat
    varlist
     var
      t
    =
    explist
     exp
      prefixexp
       functioncall
        pack
        args
         (
         explist
          exp
           prefixexp
            functioncall
             T
             .
             testC
             args
              (
              explist
               exp
                string
                 "concat 5; return *"
               ,
               exp
                string
                 "alo"
               ,
               exp
                number
                 2
               ,
               exp
                number
                 3
               ,
               exp
                string
                 "joao"
               ,
               exp
                number
                 12
              )
         )
   stat
    functioncall
     tcheck
     args
      (
      explist
       exp
        prefixexp
         t
       ,
       exp
        tableconstructor
         {
         fieldlist
          field
           n
           =
           exp
            number
             1
          fieldsep
           ,
          field
           exp
            string
             "alo23joao12"
         }
      )
   stat
    varlist
     var
      t
    =
    explist
     exp
      prefixexp
       functioncall
        pack
        args
         (
         explist
          exp
           prefixexp
            functioncall
             T
             .
             testC
             args
              (
              explist
               exp
                string
                 "call 2,-1; return *"
               ,
               exp
                functiondef
                 function
                 funcbody
                  (
                  parlist
                   namelist
                    a
                    ,
                    b
                  )
                  block
                   retstat
                    return
                    explist
                     exp
                      number
                       1
                     ,
                     exp
                      number
                       2
                     ,
                     exp
                      number
                       3
                     ,
                     exp
                      number
                       4
                     ,
                     exp
                      prefixexp
                       a
                     ,
                     exp
                      prefixexp
                       b
                  end
               ,
               exp
                string
                 "alo"
               ,
               exp
                string
                 "joao"
              )
         )
   stat
    functioncall
     tcheck
     args
      (
      explist
       exp
        prefixexp
         t
       ,
       exp
        tableconstructor
         {
         fieldlist
          field
           n
           =
           exp
            number
             6
          fieldsep
           ,
          field
           exp
            number
             1
          fieldsep
           ,
          field
           exp
            number
             2
          fieldsep
           ,
          field
           exp
            number
             3
          fieldsep
           ,
          field
           exp
            number
             4
          fieldsep
           ,
          field
           exp
            string
             "alo"
          fieldsep
           ,
          field
           exp
            string
             "joao"
         }
      )
   stat
    do
    block
     stat
      local
      attnamelist
       a
       attrib
      =
      explist
       exp
        tableconstructor
         {
         }
     stat
      for
      i
      =
      exp
       number
        1
      ,
      exp
       number
        1000
      do
      block
       stat
        varlist
         var
          prefixexp
           a
          [
          exp
           prefixexp
            i
          ]
        =
        explist
         exp
          true
      end
     stat
      ;
     stat
      varlist
       var
        prefixexp
         a
        [
        exp
         number
          999
        ]
      =
      explist
       exp
        number
         10
     stat
      local
      attnamelist
       b
       attrib
      =
      explist
       exp
        prefixexp
         functioncall
          T
          .
          testC
          args
           (
           explist
            exp
             string
              [[pcall 1 -1 0; pop 1; tostring -1; return 1]]
            ,
            exp
             prefixexp
              table
              .
              unpack
            ,
            exp
             prefixexp
              a
           )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           prefixexp
            b
          ==
          exp
           string
            "10"
        )
    end
   stat
    varlist
     var
      prefixexp
       _G
      .
      AA
    =
    explist
     exp
      number
       14
   stat
    ;
   stat
    varlist
     var
      prefixexp
       _G
      .
      BB
    =
    explist
     exp
      string
       "a31"
   stat
    local
    attnamelist
     a
     attrib
    =
    explist
     exp
      tableconstructor
       {
       fieldlist
        field
         exp
          prefixexp
           functioncall
            T
            .
            testC
            args
             string
              [[\n  getglobal AA;\n  getglobal BB;\n  getglobal BB;\n  setglobal AA;\n  return *\n]]
       }
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         exp
          exp
           exp
            prefixexp
             a
             [
             exp
              number
               2
             ]
           ==
           exp
            number
             14
          and
          exp
           exp
            prefixexp
             a
             [
             exp
              number
               3
             ]
           ==
           exp
            string
             "a31"
         and
         exp
          exp
           prefixexp
            a
            [
            exp
             number
              4
            ]
          ==
          exp
           nil
        and
        exp
         exp
          prefixexp
           _G
           .
           AA
         ==
         exp
          string
           "a31"
      )
   stat
    varlist
     var
      prefixexp
       _G
      .
      AA
     ,
     var
      prefixexp
       _G
      .
      BB
    =
    explist
     exp
      nil
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         prefixexp
          functioncall
           T
           .
           testC
           args
            (
            explist
             exp
              string
               "pushnum 10; pushnum 20; arith /; return 1"
            )
        ==
        exp
         number
          0.5
      )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         prefixexp
          functioncall
           T
           .
           testC
           args
            (
            explist
             exp
              string
               "pushnum 10; pushnum 20; arith -; return 1"
            )
        ==
        exp
         -
         exp
          number
           10
      )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         prefixexp
          functioncall
           T
           .
           testC
           args
            (
            explist
             exp
              string
               "pushnum 10; pushnum -20; arith *; return 1"
            )
        ==
        exp
         -
         exp
          number
           200
      )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         prefixexp
          functioncall
           T
           .
           testC
           args
            (
            explist
             exp
              string
               "pushnum 10; pushnum 3; arith ^; return 1"
            )
        ==
        exp
         number
          1000
      )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         prefixexp
          functioncall
           T
           .
           testC
           args
            (
            explist
             exp
              string
               "pushnum 10; pushstring 20; arith /; return 1"
            )
        ==
        exp
         number
          0.5
      )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         prefixexp
          functioncall
           T
           .
           testC
           args
            (
            explist
             exp
              string
               "pushstring 10; pushnum 20; arith -; return 1"
            )
        ==
        exp
         -
         exp
          number
           10
      )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         prefixexp
          functioncall
           T
           .
           testC
           args
            (
            explist
             exp
              string
               "pushstring 10; pushstring -20; arith *; return 1"
            )
        ==
        exp
         -
         exp
          number
           200
      )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         prefixexp
          functioncall
           T
           .
           testC
           args
            (
            explist
             exp
              string
               "pushstring 10; pushstring 3; arith ^; return 1"
            )
        ==
        exp
         number
          1000
      )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         prefixexp
          functioncall
           T
           .
           testC
           args
            (
            explist
             exp
              string
               "arith /; return 1"
             ,
             exp
              number
               2
             ,
             exp
              number
               0
            )
        ==
        exp
         exp
          number
           10.0
         /
         exp
          number
           0
      )
   stat
    varlist
     var
      a
    =
    explist
     exp
      prefixexp
       functioncall
        T
        .
        testC
        args
         (
         explist
          exp
           string
            "pushnum 10; pushint 3; arith \\; return 1"
         )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         exp
          prefixexp
           a
         ==
         exp
          number
           3.0
        and
        exp
         exp
          prefixexp
           functioncall
            math
            .
            type
            args
             (
             explist
              exp
               prefixexp
                a
             )
         ==
         exp
          string
           "float"
      )
   stat
    varlist
     var
      a
    =
    explist
     exp
      prefixexp
       functioncall
        T
        .
        testC
        args
         (
         explist
          exp
           string
            "pushint 10; pushint 3; arith \\; return 1"
         )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         exp
          prefixexp
           a
         ==
         exp
          number
           3
        and
        exp
         exp
          prefixexp
           functioncall
            math
            .
            type
            args
             (
             explist
              exp
               prefixexp
                a
             )
         ==
         exp
          string
           "integer"
      )
   stat
    varlist
     var
      a
    =
    explist
     exp
      prefixexp
       functioncall
        assert
        args
         (
         explist
          exp
           prefixexp
            functioncall
             T
             .
             testC
             args
              (
              explist
               exp
                string
                 "pushint 10; pushint 3; arith +; return 1"
              )
         )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         exp
          prefixexp
           a
         ==
         exp
          number
           13
        and
        exp
         exp
          prefixexp
           functioncall
            math
            .
            type
            args
             (
             explist
              exp
               prefixexp
                a
             )
         ==
         exp
          string
           "integer"
      )
   stat
    varlist
     var
      a
    =
    explist
     exp
      prefixexp
       functioncall
        assert
        args
         (
         explist
          exp
           prefixexp
            functioncall
             T
             .
             testC
             args
              (
              explist
               exp
                string
                 "pushnum 10; pushint 3; arith +; return 1"
              )
         )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         exp
          prefixexp
           a
         ==
         exp
          number
           13
        and
        exp
         exp
          prefixexp
           functioncall
            math
            .
            type
            args
             (
             explist
              exp
               prefixexp
                a
             )
         ==
         exp
          string
           "float"
      )
   stat
    varlist
     var
      a
     ,
     var
      b
     ,
     var
      c
    =
    explist
     exp
      prefixexp
       functioncall
        T
        .
        testC
        args
         (
         explist
          exp
           string
            [[pushnum 1;\n                  pushstring 10; arith _;\n                  pushstring 5; return 3]]
         )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         exp
          exp
           prefixexp
            a
          ==
          exp
           number
            1
         and
         exp
          exp
           prefixexp
            b
          ==
          exp
           -
           exp
            number
             10
        and
        exp
         exp
          prefixexp
           c
         ==
         exp
          string
           "5"
      )
   stat
    local
    attnamelist
     mt
     attrib
    =
    explist
     exp
      tableconstructor
       {
       fieldlist
        field
         __add
         =
         exp
          functiondef
           function
           funcbody
            (
            parlist
             namelist
              a
              ,
              b
            )
            block
             retstat
              return
              explist
               exp
                prefixexp
                 functioncall
                  setmetatable
                  args
                   (
                   explist
                    exp
                     tableconstructor
                      {
                      fieldlist
                       field
                        exp
                         exp
                          prefixexp
                           a
                           [
                           exp
                            number
                             1
                           ]
                         +
                         exp
                          prefixexp
                           b
                           [
                           exp
                            number
                             1
                           ]
                      }
                    ,
                    exp
                     prefixexp
                      mt
                   )
            end
        fieldsep
         ,
        field
         __mod
         =
         exp
          functiondef
           function
           funcbody
            (
            parlist
             namelist
              a
              ,
              b
            )
            block
             retstat
              return
              explist
               exp
                prefixexp
                 functioncall
                  setmetatable
                  args
                   (
                   explist
                    exp
                     tableconstructor
                      {
                      fieldlist
                       field
                        exp
                         exp
                          prefixexp
                           a
                           [
                           exp
                            number
                             1
                           ]
                         %
                         exp
                          prefixexp
                           b
                           [
                           exp
                            number
                             1
                           ]
                      }
                    ,
                    exp
                     prefixexp
                      mt
                   )
            end
        fieldsep
         ,
        field
         __unm
         =
         exp
          functiondef
           function
           funcbody
            (
            parlist
             namelist
              a
            )
            block
             retstat
              return
              explist
               exp
                prefixexp
                 functioncall
                  setmetatable
                  args
                   (
                   explist
                    exp
                     tableconstructor
                      {
                      fieldlist
                       field
                        exp
                         exp
                          prefixexp
                           a
                           [
                           exp
                            number
                             1
                           ]
                         *
                         exp
                          number
                           2
                      }
                    ,
                    exp
                     prefixexp
                      mt
                   )
            end
       }
   stat
    varlist
     var
      a
     ,
     var
      b
     ,
     var
      c
    =
    explist
     exp
      prefixexp
       functioncall
        setmetatable
        args
         (
         explist
          exp
           tableconstructor
            {
            fieldlist
             field
              exp
               number
                4
            }
          ,
          exp
           prefixexp
            mt
         )
     ,
     exp
      prefixexp
       functioncall
        setmetatable
        args
         (
         explist
          exp
           tableconstructor
            {
            fieldlist
             field
              exp
               number
                8
            }
          ,
          exp
           prefixexp
            mt
         )
     ,
     exp
      prefixexp
       functioncall
        setmetatable
        args
         (
         explist
          exp
           tableconstructor
            {
            fieldlist
             field
              exp
               -
               exp
                number
                 3
            }
          ,
          exp
           prefixexp
            mt
         )
   stat
    local
    attnamelist
     x
     attrib
     ,
     y
     attrib
     ,
     z
     attrib
    =
    explist
     exp
      prefixexp
       functioncall
        T
        .
        testC
        args
         (
         explist
          exp
           string
            "arith +; return 2"
          ,
          exp
           number
            10
          ,
          exp
           prefixexp
            a
          ,
          exp
           prefixexp
            b
         )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         exp
          exp
           prefixexp
            x
          ==
          exp
           number
            10
         and
         exp
          exp
           prefixexp
            y
            [
            exp
             number
              1
            ]
          ==
          exp
           number
            12
        and
        exp
         exp
          prefixexp
           z
         ==
         exp
          nil
      )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         prefixexp
          functioncall
           T
           .
           testC
           args
            (
            explist
             exp
              string
               "arith %; return 1"
             ,
             exp
              prefixexp
               a
             ,
             exp
              prefixexp
               c
            )
          [
          exp
           number
            1
          ]
        ==
        exp
         exp
          number
           4
         %
         exp
          -
          exp
           number
            3
      )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         prefixexp
          functioncall
           T
           .
           testC
           args
            (
            explist
             exp
              string
               "arith _; arith +; arith %; return 1"
             ,
             exp
              prefixexp
               b
             ,
             exp
              prefixexp
               a
             ,
             exp
              prefixexp
               c
            )
          [
          exp
           number
            1
          ]
        ==
        exp
         exp
          number
           8
         %
         exp
          prefixexp
           (
           exp
            exp
             number
              4
            +
            exp
             exp
              prefixexp
               (
               exp
                -
                exp
                 number
                  3
               )
             *
             exp
              number
               2
           )
      )
   stat
    functioncall
     checkerr
     args
      (
      explist
       exp
        string
         "divide by zero"
       ,
       exp
        prefixexp
         T
         .
         testC
       ,
       exp
        string
         "arith \\"
       ,
       exp
        number
         10
       ,
       exp
        number
         0
      )
   stat
    functioncall
     checkerr
     args
      (
      explist
       exp
        string
         "%%0"
       ,
       exp
        prefixexp
         T
         .
         testC
       ,
       exp
        string
         "arith %"
       ,
       exp
        number
         10
       ,
       exp
        number
         0
      )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        prefixexp
         functioncall
          T
          .
          testC
          args
           (
           explist
            exp
             string
              "compare LT 2 5, return 1"
            ,
            exp
             number
              3
            ,
            exp
             number
              2
            ,
            exp
             number
              2
            ,
            exp
             number
              4
            ,
            exp
             number
              2
            ,
            exp
             number
              2
           )
      )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        prefixexp
         functioncall
          T
          .
          testC
          args
           (
           explist
            exp
             string
              "compare LE 2 5, return 1"
            ,
            exp
             number
              3
            ,
            exp
             number
              2
            ,
            exp
             number
              2
            ,
            exp
             number
              4
            ,
            exp
             number
              2
            ,
            exp
             number
              2
           )
      )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        not
        exp
         prefixexp
          functioncall
           T
           .
           testC
           args
            (
            explist
             exp
              string
               "compare LT 3 4, return 1"
             ,
             exp
              number
               3
             ,
             exp
              number
               2
             ,
             exp
              number
               2
             ,
             exp
              number
               4
             ,
             exp
              number
               2
             ,
             exp
              number
               2
            )
      )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        prefixexp
         functioncall
          T
          .
          testC
          args
           (
           explist
            exp
             string
              "compare LE 3 4, return 1"
            ,
            exp
             number
              3
            ,
            exp
             number
              2
            ,
            exp
             number
              2
            ,
            exp
             number
              4
            ,
            exp
             number
              2
            ,
            exp
             number
              2
           )
      )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        prefixexp
         functioncall
          T
          .
          testC
          args
           (
           explist
            exp
             string
              "compare LT 5 2, return 1"
            ,
            exp
             number
              4
            ,
            exp
             number
              2
            ,
            exp
             number
              2
            ,
            exp
             number
              3
            ,
            exp
             number
              2
            ,
            exp
             number
              2
           )
      )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        not
        exp
         prefixexp
          functioncall
           T
           .
           testC
           args
            (
            explist
             exp
              string
               "compare LT 2 -3, return 1"
             ,
             exp
              string
               "4"
             ,
             exp
              string
               "2"
             ,
             exp
              string
               "2"
             ,
             exp
              string
               "3"
             ,
             exp
              string
               "2"
             ,
             exp
              string
               "2"
            )
      )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        not
        exp
         prefixexp
          functioncall
           T
           .
           testC
           args
            (
            explist
             exp
              string
               "compare LT -3 2, return 1"
             ,
             exp
              string
               "3"
             ,
             exp
              string
               "2"
             ,
             exp
              string
               "2"
             ,
             exp
              string
               "4"
             ,
             exp
              string
               "2"
             ,
             exp
              string
               "2"
            )
      )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        not
        exp
         prefixexp
          functioncall
           T
           .
           testC
           args
            (
            explist
             exp
              string
               "compare LT 1 4, return 1"
            )
      )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        not
        exp
         prefixexp
          functioncall
           T
           .
           testC
           args
            (
            explist
             exp
              string
               "compare LE 9 1, return 1"
            )
      )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        not
        exp
         prefixexp
          functioncall
           T
           .
           testC
           args
            (
            explist
             exp
              string
               "compare EQ 9 9, return 1"
            )
      )
   stat
    local
    attnamelist
     b
     attrib
    =
    explist
     exp
      tableconstructor
       {
       fieldlist
        field
         __lt
         =
         exp
          functiondef
           function
           funcbody
            (
            parlist
             namelist
              a
              ,
              b
            )
            block
             retstat
              return
              explist
               exp
                exp
                 prefixexp
                  a
                  [
                  exp
                   number
                    1
                  ]
                <
                exp
                 prefixexp
                  b
                  [
                  exp
                   number
                    1
                  ]
            end
       }
   stat
    local
    attnamelist
     a1
     attrib
     ,
     a3
     attrib
     ,
     a4
     attrib
    =
    explist
     exp
      prefixexp
       functioncall
        setmetatable
        args
         (
         explist
          exp
           tableconstructor
            {
            fieldlist
             field
              exp
               number
                1
            }
          ,
          exp
           prefixexp
            b
         )
     ,
     exp
      prefixexp
       functioncall
        setmetatable
        args
         (
         explist
          exp
           tableconstructor
            {
            fieldlist
             field
              exp
               number
                3
            }
          ,
          exp
           prefixexp
            b
         )
     ,
     exp
      prefixexp
       functioncall
        setmetatable
        args
         (
         explist
          exp
           tableconstructor
            {
            fieldlist
             field
              exp
               number
                4
            }
          ,
          exp
           prefixexp
            b
         )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        prefixexp
         functioncall
          T
          .
          testC
          args
           (
           explist
            exp
             string
              "compare LT 2 5, return 1"
            ,
            exp
             prefixexp
              a3
            ,
            exp
             number
              2
            ,
            exp
             number
              2
            ,
            exp
             prefixexp
              a4
            ,
            exp
             number
              2
            ,
            exp
             number
              2
           )
      )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        prefixexp
         functioncall
          T
          .
          testC
          args
           (
           explist
            exp
             string
              "compare LE 2 5, return 1"
            ,
            exp
             prefixexp
              a3
            ,
            exp
             number
              2
            ,
            exp
             number
              2
            ,
            exp
             prefixexp
              a4
            ,
            exp
             number
              2
            ,
            exp
             number
              2
           )
      )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        prefixexp
         functioncall
          T
          .
          testC
          args
           (
           explist
            exp
             string
              "compare LT 5 -6, return 1"
            ,
            exp
             prefixexp
              a4
            ,
            exp
             number
              2
            ,
            exp
             number
              2
            ,
            exp
             prefixexp
              a3
            ,
            exp
             number
              2
            ,
            exp
             number
              2
           )
      )
   stat
    varlist
     var
      a
     ,
     var
      b
    =
    explist
     exp
      prefixexp
       functioncall
        T
        .
        testC
        args
         (
         explist
          exp
           string
            "compare LT 5 -6, return 2"
          ,
          exp
           prefixexp
            a1
          ,
          exp
           number
            2
          ,
          exp
           number
            2
          ,
          exp
           prefixexp
            a3
          ,
          exp
           number
            2
          ,
          exp
           number
            20
         )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         exp
          prefixexp
           a
         ==
         exp
          number
           20
        and
        exp
         exp
          prefixexp
           b
         ==
         exp
          false
      )
   stat
    varlist
     var
      a
     ,
     var
      b
    =
    explist
     exp
      prefixexp
       functioncall
        T
        .
        testC
        args
         (
         explist
          exp
           string
            "compare LE 5 -6, return 2"
          ,
          exp
           prefixexp
            a1
          ,
          exp
           number
            2
          ,
          exp
           number
            2
          ,
          exp
           prefixexp
            a3
          ,
          exp
           number
            2
          ,
          exp
           number
            20
         )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         exp
          prefixexp
           a
         ==
         exp
          number
           20
        and
        exp
         exp
          prefixexp
           b
         ==
         exp
          false
      )
   stat
    varlist
     var
      a
     ,
     var
      b
    =
    explist
     exp
      prefixexp
       functioncall
        T
        .
        testC
        args
         (
         explist
          exp
           string
            "compare LE 5 -6, return 2"
          ,
          exp
           prefixexp
            a1
          ,
          exp
           number
            2
          ,
          exp
           number
            2
          ,
          exp
           prefixexp
            a1
          ,
          exp
           number
            2
          ,
          exp
           number
            20
         )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         exp
          prefixexp
           a
         ==
         exp
          number
           20
        and
        exp
         exp
          prefixexp
           b
         ==
         exp
          true
      )
   stat
    do
    block
     stat
      local
      attnamelist
       mt
       attrib
      =
      explist
       exp
        tableconstructor
         {
         fieldlist
          field
           __lt
           =
           exp
            functiondef
             function
             funcbody
              (
              parlist
               namelist
                a
                ,
                b
              )
              block
               retstat
                return
                explist
                 exp
                  exp
                   prefixexp
                    a
                    [
                    exp
                     number
                      1
                    ]
                  <
                  exp
                   prefixexp
                    b
                    [
                    exp
                     number
                      1
                    ]
              end
          fieldsep
           ,
          field
           __le
           =
           exp
            functiondef
             function
             funcbody
              (
              parlist
               namelist
                a
                ,
                b
              )
              block
               retstat
                return
                explist
                 exp
                  exp
                   prefixexp
                    a
                    [
                    exp
                     number
                      1
                    ]
                  <=
                  exp
                   prefixexp
                    b
                    [
                    exp
                     number
                      1
                    ]
              end
          fieldsep
           ,
          field
           __eq
           =
           exp
            functiondef
             function
             funcbody
              (
              parlist
               namelist
                a
                ,
                b
              )
              block
               retstat
                return
                explist
                 exp
                  exp
                   prefixexp
                    a
                    [
                    exp
                     number
                      1
                    ]
                  ==
                  exp
                   prefixexp
                    b
                    [
                    exp
                     number
                      1
                    ]
              end
         }
     stat
      local
      function
      O
      funcbody
       (
       parlist
        namelist
         x
       )
       block
        retstat
         return
         explist
          exp
           prefixexp
            functioncall
             setmetatable
             args
              (
              explist
               exp
                tableconstructor
                 {
                 fieldlist
                  field
                   exp
                    prefixexp
                     x
                 }
               ,
               exp
                prefixexp
                 mt
              )
       end
     stat
      local
      attnamelist
       a
       attrib
       ,
       b
       attrib
      =
      explist
       exp
        prefixexp
         functioncall
          T
          .
          testC
          args
           (
           explist
            exp
             string
              "compare LT 2 3; pushint 10; return 2"
            ,
            exp
             prefixexp
              functioncall
               O
               args
                (
                explist
                 exp
                  number
                   1
                )
            ,
            exp
             prefixexp
              functioncall
               O
               args
                (
                explist
                 exp
                  number
                   2
                )
           )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           exp
            prefixexp
             a
           ==
           exp
            true
          and
          exp
           exp
            prefixexp
             b
           ==
           exp
            number
             10
        )
     stat
      local
      attnamelist
       a
       attrib
       ,
       b
       attrib
      =
      explist
       exp
        prefixexp
         functioncall
          T
          .
          testC
          args
           (
           explist
            exp
             string
              "compare LE 2 3; pushint 10; return 2"
            ,
            exp
             prefixexp
              functioncall
               O
               args
                (
                explist
                 exp
                  number
                   3
                )
            ,
            exp
             prefixexp
              functioncall
               O
               args
                (
                explist
                 exp
                  number
                   2
                )
           )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           exp
            prefixexp
             a
           ==
           exp
            false
          and
          exp
           exp
            prefixexp
             b
           ==
           exp
            number
             10
        )
     stat
      local
      attnamelist
       a
       attrib
       ,
       b
       attrib
      =
      explist
       exp
        prefixexp
         functioncall
          T
          .
          testC
          args
           (
           explist
            exp
             string
              "compare EQ 2 3; pushint 10; return 2"
            ,
            exp
             prefixexp
              functioncall
               O
               args
                (
                explist
                 exp
                  number
                   3
                )
            ,
            exp
             prefixexp
              functioncall
               O
               args
                (
                explist
                 exp
                  number
                   3
                )
           )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           exp
            prefixexp
             a
           ==
           exp
            true
          and
          exp
           exp
            prefixexp
             b
           ==
           exp
            number
             10
        )
    end
   stat
    local
    attnamelist
     t
     attrib
    =
    explist
     exp
      prefixexp
       functioncall
        setmetatable
        args
         (
         explist
          exp
           tableconstructor
            {
            fieldlist
             field
              x
              =
              exp
               number
                20
            }
          ,
          exp
           tableconstructor
            {
            fieldlist
             field
              __len
              =
              exp
               functiondef
                function
                funcbody
                 (
                 parlist
                  namelist
                   t
                 )
                 block
                  retstat
                   return
                   explist
                    exp
                     prefixexp
                      t
                      .
                      x
                 end
            }
         )
   stat
    varlist
     var
      a
     ,
     var
      b
     ,
     var
      c
    =
    explist
     exp
      prefixexp
       functioncall
        T
        .
        testC
        args
         (
         explist
          exp
           string
            [[\n   len 2;\n   Llen 2;\n   objsize 2;\n   return 3\n]]
          ,
          exp
           prefixexp
            t
         )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         exp
          exp
           prefixexp
            a
          ==
          exp
           number
            20
         and
         exp
          exp
           prefixexp
            b
          ==
          exp
           number
            20
        and
        exp
         exp
          prefixexp
           c
         ==
         exp
          number
           0
      )
   stat
    varlist
     var
      prefixexp
       t
      .
      x
    =
    explist
     exp
      string
       "234"
   stat
    ;
   stat
    varlist
     var
      prefixexp
       t
      [
      exp
       number
        1
      ]
    =
    explist
     exp
      number
       20
   stat
    varlist
     var
      a
     ,
     var
      b
     ,
     var
      c
    =
    explist
     exp
      prefixexp
       functioncall
        T
        .
        testC
        args
         (
         explist
          exp
           string
            [[\n   len 2;\n   Llen 2;\n   objsize 2;\n   return 3\n]]
          ,
          exp
           prefixexp
            t
         )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         exp
          exp
           prefixexp
            a
          ==
          exp
           string
            "234"
         and
         exp
          exp
           prefixexp
            b
          ==
          exp
           number
            234
        and
        exp
         exp
          prefixexp
           c
         ==
         exp
          number
           1
      )
   stat
    varlist
     var
      prefixexp
       t
      .
      x
    =
    explist
     exp
      prefixexp
       print
   stat
    ;
   stat
    varlist
     var
      prefixexp
       t
      [
      exp
       number
        1
      ]
    =
    explist
     exp
      number
       20
   stat
    varlist
     var
      a
     ,
     var
      c
    =
    explist
     exp
      prefixexp
       functioncall
        T
        .
        testC
        args
         (
         explist
          exp
           string
            [[\n   len 2;\n   objsize 2;\n   return 2\n]]
          ,
          exp
           prefixexp
            t
         )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         exp
          prefixexp
           a
         ==
         exp
          prefixexp
           print
        and
        exp
         exp
          prefixexp
           c
         ==
         exp
          number
           1
      )
   stat
    varlist
     var
      a
    =
    explist
     exp
      prefixexp
       functioncall
        setmetatable
        args
         (
         explist
          exp
           tableconstructor
            {
            fieldlist
             field
              x
              =
              exp
               string
                "u"
            }
          ,
          exp
           tableconstructor
            {
            fieldlist
             field
              __concat
              =
              exp
               functiondef
                function
                funcbody
                 (
                 parlist
                  namelist
                   a
                   ,
                   b
                 )
                 block
                  retstat
                   return
                   explist
                    exp
                     exp
                      prefixexp
                       a
                       .
                       x
                     ..
                     exp
                      exp
                       string
                        '.'
                      ..
                      exp
                       prefixexp
                        b
                        .
                        x
                 end
            }
         )
   stat
    varlist
     var
      x
     ,
     var
      y
    =
    explist
     exp
      prefixexp
       functioncall
        T
        .
        testC
        args
         (
         explist
          exp
           string
            [[\n  pushnum 5\n  pushvalue 2;\n  pushvalue 2;\n  concat 2;\n  pushvalue -2;\n  return 2;\n]]
          ,
          exp
           prefixexp
            a
          ,
          exp
           prefixexp
            a
         )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         exp
          prefixexp
           x
         ==
         exp
          exp
           prefixexp
            a
          ..
          exp
           prefixexp
            a
        and
        exp
         exp
          prefixexp
           y
         ==
         exp
          number
           5
      )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         prefixexp
          functioncall
           T
           .
           testC
           args
            (
            explist
             exp
              string
               "concat 0; return 1"
            )
        ==
        exp
         string
          ""
      )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         prefixexp
          functioncall
           T
           .
           testC
           args
            (
            explist
             exp
              string
               "concat 1; return 1"
             ,
             exp
              string
               "xuxu"
            )
        ==
        exp
         string
          "xuxu"
      )
   stat
    local
    function
    B
    funcbody
     (
     parlist
      namelist
       x
     )
     block
      retstat
       return
       explist
        exp
         exp
          exp
           prefixexp
            x
          and
          exp
           number
            1
         or
         exp
          number
           0
     end
   stat
    local
    function
    count
    funcbody
     (
     parlist
      namelist
       x
       ,
       n
     )
     block
      stat
       varlist
        var
         n
       =
       explist
        exp
         exp
          prefixexp
           n
         or
         exp
          number
           2
      stat
       local
       attnamelist
        prog
        attrib
       =
       explist
        exp
         string
          [[\n    isnumber %d;\n    isstring %d;\n    isfunction %d;\n    iscfunction %d;\n    istable %d;\n    isuserdata %d;\n    isnil %d;\n    isnull %d;\n    return 8\n  ]]
      stat
       varlist
        var
         prog
       =
       explist
        exp
         prefixexp
          functioncall
           string
           .
           format
           args
            (
            explist
             exp
              prefixexp
               prog
             ,
             exp
              prefixexp
               n
             ,
             exp
              prefixexp
               n
             ,
             exp
              prefixexp
               n
             ,
             exp
              prefixexp
               n
             ,
             exp
              prefixexp
               n
             ,
             exp
              prefixexp
               n
             ,
             exp
              prefixexp
               n
             ,
             exp
              prefixexp
               n
            )
      stat
       local
       attnamelist
        a
        attrib
        ,
        b
        attrib
        ,
        c
        attrib
        ,
        d
        attrib
        ,
        e
        attrib
        ,
        f
        attrib
        ,
        g
        attrib
        ,
        h
        attrib
       =
       explist
        exp
         prefixexp
          functioncall
           T
           .
           testC
           args
            (
            explist
             exp
              prefixexp
               prog
             ,
             exp
              prefixexp
               x
            )
      retstat
       return
       explist
        exp
         exp
          exp
           exp
            exp
             exp
              exp
               exp
                prefixexp
                 functioncall
                  B
                  args
                   (
                   explist
                    exp
                     prefixexp
                      a
                   )
               +
               exp
                prefixexp
                 functioncall
                  B
                  args
                   (
                   explist
                    exp
                     prefixexp
                      b
                   )
              +
              exp
               prefixexp
                functioncall
                 B
                 args
                  (
                  explist
                   exp
                    prefixexp
                     c
                  )
             +
             exp
              prefixexp
               functioncall
                B
                args
                 (
                 explist
                  exp
                   prefixexp
                    d
                 )
            +
            exp
             prefixexp
              functioncall
               B
               args
                (
                explist
                 exp
                  prefixexp
                   e
                )
           +
           exp
            prefixexp
             functioncall
              B
              args
               (
               explist
                exp
                 prefixexp
                  f
               )
          +
          exp
           prefixexp
            functioncall
             B
             args
              (
              explist
               exp
                prefixexp
                 g
              )
         +
         exp
          prefixexp
           (
           exp
            exp
             number
              100
            *
            exp
             prefixexp
              functioncall
               B
               args
                (
                explist
                 exp
                  prefixexp
                   h
                )
           )
     end
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         prefixexp
          functioncall
           count
           args
            (
            explist
             exp
              number
               3
            )
        ==
        exp
         number
          2
      )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         prefixexp
          functioncall
           count
           args
            (
            explist
             exp
              string
               'alo'
            )
        ==
        exp
         number
          1
      )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         prefixexp
          functioncall
           count
           args
            (
            explist
             exp
              string
               '32'
            )
        ==
        exp
         number
          2
      )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         prefixexp
          functioncall
           count
           args
            (
            explist
             exp
              tableconstructor
               {
               }
            )
        ==
        exp
         number
          1
      )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         prefixexp
          functioncall
           count
           args
            (
            explist
             exp
              prefixexp
               print
            )
        ==
        exp
         number
          2
      )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         prefixexp
          functioncall
           count
           args
            (
            explist
             exp
              functiondef
               function
               funcbody
                (
                parlist
                )
                block
                end
            )
        ==
        exp
         number
          1
      )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         prefixexp
          functioncall
           count
           args
            (
            explist
             exp
              nil
            )
        ==
        exp
         number
          1
      )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         prefixexp
          functioncall
           count
           args
            (
            explist
             exp
              prefixexp
               io
               .
               stdin
            )
        ==
        exp
         number
          1
      )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         prefixexp
          functioncall
           count
           args
            (
            explist
             exp
              nil
             ,
             exp
              number
               15
            )
        ==
        exp
         number
          100
      )
   stat
    local
    function
    to
    funcbody
     (
     parlist
      namelist
       s
       ,
       x
       ,
       n
     )
     block
      stat
       varlist
        var
         n
       =
       explist
        exp
         exp
          prefixexp
           n
         or
         exp
          number
           2
      retstat
       return
       explist
        exp
         prefixexp
          functioncall
           T
           .
           testC
           args
            (
            explist
             exp
              prefixexp
               functioncall
                string
                .
                format
                args
                 (
                 explist
                  exp
                   string
                    "%s %d; return 1"
                  ,
                  exp
                   prefixexp
                    s
                  ,
                  exp
                   prefixexp
                    n
                 )
             ,
             exp
              prefixexp
               x
            )
     end
   stat
    local
    attnamelist
     null
     attrib
    =
    explist
     exp
      prefixexp
       functioncall
        T
        .
        pushuserdata
        args
         (
         explist
          exp
           number
            0
         )
   stat
    local
    attnamelist
     hfunc
     attrib
    =
    explist
     exp
      prefixexp
       functioncall
        string
        .
        gmatch
        args
         (
         explist
          exp
           string
            ""
          ,
          exp
           string
            ""
         )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        prefixexp
         functioncall
          debug
          .
          getupvalue
          args
           (
           explist
            exp
             prefixexp
              hfunc
            ,
            exp
             number
              1
           )
      )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         prefixexp
          functioncall
           to
           args
            (
            explist
             exp
              string
               "tostring"
             ,
             exp
              tableconstructor
               {
               }
            )
        ==
        exp
         nil
      )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         prefixexp
          functioncall
           to
           args
            (
            explist
             exp
              string
               "tostring"
             ,
             exp
              string
               "alo"
            )
        ==
        exp
         string
          "alo"
      )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         prefixexp
          functioncall
           to
           args
            (
            explist
             exp
              string
               "tostring"
             ,
             exp
              number
               12
            )
        ==
        exp
         string
          "12"
      )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         prefixexp
          functioncall
           to
           args
            (
            explist
             exp
              string
               "tostring"
             ,
             exp
              number
               12
             ,
             exp
              number
               3
            )
        ==
        exp
         nil
      )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         prefixexp
          functioncall
           to
           args
            (
            explist
             exp
              string
               "objsize"
             ,
             exp
              tableconstructor
               {
               }
            )
        ==
        exp
         number
          0
      )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         prefixexp
          functioncall
           to
           args
            (
            explist
             exp
              string
               "objsize"
             ,
             exp
              tableconstructor
               {
               fieldlist
                field
                 exp
                  number
                   1
                fieldsep
                 ,
                field
                 exp
                  number
                   2
                fieldsep
                 ,
                field
                 exp
                  number
                   3
               }
            )
        ==
        exp
         number
          3
      )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         prefixexp
          functioncall
           to
           args
            (
            explist
             exp
              string
               "objsize"
             ,
             exp
              string
               "alo\0\0a"
            )
        ==
        exp
         number
          6
      )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         prefixexp
          functioncall
           to
           args
            (
            explist
             exp
              string
               "objsize"
             ,
             exp
              prefixexp
               functioncall
                T
                .
                newuserdata
                args
                 (
                 explist
                  exp
                   number
                    0
                 )
            )
        ==
        exp
         number
          0
      )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         prefixexp
          functioncall
           to
           args
            (
            explist
             exp
              string
               "objsize"
             ,
             exp
              prefixexp
               functioncall
                T
                .
                newuserdata
                args
                 (
                 explist
                  exp
                   number
                    101
                 )
            )
        ==
        exp
         number
          101
      )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         prefixexp
          functioncall
           to
           args
            (
            explist
             exp
              string
               "objsize"
             ,
             exp
              number
               124
            )
        ==
        exp
         number
          0
      )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         prefixexp
          functioncall
           to
           args
            (
            explist
             exp
              string
               "objsize"
             ,
             exp
              true
            )
        ==
        exp
         number
          0
      )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         prefixexp
          functioncall
           to
           args
            (
            explist
             exp
              string
               "tonumber"
             ,
             exp
              tableconstructor
               {
               }
            )
        ==
        exp
         number
          0
      )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         prefixexp
          functioncall
           to
           args
            (
            explist
             exp
              string
               "tonumber"
             ,
             exp
              string
               "12"
            )
        ==
        exp
         number
          12
      )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         prefixexp
          functioncall
           to
           args
            (
            explist
             exp
              string
               "tonumber"
             ,
             exp
              string
               "s2"
            )
        ==
        exp
         number
          0
      )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         prefixexp
          functioncall
           to
           args
            (
            explist
             exp
              string
               "tonumber"
             ,
             exp
              number
               1
             ,
             exp
              number
               20
            )
        ==
        exp
         number
          0
      )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         prefixexp
          functioncall
           to
           args
            (
            explist
             exp
              string
               "topointer"
             ,
             exp
              number
               10
            )
        ==
        exp
         prefixexp
          null
      )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         prefixexp
          functioncall
           to
           args
            (
            explist
             exp
              string
               "topointer"
             ,
             exp
              true
            )
        ==
        exp
         prefixexp
          null
      )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         prefixexp
          functioncall
           to
           args
            (
            explist
             exp
              string
               "topointer"
             ,
             exp
              nil
            )
        ==
        exp
         prefixexp
          null
      )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         prefixexp
          functioncall
           to
           args
            (
            explist
             exp
              string
               "topointer"
             ,
             exp
              string
               "abc"
            )
        ~=
        exp
         prefixexp
          null
      )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         prefixexp
          functioncall
           to
           args
            (
            explist
             exp
              string
               "topointer"
             ,
             exp
              prefixexp
               functioncall
                string
                .
                rep
                args
                 (
                 explist
                  exp
                   string
                    "x"
                  ,
                  exp
                   number
                    10
                 )
            )
        ==
        exp
         prefixexp
          functioncall
           to
           args
            (
            explist
             exp
              string
               "topointer"
             ,
             exp
              prefixexp
               functioncall
                string
                .
                rep
                args
                 (
                 explist
                  exp
                   string
                    "x"
                  ,
                  exp
                   number
                    10
                 )
            )
      )
   stat
    do
    block
     stat
      local
      attnamelist
       s1
       attrib
      =
      explist
       exp
        prefixexp
         functioncall
          string
          .
          rep
          args
           (
           explist
            exp
             string
              "x"
            ,
            exp
             number
              300
           )
     stat
      local
      attnamelist
       s2
       attrib
      =
      explist
       exp
        prefixexp
         functioncall
          string
          .
          rep
          args
           (
           explist
            exp
             string
              "x"
            ,
            exp
             number
              300
           )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           prefixexp
            functioncall
             to
             args
              (
              explist
               exp
                string
                 "topointer"
               ,
               exp
                prefixexp
                 s1
              )
          ~=
          exp
           prefixexp
            functioncall
             to
             args
              (
              explist
               exp
                string
                 "topointer"
               ,
               exp
                prefixexp
                 s2
              )
        )
    end
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         prefixexp
          functioncall
           to
           args
            (
            explist
             exp
              string
               "topointer"
             ,
             exp
              prefixexp
               functioncall
                T
                .
                pushuserdata
                args
                 (
                 explist
                  exp
                   number
                    20
                 )
            )
        ~=
        exp
         prefixexp
          null
      )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         prefixexp
          functioncall
           to
           args
            (
            explist
             exp
              string
               "topointer"
             ,
             exp
              prefixexp
               io
               .
               read
            )
        ~=
        exp
         prefixexp
          null
      )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         prefixexp
          functioncall
           to
           args
            (
            explist
             exp
              string
               "topointer"
             ,
             exp
              prefixexp
               hfunc
            )
        ~=
        exp
         prefixexp
          null
      )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         prefixexp
          functioncall
           to
           args
            (
            explist
             exp
              string
               "topointer"
             ,
             exp
              functiondef
               function
               funcbody
                (
                parlist
                )
                block
                end
            )
        ~=
        exp
         prefixexp
          null
      )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         prefixexp
          functioncall
           to
           args
            (
            explist
             exp
              string
               "topointer"
             ,
             exp
              prefixexp
               io
               .
               stdin
            )
        ~=
        exp
         prefixexp
          null
      )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         prefixexp
          functioncall
           to
           args
            (
            explist
             exp
              string
               "func2num"
             ,
             exp
              number
               20
            )
        ==
        exp
         number
          0
      )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         prefixexp
          functioncall
           to
           args
            (
            explist
             exp
              string
               "func2num"
             ,
             exp
              prefixexp
               functioncall
                T
                .
                pushuserdata
                args
                 (
                 explist
                  exp
                   number
                    10
                 )
            )
        ==
        exp
         number
          0
      )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         prefixexp
          functioncall
           to
           args
            (
            explist
             exp
              string
               "func2num"
             ,
             exp
              prefixexp
               io
               .
               read
            )
        ~=
        exp
         number
          0
      )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         prefixexp
          functioncall
           to
           args
            (
            explist
             exp
              string
               "func2num"
             ,
             exp
              prefixexp
               hfunc
            )
        ~=
        exp
         number
          0
      )
   stat
    varlist
     var
      a
    =
    explist
     exp
      prefixexp
       functioncall
        to
        args
         (
         explist
          exp
           string
            "tocfunction"
          ,
          exp
           prefixexp
            math
            .
            deg
         )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         exp
          prefixexp
           functioncall
            a
            args
             (
             explist
              exp
               number
                3
             )
         ==
         exp
          prefixexp
           functioncall
            math
            .
            deg
            args
             (
             explist
              exp
               number
                3
             )
        and
        exp
         exp
          prefixexp
           a
         ==
         exp
          prefixexp
           math
           .
           deg
      )
   stat
    functioncall
     print
     args
      (
      explist
       exp
        string
         "testing panic function"
      )
   stat
    do
    block
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           prefixexp
            functioncall
             T
             .
             checkpanic
             args
              (
              explist
               exp
                string
                 "pushstring hi; error"
              )
          ==
          exp
           string
            "hi"
        )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           prefixexp
            functioncall
             T
             .
             checkpanic
             args
              (
              explist
               exp
                string
                 "pushstring hi; error;"
               ,
               exp
                string
                 [[checkstack 5 XX\n      pushstring ' alo'\n      pushstring ' mundo'\n      concat 3]]
              )
          ==
          exp
           string
            "hi alo mundo"
        )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           prefixexp
            functioncall
             T
             .
             checkpanic
             args
              (
              explist
               exp
                string
                 "loadstring 4"
              )
          ==
          exp
           string
            "bad argument #4 (string expected, got no value)"
        )
     stat
      functioncall
       T
       .
       totalmem
       args
        (
        explist
         exp
          exp
           prefixexp
            functioncall
             T
             .
             totalmem
             args
              (
              )
          +
          exp
           number
            10000
        )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           prefixexp
            functioncall
             T
             .
             checkpanic
             args
              (
              explist
               exp
                string
                 "newuserdata 20000"
              )
          ==
          exp
           prefixexp
            MEMERRMSG
        )
     stat
      functioncall
       T
       .
       totalmem
       args
        (
        explist
         exp
          number
           0
        )
     stat
      if
      exp
       not
       exp
        prefixexp
         _soft
      then
      block
       stat
        local
        attnamelist
         msg
         attrib
        =
        explist
         exp
          prefixexp
           functioncall
            T
            .
            checkpanic
            args
             string
              [[\n      pushstring "function f() f() end"\n      loadstring -1; call 0 0\n      getglobal f; call 0 0\n    ]]
       stat
        functioncall
         assert
         args
          (
          explist
           exp
            prefixexp
             functioncall
              string
              .
              find
              args
               (
               explist
                exp
                 prefixexp
                  msg
                ,
                exp
                 string
                  "stack overflow"
               )
          )
      end
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           prefixexp
            functioncall
             T
             .
             checkpanic
             args
              (
              explist
               exp
                string
                 [[\n    pushstring "return {__close = function () Y = 'ho'; end}"\n    newtable\n    loadstring -2\n    call 0 1\n    setmetatable -2\n    toclose -1\n    pushstring "hi"\n    error\n  ]]
               ,
               exp
                string
                 [[\n    getglobal Y\n    concat 2         # concat original error with global Y\n  ]]
              )
          ==
          exp
           string
            "hiho"
        )
    end
   stat
    if
    exp
     not
     exp
      prefixexp
       _soft
    then
    block
     stat
      functioncall
       print
       args
        (
        explist
         exp
          string
           "testing stack overflow"
        )
     stat
      functioncall
       collectgarbage
       args
        (
        explist
         exp
          string
           "stop"
        )
     stat
      functioncall
       checkerr
       args
        (
        explist
         exp
          string
           "XXXX"
         ,
         exp
          prefixexp
           T
           .
           testC
         ,
         exp
          string
           "checkstack 1000023 XXXX"
        )
     stat
      functioncall
       checkerr
       args
        (
        explist
         exp
          string
           "^stack overflow$"
         ,
         exp
          prefixexp
           T
           .
           testC
         ,
         exp
          string
           "checkstack 1000023 ''"
        )
     stat
      local
      attnamelist
       s
       attrib
      =
      explist
       exp
        prefixexp
         functioncall
          string
          .
          rep
          args
           (
           explist
            exp
             string
              "pushnil;checkstack 1 XX;"
            ,
            exp
             number
              1000000
           )
     stat
      functioncall
       checkerr
       args
        (
        explist
         exp
          string
           "overflow"
         ,
         exp
          prefixexp
           T
           .
           testC
         ,
         exp
          prefixexp
           s
        )
     stat
      functioncall
       collectgarbage
       args
        (
        explist
         exp
          string
           "restart"
        )
     stat
      functioncall
       print
       args
        string
         '+'
    end
   stat
    local
    attnamelist
     lim
     attrib
    =
    explist
     exp
      exp
       exp
        prefixexp
         _soft
       and
       exp
        number
         500
      or
      exp
       number
        12000
   stat
    local
    attnamelist
     prog
     attrib
    =
    explist
     exp
      tableconstructor
       {
       fieldlist
        field
         exp
          exp
           string
            "checkstack "
          ..
          exp
           exp
            prefixexp
             (
             exp
              exp
               exp
                prefixexp
                 lim
               *
               exp
                number
                 2
              +
              exp
               number
                100
             )
           ..
           exp
            string
             "msg"
        fieldsep
         ,
        field
         exp
          string
           "newtable"
       }
   stat
    for
    i
    =
    exp
     number
      1
    ,
    exp
     prefixexp
      lim
    do
    block
     stat
      varlist
       var
        prefixexp
         prog
        [
        exp
         exp
          #
          exp
           prefixexp
            prog
         +
         exp
          number
           1
        ]
      =
      explist
       exp
        exp
         string
          "pushnum "
        ..
        exp
         prefixexp
          i
     stat
      varlist
       var
        prefixexp
         prog
        [
        exp
         exp
          #
          exp
           prefixexp
            prog
         +
         exp
          number
           1
        ]
      =
      explist
       exp
        exp
         string
          "pushnum "
        ..
        exp
         exp
          prefixexp
           i
         *
         exp
          number
           10
    end
   stat
    varlist
     var
      prefixexp
       prog
      [
      exp
       exp
        #
        exp
         prefixexp
          prog
       +
       exp
        number
         1
      ]
    =
    explist
     exp
      string
       "rawgeti R 2"
   stat
    varlist
     var
      prefixexp
       prog
      [
      exp
       exp
        #
        exp
         prefixexp
          prog
       +
       exp
        number
         1
      ]
    =
    explist
     exp
      exp
       string
        "insert "
      ..
      exp
       -
       exp
        prefixexp
         (
         exp
          exp
           exp
            number
             2
           *
           exp
            prefixexp
             lim
          +
          exp
           number
            2
         )
   stat
    for
    i
    =
    exp
     number
      1
    ,
    exp
     prefixexp
      lim
    do
    block
     stat
      varlist
       var
        prefixexp
         prog
        [
        exp
         exp
          #
          exp
           prefixexp
            prog
         +
         exp
          number
           1
        ]
      =
      explist
       exp
        exp
         string
          "settable "
        ..
        exp
         -
         exp
          prefixexp
           (
           exp
            exp
             exp
              number
               2
             *
             exp
              prefixexp
               (
               exp
                exp
                 exp
                  prefixexp
                   lim
                 -
                 exp
                  prefixexp
                   i
                +
                exp
                 number
                  1
               )
            +
            exp
             number
              1
           )
    end
   stat
    varlist
     var
      prefixexp
       prog
      [
      exp
       exp
        #
        exp
         prefixexp
          prog
       +
       exp
        number
         1
      ]
    =
    explist
     exp
      string
       "return 2"
   stat
    varlist
     var
      prog
    =
    explist
     exp
      prefixexp
       functioncall
        table
        .
        concat
        args
         (
         explist
          exp
           prefixexp
            prog
          ,
          exp
           string
            ";"
         )
   stat
    local
    attnamelist
     g
     attrib
     ,
     t
     attrib
    =
    explist
     exp
      prefixexp
       functioncall
        T
        .
        testC
        args
         (
         explist
          exp
           prefixexp
            prog
         )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         prefixexp
          g
        ==
        exp
         prefixexp
          _G
      )
   stat
    for
    i
    =
    exp
     number
      1
    ,
    exp
     prefixexp
      lim
    do
    block
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           prefixexp
            t
            [
            exp
             prefixexp
              i
            ]
          ==
          exp
           exp
            prefixexp
             i
           *
           exp
            number
             10
        )
     stat
      ;
     stat
      varlist
       var
        prefixexp
         t
        [
        exp
         prefixexp
          i
        ]
      =
      explist
       exp
        prefixexp
         undef
    end
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         prefixexp
          functioncall
           next
           args
            (
            explist
             exp
              prefixexp
               t
            )
        ==
        exp
         nil
      )
   stat
    varlist
     var
      prog
     ,
     var
      g
     ,
     var
      t
    =
    explist
     exp
      nil
   stat
    varlist
     var
      a
    =
    explist
     exp
      prefixexp
       functioncall
        T
        .
        testC
        args
         (
         explist
          exp
           string
            [[\n  loadstring 2; pcall 0 1 0;\n  pushvalue 3; insert -2; pcall 1 1 0;\n  pcall 0 0 0;\n  return 1\n]]
          ,
          exp
           string
            "XX=150"
          ,
          exp
           functiondef
            function
            funcbody
             (
             parlist
              namelist
               a
             )
             block
              stat
               functioncall
                assert
                args
                 (
                 explist
                  exp
                   exp
                    prefixexp
                     a
                   ==
                   exp
                    nil
                 )
              stat
               ;
              retstat
               return
               explist
                exp
                 number
                  3
             end
         )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         exp
          prefixexp
           functioncall
            type
            args
             (
             explist
              exp
               prefixexp
                a
             )
         ==
         exp
          string
           'string'
        and
        exp
         exp
          prefixexp
           XX
         ==
         exp
          number
           150
      )
   stat
    varlist
     var
      prefixexp
       _G
      .
      XX
    =
    explist
     exp
      nil
   stat
    local
    function
    check3
    funcbody
     (
     parlist
      namelist
       p
      ,
      ...
     )
     block
      stat
       local
       attnamelist
        arg
        attrib
       =
       explist
        exp
         tableconstructor
          {
          fieldlist
           field
            exp
             ...
          }
      stat
       functioncall
        assert
        args
         (
         explist
          exp
           exp
            #
            exp
             prefixexp
              arg
           ==
           exp
            number
             3
         )
      stat
       functioncall
        assert
        args
         (
         explist
          exp
           prefixexp
            functioncall
             string
             .
             find
             args
              (
              explist
               exp
                prefixexp
                 arg
                 [
                 exp
                  number
                   3
                 ]
               ,
               exp
                prefixexp
                 p
              )
         )
     end
   stat
    functioncall
     check3
     args
      (
      explist
       exp
        string
         ":1:"
       ,
       exp
        prefixexp
         functioncall
          T
          .
          testC
          args
           (
           explist
            exp
             string
              "loadstring 2; return *"
            ,
            exp
             string
              "x="
           )
      )
   stat
    functioncall
     check3
     args
      (
      explist
       exp
        string
         "%."
       ,
       exp
        prefixexp
         functioncall
          T
          .
          testC
          args
           (
           explist
            exp
             string
              "loadfile 2; return *"
            ,
            exp
             string
              "."
           )
      )
   stat
    functioncall
     check3
     args
      (
      explist
       exp
        string
         "xxxx"
       ,
       exp
        prefixexp
         functioncall
          T
          .
          testC
          args
           (
           explist
            exp
             string
              "loadfile 2; return *"
            ,
            exp
             string
              "xxxx"
           )
      )
   stat
    local
    function
    checkerrnopro
    funcbody
     (
     parlist
      namelist
       code
       ,
       msg
     )
     block
      stat
       local
       attnamelist
        th
        attrib
       =
       explist
        exp
         prefixexp
          functioncall
           coroutine
           .
           create
           args
            (
            explist
             exp
              functiondef
               function
               funcbody
                (
                parlist
                )
                block
                end
            )
      stat
       local
       attnamelist
        stt
        attrib
        ,
        err
        attrib
       =
       explist
        exp
         prefixexp
          functioncall
           pcall
           args
            (
            explist
             exp
              prefixexp
               T
               .
               testC
             ,
             exp
              prefixexp
               th
             ,
             exp
              prefixexp
               code
            )
      stat
       functioncall
        assert
        args
         (
         explist
          exp
           exp
            not
            exp
             prefixexp
              stt
           and
           exp
            prefixexp
             functioncall
              string
              .
              find
              args
               (
               explist
                exp
                 prefixexp
                  err
                ,
                exp
                 prefixexp
                  msg
               )
         )
     end
   stat
    if
    exp
     not
     exp
      prefixexp
       _soft
    then
    block
     stat
      functioncall
       collectgarbage
       args
        (
        explist
         exp
          string
           "stop"
        )
     stat
      functioncall
       checkerrnopro
       args
        (
        explist
         exp
          string
           "pushnum 3; call 0 0"
         ,
         exp
          string
           "attempt to call"
        )
     stat
      functioncall
       print
       args
        string
         "testing stack overflow in unprotected thread"
     stat
      function
      funcname
       F
      funcbody
       (
       parlist
       )
       block
        stat
         functioncall
          F
          args
           (
           )
       end
     stat
      functioncall
       checkerrnopro
       args
        (
        explist
         exp
          string
           "getglobal 'F'; call 0 0;"
         ,
         exp
          string
           "stack overflow"
        )
     stat
      varlist
       var
        F
      =
      explist
       exp
        nil
     stat
      functioncall
       collectgarbage
       args
        (
        explist
         exp
          string
           "restart"
        )
    end
   stat
    functioncall
     print
     args
      string
       "+"
   stat
    do
    block
     stat
      local
      attnamelist
       a
       attrib
      =
      explist
       exp
        tableconstructor
         {
         }
     stat
      local
      attnamelist
       a1
       attrib
      =
      explist
       exp
        prefixexp
         functioncall
          T
          .
          testC
          args
           (
           explist
            exp
             string
              "rawsetp 2 1; return 1"
            ,
            exp
             prefixexp
              a
            ,
            exp
             number
              20
           )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           prefixexp
            a
          ==
          exp
           prefixexp
            a1
        )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           prefixexp
            a
            [
            exp
             prefixexp
              functioncall
               T
               .
               pushuserdata
               args
                (
                explist
                 exp
                  number
                   1
                )
            ]
          ==
          exp
           number
            20
        )
     stat
      local
      attnamelist
       a1
       attrib
       ,
       res
       attrib
      =
      explist
       exp
        prefixexp
         functioncall
          T
          .
          testC
          args
           (
           explist
            exp
             string
              "rawgetp -1 1; return 2"
            ,
            exp
             prefixexp
              a
           )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           exp
            prefixexp
             a
           ==
           exp
            prefixexp
             a1
          and
          exp
           exp
            prefixexp
             res
           ==
           exp
            number
             20
        )
    end
   stat
    do
    block
     stat
      local
      attnamelist
       a
       attrib
      =
      explist
       exp
        tableconstructor
         {
         }
     stat
      varlist
       var
        prefixexp
         a
        [
        exp
         prefixexp
          a
        ]
      =
      explist
       exp
        number
         10
     stat
      local
      attnamelist
       prog
       attrib
      =
      explist
       exp
        string
         "gettable -1; return *"
     stat
      local
      attnamelist
       res
       attrib
      =
      explist
       exp
        tableconstructor
         {
         fieldlist
          field
           exp
            prefixexp
             functioncall
              T
              .
              testC
              args
               (
               explist
                exp
                 prefixexp
                  prog
                ,
                exp
                 prefixexp
                  a
               )
         }
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           exp
            exp
             #
             exp
              prefixexp
               res
            ==
            exp
             number
              2
           and
           exp
            exp
             prefixexp
              res
              [
              exp
               number
                1
              ]
            ==
            exp
             prefixexp
              prog
          and
          exp
           exp
            prefixexp
             res
             [
             exp
              number
               2
             ]
           ==
           exp
            number
             10
        )
     stat
      local
      attnamelist
       prog
       attrib
      =
      explist
       exp
        string
         "settable -2; return *"
     stat
      local
      attnamelist
       res
       attrib
      =
      explist
       exp
        tableconstructor
         {
         fieldlist
          field
           exp
            prefixexp
             functioncall
              T
              .
              testC
              args
               (
               explist
                exp
                 prefixexp
                  prog
                ,
                exp
                 prefixexp
                  a
                ,
                exp
                 number
                  20
               )
         }
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           prefixexp
            a
            [
            exp
             prefixexp
              a
            ]
          ==
          exp
           number
            20
        )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           exp
            #
            exp
             prefixexp
              res
           ==
           exp
            number
             1
          and
          exp
           exp
            prefixexp
             res
             [
             exp
              number
               1
             ]
           ==
           exp
            prefixexp
             prog
        )
     stat
      varlist
       var
        prefixexp
         a
        [
        exp
         prefixexp
          a
        ]
      =
      explist
       exp
        number
         10
     stat
      local
      attnamelist
       prog
       attrib
      =
      explist
       exp
        string
         "rawget -1; return *"
     stat
      local
      attnamelist
       res
       attrib
      =
      explist
       exp
        tableconstructor
         {
         fieldlist
          field
           exp
            prefixexp
             functioncall
              T
              .
              testC
              args
               (
               explist
                exp
                 prefixexp
                  prog
                ,
                exp
                 prefixexp
                  a
               )
         }
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           exp
            exp
             #
             exp
              prefixexp
               res
            ==
            exp
             number
              2
           and
           exp
            exp
             prefixexp
              res
              [
              exp
               number
                1
              ]
            ==
            exp
             prefixexp
              prog
          and
          exp
           exp
            prefixexp
             res
             [
             exp
              number
               2
             ]
           ==
           exp
            number
             10
        )
     stat
      local
      attnamelist
       prog
       attrib
      =
      explist
       exp
        string
         "rawset -2; return *"
     stat
      local
      attnamelist
       res
       attrib
      =
      explist
       exp
        tableconstructor
         {
         fieldlist
          field
           exp
            prefixexp
             functioncall
              T
              .
              testC
              args
               (
               explist
                exp
                 prefixexp
                  prog
                ,
                exp
                 prefixexp
                  a
                ,
                exp
                 number
                  20
               )
         }
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           prefixexp
            a
            [
            exp
             prefixexp
              a
            ]
          ==
          exp
           number
            20
        )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           exp
            #
            exp
             prefixexp
              res
           ==
           exp
            number
             1
          and
          exp
           exp
            prefixexp
             res
             [
             exp
              number
               1
             ]
           ==
           exp
            prefixexp
             prog
        )
     stat
      local
      attnamelist
       prog
       attrib
      =
      explist
       exp
        string
         "rawset -1; return *"
     stat
      local
      attnamelist
       res
       attrib
      =
      explist
       exp
        tableconstructor
         {
         fieldlist
          field
           exp
            prefixexp
             functioncall
              T
              .
              testC
              args
               (
               explist
                exp
                 prefixexp
                  prog
                ,
                exp
                 number
                  30
                ,
                exp
                 prefixexp
                  a
               )
         }
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           prefixexp
            a
            [
            exp
             number
              30
            ]
          ==
          exp
           prefixexp
            a
        )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           exp
            #
            exp
             prefixexp
              res
           ==
           exp
            number
             1
          and
          exp
           exp
            prefixexp
             res
             [
             exp
              number
               1
             ]
           ==
           exp
            prefixexp
             prog
        )
     stat
      local
      attnamelist
       prog
       attrib
      =
      explist
       exp
        string
         "settable -1; return *"
     stat
      local
      attnamelist
       res
       attrib
      =
      explist
       exp
        tableconstructor
         {
         fieldlist
          field
           exp
            prefixexp
             functioncall
              T
              .
              testC
              args
               (
               explist
                exp
                 prefixexp
                  prog
                ,
                exp
                 number
                  40
                ,
                exp
                 prefixexp
                  a
               )
         }
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           prefixexp
            a
            [
            exp
             number
              40
            ]
          ==
          exp
           prefixexp
            a
        )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           exp
            #
            exp
             prefixexp
              res
           ==
           exp
            number
             1
          and
          exp
           exp
            prefixexp
             res
             [
             exp
              number
               1
             ]
           ==
           exp
            prefixexp
             prog
        )
     stat
      local
      attnamelist
       prog
       attrib
      =
      explist
       exp
        string
         "rawseti -1 100; return *"
     stat
      local
      attnamelist
       res
       attrib
      =
      explist
       exp
        tableconstructor
         {
         fieldlist
          field
           exp
            prefixexp
             functioncall
              T
              .
              testC
              args
               (
               explist
                exp
                 prefixexp
                  prog
                ,
                exp
                 prefixexp
                  a
               )
         }
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           prefixexp
            a
            [
            exp
             number
              100
            ]
          ==
          exp
           prefixexp
            a
        )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           exp
            #
            exp
             prefixexp
              res
           ==
           exp
            number
             1
          and
          exp
           exp
            prefixexp
             res
             [
             exp
              number
               1
             ]
           ==
           exp
            prefixexp
             prog
        )
     stat
      local
      attnamelist
       prog
       attrib
      =
      explist
       exp
        string
         "seti -1 200; return *"
     stat
      local
      attnamelist
       res
       attrib
      =
      explist
       exp
        tableconstructor
         {
         fieldlist
          field
           exp
            prefixexp
             functioncall
              T
              .
              testC
              args
               (
               explist
                exp
                 prefixexp
                  prog
                ,
                exp
                 prefixexp
                  a
               )
         }
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           prefixexp
            a
            [
            exp
             number
              200
            ]
          ==
          exp
           prefixexp
            a
        )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           exp
            #
            exp
             prefixexp
              res
           ==
           exp
            number
             1
          and
          exp
           exp
            prefixexp
             res
             [
             exp
              number
               1
             ]
           ==
           exp
            prefixexp
             prog
        )
    end
   stat
    varlist
     var
      a
    =
    explist
     exp
      tableconstructor
       {
       fieldlist
        field
         x
         =
         exp
          number
           0
        fieldsep
         ,
        field
         y
         =
         exp
          number
           12
       }
   stat
    varlist
     var
      x
     ,
     var
      y
    =
    explist
     exp
      prefixexp
       functioncall
        T
        .
        testC
        args
         (
         explist
          exp
           string
            "gettable 2; pushvalue 4; gettable 2; return 2"
          ,
          exp
           prefixexp
            a
          ,
          exp
           number
            3
          ,
          exp
           string
            "y"
          ,
          exp
           number
            4
          ,
          exp
           string
            "x"
         )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         exp
          prefixexp
           x
         ==
         exp
          number
           0
        and
        exp
         exp
          prefixexp
           y
         ==
         exp
          number
           12
      )
   stat
    functioncall
     T
     .
     testC
     args
      (
      explist
       exp
        string
         "settable -5"
       ,
       exp
        prefixexp
         a
       ,
       exp
        number
         3
       ,
       exp
        number
         4
       ,
       exp
        string
         "x"
       ,
       exp
        number
         15
      )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         prefixexp
          a
          .
          x
        ==
        exp
         number
          15
      )
   stat
    varlist
     var
      prefixexp
       a
      [
      exp
       prefixexp
        a
      ]
    =
    explist
     exp
      prefixexp
       print
   stat
    varlist
     var
      x
    =
    explist
     exp
      prefixexp
       functioncall
        T
        .
        testC
        args
         (
         explist
          exp
           string
            "gettable 2; return 1"
          ,
          exp
           prefixexp
            a
         )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         prefixexp
          x
        ==
        exp
         prefixexp
          print
      )
   stat
    functioncall
     T
     .
     testC
     args
      (
      explist
       exp
        string
         "settable 2"
       ,
       exp
        prefixexp
         a
       ,
       exp
        string
         "x"
      )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         prefixexp
          a
          [
          exp
           prefixexp
            a
          ]
        ==
        exp
         string
          "x"
      )
   stat
    varlist
     var
      b
    =
    explist
     exp
      prefixexp
       functioncall
        setmetatable
        args
         (
         explist
          exp
           tableconstructor
            {
            fieldlist
             field
              p
              =
              exp
               prefixexp
                a
            }
          ,
          exp
           tableconstructor
            {
            }
         )
   stat
    varlist
     var
      prefixexp
       functioncall
        getmetatable
        args
         (
         explist
          exp
           prefixexp
            b
         )
      .
      __index
    =
    explist
     exp
      functiondef
       function
       funcbody
        (
        parlist
         namelist
          t
          ,
          i
        )
        block
         retstat
          return
          explist
           exp
            prefixexp
             t
             .
             p
             [
             exp
              prefixexp
               i
             ]
        end
   stat
    local
    attnamelist
     k
     attrib
     ,
     x
     attrib
    =
    explist
     exp
      prefixexp
       functioncall
        T
        .
        testC
        args
         (
         explist
          exp
           string
            "gettable 3, return 2"
          ,
          exp
           number
            4
          ,
          exp
           prefixexp
            b
          ,
          exp
           number
            20
          ,
          exp
           number
            35
          ,
          exp
           string
            "x"
         )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         exp
          prefixexp
           x
         ==
         exp
          number
           15
        and
        exp
         exp
          prefixexp
           k
         ==
         exp
          number
           35
      )
   stat
    varlist
     var
      k
    =
    explist
     exp
      prefixexp
       functioncall
        T
        .
        testC
        args
         (
         explist
          exp
           string
            "getfield 2 y, return 1"
          ,
          exp
           prefixexp
            b
         )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         prefixexp
          k
        ==
        exp
         number
          12
      )
   stat
    varlist
     var
      prefixexp
       functioncall
        getmetatable
        args
         (
         explist
          exp
           prefixexp
            b
         )
      .
      __index
    =
    explist
     exp
      functiondef
       function
       funcbody
        (
        parlist
         namelist
          t
          ,
          i
        )
        block
         retstat
          return
          explist
           exp
            prefixexp
             a
             [
             exp
              prefixexp
               i
             ]
        end
   stat
    varlist
     var
      prefixexp
       functioncall
        getmetatable
        args
         (
         explist
          exp
           prefixexp
            b
         )
      .
      __newindex
    =
    explist
     exp
      functiondef
       function
       funcbody
        (
        parlist
         namelist
          t
          ,
          i
          ,
          v
        )
        block
         stat
          varlist
           var
            prefixexp
             a
            [
            exp
             prefixexp
              i
            ]
          =
          explist
           exp
            prefixexp
             v
        end
   stat
    varlist
     var
      y
    =
    explist
     exp
      prefixexp
       functioncall
        T
        .
        testC
        args
         (
         explist
          exp
           string
            "insert 2; gettable -5; return 1"
          ,
          exp
           number
            2
          ,
          exp
           number
            3
          ,
          exp
           number
            4
          ,
          exp
           string
            "y"
          ,
          exp
           prefixexp
            b
         )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         prefixexp
          y
        ==
        exp
         number
          12
      )
   stat
    varlist
     var
      k
    =
    explist
     exp
      prefixexp
       functioncall
        T
        .
        testC
        args
         (
         explist
          exp
           string
            "settable -5, return 1"
          ,
          exp
           prefixexp
            b
          ,
          exp
           number
            3
          ,
          exp
           number
            4
          ,
          exp
           string
            "x"
          ,
          exp
           number
            16
         )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         exp
          prefixexp
           a
           .
           x
         ==
         exp
          number
           16
        and
        exp
         exp
          prefixexp
           k
         ==
         exp
          number
           4
      )
   stat
    varlist
     var
      prefixexp
       a
      [
      exp
       prefixexp
        b
      ]
    =
    explist
     exp
      string
       'xuxu'
   stat
    varlist
     var
      y
    =
    explist
     exp
      prefixexp
       functioncall
        T
        .
        testC
        args
         (
         explist
          exp
           string
            "gettable 2, return 1"
          ,
          exp
           prefixexp
            b
         )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         prefixexp
          y
        ==
        exp
         string
          'xuxu'
      )
   stat
    functioncall
     T
     .
     testC
     args
      (
      explist
       exp
        string
         "settable 2"
       ,
       exp
        prefixexp
         b
       ,
       exp
        number
         19
      )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         prefixexp
          a
          [
          exp
           prefixexp
            b
          ]
        ==
        exp
         number
          19
      )
   stat
    do
    block
     stat
      local
      attnamelist
       t
       attrib
      =
      explist
       exp
        tableconstructor
         {
         fieldlist
          field
           _012345678901234567890123456789012345678901234567890123456789
           =
           exp
            number
             32
         }
     stat
      local
      attnamelist
       a
       attrib
      =
      explist
       exp
        prefixexp
         functioncall
          T
          .
          testC
          args
           (
           explist
            exp
             string
              [[\n    getfield 2 _012345678901234567890123456789012345678901234567890123456789\n    return 1\n  ]]
            ,
            exp
             prefixexp
              t
           )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           prefixexp
            a
          ==
          exp
           number
            32
        )
     stat
      local
      attnamelist
       a
       attrib
      =
      explist
       exp
        prefixexp
         functioncall
          T
          .
          testC
          args
           (
           explist
            exp
             string
              [[\n    pushnum 33\n    setglobal _012345678901234567890123456789012345678901234567890123456789\n  ]]
           )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           prefixexp
            _012345678901234567890123456789012345678901234567890123456789
          ==
          exp
           number
            33
        )
     stat
      varlist
       var
        _012345678901234567890123456789012345678901234567890123456789
      =
      explist
       exp
        nil
    end
   stat
    varlist
     var
      a
    =
    explist
     exp
      tableconstructor
       {
       }
   stat
    varlist
     var
      t
    =
    explist
     exp
      prefixexp
       functioncall
        pack
        args
         (
         explist
          exp
           prefixexp
            functioncall
             T
             .
             testC
             args
              (
              explist
               exp
                string
                 "next; return *"
               ,
               exp
                prefixexp
                 a
               ,
               exp
                nil
              )
         )
   stat
    functioncall
     tcheck
     args
      (
      explist
       exp
        prefixexp
         t
       ,
       exp
        tableconstructor
         {
         fieldlist
          field
           n
           =
           exp
            number
             1
          fieldsep
           ,
          field
           exp
            prefixexp
             a
         }
      )
   stat
    varlist
     var
      a
    =
    explist
     exp
      tableconstructor
       {
       fieldlist
        field
         a
         =
         exp
          number
           3
       }
   stat
    varlist
     var
      t
    =
    explist
     exp
      prefixexp
       functioncall
        pack
        args
         (
         explist
          exp
           prefixexp
            functioncall
             T
             .
             testC
             args
              (
              explist
               exp
                string
                 "next; return *"
               ,
               exp
                prefixexp
                 a
               ,
               exp
                nil
              )
         )
   stat
    functioncall
     tcheck
     args
      (
      explist
       exp
        prefixexp
         t
       ,
       exp
        tableconstructor
         {
         fieldlist
          field
           n
           =
           exp
            number
             3
          fieldsep
           ,
          field
           exp
            prefixexp
             a
          fieldsep
           ,
          field
           exp
            string
             'a'
          fieldsep
           ,
          field
           exp
            number
             3
         }
      )
   stat
    varlist
     var
      t
    =
    explist
     exp
      prefixexp
       functioncall
        pack
        args
         (
         explist
          exp
           prefixexp
            functioncall
             T
             .
             testC
             args
              (
              explist
               exp
                string
                 "next; pop 1; next; return *"
               ,
               exp
                prefixexp
                 a
               ,
               exp
                nil
              )
         )
   stat
    functioncall
     tcheck
     args
      (
      explist
       exp
        prefixexp
         t
       ,
       exp
        tableconstructor
         {
         fieldlist
          field
           n
           =
           exp
            number
             1
          fieldsep
           ,
          field
           exp
            prefixexp
             a
         }
      )
   stat
    do
    block
     stat
      local
      attnamelist
       A
       attrib
      =
      explist
       exp
        prefixexp
         functioncall
          T
          .
          testC
          args
           string
            [[ pushnum 10; pushnum 20; pushcclosure 2; return 1]]
     stat
      varlist
       var
        t
       ,
       var
        b
       ,
       var
        c
      =
      explist
       exp
        prefixexp
         functioncall
          A
          args
           (
           explist
            exp
             string
              [[pushvalue U0; pushvalue U1; pushvalue U2; return 3]]
           )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           exp
            exp
             prefixexp
              b
            ==
            exp
             number
              10
           and
           exp
            exp
             prefixexp
              c
            ==
            exp
             number
              20
          and
          exp
           exp
            prefixexp
             functioncall
              type
              args
               (
               explist
                exp
                 prefixexp
                  t
               )
           ==
           exp
            string
             'table'
        )
     stat
      varlist
       var
        a
       ,
       var
        b
      =
      explist
       exp
        prefixexp
         functioncall
          A
          args
           (
           explist
            exp
             string
              [[tostring U3; tonumber U4; return 2]]
           )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           exp
            prefixexp
             a
           ==
           exp
            nil
          and
          exp
           exp
            prefixexp
             b
           ==
           exp
            number
             0
        )
     stat
      functioncall
       A
       args
        (
        explist
         exp
          string
           [[pushnum 100; pushnum 200; replace U2; replace U1]]
        )
     stat
      varlist
       var
        b
       ,
       var
        c
      =
      explist
       exp
        prefixexp
         functioncall
          A
          args
           (
           explist
            exp
             string
              [[pushvalue U1; pushvalue U2; return 2]]
           )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           exp
            prefixexp
             b
           ==
           exp
            number
             100
          and
          exp
           exp
            prefixexp
             c
           ==
           exp
            number
             200
        )
     stat
      functioncall
       A
       args
        (
        explist
         exp
          string
           [[replace U2; replace U1]]
         ,
         exp
          tableconstructor
           {
           fieldlist
            field
             x
             =
             exp
              number
               1
           }
         ,
         exp
          tableconstructor
           {
           fieldlist
            field
             x
             =
             exp
              number
               2
           }
        )
     stat
      varlist
       var
        b
       ,
       var
        c
      =
      explist
       exp
        prefixexp
         functioncall
          A
          args
           (
           explist
            exp
             string
              [[pushvalue U1; pushvalue U2; return 2]]
           )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           exp
            prefixexp
             b
             .
             x
           ==
           exp
            number
             1
          and
          exp
           exp
            prefixexp
             c
             .
             x
           ==
           exp
            number
             2
        )
     stat
      functioncall
       T
       .
       checkmemory
       args
        (
        )
    end
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         prefixexp
          functioncall
           T
           .
           testC
           args
            string
             [[isnull U1; return 1]]
        ==
        exp
         true
      )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         prefixexp
          functioncall
           T
           .
           testC
           args
            string
             [[isnull U100; return 1]]
        ==
        exp
         true
      )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         prefixexp
          functioncall
           T
           .
           testC
           args
            string
             [[pushvalue U1; return 1]]
        ==
        exp
         nil
      )
   stat
    local
    attnamelist
     f
     attrib
    =
    explist
     exp
      prefixexp
       functioncall
        T
        .
        testC
        args
         string
          [[ pushnum 10; pushnum 20; pushcclosure 2; return 1]]
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         exp
          exp
           prefixexp
            functioncall
             T
             .
             upvalue
             args
              (
              explist
               exp
                prefixexp
                 f
               ,
               exp
                number
                 1
              )
          ==
          exp
           number
            10
         and
         exp
          exp
           prefixexp
            functioncall
             T
             .
             upvalue
             args
              (
              explist
               exp
                prefixexp
                 f
               ,
               exp
                number
                 2
              )
          ==
          exp
           number
            20
        and
        exp
         exp
          prefixexp
           functioncall
            T
            .
            upvalue
            args
             (
             explist
              exp
               prefixexp
                f
              ,
              exp
               number
                3
             )
         ==
         exp
          nil
      )
   stat
    functioncall
     T
     .
     upvalue
     args
      (
      explist
       exp
        prefixexp
         f
       ,
       exp
        number
         2
       ,
       exp
        string
         "xuxu"
      )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         prefixexp
          functioncall
           T
           .
           upvalue
           args
            (
            explist
             exp
              prefixexp
               f
             ,
             exp
              number
               2
            )
        ==
        exp
         string
          "xuxu"
      )
   stat
    do
    block
     stat
      local
      attnamelist
       A
       attrib
      =
      explist
       exp
        exp
         string
          "checkstack 300 msg;"
        ..
        exp
         exp
          prefixexp
           functioncall
            string
            .
            rep
            args
             (
             explist
              exp
               string
                "pushnum 10;"
              ,
              exp
               number
                255
             )
         ..
         exp
          string
           "pushcclosure 255; return 1"
     stat
      varlist
       var
        A
      =
      explist
       exp
        prefixexp
         functioncall
          T
          .
          testC
          args
           (
           explist
            exp
             prefixexp
              A
           )
     stat
      for
      i
      =
      exp
       number
        1
      ,
      exp
       number
        255
      do
      block
       stat
        functioncall
         assert
         args
          (
          explist
           exp
            exp
             prefixexp
              functioncall
               A
               args
                (
                explist
                 exp
                  prefixexp
                   functioncall
                    (
                    exp
                     string
                      "pushvalue U%d; return 1"
                    )
                    :
                    format
                    args
                     (
                     explist
                      exp
                       prefixexp
                        i
                     )
                )
            ==
            exp
             number
              10
          )
      end
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          prefixexp
           functioncall
            A
            args
             (
             explist
              exp
               string
                "isnull U256; return 1"
             )
        )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          not
          exp
           prefixexp
            functioncall
             A
             args
              (
              explist
               exp
                string
                 "isnil U256; return 1"
              )
        )
    end
   stat
    functioncall
     checkerr
     args
      (
      explist
       exp
        string
         "got number"
       ,
       exp
        prefixexp
         debug
         .
         setuservalue
       ,
       exp
        number
         3
       ,
       exp
        tableconstructor
         {
         }
      )
   stat
    functioncall
     checkerr
     args
      (
      explist
       exp
        string
         "got nil"
       ,
       exp
        prefixexp
         debug
         .
         setuservalue
       ,
       exp
        nil
       ,
       exp
        tableconstructor
         {
         }
      )
   stat
    functioncall
     checkerr
     args
      (
      explist
       exp
        string
         "got light userdata"
       ,
       exp
        prefixexp
         debug
         .
         setuservalue
       ,
       exp
        prefixexp
         functioncall
          T
          .
          pushuserdata
          args
           (
           explist
            exp
             number
              1
           )
       ,
       exp
        tableconstructor
         {
         }
      )
   stat
    local
    attnamelist
     b
     attrib
    =
    explist
     exp
      prefixexp
       functioncall
        T
        .
        newuserdata
        args
         (
         explist
          exp
           number
            0
          ,
          exp
           number
            10
         )
   stat
    for
    i
    =
    exp
     number
      1
    ,
    exp
     number
      10
    do
    block
     stat
      local
      attnamelist
       v
       attrib
       ,
       p
       attrib
      =
      explist
       exp
        prefixexp
         functioncall
          debug
          .
          getuservalue
          args
           (
           explist
            exp
             prefixexp
              b
            ,
            exp
             prefixexp
              i
           )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           exp
            prefixexp
             v
           ==
           exp
            nil
          and
          exp
           prefixexp
            p
        )
    end
   stat
    do
    block
     stat
      local
      attnamelist
       v
       attrib
       ,
       p
       attrib
      =
      explist
       exp
        prefixexp
         functioncall
          debug
          .
          getuservalue
          args
           (
           explist
            exp
             prefixexp
              b
            ,
            exp
             -
             exp
              number
               2
           )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           exp
            prefixexp
             v
           ==
           exp
            nil
          and
          exp
           not
           exp
            prefixexp
             p
        )
     stat
      local
      attnamelist
       v
       attrib
       ,
       p
       attrib
      =
      explist
       exp
        prefixexp
         functioncall
          debug
          .
          getuservalue
          args
           (
           explist
            exp
             prefixexp
              b
            ,
            exp
             number
              11
           )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           exp
            prefixexp
             v
           ==
           exp
            nil
          and
          exp
           not
           exp
            prefixexp
             p
        )
    end
   stat
    local
    attnamelist
     t
     attrib
    =
    explist
     exp
      tableconstructor
       {
       fieldlist
        field
         exp
          true
        fieldsep
         ,
        field
         exp
          false
        fieldsep
         ,
        field
         exp
          number
           4.56
        fieldsep
         ,
        field
         exp
          prefixexp
           print
        fieldsep
         ,
        field
         exp
          tableconstructor
           {
           }
        fieldsep
         ,
        field
         exp
          prefixexp
           b
        fieldsep
         ,
        field
         exp
          string
           "XYZ"
       }
   stat
    for
    namelist
     k
     ,
     v
    in
    explist
     exp
      prefixexp
       functioncall
        ipairs
        args
         (
         explist
          exp
           prefixexp
            t
         )
    do
    block
     stat
      functioncall
       debug
       .
       setuservalue
       args
        (
        explist
         exp
          prefixexp
           b
         ,
         exp
          prefixexp
           v
         ,
         exp
          prefixexp
           k
        )
    end
   stat
    for
    namelist
     k
     ,
     v
    in
    explist
     exp
      prefixexp
       functioncall
        ipairs
        args
         (
         explist
          exp
           prefixexp
            t
         )
    do
    block
     stat
      local
      attnamelist
       v1
       attrib
       ,
       p
       attrib
      =
      explist
       exp
        prefixexp
         functioncall
          debug
          .
          getuservalue
          args
           (
           explist
            exp
             prefixexp
              b
            ,
            exp
             prefixexp
              k
           )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           exp
            prefixexp
             v1
           ==
           exp
            prefixexp
             v
          and
          exp
           prefixexp
            p
        )
    end
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        not
        exp
         prefixexp
          functioncall
           debug
           .
           getuservalue
           args
            (
            explist
             exp
              number
               4
            )
      )
   stat
    functioncall
     debug
     .
     setuservalue
     args
      (
      explist
       exp
        prefixexp
         b
       ,
       exp
        functiondef
         function
         funcbody
          (
          parlist
          )
          block
           retstat
            return
            explist
             exp
              number
               10
          end
       ,
       exp
        number
         10
      )
   stat
    functioncall
     collectgarbage
     args
      (
      )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         prefixexp
          functioncall
           functioncall
            debug
            .
            getuservalue
            args
             (
             explist
              exp
               prefixexp
                b
              ,
              exp
               number
                10
             )
           args
            (
            )
        ==
        exp
         number
          10
      )
   stat
    functioncall
     debug
     .
     setuservalue
     args
      (
      explist
       exp
        prefixexp
         b
       ,
       exp
        number
         134
      )
   stat
    functioncall
     collectgarbage
     args
      (
      )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         prefixexp
          functioncall
           debug
           .
           getuservalue
           args
            (
            explist
             exp
              prefixexp
               b
            )
        ==
        exp
         number
          134
      )
   stat
    do
    block
     stat
      local
      attnamelist
       oldmode
       attrib
      =
      explist
       exp
        prefixexp
         functioncall
          collectgarbage
          args
           (
           explist
            exp
             string
              "incremental"
           )
     stat
      functioncall
       T
       .
       gcstate
       args
        (
        explist
         exp
          string
           "atomic"
        )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           prefixexp
            functioncall
             T
             .
             gccolor
             args
              (
              explist
               exp
                prefixexp
                 b
              )
          ==
          exp
           string
            "black"
        )
     stat
      functioncall
       debug
       .
       setuservalue
       args
        (
        explist
         exp
          prefixexp
           b
         ,
         exp
          tableconstructor
           {
           fieldlist
            field
             x
             =
             exp
              number
               100
           }
        )
     stat
      functioncall
       T
       .
       gcstate
       args
        (
        explist
         exp
          string
           "pause"
        )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           prefixexp
            functioncall
             debug
             .
             getuservalue
             args
              (
              explist
               exp
                prefixexp
                 b
              )
            .
            x
          ==
          exp
           number
            100
        )
     stat
      functioncall
       collectgarbage
       args
        (
        explist
         exp
          prefixexp
           oldmode
        )
    end
   stat
    for
    i
    =
    exp
     number
      1
    ,
    exp
     number
      1000
    do
    block
     stat
      local
      attnamelist
       bb
       attrib
      =
      explist
       exp
        prefixexp
         functioncall
          T
          .
          newuserdata
          args
           (
           explist
            exp
             number
              0
            ,
            exp
             number
              1
           )
     stat
      functioncall
       debug
       .
       setuservalue
       args
        (
        explist
         exp
          prefixexp
           bb
         ,
         exp
          prefixexp
           b
        )
     stat
      varlist
       var
        b
      =
      explist
       exp
        prefixexp
         bb
    end
   stat
    functioncall
     collectgarbage
     args
      (
      )
   stat
    for
    i
    =
    exp
     number
      1
    ,
    exp
     number
      1000
    do
    block
     stat
      varlist
       var
        b
      =
      explist
       exp
        prefixexp
         functioncall
          debug
          .
          getuservalue
          args
           (
           explist
            exp
             prefixexp
              b
           )
    end
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         prefixexp
          functioncall
           debug
           .
           getuservalue
           args
            (
            explist
             exp
              prefixexp
               b
            )
          .
          x
        ==
        exp
         number
          100
      )
   stat
    varlist
     var
      b
    =
    explist
     exp
      nil
   stat
    local
    attnamelist
     i
     attrib
    =
    explist
     exp
      prefixexp
       functioncall
        T
        .
        ref
        args
         tableconstructor
          {
          }
   stat
    functioncall
     T
     .
     unref
     args
      (
      explist
       exp
        prefixexp
         i
      )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         prefixexp
          functioncall
           T
           .
           ref
           args
            tableconstructor
             {
             }
        ==
        exp
         prefixexp
          i
      )
   stat
    local
    attnamelist
     Arr
     attrib
    =
    explist
     exp
      tableconstructor
       {
       }
   stat
    local
    attnamelist
     Lim
     attrib
    =
    explist
     exp
      number
       100
   stat
    for
    i
    =
    exp
     number
      1
    ,
    exp
     prefixexp
      Lim
    do
    block
     stat
      varlist
       var
        prefixexp
         Arr
        [
        exp
         prefixexp
          i
        ]
      =
      explist
       exp
        prefixexp
         functioncall
          T
          .
          ref
          args
           (
           explist
            exp
             tableconstructor
              {
              }
           )
    end
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         exp
          prefixexp
           functioncall
            T
            .
            ref
            args
             (
             explist
              exp
               nil
             )
         ==
         exp
          -
          exp
           number
            1
        and
        exp
         exp
          prefixexp
           functioncall
            T
            .
            getref
            args
             (
             explist
              exp
               -
               exp
                number
                 1
             )
         ==
         exp
          nil
      )
   stat
    functioncall
     T
     .
     unref
     args
      (
      explist
       exp
        -
        exp
         number
          1
      )
   stat
    ;
   stat
    functioncall
     T
     .
     unref
     args
      (
      explist
       exp
        -
        exp
         number
          1
      )
   stat
    for
    i
    =
    exp
     number
      1
    ,
    exp
     prefixexp
      Lim
    do
    block
     stat
      functioncall
       T
       .
       unref
       args
        (
        explist
         exp
          prefixexp
           Arr
           [
           exp
            prefixexp
             i
           ]
        )
    end
   stat
    local
    function
    printlocks
    funcbody
     (
     parlist
     )
     block
      stat
       local
       attnamelist
        f
        attrib
       =
       explist
        exp
         prefixexp
          functioncall
           T
           .
           makeCfunc
           args
            (
            explist
             exp
              string
               "gettable R; return 1"
            )
      stat
       local
       attnamelist
        n
        attrib
       =
       explist
        exp
         prefixexp
          functioncall
           f
           args
            (
            explist
             exp
              string
               "n"
            )
      stat
       functioncall
        print
        args
         (
         explist
          exp
           string
            "n"
          ,
          exp
           prefixexp
            n
         )
      stat
       for
       i
       =
       exp
        number
         0
       ,
       exp
        prefixexp
         n
       do
       block
        stat
         functioncall
          print
          args
           (
           explist
            exp
             prefixexp
              i
            ,
            exp
             prefixexp
              functioncall
               f
               args
                (
                explist
                 exp
                  prefixexp
                   i
                )
           )
       end
     end
   stat
    for
    i
    =
    exp
     number
      1
    ,
    exp
     prefixexp
      Lim
    do
    block
     stat
      varlist
       var
        prefixexp
         Arr
        [
        exp
         prefixexp
          i
        ]
      =
      explist
       exp
        prefixexp
         functioncall
          T
          .
          ref
          args
           (
           explist
            exp
             tableconstructor
              {
              }
           )
    end
   stat
    for
    i
    =
    exp
     number
      1
    ,
    exp
     prefixexp
      Lim
    ,
    exp
     number
      2
    do
    block
     stat
      functioncall
       T
       .
       unref
       args
        (
        explist
         exp
          prefixexp
           Arr
           [
           exp
            prefixexp
             i
           ]
        )
    end
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         prefixexp
          functioncall
           type
           args
            (
            explist
             exp
              prefixexp
               functioncall
                T
                .
                getref
                args
                 (
                 explist
                  exp
                   prefixexp
                    Arr
                    [
                    exp
                     number
                      2
                    ]
                 )
            )
        ==
        exp
         string
          'table'
      )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         prefixexp
          functioncall
           T
           .
           getref
           args
            (
            explist
             exp
              -
              exp
               number
                1
            )
        ==
        exp
         nil
      )
   stat
    varlist
     var
      a
    =
    explist
     exp
      prefixexp
       functioncall
        T
        .
        ref
        args
         (
         explist
          exp
           tableconstructor
            {
            }
         )
   stat
    functioncall
     collectgarbage
     args
      (
      )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         prefixexp
          functioncall
           type
           args
            (
            explist
             exp
              prefixexp
               functioncall
                T
                .
                getref
                args
                 (
                 explist
                  exp
                   prefixexp
                    a
                 )
            )
        ==
        exp
         string
          'table'
      )
   stat
    local
    attnamelist
     tt
     attrib
    =
    explist
     exp
      tableconstructor
       {
       }
   stat
    local
    attnamelist
     cl
     attrib
    =
    explist
     exp
      tableconstructor
       {
       fieldlist
        field
         n
         =
         exp
          number
           0
       }
   stat
    varlist
     var
      A
    =
    explist
     exp
      nil
   stat
    ;
   stat
    varlist
     var
      B
    =
    explist
     exp
      nil
   stat
    local
    attnamelist
     F
     attrib
   stat
    varlist
     var
      F
    =
    explist
     exp
      functiondef
       function
       funcbody
        (
        parlist
         namelist
          x
        )
        block
         stat
          local
          attnamelist
           udval
           attrib
          =
          explist
           exp
            prefixexp
             functioncall
              T
              .
              udataval
              args
               (
               explist
                exp
                 prefixexp
                  x
               )
         stat
          functioncall
           table
           .
           insert
           args
            (
            explist
             exp
              prefixexp
               cl
             ,
             exp
              prefixexp
               udval
            )
         stat
          local
          attnamelist
           d
           attrib
          =
          explist
           exp
            prefixexp
             functioncall
              T
              .
              newuserdata
              args
               (
               explist
                exp
                 number
                  100
               )
         stat
          varlist
           var
            d
          =
          explist
           exp
            nil
         stat
          functioncall
           assert
           args
            (
            explist
             exp
              exp
               prefixexp
                functioncall
                 debug
                 .
                 getmetatable
                 args
                  (
                  explist
                   exp
                    prefixexp
                     x
                  )
                .
                __gc
              ==
              exp
               prefixexp
                F
            )
         stat
          functioncall
           functioncall
            assert
            args
             (
             explist
              exp
               prefixexp
                functioncall
                 load
                 args
                  (
                  explist
                   exp
                    string
                     "table.insert({}, {})"
                  )
             )
           args
            (
            )
         stat
          functioncall
           assert
           args
            (
            explist
             exp
              not
              exp
               prefixexp
                functioncall
                 collectgarbage
                 args
                  (
                  )
            )
         stat
          local
          attnamelist
           dummy
           attrib
          =
          explist
           exp
            tableconstructor
             {
             }
         stat
          if
          exp
           exp
            prefixexp
             A
           ~=
           exp
            nil
          then
          block
           stat
            functioncall
             assert
             args
              (
              explist
               exp
                exp
                 prefixexp
                  functioncall
                   type
                   args
                    (
                    explist
                     exp
                      prefixexp
                       A
                    )
                ==
                exp
                 string
                  "userdata"
              )
           stat
            functioncall
             assert
             args
              (
              explist
               exp
                exp
                 prefixexp
                  functioncall
                   T
                   .
                   udataval
                   args
                    (
                    explist
                     exp
                      prefixexp
                       A
                    )
                ==
                exp
                 prefixexp
                  B
              )
           stat
            functioncall
             debug
             .
             getmetatable
             args
              (
              explist
               exp
                prefixexp
                 A
              )
          end
         stat
          varlist
           var
            A
          =
          explist
           exp
            prefixexp
             x
         stat
          varlist
           var
            B
          =
          explist
           exp
            prefixexp
             udval
         retstat
          return
          explist
           exp
            number
             1
           ,
           exp
            number
             2
           ,
           exp
            number
             3
        end
   stat
    varlist
     var
      prefixexp
       tt
      .
      __gc
    =
    explist
     exp
      prefixexp
       F
   stat
    do
    block
     stat
      functioncall
       collectgarbage
       args
        (
        )
     stat
      ;
     stat
      functioncall
       collectgarbage
       args
        (
        )
     stat
      ;
     stat
      local
      attnamelist
       x
       attrib
      =
      explist
       exp
        prefixexp
         functioncall
          collectgarbage
          args
           (
           explist
            exp
             string
              "count"
           )
     stat
      ;
     stat
      local
      attnamelist
       a
       attrib
      =
      explist
       exp
        prefixexp
         functioncall
          T
          .
          newuserdata
          args
           (
           explist
            exp
             number
              5001
           )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           prefixexp
            functioncall
             T
             .
             testC
             args
              (
              explist
               exp
                string
                 "objsize 2; return 1"
               ,
               exp
                prefixexp
                 a
              )
          ==
          exp
           number
            5001
        )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           prefixexp
            functioncall
             collectgarbage
             args
              (
              explist
               exp
                string
                 "count"
              )
          >=
          exp
           exp
            prefixexp
             x
           +
           exp
            number
             4
        )
     stat
      varlist
       var
        a
      =
      explist
       exp
        nil
     stat
      functioncall
       collectgarbage
       args
        (
        )
     stat
      ;
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           prefixexp
            functioncall
             collectgarbage
             args
              (
              explist
               exp
                string
                 "count"
              )
          <=
          exp
           exp
            prefixexp
             x
           +
           exp
            number
             1
        )
     stat
      varlist
       var
        x
      =
      explist
       exp
        prefixexp
         functioncall
          collectgarbage
          args
           (
           explist
            exp
             string
              "count"
           )
     stat
      functioncall
       collectgarbage
       args
        (
        explist
         exp
          string
           "stop"
        )
     stat
      for
      i
      =
      exp
       number
        1
      ,
      exp
       number
        1000
      do
      block
       stat
        functioncall
         T
         .
         newuserdata
         args
          (
          explist
           exp
            number
             0
          )
      end
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           prefixexp
            functioncall
             collectgarbage
             args
              (
              explist
               exp
                string
                 "count"
              )
          >
          exp
           exp
            prefixexp
             x
           +
           exp
            number
             10
        )
     stat
      functioncall
       collectgarbage
       args
        (
        )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           prefixexp
            functioncall
             collectgarbage
             args
              (
              explist
               exp
                string
                 "count"
              )
          <=
          exp
           exp
            prefixexp
             x
           +
           exp
            number
             1
        )
     stat
      functioncall
       collectgarbage
       args
        (
        )
     stat
      varlist
       var
        x
      =
      explist
       exp
        prefixexp
         functioncall
          collectgarbage
          args
           (
           explist
            exp
             string
              "count"
           )
     stat
      functioncall
       collectgarbage
       args
        (
        explist
         exp
          string
           "stop"
        )
     stat
      varlist
       var
        a
      =
      explist
       exp
        tableconstructor
         {
         fieldlist
          field
           __gc
           =
           exp
            functiondef
             function
             funcbody
              (
              parlist
              )
              block
              end
         }
     stat
      for
      i
      =
      exp
       number
        1
      ,
      exp
       number
        1000
      do
      block
       stat
        functioncall
         debug
         .
         setmetatable
         args
          (
          explist
           exp
            prefixexp
             functioncall
              T
              .
              newuserdata
              args
               (
               explist
                exp
                 number
                  0
               )
           ,
           exp
            prefixexp
             a
          )
      end
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           prefixexp
            functioncall
             collectgarbage
             args
              (
              explist
               exp
                string
                 "count"
              )
          >=
          exp
           exp
            prefixexp
             x
           +
           exp
            number
             10
        )
     stat
      functioncall
       collectgarbage
       args
        (
        )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           prefixexp
            functioncall
             collectgarbage
             args
              (
              explist
               exp
                string
                 "count"
              )
          >=
          exp
           exp
            prefixexp
             x
           +
           exp
            number
             10
        )
     stat
      functioncall
       collectgarbage
       args
        (
        )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           prefixexp
            functioncall
             collectgarbage
             args
              (
              explist
               exp
                string
                 "count"
              )
          <=
          exp
           exp
            prefixexp
             x
           +
           exp
            number
             1
        )
     stat
      functioncall
       collectgarbage
       args
        (
        explist
         exp
          string
           "restart"
        )
    end
   stat
    functioncall
     collectgarbage
     args
      (
      explist
       exp
        string
         "stop"
      )
   stat
    varlist
     var
      a
    =
    explist
     exp
      prefixexp
       functioncall
        T
        .
        newuserdata
        args
         (
         explist
          exp
           number
            0
         )
   stat
    ;
   stat
    functioncall
     debug
     .
     setmetatable
     args
      (
      explist
       exp
        prefixexp
         a
       ,
       exp
        prefixexp
         tt
      )
   stat
    ;
   stat
    local
    attnamelist
     na
     attrib
    =
    explist
     exp
      prefixexp
       functioncall
        T
        .
        udataval
        args
         (
         explist
          exp
           prefixexp
            a
         )
   stat
    varlist
     var
      b
    =
    explist
     exp
      prefixexp
       functioncall
        T
        .
        newuserdata
        args
         (
         explist
          exp
           number
            0
         )
   stat
    ;
   stat
    functioncall
     debug
     .
     setmetatable
     args
      (
      explist
       exp
        prefixexp
         b
       ,
       exp
        prefixexp
         tt
      )
   stat
    ;
   stat
    local
    attnamelist
     nb
     attrib
    =
    explist
     exp
      prefixexp
       functioncall
        T
        .
        udataval
        args
         (
         explist
          exp
           prefixexp
            b
         )
   stat
    varlist
     var
      c
    =
    explist
     exp
      prefixexp
       functioncall
        T
        .
        newuserdata
        args
         (
         explist
          exp
           number
            0
         )
   stat
    ;
   stat
    functioncall
     debug
     .
     setmetatable
     args
      (
      explist
       exp
        prefixexp
         c
       ,
       exp
        prefixexp
         tt
      )
   stat
    ;
   stat
    local
    attnamelist
     nc
     attrib
    =
    explist
     exp
      prefixexp
       functioncall
        T
        .
        udataval
        args
         (
         explist
          exp
           prefixexp
            c
         )
   stat
    varlist
     var
      x
    =
    explist
     exp
      prefixexp
       functioncall
        T
        .
        newuserdata
        args
         (
         explist
          exp
           number
            4
         )
   stat
    varlist
     var
      y
    =
    explist
     exp
      prefixexp
       functioncall
        T
        .
        newuserdata
        args
         (
         explist
          exp
           number
            0
         )
   stat
    functioncall
     checkerr
     args
      (
      explist
       exp
        string
         "FILE%* expected, got userdata"
       ,
       exp
        prefixexp
         io
         .
         input
       ,
       exp
        prefixexp
         a
      )
   stat
    functioncall
     checkerr
     args
      (
      explist
       exp
        string
         "FILE%* expected, got userdata"
       ,
       exp
        prefixexp
         io
         .
         input
       ,
       exp
        prefixexp
         x
      )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         exp
          prefixexp
           functioncall
            debug
            .
            getmetatable
            args
             (
             explist
              exp
               prefixexp
                x
             )
         ==
         exp
          nil
        and
        exp
         exp
          prefixexp
           functioncall
            debug
            .
            getmetatable
            args
             (
             explist
              exp
               prefixexp
                y
             )
         ==
         exp
          nil
      )
   stat
    local
    attnamelist
     d
     attrib
    =
    explist
     exp
      prefixexp
       functioncall
        T
        .
        ref
        args
         (
         explist
          exp
           prefixexp
            a
         )
   stat
    ;
   stat
    local
    attnamelist
     e
     attrib
    =
    explist
     exp
      prefixexp
       functioncall
        T
        .
        ref
        args
         (
         explist
          exp
           prefixexp
            b
         )
   stat
    ;
   stat
    local
    attnamelist
     f
     attrib
    =
    explist
     exp
      prefixexp
       functioncall
        T
        .
        ref
        args
         (
         explist
          exp
           prefixexp
            c
         )
   stat
    ;
   stat
    varlist
     var
      t
    =
    explist
     exp
      tableconstructor
       {
       fieldlist
        field
         exp
          prefixexp
           functioncall
            T
            .
            getref
            args
             (
             explist
              exp
               prefixexp
                d
             )
        fieldsep
         ,
        field
         exp
          prefixexp
           functioncall
            T
            .
            getref
            args
             (
             explist
              exp
               prefixexp
                e
             )
        fieldsep
         ,
        field
         exp
          prefixexp
           functioncall
            T
            .
            getref
            args
             (
             explist
              exp
               prefixexp
                f
             )
       }
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         exp
          exp
           prefixexp
            t
            [
            exp
             number
              1
            ]
          ==
          exp
           prefixexp
            a
         and
         exp
          exp
           prefixexp
            t
            [
            exp
             number
              2
            ]
          ==
          exp
           prefixexp
            b
        and
        exp
         exp
          prefixexp
           t
           [
           exp
            number
             3
           ]
         ==
         exp
          prefixexp
           c
      )
   stat
    varlist
     var
      t
    =
    explist
     exp
      nil
   stat
    ;
   stat
    varlist
     var
      a
    =
    explist
     exp
      nil
   stat
    ;
   stat
    varlist
     var
      c
    =
    explist
     exp
      nil
   stat
    ;
   stat
    functioncall
     T
     .
     unref
     args
      (
      explist
       exp
        prefixexp
         e
      )
   stat
    ;
   stat
    functioncall
     T
     .
     unref
     args
      (
      explist
       exp
        prefixexp
         f
      )
   stat
    functioncall
     collectgarbage
     args
      (
      )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         exp
          #
          exp
           prefixexp
            cl
         ==
         exp
          number
           1
        and
        exp
         exp
          prefixexp
           cl
           [
           exp
            number
             1
           ]
         ==
         exp
          prefixexp
           nc
      )
   stat
    varlist
     var
      x
    =
    explist
     exp
      prefixexp
       functioncall
        T
        .
        getref
        args
         (
         explist
          exp
           prefixexp
            d
         )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         exp
          prefixexp
           functioncall
            type
            args
             (
             explist
              exp
               prefixexp
                x
             )
         ==
         exp
          string
           'userdata'
        and
        exp
         exp
          prefixexp
           functioncall
            debug
            .
            getmetatable
            args
             (
             explist
              exp
               prefixexp
                x
             )
         ==
         exp
          prefixexp
           tt
      )
   stat
    varlist
     var
      x
    =
    explist
     exp
      nil
   stat
    varlist
     var
      prefixexp
       tt
      .
      b
    =
    explist
     exp
      prefixexp
       b
   stat
    varlist
     var
      tt
    =
    explist
     exp
      nil
   stat
    varlist
     var
      A
    =
    explist
     exp
      nil
   stat
    varlist
     var
      b
    =
    explist
     exp
      nil
   stat
    functioncall
     T
     .
     unref
     args
      (
      explist
       exp
        prefixexp
         d
      )
   stat
    ;
   stat
    local
    attnamelist
     n5
     attrib
    =
    explist
     exp
      prefixexp
       functioncall
        T
        .
        newuserdata
        args
         (
         explist
          exp
           number
            0
         )
   stat
    functioncall
     debug
     .
     setmetatable
     args
      (
      explist
       exp
        prefixexp
         n5
       ,
       exp
        tableconstructor
         {
         fieldlist
          field
           __gc
           =
           exp
            prefixexp
             F
         }
      )
   stat
    varlist
     var
      n5
    =
    explist
     exp
      prefixexp
       functioncall
        T
        .
        udataval
        args
         (
         explist
          exp
           prefixexp
            n5
         )
   stat
    functioncall
     collectgarbage
     args
      (
      )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         #
         exp
          prefixexp
           cl
        ==
        exp
         number
          4
      )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         exp
          exp
           prefixexp
            cl
            [
            exp
             number
              2
            ]
          ==
          exp
           prefixexp
            n5
         and
         exp
          exp
           prefixexp
            cl
            [
            exp
             number
              3
            ]
          ==
          exp
           prefixexp
            nb
        and
        exp
         exp
          prefixexp
           cl
           [
           exp
            number
             4
           ]
         ==
         exp
          prefixexp
           na
      )
   stat
    functioncall
     collectgarbage
     args
      string
       "restart"
   stat
    varlist
     var
      a
     ,
     var
      na
    =
    explist
     exp
      tableconstructor
       {
       }
     ,
     exp
      tableconstructor
       {
       }
   stat
    for
    i
    =
    exp
     number
      30
    ,
    exp
     number
      1
    ,
    exp
     -
     exp
      number
       1
    do
    block
     stat
      varlist
       var
        prefixexp
         a
        [
        exp
         prefixexp
          i
        ]
      =
      explist
       exp
        prefixexp
         functioncall
          T
          .
          newuserdata
          args
           (
           explist
            exp
             number
              0
           )
     stat
      functioncall
       debug
       .
       setmetatable
       args
        (
        explist
         exp
          prefixexp
           a
           [
           exp
            prefixexp
             i
           ]
         ,
         exp
          tableconstructor
           {
           fieldlist
            field
             __gc
             =
             exp
              prefixexp
               F
           }
        )
     stat
      varlist
       var
        prefixexp
         na
        [
        exp
         prefixexp
          i
        ]
      =
      explist
       exp
        prefixexp
         functioncall
          T
          .
          udataval
          args
           (
           explist
            exp
             prefixexp
              a
              [
              exp
               prefixexp
                i
              ]
           )
    end
   stat
    varlist
     var
      cl
    =
    explist
     exp
      tableconstructor
       {
       }
   stat
    varlist
     var
      a
    =
    explist
     exp
      nil
   stat
    ;
   stat
    functioncall
     collectgarbage
     args
      (
      )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         #
         exp
          prefixexp
           cl
        ==
        exp
         number
          30
      )
   stat
    for
    i
    =
    exp
     number
      1
    ,
    exp
     number
      30
    do
    block
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           prefixexp
            cl
            [
            exp
             prefixexp
              i
            ]
          ==
          exp
           prefixexp
            na
            [
            exp
             prefixexp
              i
            ]
        )
    end
   stat
    varlist
     var
      na
    =
    explist
     exp
      nil
   stat
    for
    i
    =
    exp
     number
      2
    ,
    exp
     prefixexp
      Lim
    ,
    exp
     number
      2
    do
    block
     stat
      functioncall
       T
       .
       unref
       args
        (
        explist
         exp
          prefixexp
           Arr
           [
           exp
            prefixexp
             i
           ]
        )
    end
   stat
    varlist
     var
      x
    =
    explist
     exp
      prefixexp
       functioncall
        T
        .
        newuserdata
        args
         (
         explist
          exp
           number
            41
         )
   stat
    ;
   stat
    functioncall
     debug
     .
     setmetatable
     args
      (
      explist
       exp
        prefixexp
         x
       ,
       exp
        tableconstructor
         {
         fieldlist
          field
           __gc
           =
           exp
            prefixexp
             F
         }
      )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         prefixexp
          functioncall
           T
           .
           testC
           args
            (
            explist
             exp
              string
               "objsize 2; return 1"
             ,
             exp
              prefixexp
               x
            )
        ==
        exp
         number
          41
      )
   stat
    varlist
     var
      cl
    =
    explist
     exp
      tableconstructor
       {
       }
   stat
    varlist
     var
      a
    =
    explist
     exp
      tableconstructor
       {
       fieldlist
        field
         [
         exp
          prefixexp
           x
         ]
         =
         exp
          number
           1
       }
   stat
    varlist
     var
      x
    =
    explist
     exp
      prefixexp
       functioncall
        T
        .
        udataval
        args
         (
         explist
          exp
           prefixexp
            x
         )
   stat
    functioncall
     collectgarbage
     args
      (
      )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         #
         exp
          prefixexp
           cl
        ==
        exp
         number
          0
      )
   stat
    for
    namelist
     n
    in
    explist
     exp
      prefixexp
       functioncall
        pairs
        args
         (
         explist
          exp
           prefixexp
            a
         )
    do
    block
     stat
      varlist
       var
        prefixexp
         a
        [
        exp
         prefixexp
          n
        ]
      =
      explist
       exp
        prefixexp
         undef
    end
   stat
    functioncall
     collectgarbage
     args
      (
      )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         exp
          #
          exp
           prefixexp
            cl
         ==
         exp
          number
           1
        and
        exp
         exp
          prefixexp
           cl
           [
           exp
            number
             1
           ]
         ==
         exp
          prefixexp
           x
      )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        prefixexp
         functioncall
          T
          .
          testC
          args
           (
           explist
            exp
             string
              "compare EQ 2 4; return 1"
            ,
            exp
             prefixexp
              print
            ,
            exp
             number
              1
            ,
            exp
             prefixexp
              print
            ,
            exp
             number
              20
           )
      )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        prefixexp
         functioncall
          T
          .
          testC
          args
           (
           explist
            exp
             string
              "compare EQ 3 2; return 1"
            ,
            exp
             string
              'alo'
            ,
            exp
             string
              "alo"
           )
      )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        prefixexp
         functioncall
          T
          .
          testC
          args
           (
           explist
            exp
             string
              "compare EQ 2 3; return 1"
            ,
            exp
             nil
            ,
            exp
             nil
           )
      )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        not
        exp
         prefixexp
          functioncall
           T
           .
           testC
           args
            (
            explist
             exp
              string
               "compare EQ 2 3; return 1"
             ,
             exp
              tableconstructor
               {
               }
             ,
             exp
              tableconstructor
               {
               }
            )
      )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        not
        exp
         prefixexp
          functioncall
           T
           .
           testC
           args
            (
            explist
             exp
              string
               "compare EQ 2 3; return 1"
            )
      )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        not
        exp
         prefixexp
          functioncall
           T
           .
           testC
           args
            (
            explist
             exp
              string
               "compare EQ 2 3; return 1"
             ,
             exp
              number
               3
            )
      )
   stat
    do
    block
     stat
      local
      attnamelist
       map
       attrib
      =
      explist
       exp
        tableconstructor
         {
         }
     stat
      local
      attnamelist
       t
       attrib
      =
      explist
       exp
        tableconstructor
         {
         fieldlist
          field
           __eq
           =
           exp
            functiondef
             function
             funcbody
              (
              parlist
               namelist
                a
                ,
                b
              )
              block
               retstat
                return
                explist
                 exp
                  exp
                   prefixexp
                    map
                    [
                    exp
                     prefixexp
                      a
                    ]
                  ==
                  exp
                   prefixexp
                    map
                    [
                    exp
                     prefixexp
                      b
                    ]
              end
         }
     stat
      local
      function
      f
      funcbody
       (
       parlist
        namelist
         x
       )
       block
        stat
         local
         attnamelist
          u
          attrib
         =
         explist
          exp
           prefixexp
            functioncall
             T
             .
             newuserdata
             args
              (
              explist
               exp
                number
                 0
              )
        stat
         functioncall
          debug
          .
          setmetatable
          args
           (
           explist
            exp
             prefixexp
              u
            ,
            exp
             prefixexp
              t
           )
        stat
         varlist
          var
           prefixexp
            map
           [
           exp
            prefixexp
             u
           ]
         =
         explist
          exp
           prefixexp
            x
        retstat
         return
         explist
          exp
           prefixexp
            u
       end
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           prefixexp
            functioncall
             f
             args
              (
              explist
               exp
                number
                 10
              )
          ==
          exp
           prefixexp
            functioncall
             f
             args
              (
              explist
               exp
                number
                 10
              )
        )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           prefixexp
            functioncall
             f
             args
              (
              explist
               exp
                number
                 10
              )
          ~=
          exp
           prefixexp
            functioncall
             f
             args
              (
              explist
               exp
                number
                 11
              )
        )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          prefixexp
           functioncall
            T
            .
            testC
            args
             (
             explist
              exp
               string
                "compare EQ 2 3; return 1"
              ,
              exp
               prefixexp
                functioncall
                 f
                 args
                  (
                  explist
                   exp
                    number
                     10
                  )
              ,
              exp
               prefixexp
                functioncall
                 f
                 args
                  (
                  explist
                   exp
                    number
                     10
                  )
             )
        )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          not
          exp
           prefixexp
            functioncall
             T
             .
             testC
             args
              (
              explist
               exp
                string
                 "compare EQ 2 3; return 1"
               ,
               exp
                prefixexp
                 functioncall
                  f
                  args
                   (
                   explist
                    exp
                     number
                      10
                   )
               ,
               exp
                prefixexp
                 functioncall
                  f
                  args
                   (
                   explist
                    exp
                     number
                      20
                   )
              )
        )
     stat
      varlist
       var
        prefixexp
         t
        .
        __eq
      =
      explist
       exp
        nil
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           prefixexp
            functioncall
             f
             args
              (
              explist
               exp
                number
                 10
              )
          ~=
          exp
           prefixexp
            functioncall
             f
             args
              (
              explist
               exp
                number
                 10
              )
        )
    end
   stat
    functioncall
     print
     args
      string
       '+'
   stat
    varlist
     var
      prefixexp
       _G
      .
      TT
    =
    explist
     exp
      tableconstructor
       {
       }
   stat
    functioncall
     T
     .
     sethook
     args
      (
      explist
       exp
        string
         [[\n  # set a line hook after 3 count hooks\n  sethook 4 0 '\n    getglobal TT;\n    pushvalue -3; append -2\n    pushvalue -2; append -2\n  ']]
       ,
       exp
        string
         "c"
       ,
       exp
        number
         3
      )
   stat
    local
    attnamelist
     a
     attrib
    =
    explist
     exp
      number
       1
   stat
    varlist
     var
      a
    =
    explist
     exp
      number
       1
   stat
    varlist
     var
      a
    =
    explist
     exp
      number
       1
   stat
    varlist
     var
      a
    =
    explist
     exp
      number
       1
   stat
    varlist
     var
      a
    =
    explist
     exp
      number
       1
   stat
    functioncall
     debug
     .
     sethook
     args
      (
      )
   stat
    local
    attnamelist
     t
     attrib
    =
    explist
     exp
      prefixexp
       _G
       .
       TT
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         prefixexp
          t
          [
          exp
           number
            1
          ]
        ==
        exp
         string
          "line"
      )
   stat
    local
    attnamelist
     line
     attrib
    =
    explist
     exp
      prefixexp
       t
       [
       exp
        number
         2
       ]
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         exp
          prefixexp
           t
           [
           exp
            number
             3
           ]
         ==
         exp
          string
           "line"
        and
        exp
         exp
          prefixexp
           t
           [
           exp
            number
             4
           ]
         ==
         exp
          exp
           prefixexp
            line
          +
          exp
           number
            1
      )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         exp
          prefixexp
           t
           [
           exp
            number
             5
           ]
         ==
         exp
          string
           "line"
        and
        exp
         exp
          prefixexp
           t
           [
           exp
            number
             6
           ]
         ==
         exp
          exp
           prefixexp
            line
          +
          exp
           number
            2
      )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         prefixexp
          t
          [
          exp
           number
            7
          ]
        ==
        exp
         nil
      )
   stat
    varlist
     var
      prefixexp
       _G
      .
      TT
    =
    explist
     exp
      nil
   stat
    do
    block
     stat
      functioncall
       warn
       args
        (
        explist
         exp
          string
           "@off"
        )
     stat
      functioncall
       collectgarbage
       args
        (
        explist
         exp
          string
           "stop"
        )
     stat
      local
      attnamelist
       a
       attrib
      =
      explist
       exp
        tableconstructor
         {
         }
     stat
      for
      i
      =
      exp
       number
        1
      ,
      exp
       number
        20
      do
      block
       stat
        varlist
         var
          prefixexp
           a
          [
          exp
           prefixexp
            i
          ]
        =
        explist
         exp
          prefixexp
           functioncall
            T
            .
            newuserdata
            args
             (
             explist
              exp
               prefixexp
                i
             )
      end
     stat
      for
      i
      =
      exp
       number
        1
      ,
      exp
       number
        20
      ,
      exp
       number
        2
      do
      block
       stat
        functioncall
         debug
         .
         setmetatable
         args
          (
          explist
           exp
            prefixexp
             a
             [
             exp
              prefixexp
               i
             ]
           ,
           exp
            tableconstructor
             {
             fieldlist
              field
               __gc
               =
               exp
                functiondef
                 function
                 funcbody
                  (
                  parlist
                   namelist
                    x
                  )
                  block
                   stat
                    functioncall
                     error
                     args
                      (
                      explist
                       exp
                        string
                         "@expected error in gc"
                      )
                  end
             }
          )
      end
     stat
      for
      i
      =
      exp
       number
        2
      ,
      exp
       number
        20
      ,
      exp
       number
        2
      do
      block
       stat
        functioncall
         debug
         .
         setmetatable
         args
          (
          explist
           exp
            prefixexp
             a
             [
             exp
              prefixexp
               i
             ]
           ,
           exp
            tableconstructor
             {
             fieldlist
              field
               __gc
               =
               exp
                functiondef
                 function
                 funcbody
                  (
                  parlist
                   namelist
                    x
                  )
                  block
                   stat
                    functioncall
                     functioncall
                      load
                      args
                       (
                       explist
                        exp
                         string
                          "A=A+1"
                       )
                     args
                      (
                      )
                  end
             }
          )
      end
     stat
      varlist
       var
        a
      =
      explist
       exp
        nil
     stat
      varlist
       var
        prefixexp
         _G
        .
        A
      =
      explist
       exp
        number
         0
     stat
      functioncall
       collectgarbage
       args
        (
        )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           prefixexp
            A
          ==
          exp
           number
            10
        )
     stat
      functioncall
       collectgarbage
       args
        (
        explist
         exp
          string
           "restart"
        )
     stat
      functioncall
       warn
       args
        (
        explist
         exp
          string
           "@on"
        )
    end
   stat
    varlist
     var
      prefixexp
       _G
      .
      A
    =
    explist
     exp
      nil
   stat
    do
    block
     stat
      local
      attnamelist
       a
       attrib
      =
      explist
       exp
        tableconstructor
         {
         }
     stat
      ;
     stat
      local
      attnamelist
       lim
       attrib
      =
      explist
       exp
        number
         30
     stat
      for
      i
      =
      exp
       number
        0
      ,
      exp
       prefixexp
        lim
      do
      block
       stat
        varlist
         var
          prefixexp
           a
          [
          exp
           prefixexp
            i
          ]
        =
        explist
         exp
          prefixexp
           functioncall
            T
            .
            pushuserdata
            args
             (
             explist
              exp
               prefixexp
                i
             )
      end
     stat
      for
      i
      =
      exp
       number
        0
      ,
      exp
       prefixexp
        lim
      do
      block
       stat
        functioncall
         assert
         args
          (
          explist
           exp
            exp
             prefixexp
              functioncall
               T
               .
               udataval
               args
                (
                explist
                 exp
                  prefixexp
                   a
                   [
                   exp
                    prefixexp
                     i
                   ]
                )
            ==
            exp
             prefixexp
              i
          )
      end
     stat
      for
      i
      =
      exp
       number
        0
      ,
      exp
       prefixexp
        lim
      do
      block
       stat
        functioncall
         assert
         args
          (
          explist
           exp
            exp
             prefixexp
              functioncall
               T
               .
               pushuserdata
               args
                (
                explist
                 exp
                  prefixexp
                   i
                )
            ==
            exp
             prefixexp
              a
              [
              exp
               prefixexp
                i
              ]
          )
      end
     stat
      for
      i
      =
      exp
       number
        0
      ,
      exp
       prefixexp
        lim
      do
      block
       stat
        varlist
         var
          prefixexp
           a
          [
          exp
           prefixexp
            a
            [
            exp
             prefixexp
              i
            ]
          ]
        =
        explist
         exp
          prefixexp
           i
      end
     stat
      for
      i
      =
      exp
       number
        0
      ,
      exp
       prefixexp
        lim
      do
      block
       stat
        varlist
         var
          prefixexp
           a
          [
          exp
           prefixexp
            functioncall
             T
             .
             pushuserdata
             args
              (
              explist
               exp
                prefixexp
                 i
              )
          ]
        =
        explist
         exp
          prefixexp
           i
      end
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           prefixexp
            functioncall
             type
             args
              (
              explist
               exp
                prefixexp
                 functioncall
                  tostring
                  args
                   (
                   explist
                    exp
                     prefixexp
                      a
                      [
                      exp
                       number
                        1
                      ]
                   )
              )
          ==
          exp
           string
            "string"
        )
    end
   stat
    functioncall
     T
     .
     closestate
     args
      (
      explist
       exp
        prefixexp
         functioncall
          T
          .
          newstate
          args
           (
           )
      )
   stat
    ;
   stat
    varlist
     var
      L1
    =
    explist
     exp
      prefixexp
       functioncall
        T
        .
        newstate
        args
         (
         )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        prefixexp
         L1
      )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         prefixexp
          functioncall
           T
           .
           doremote
           args
            (
            explist
             exp
              prefixexp
               L1
             ,
             exp
              string
               "X='a'; return 'a'"
            )
        ==
        exp
         string
          'a'
      )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         #
         exp
          prefixexp
           functioncall
            pack
            args
             (
             explist
              exp
               prefixexp
                functioncall
                 T
                 .
                 doremote
                 args
                  (
                  explist
                   exp
                    prefixexp
                     L1
                   ,
                   exp
                    string
                     "function f () return 'alo', 3 end; f()"
                  )
             )
        ==
        exp
         number
          0
      )
   stat
    varlist
     var
      a
     ,
     var
      b
    =
    explist
     exp
      prefixexp
       functioncall
        T
        .
        doremote
        args
         (
         explist
          exp
           prefixexp
            L1
          ,
          exp
           string
            "return f()"
         )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         exp
          prefixexp
           a
         ==
         exp
          string
           'alo'
        and
        exp
         exp
          prefixexp
           b
         ==
         exp
          string
           '3'
      )
   stat
    functioncall
     T
     .
     doremote
     args
      (
      explist
       exp
        prefixexp
         L1
       ,
       exp
        string
         "_ERRORMESSAGE = nil"
      )
   stat
    varlist
     var
      a
     ,
     var
      b
     ,
     var
      c
    =
    explist
     exp
      prefixexp
       functioncall
        T
        .
        doremote
        args
         (
         explist
          exp
           prefixexp
            L1
          ,
          exp
           string
            "return sin(1)"
         )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         exp
          prefixexp
           a
         ==
         exp
          nil
        and
        exp
         exp
          prefixexp
           c
         ==
         exp
          number
           2
      )
   stat
    varlist
     var
      a
     ,
     var
      b
     ,
     var
      c
    =
    explist
     exp
      prefixexp
       functioncall
        T
        .
        doremote
        args
         (
         explist
          exp
           prefixexp
            L1
          ,
          exp
           string
            "return a+"
         )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         exp
          exp
           prefixexp
            a
          ==
          exp
           nil
         and
         exp
          exp
           prefixexp
            c
          ==
          exp
           number
            3
        and
        exp
         exp
          prefixexp
           functioncall
            type
            args
             (
             explist
              exp
               prefixexp
                b
             )
         ==
         exp
          string
           "string"
      )
   stat
    functioncall
     T
     .
     loadlib
     args
      (
      explist
       exp
        prefixexp
         L1
      )
   stat
    varlist
     var
      a
     ,
     var
      b
     ,
     var
      c
    =
    explist
     exp
      prefixexp
       functioncall
        T
        .
        doremote
        args
         (
         explist
          exp
           prefixexp
            L1
          ,
          exp
           string
            [[\n  string = require'string'\n  a = require'_G'; assert(a == _G and require("_G") == a)\n  io = require'io'; assert(type(io.read) == "function")\n  assert(require("io") == io)\n  a = require'table'; assert(type(a.insert) == "function")\n  a = require'debug'; assert(type(a.getlocal) == "function")\n  a = require'math'; assert(type(a.sin) == "function")\n  return string.sub('okinama', 1, 2)\n]]
         )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         prefixexp
          a
        ==
        exp
         string
          "ok"
      )
   stat
    functioncall
     T
     .
     closestate
     args
      (
      explist
       exp
        prefixexp
         L1
      )
   stat
    ;
   stat
    varlist
     var
      L1
    =
    explist
     exp
      prefixexp
       functioncall
        T
        .
        newstate
        args
         (
         )
   stat
    functioncall
     T
     .
     loadlib
     args
      (
      explist
       exp
        prefixexp
         L1
      )
   stat
    functioncall
     T
     .
     doremote
     args
      (
      explist
       exp
        prefixexp
         L1
       ,
       exp
        string
         "a = {}"
      )
   stat
    functioncall
     T
     .
     testC
     args
      (
      explist
       exp
        prefixexp
         L1
       ,
       exp
        string
         [[getglobal "a"; pushstring "x"; pushint 1;\n             settable -3]]
      )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         prefixexp
          functioncall
           T
           .
           doremote
           args
            (
            explist
             exp
              prefixexp
               L1
             ,
             exp
              string
               "return a.x"
            )
        ==
        exp
         string
          "1"
      )
   stat
    functioncall
     T
     .
     closestate
     args
      (
      explist
       exp
        prefixexp
         L1
      )
   stat
    varlist
     var
      L1
    =
    explist
     exp
      nil
   stat
    functioncall
     print
     args
      (
      explist
       exp
        string
         '+'
      )
   stat
    functioncall
     print
     args
      string
       "testing to-be-closed variables"
   stat
    do
    block
     stat
      local
      attnamelist
       openresource
       attrib
      =
      explist
       exp
        tableconstructor
         {
         }
     stat
      local
      function
      newresource
      funcbody
       (
       parlist
       )
       block
        stat
         local
         attnamelist
          x
          attrib
         =
         explist
          exp
           prefixexp
            functioncall
             setmetatable
             args
              (
              explist
               exp
                tableconstructor
                 {
                 fieldlist
                  field
                   exp
                    number
                     10
                 }
               ,
               exp
                tableconstructor
                 {
                 fieldlist
                  field
                   __close
                   =
                   exp
                    functiondef
                     function
                     funcbody
                      (
                      parlist
                       namelist
                        y
                      )
                      block
                       stat
                        functioncall
                         assert
                         args
                          (
                          explist
                           exp
                            exp
                             prefixexp
                              openresource
                              [
                              exp
                               #
                               exp
                                prefixexp
                                 openresource
                              ]
                            ==
                            exp
                             prefixexp
                              y
                          )
                       stat
                        varlist
                         var
                          prefixexp
                           openresource
                          [
                          exp
                           #
                           exp
                            prefixexp
                             openresource
                          ]
                        =
                        explist
                         exp
                          nil
                       stat
                        varlist
                         var
                          prefixexp
                           y
                          [
                          exp
                           number
                            1
                          ]
                        =
                        explist
                         exp
                          exp
                           prefixexp
                            y
                            [
                            exp
                             number
                              1
                            ]
                          +
                          exp
                           number
                            1
                      end
                 }
              )
        stat
         varlist
          var
           prefixexp
            openresource
           [
           exp
            exp
             #
             exp
              prefixexp
               openresource
            +
            exp
             number
              1
           ]
         =
         explist
          exp
           prefixexp
            x
        retstat
         return
         explist
          exp
           prefixexp
            x
       end
     stat
      local
      attnamelist
       a
       attrib
       ,
       b
       attrib
      =
      explist
       exp
        prefixexp
         functioncall
          T
          .
          testC
          args
           (
           explist
            exp
             string
              [[\n    call 0 1   # create resource\n    pushnil\n    toclose -2  # mark call result to be closed\n    toclose -1  # mark nil to be closed (will be ignored)\n    return 2\n  ]]
            ,
            exp
             prefixexp
              newresource
           )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           exp
            prefixexp
             a
             [
             exp
              number
               1
             ]
           ==
           exp
            number
             11
          and
          exp
           exp
            prefixexp
             b
           ==
           exp
            nil
        )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           #
           exp
            prefixexp
             openresource
          ==
          exp
           number
            0
        )
     stat
      local
      attnamelist
       a
       attrib
      =
      explist
       exp
        tableconstructor
         {
         fieldlist
          field
           exp
            prefixexp
             functioncall
              T
              .
              testC
              args
               (
               explist
                exp
                 string
                  [[\n    call 0 1   # create resource\n    toclose 2 # mark it to be closed\n    return 2\n  ]]
                ,
                exp
                 prefixexp
                  newresource
               )
         }
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           exp
            prefixexp
             functioncall
              type
              args
               (
               explist
                exp
                 prefixexp
                  a
                  [
                  exp
                   number
                    1
                  ]
               )
           ==
           exp
            string
             "string"
          and
          exp
           exp
            prefixexp
             a
             [
             exp
              number
               2
             ]
             [
             exp
              number
               1
             ]
           ==
           exp
            number
             11
        )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           #
           exp
            prefixexp
             openresource
          ==
          exp
           number
            0
        )
     stat
      local
      attnamelist
       a
       attrib
       ,
       b
       attrib
      =
      explist
       exp
        prefixexp
         functioncall
          pcall
          args
           (
           explist
            exp
             prefixexp
              functioncall
               T
               .
               makeCfunc
               args
                string
                 [[\n    call 0 1   # create resource\n    toclose -1 # mark it to be closed\n    error       # resource is the error object\n  ]]
            ,
            exp
             prefixexp
              newresource
           )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           exp
            prefixexp
             a
           ==
           exp
            false
          and
          exp
           exp
            prefixexp
             b
             [
             exp
              number
               1
             ]
           ==
           exp
            number
             11
        )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           #
           exp
            prefixexp
             openresource
          ==
          exp
           number
            0
        )
     stat
      local
      attnamelist
       a
       attrib
       ,
       b
       attrib
      =
      explist
       exp
        prefixexp
         functioncall
          pcall
          args
           (
           explist
            exp
             prefixexp
              functioncall
               T
               .
               makeCfunc
               args
                string
                 [[\n    newtable   # create non-closable object\n    toclose -1 # mark it to be closed (should raise an error)\n    abort  # will not be executed\n  ]]
           )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           exp
            prefixexp
             a
           ==
           exp
            false
          and
          exp
           prefixexp
            functioncall
             string
             .
             find
             args
              (
              explist
               exp
                prefixexp
                 b
               ,
               exp
                string
                 "non%-closable value"
              )
        )
     stat
      local
      function
      check
      funcbody
       (
       parlist
        namelist
         n
       )
       block
        stat
         functioncall
          assert
          args
           (
           explist
            exp
             exp
              #
              exp
               prefixexp
                openresource
             ==
             exp
              prefixexp
               n
           )
       end
     stat
      varlist
       var
        prefixexp
         _ENV
        .
        xxx
      =
      explist
       exp
        true
     stat
      local
      attnamelist
       a
       attrib
      =
      explist
       exp
        prefixexp
         functioncall
          T
          .
          testC
          args
           (
           explist
            exp
             string
              [[\n    pushvalue 2  # stack: S, NR, CH, NR\n    call 0 1   # create resource; stack: S, NR, CH, R\n    toclose -1 # mark it to be closed\n    pushvalue 2  #  stack: S, NR, CH, R, NR\n    call 0 1   # create another resource; stack: S, NR, CH, R, R\n    toclose -1 # mark it to be closed\n    pushvalue 3  # stack: S, NR, CH, R, R, CH\n    pushint 2   # there should be two open resources\n    call 1 0  #  stack: S, NR, CH, R, R\n    closeslot -1   # close second resource\n    pushvalue 3  # stack: S, NR, CH, R, R, CH\n    pushint 1   # there should be one open resource\n    call 1 0  # stack: S, NR, CH, R, R\n    closeslot 4\n    setglobal "xxx"  # previous op. erased the slot\n    pop 1       # pop other resource from the stack\n    pushint *\n    return 1    # return stack size\n  ]]
            ,
            exp
             prefixexp
              newresource
            ,
            exp
             prefixexp
              check
           )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           exp
            prefixexp
             a
           ==
           exp
            number
             3
          and
          exp
           exp
            prefixexp
             _ENV
             .
             xxx
           ==
           exp
            nil
        )
     stat
      local
      attnamelist
       a
       attrib
      =
      explist
       exp
        prefixexp
         functioncall
          T
          .
          testC
          args
           (
           explist
            exp
             string
              [[\n    pushvalue 2  # stack: S, NR, CH, NR\n    call 0 1   # create resource; stack: S, NR, CH, R\n    toclose -1 # mark it to be closed\n    pushvalue 2  #  stack: S, NR, CH, R, NR\n    call 0 1   # create another resource; stack: S, NR, CH, R, R\n    toclose -1 # mark it to be closed\n    pushvalue 3  # stack: S, NR, CH, R, R, CH\n    pushint 2   # there should be two open resources\n    call 1 0  #  stack: S, NR, CH, R, R\n    pop 1   # pop second resource\n    pushvalue 3  # stack: S, NR, CH, R, CH\n    pushint 1   # there should be one open resource\n    call 1 0  # stack: S, NR, CH, R\n    pop 1       # pop other resource from the stack\n    pushvalue 3  # stack: S, NR, CH, CH\n    pushint 0   # there should be no open resources\n    call 1 0  # stack: S, NR, CH\n    pushint *\n    return 1    # return stack size\n  ]]
            ,
            exp
             prefixexp
              newresource
            ,
            exp
             prefixexp
              check
           )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           prefixexp
            a
          ==
          exp
           number
            3
        )
     stat
      local
      attnamelist
       a
       attrib
       ,
       b
       attrib
      =
      explist
       exp
        prefixexp
         functioncall
          pcall
          args
           (
           explist
            exp
             prefixexp
              functioncall
               T
               .
               makeCfunc
               args
                string
                 [[\n    pushint 32\n    toclose -1\n  ]]
           )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           not
           exp
            prefixexp
             a
          and
          exp
           prefixexp
            functioncall
             string
             .
             find
             args
              (
              explist
               exp
                prefixexp
                 b
               ,
               exp
                string
                 "(C temporary)"
              )
        )
    end
   stat
    functioncall
     print
     args
      (
      explist
       exp
        string
         "memory-allocation errors"
      )
   stat
    functioncall
     checkerr
     args
      (
      explist
       exp
        string
         "block too big"
       ,
       exp
        prefixexp
         T
         .
         newuserdata
       ,
       exp
        prefixexp
         math
         .
         maxinteger
      )
   stat
    functioncall
     collectgarbage
     args
      (
      )
   stat
    local
    attnamelist
     f
     attrib
    =
    explist
     exp
      prefixexp
       functioncall
        load
        args
         string
          "local a={}; for i=1,100000 do a[i]=i end"
   stat
    functioncall
     T
     .
     alloccount
     args
      (
      explist
       exp
        number
         10
      )
   stat
    functioncall
     checkerr
     args
      (
      explist
       exp
        prefixexp
         MEMERRMSG
       ,
       exp
        prefixexp
         f
      )
   stat
    functioncall
     T
     .
     alloccount
     args
      (
      )
   stat
    local
    function
    testbytes
    funcbody
     (
     parlist
      namelist
       s
       ,
       f
     )
     block
      stat
       functioncall
        collectgarbage
        args
         (
         )
      stat
       local
       attnamelist
        M
        attrib
       =
       explist
        exp
         prefixexp
          functioncall
           T
           .
           totalmem
           args
            (
            )
      stat
       local
       attnamelist
        oldM
        attrib
       =
       explist
        exp
         prefixexp
          M
      stat
       local
       attnamelist
        a
        attrib
        ,
        b
        attrib
       =
       explist
        exp
         nil
      stat
       while
       exp
        true
       do
       block
        stat
         functioncall
          collectgarbage
          args
           (
           )
        stat
         ;
        stat
         functioncall
          collectgarbage
          args
           (
           )
        stat
         functioncall
          T
          .
          totalmem
          args
           (
           explist
            exp
             prefixexp
              M
           )
        stat
         varlist
          var
           a
          ,
          var
           b
         =
         explist
          exp
           prefixexp
            functioncall
             T
             .
             testC
             args
              (
              explist
               exp
                string
                 "pcall 0 1 0; pushstatus; return 2"
               ,
               exp
                prefixexp
                 f
              )
        stat
         functioncall
          T
          .
          totalmem
          args
           (
           explist
            exp
             number
              0
           )
        stat
         if
         exp
          exp
           prefixexp
            a
          and
          exp
           exp
            prefixexp
             b
           ==
           exp
            string
             "OK"
         then
         block
          stat
           break
         end
        stat
         if
         exp
          exp
           exp
            prefixexp
             b
           ~=
           exp
            string
             "OK"
          and
          exp
           exp
            prefixexp
             b
           ~=
           exp
            prefixexp
             MEMERRMSG
         then
         block
          stat
           functioncall
            error
            args
             (
             explist
              exp
               prefixexp
                a
              ,
              exp
               number
                0
             )
         end
        stat
         varlist
          var
           M
         =
         explist
          exp
           exp
            prefixexp
             M
           +
           exp
            number
             7
       end
      stat
       functioncall
        print
        args
         (
         explist
          exp
           prefixexp
            functioncall
             string
             .
             format
             args
              (
              explist
               exp
                string
                 "minimum memory for %s: %d bytes"
               ,
               exp
                prefixexp
                 s
               ,
               exp
                exp
                 prefixexp
                  M
                -
                exp
                 prefixexp
                  oldM
              )
         )
      retstat
       return
       explist
        exp
         prefixexp
          a
     end
   stat
    local
    function
    testalloc
    funcbody
     (
     parlist
      namelist
       s
       ,
       f
     )
     block
      stat
       functioncall
        collectgarbage
        args
         (
         )
      stat
       local
       attnamelist
        M
        attrib
       =
       explist
        exp
         number
          0
      stat
       local
       attnamelist
        a
        attrib
        ,
        b
        attrib
       =
       explist
        exp
         nil
      stat
       while
       exp
        true
       do
       block
        stat
         functioncall
          collectgarbage
          args
           (
           )
        stat
         ;
        stat
         functioncall
          collectgarbage
          args
           (
           )
        stat
         functioncall
          T
          .
          alloccount
          args
           (
           explist
            exp
             prefixexp
              M
           )
        stat
         varlist
          var
           a
          ,
          var
           b
         =
         explist
          exp
           prefixexp
            functioncall
             T
             .
             testC
             args
              (
              explist
               exp
                string
                 "pcall 0 1 0; pushstatus; return 2"
               ,
               exp
                prefixexp
                 f
              )
        stat
         functioncall
          T
          .
          alloccount
          args
           (
           )
        stat
         if
         exp
          exp
           prefixexp
            a
          and
          exp
           exp
            prefixexp
             b
           ==
           exp
            string
             "OK"
         then
         block
          stat
           break
         end
        stat
         if
         exp
          exp
           exp
            prefixexp
             b
           ~=
           exp
            string
             "OK"
          and
          exp
           exp
            prefixexp
             b
           ~=
           exp
            prefixexp
             MEMERRMSG
         then
         block
          stat
           functioncall
            error
            args
             (
             explist
              exp
               prefixexp
                a
              ,
              exp
               number
                0
             )
         end
        stat
         varlist
          var
           M
         =
         explist
          exp
           exp
            prefixexp
             M
           +
           exp
            number
             1
       end
      stat
       functioncall
        print
        args
         (
         explist
          exp
           prefixexp
            functioncall
             string
             .
             format
             args
              (
              explist
               exp
                string
                 "minimum allocations for %s: %d allocations"
               ,
               exp
                prefixexp
                 s
               ,
               exp
                prefixexp
                 M
              )
         )
      retstat
       return
       explist
        exp
         prefixexp
          a
     end
   stat
    local
    function
    testamem
    funcbody
     (
     parlist
      namelist
       s
       ,
       f
     )
     block
      stat
       functioncall
        testalloc
        args
         (
         explist
          exp
           prefixexp
            s
          ,
          exp
           prefixexp
            f
         )
      retstat
       return
       explist
        exp
         prefixexp
          functioncall
           testbytes
           args
            (
            explist
             exp
              prefixexp
               s
             ,
             exp
              prefixexp
               f
            )
     end
   stat
    varlist
     var
      b
    =
    explist
     exp
      prefixexp
       functioncall
        testamem
        args
         (
         explist
          exp
           string
            "doing nothing"
          ,
          exp
           functiondef
            function
            funcbody
             (
             parlist
             )
             block
              retstat
               return
               explist
                exp
                 number
                  10
             end
         )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         prefixexp
          b
        ==
        exp
         number
          10
      )
   stat
    functioncall
     testamem
     args
      (
      explist
       exp
        string
         "state creation"
       ,
       exp
        functiondef
         function
         funcbody
          (
          parlist
          )
          block
           stat
            local
            attnamelist
             st
             attrib
            =
            explist
             exp
              prefixexp
               functioncall
                T
                .
                newstate
                args
                 (
                 )
           stat
            if
            exp
             prefixexp
              st
            then
            block
             stat
              functioncall
               T
               .
               closestate
               args
                (
                explist
                 exp
                  prefixexp
                   st
                )
            end
           retstat
            return
            explist
             exp
              prefixexp
               st
          end
      )
   stat
    functioncall
     testamem
     args
      (
      explist
       exp
        string
         "empty-table creation"
       ,
       exp
        functiondef
         function
         funcbody
          (
          parlist
          )
          block
           retstat
            return
            explist
             exp
              tableconstructor
               {
               }
          end
      )
   stat
    functioncall
     testamem
     args
      (
      explist
       exp
        string
         "string creation"
       ,
       exp
        functiondef
         function
         funcbody
          (
          parlist
          )
          block
           retstat
            return
            explist
             exp
              exp
               string
                "XXX"
              ..
              exp
               string
                "YYY"
          end
      )
   stat
    functioncall
     testamem
     args
      (
      explist
       exp
        string
         "coroutine creation"
       ,
       exp
        functiondef
         function
         funcbody
          (
          parlist
          )
          block
           retstat
            return
            explist
             exp
              prefixexp
               functioncall
                coroutine
                .
                create
                args
                 (
                 explist
                  exp
                   prefixexp
                    print
                 )
          end
      )
   stat
    functioncall
     testamem
     args
      (
      explist
       exp
        string
         "to-be-closed variables"
       ,
       exp
        functiondef
         function
         funcbody
          (
          parlist
          )
          block
           stat
            local
            attnamelist
             flag
             attrib
           stat
            do
            block
             stat
              local
              attnamelist
               x
               attrib
                <
                close
                >
              =
              explist
               exp
                prefixexp
                 functioncall
                  setmetatable
                  args
                   (
                   explist
                    exp
                     tableconstructor
                      {
                      }
                    ,
                    exp
                     tableconstructor
                      {
                      fieldlist
                       field
                        __close
                        =
                        exp
                         functiondef
                          function
                          funcbody
                           (
                           parlist
                           )
                           block
                            stat
                             varlist
                              var
                               flag
                             =
                             explist
                              exp
                               true
                           end
                      }
                   )
             stat
              varlist
               var
                flag
              =
              explist
               exp
                false
             stat
              local
              attnamelist
               x
               attrib
              =
              explist
               exp
                tableconstructor
                 {
                 }
            end
           retstat
            return
            explist
             exp
              prefixexp
               flag
          end
      )
   stat
    local
    attnamelist
     mt
     attrib
    =
    explist
     exp
      prefixexp
       functioncall
        T
        .
        testC
        args
         (
         explist
          exp
           string
            "rawgeti R 1; return 1"
         )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         exp
          prefixexp
           functioncall
            type
            args
             (
             explist
              exp
               prefixexp
                mt
             )
         ==
         exp
          string
           "thread"
        and
        exp
         exp
          prefixexp
           functioncall
            coroutine
            .
            running
            args
             (
             )
         ==
         exp
          prefixexp
           mt
      )
   stat
    local
    function
    expand
    funcbody
     (
     parlist
      namelist
       n
       ,
       s
     )
     block
      stat
       if
       exp
        exp
         prefixexp
          n
        ==
        exp
         number
          0
       then
       block
        retstat
         return
         explist
          exp
           string
            ""
       end
      stat
       local
       attnamelist
        e
        attrib
       =
       explist
        exp
         prefixexp
          functioncall
           string
           .
           rep
           args
            (
            explist
             exp
              string
               "="
             ,
             exp
              prefixexp
               n
            )
      retstat
       return
       explist
        exp
         prefixexp
          functioncall
           string
           .
           format
           args
            (
            explist
             exp
              string
               "T.doonnewstack([%s[ %s;\n collectgarbage(); %s]%s])\n"
             ,
             exp
              prefixexp
               e
             ,
             exp
              prefixexp
               s
             ,
             exp
              prefixexp
               functioncall
                expand
                args
                 (
                 explist
                  exp
                   exp
                    prefixexp
                     n
                   -
                   exp
                    number
                     1
                  ,
                  exp
                   prefixexp
                    s
                 )
             ,
             exp
              prefixexp
               e
            )
     end
   stat
    varlist
     var
      G
    =
    explist
     exp
      number
       0
   stat
    ;
   stat
    functioncall
     collectgarbage
     args
      (
      )
   stat
    ;
   stat
    varlist
     var
      a
    =
    explist
     exp
      prefixexp
       functioncall
        collectgarbage
        args
         (
         explist
          exp
           string
            "count"
         )
   stat
    functioncall
     functioncall
      load
      args
       (
       explist
        exp
         prefixexp
          functioncall
           expand
           args
            (
            explist
             exp
              number
               20
             ,
             exp
              string
               "G=G+1"
            )
       )
     args
      (
      )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         prefixexp
          G
        ==
        exp
         number
          20
      )
   stat
    ;
   stat
    functioncall
     collectgarbage
     args
      (
      )
   stat
    ;
   stat
    varlist
     var
      G
    =
    explist
     exp
      nil
   stat
    functioncall
     testamem
     args
      (
      explist
       exp
        string
         "running code on new thread"
       ,
       exp
        functiondef
         function
         funcbody
          (
          parlist
          )
          block
           retstat
            return
            explist
             exp
              exp
               prefixexp
                functioncall
                 T
                 .
                 doonnewstack
                 args
                  (
                  explist
                   exp
                    string
                     "local x=1"
                  )
              ==
              exp
               number
                0
          end
      )
   stat
    functioncall
     testamem
     args
      (
      explist
       exp
        string
         "loadstring"
       ,
       exp
        functiondef
         function
         funcbody
          (
          parlist
          )
          block
           retstat
            return
            explist
             exp
              prefixexp
               functioncall
                load
                args
                 (
                 explist
                  exp
                   string
                    "x=1"
                 )
          end
      )
   stat
    local
    attnamelist
     testprog
     attrib
    =
    explist
     exp
      string
       [[\nlocal function foo () return end\nlocal t = {"x"}\nAA = "aaa"\nfor i = 1, #t do AA = AA .. t[i] end\nreturn true\n]]
   stat
    varlist
     var
      prefixexp
       _G
      .
      AA
    =
    explist
     exp
      nil
   stat
    local
    attnamelist
     t
     attrib
    =
    explist
     exp
      prefixexp
       functioncall
        os
        .
        tmpname
        args
         (
         )
   stat
    local
    attnamelist
     f
     attrib
    =
    explist
     exp
      prefixexp
       functioncall
        assert
        args
         (
         explist
          exp
           prefixexp
            functioncall
             io
             .
             open
             args
              (
              explist
               exp
                prefixexp
                 t
               ,
               exp
                string
                 "w"
              )
         )
   stat
    functioncall
     f
     :
     write
     args
      (
      explist
       exp
        prefixexp
         testprog
      )
   stat
    functioncall
     f
     :
     close
     args
      (
      )
   stat
    functioncall
     testamem
     args
      (
      explist
       exp
        string
         "dofile"
       ,
       exp
        functiondef
         function
         funcbody
          (
          parlist
          )
          block
           stat
            local
            attnamelist
             a
             attrib
            =
            explist
             exp
              prefixexp
               functioncall
                loadfile
                args
                 (
                 explist
                  exp
                   prefixexp
                    t
                 )
           retstat
            return
            explist
             exp
              exp
               prefixexp
                a
              and
              exp
               prefixexp
                functioncall
                 a
                 args
                  (
                  )
          end
      )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        prefixexp
         functioncall
          os
          .
          remove
          args
           (
           explist
            exp
             prefixexp
              t
           )
      )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         prefixexp
          _G
          .
          AA
        ==
        exp
         string
          "aaax"
      )
   stat
    functioncall
     testamem
     args
      (
      explist
       exp
        string
         "gsub"
       ,
       exp
        functiondef
         function
         funcbody
          (
          parlist
          )
          block
           stat
            local
            attnamelist
             a
             attrib
             ,
             b
             attrib
            =
            explist
             exp
              prefixexp
               functioncall
                string
                .
                gsub
                args
                 (
                 explist
                  exp
                   string
                    "alo alo"
                  ,
                  exp
                   string
                    "(a)"
                  ,
                  exp
                   functiondef
                    function
                    funcbody
                     (
                     parlist
                      namelist
                       x
                     )
                     block
                      retstat
                       return
                       explist
                        exp
                         exp
                          prefixexp
                           x
                         ..
                         exp
                          string
                           'b'
                     end
                 )
           retstat
            return
            explist
             exp
              prefixexp
               (
               exp
                exp
                 prefixexp
                  a
                ==
                exp
                 string
                  'ablo ablo'
               )
          end
      )
   stat
    functioncall
     testamem
     args
      (
      explist
       exp
        string
         "dump/undump"
       ,
       exp
        functiondef
         function
         funcbody
          (
          parlist
          )
          block
           stat
            local
            attnamelist
             a
             attrib
            =
            explist
             exp
              prefixexp
               functioncall
                load
                args
                 (
                 explist
                  exp
                   prefixexp
                    testprog
                 )
           stat
            local
            attnamelist
             b
             attrib
            =
            explist
             exp
              exp
               prefixexp
                a
              and
              exp
               prefixexp
                functioncall
                 string
                 .
                 dump
                 args
                  (
                  explist
                   exp
                    prefixexp
                     a
                  )
           stat
            varlist
             var
              a
            =
            explist
             exp
              exp
               prefixexp
                b
              and
              exp
               prefixexp
                functioncall
                 load
                 args
                  (
                  explist
                   exp
                    prefixexp
                     b
                  )
           retstat
            return
            explist
             exp
              exp
               prefixexp
                a
              and
              exp
               prefixexp
                functioncall
                 a
                 args
                  (
                  )
          end
      )
   stat
    varlist
     var
      prefixexp
       _G
      .
      AA
    =
    explist
     exp
      nil
   stat
    local
    attnamelist
     t
     attrib
    =
    explist
     exp
      prefixexp
       functioncall
        os
        .
        tmpname
        args
         (
         )
   stat
    functioncall
     testamem
     args
      (
      explist
       exp
        string
         "file creation"
       ,
       exp
        functiondef
         function
         funcbody
          (
          parlist
          )
          block
           stat
            local
            attnamelist
             f
             attrib
            =
            explist
             exp
              prefixexp
               functioncall
                assert
                args
                 (
                 explist
                  exp
                   prefixexp
                    functioncall
                     io
                     .
                     open
                     args
                      (
                      explist
                       exp
                        prefixexp
                         t
                       ,
                       exp
                        string
                         'w'
                      )
                 )
           stat
            functioncall
             assert
             args
              (
              explist
               exp
                not
                exp
                 prefixexp
                  functioncall
                   io
                   .
                   open
                   args
                    string
                     "nomenaoexistente"
              )
           stat
            functioncall
             io
             .
             close
             args
              (
              explist
               exp
                prefixexp
                 f
              )
           stat
            ;
           retstat
            return
            explist
             exp
              not
              exp
               prefixexp
                functioncall
                 loadfile
                 args
                  string
                   'nomenaoexistente'
          end
      )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        prefixexp
         functioncall
          os
          .
          remove
          args
           (
           explist
            exp
             prefixexp
              t
           )
      )
   stat
    functioncall
     testamem
     args
      (
      explist
       exp
        string
         "table creation"
       ,
       exp
        functiondef
         function
         funcbody
          (
          parlist
          )
          block
           stat
            local
            attnamelist
             a
             attrib
             ,
             lim
             attrib
            =
            explist
             exp
              tableconstructor
               {
               }
             ,
             exp
              number
               10
           stat
            for
            i
            =
            exp
             number
              1
            ,
            exp
             prefixexp
              lim
            do
            block
             stat
              varlist
               var
                prefixexp
                 a
                [
                exp
                 prefixexp
                  i
                ]
              =
              explist
               exp
                prefixexp
                 i
             stat
              ;
             stat
              varlist
               var
                prefixexp
                 a
                [
                exp
                 exp
                  prefixexp
                   i
                 ..
                 exp
                  string
                   'a'
                ]
              =
              explist
               exp
                tableconstructor
                 {
                 }
            end
           retstat
            return
            explist
             exp
              prefixexp
               (
               exp
                exp
                 exp
                  prefixexp
                   functioncall
                    type
                    args
                     (
                     explist
                      exp
                       prefixexp
                        a
                        [
                        exp
                         exp
                          prefixexp
                           lim
                         ..
                         exp
                          string
                           'a'
                        ]
                     )
                 ==
                 exp
                  string
                   'table'
                and
                exp
                 exp
                  prefixexp
                   a
                   [
                   exp
                    prefixexp
                     lim
                   ]
                 ==
                 exp
                  prefixexp
                   lim
               )
          end
      )
   stat
    functioncall
     testamem
     args
      (
      explist
       exp
        string
         "constructors"
       ,
       exp
        functiondef
         function
         funcbody
          (
          parlist
          )
          block
           stat
            local
            attnamelist
             a
             attrib
            =
            explist
             exp
              tableconstructor
               {
               fieldlist
                field
                 exp
                  number
                   10
                fieldsep
                 ,
                field
                 exp
                  number
                   20
                fieldsep
                 ,
                field
                 exp
                  number
                   30
                fieldsep
                 ,
                field
                 exp
                  number
                   40
                fieldsep
                 ,
                field
                 exp
                  number
                   50
                fieldsep
                 ;
                field
                 a
                 =
                 exp
                  number
                   1
                fieldsep
                 ,
                field
                 b
                 =
                 exp
                  number
                   2
                fieldsep
                 ,
                field
                 c
                 =
                 exp
                  number
                   3
                fieldsep
                 ,
                field
                 d
                 =
                 exp
                  number
                   4
                fieldsep
                 ,
                field
                 e
                 =
                 exp
                  number
                   5
               }
           retstat
            return
            explist
             exp
              prefixexp
               (
               exp
                exp
                 exp
                  prefixexp
                   functioncall
                    type
                    args
                     (
                     explist
                      exp
                       prefixexp
                        a
                     )
                 ==
                 exp
                  string
                   'table'
                and
                exp
                 exp
                  prefixexp
                   a
                   .
                   e
                 ==
                 exp
                  number
                   5
               )
          end
      )
   stat
    local
    attnamelist
     a
     attrib
    =
    explist
     exp
      number
       1
   stat
    local
    attnamelist
     close
     attrib
    =
    explist
     exp
      nil
   stat
    functioncall
     testamem
     args
      (
      explist
       exp
        string
         "closure creation"
       ,
       exp
        functiondef
         function
         funcbody
          (
          parlist
          )
          block
           stat
            function
            funcname
             close
            funcbody
             (
             parlist
              namelist
               b
             )
             block
              retstat
               return
               explist
                exp
                 functiondef
                  function
                  funcbody
                   (
                   parlist
                    namelist
                     x
                   )
                   block
                    retstat
                     return
                     explist
                      exp
                       exp
                        prefixexp
                         b
                       +
                       exp
                        prefixexp
                         x
                   end
             end
           retstat
            return
            explist
             exp
              prefixexp
               (
               exp
                exp
                 prefixexp
                  functioncall
                   functioncall
                    close
                    args
                     (
                     explist
                      exp
                       number
                        2
                     )
                   args
                    (
                    explist
                     exp
                      number
                       4
                    )
                ==
                exp
                 number
                  6
               )
          end
      )
   stat
    functioncall
     testamem
     args
      (
      explist
       exp
        string
         "using coroutines"
       ,
       exp
        functiondef
         function
         funcbody
          (
          parlist
          )
          block
           stat
            local
            attnamelist
             a
             attrib
            =
            explist
             exp
              prefixexp
               functioncall
                coroutine
                .
                wrap
                args
                 (
                 explist
                  exp
                   functiondef
                    function
                    funcbody
                     (
                     parlist
                     )
                     block
                      stat
                       functioncall
                        coroutine
                        .
                        yield
                        args
                         (
                         explist
                          exp
                           prefixexp
                            functioncall
                             string
                             .
                             rep
                             args
                              (
                              explist
                               exp
                                string
                                 "a"
                               ,
                               exp
                                number
                                 10
                              )
                         )
                      retstat
                       return
                       explist
                        exp
                         tableconstructor
                          {
                          }
                     end
                 )
           stat
            functioncall
             assert
             args
              (
              explist
               exp
                exp
                 prefixexp
                  functioncall
                   string
                   .
                   len
                   args
                    (
                    explist
                     exp
                      prefixexp
                       functioncall
                        a
                        args
                         (
                         )
                    )
                ==
                exp
                 number
                  10
              )
           retstat
            return
            explist
             exp
              prefixexp
               functioncall
                a
                args
                 (
                 )
          end
      )
   stat
    do
    block
     stat
      local
      attnamelist
       lim
       attrib
      =
      explist
       exp
        number
         100
     stat
      local
      attnamelist
       a
       attrib
      =
      explist
       exp
        tableconstructor
         {
         }
     stat
      ;
     stat
      for
      i
      =
      exp
       number
        1
      ,
      exp
       prefixexp
        lim
      do
      block
       stat
        varlist
         var
          prefixexp
           a
          [
          exp
           prefixexp
            i
          ]
        =
        explist
         exp
          string
           "01234567890123456789"
      end
     stat
      functioncall
       testamem
       args
        (
        explist
         exp
          string
           "auxiliary buffer"
         ,
         exp
          functiondef
           function
           funcbody
            (
            parlist
            )
            block
             retstat
              return
              explist
               exp
                prefixexp
                 (
                 exp
                  exp
                   #
                   exp
                    prefixexp
                     functioncall
                      table
                      .
                      concat
                      args
                       (
                       explist
                        exp
                         prefixexp
                          a
                        ,
                        exp
                         string
                          ","
                       )
                  ==
                  exp
                   exp
                    exp
                     exp
                      number
                       20
                     *
                     exp
                      prefixexp
                       lim
                    +
                    exp
                     prefixexp
                      lim
                   -
                   exp
                    number
                     1
                 )
            end
        )
    end
   stat
    functioncall
     testamem
     args
      (
      explist
       exp
        string
         "growing stack"
       ,
       exp
        functiondef
         function
         funcbody
          (
          parlist
          )
          block
           stat
            local
            function
            foo
            funcbody
             (
             parlist
              namelist
               n
             )
             block
              stat
               if
               exp
                exp
                 prefixexp
                  n
                ==
                exp
                 number
                  0
               then
               block
                retstat
                 return
                 explist
                  exp
                   number
                    1
               else
               block
                retstat
                 return
                 explist
                  exp
                   exp
                    number
                     1
                   +
                   exp
                    prefixexp
                     functioncall
                      foo
                      args
                       (
                       explist
                        exp
                         exp
                          prefixexp
                           n
                         -
                         exp
                          number
                           1
                       )
               end
             end
           retstat
            return
            explist
             exp
              prefixexp
               functioncall
                foo
                args
                 (
                 explist
                  exp
                   number
                    100
                 )
          end
      )
   stat
    do
    block
     stat
      local
      attnamelist
       res
       attrib
      =
      explist
       exp
        prefixexp
         functioncall
          T
          .
          testC
          args
           (
           explist
            exp
             string
              [[rawcheckstack 500000; return 1]]
           )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           prefixexp
            res
          ==
          exp
           false
        )
     stat
      local
      attnamelist
       L
       attrib
      =
      explist
       exp
        prefixexp
         functioncall
          T
          .
          newstate
          args
           (
           )
     stat
      functioncall
       T
       .
       alloccount
       args
        (
        explist
         exp
          number
           0
        )
     stat
      varlist
       var
        res
      =
      explist
       exp
        prefixexp
         functioncall
          T
          .
          testC
          args
           (
           explist
            exp
             prefixexp
              L
            ,
            exp
             string
              [[rawcheckstack 5000; return 1]]
           )
     stat
      functioncall
       T
       .
       alloccount
       args
        (
        )
     stat
      functioncall
       T
       .
       closestate
       args
        (
        explist
         exp
          prefixexp
           L
        )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           prefixexp
            res
          ==
          exp
           false
        )
    end
   stat
    do
    block
     stat
      local
      attnamelist
       L
       attrib
      =
      explist
       exp
        prefixexp
         functioncall
          T
          .
          newstate
          args
           (
           )
     stat
      functioncall
       T
       .
       alloccount
       args
        (
        explist
         exp
          number
           0
        )
     stat
      functioncall
       T
       .
       closestate
       args
        (
        explist
         exp
          prefixexp
           L
        )
     stat
      functioncall
       T
       .
       alloccount
       args
        (
        )
    end
   stat
    do
    block
     stat
      local
      attnamelist
       L
       attrib
      =
      explist
       exp
        prefixexp
         functioncall
          T
          .
          newstate
          args
           (
           )
     stat
      functioncall
       T
       .
       loadlib
       args
        (
        explist
         exp
          prefixexp
           L
        )
     stat
      local
      attnamelist
       res
       attrib
      =
      explist
       exp
        prefixexp
         (
         exp
          prefixexp
           functioncall
            T
            .
            doremote
            args
             (
             explist
              exp
               prefixexp
                L
              ,
              exp
               string
                [[\n    _ENV = require"_G"\n    local T = require"T"\n    local a = {}\n    for i = 1, 1000 do a[i] = 'i' .. i end    -- grow string table\n    local stsize, stuse = T.querystr()\n    assert(stuse > 1000)\n    local function foo (n)\n      if n > 0 then foo(n - 1) end\n    end\n    foo(180)    -- grow stack\n    local _, stksize = T.stacklevel()\n    assert(stksize > 180)\n    a = nil\n    T.alloccount(0)\n    collectgarbage()\n    T.alloccount()\n    -- stack and string table could not be reallocated,\n    -- so they kept their sizes (without errors)\n    assert(select(2, T.stacklevel()) == stksize)\n    assert(T.querystr() == stsize)\n    return 'ok'\n  ]]
             )
         )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           prefixexp
            res
          ==
          exp
           string
            'ok'
        )
     stat
      functioncall
       T
       .
       closestate
       args
        (
        explist
         exp
          prefixexp
           L
        )
    end
   stat
    functioncall
     print
     args
      string
       '+'
   stat
    local
    function
    gsub
    funcbody
     (
     parlist
      namelist
       a
       ,
       b
       ,
       c
     )
     block
      stat
       varlist
        var
         a
        ,
        var
         b
       =
       explist
        exp
         prefixexp
          functioncall
           T
           .
           testC
           args
            (
            explist
             exp
              string
               "gsub 2 3 4; gettop; return 2"
             ,
             exp
              prefixexp
               a
             ,
             exp
              prefixexp
               b
             ,
             exp
              prefixexp
               c
            )
      stat
       functioncall
        assert
        args
         (
         explist
          exp
           exp
            prefixexp
             b
           ==
           exp
            number
             5
         )
      retstat
       return
       explist
        exp
         prefixexp
          a
     end
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         prefixexp
          functioncall
           gsub
           args
            (
            explist
             exp
              string
               "alo.alo.uhuh."
             ,
             exp
              string
               "."
             ,
             exp
              string
               "//"
            )
        ==
        exp
         string
          "alo//alo//uhuh//"
      )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         prefixexp
          functioncall
           gsub
           args
            (
            explist
             exp
              string
               "alo.alo.uhuh."
             ,
             exp
              string
               "alo"
             ,
             exp
              string
               "//"
            )
        ==
        exp
         string
          "//.//.uhuh."
      )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         prefixexp
          functioncall
           gsub
           args
            (
            explist
             exp
              string
               ""
             ,
             exp
              string
               "alo"
             ,
             exp
              string
               "//"
            )
        ==
        exp
         string
          ""
      )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         prefixexp
          functioncall
           gsub
           args
            (
            explist
             exp
              string
               "..."
             ,
             exp
              string
               "."
             ,
             exp
              string
               "/."
            )
        ==
        exp
         string
          "/././."
      )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         prefixexp
          functioncall
           gsub
           args
            (
            explist
             exp
              string
               "..."
             ,
             exp
              string
               "..."
             ,
             exp
              string
               ""
            )
        ==
        exp
         string
          ""
      )
   stat
    local
    attnamelist
     mt_xuxu
     attrib
     ,
     res
     attrib
     ,
     top
     attrib
    =
    explist
     exp
      prefixexp
       functioncall
        T
        .
        testC
        args
         (
         explist
          exp
           string
            "newmetatable xuxu; gettop; return 3"
         )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         exp
          exp
           prefixexp
            functioncall
             type
             args
              (
              explist
               exp
                prefixexp
                 mt_xuxu
              )
          ==
          exp
           string
            "table"
         and
         exp
          prefixexp
           res
        and
        exp
         exp
          prefixexp
           top
         ==
         exp
          number
           3
      )
   stat
    local
    attnamelist
     d
     attrib
     ,
     res
     attrib
     ,
     top
     attrib
    =
    explist
     exp
      prefixexp
       functioncall
        T
        .
        testC
        args
         (
         explist
          exp
           string
            "newmetatable xuxu; gettop; return 3"
         )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         exp
          exp
           prefixexp
            mt_xuxu
          ==
          exp
           prefixexp
            d
         and
         exp
          not
          exp
           prefixexp
            res
        and
        exp
         exp
          prefixexp
           top
         ==
         exp
          number
           3
      )
   stat
    varlist
     var
      d
     ,
     var
      res
     ,
     var
      top
    =
    explist
     exp
      prefixexp
       functioncall
        T
        .
        testC
        args
         (
         explist
          exp
           string
            "newmetatable xuxu1; gettop; return 3"
         )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         exp
          exp
           prefixexp
            mt_xuxu
          ~=
          exp
           prefixexp
            d
         and
         exp
          prefixexp
           res
        and
        exp
         exp
          prefixexp
           top
         ==
         exp
          number
           3
      )
   stat
    varlist
     var
      x
    =
    explist
     exp
      prefixexp
       functioncall
        T
        .
        newuserdata
        args
         (
         explist
          exp
           number
            0
         )
   stat
    ;
   stat
    varlist
     var
      y
    =
    explist
     exp
      prefixexp
       functioncall
        T
        .
        newuserdata
        args
         (
         explist
          exp
           number
            0
         )
   stat
    ;
   stat
    functioncall
     T
     .
     testC
     args
      (
      explist
       exp
        string
         "pushstring xuxu; gettable R; setmetatable 2"
       ,
       exp
        prefixexp
         x
      )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         prefixexp
          functioncall
           getmetatable
           args
            (
            explist
             exp
              prefixexp
               x
            )
        ==
        exp
         prefixexp
          mt_xuxu
      )
   stat
    local
    attnamelist
     res1
     attrib
     ,
     res2
     attrib
     ,
     top
     attrib
    =
    explist
     exp
      prefixexp
       functioncall
        T
        .
        testC
        args
         (
         explist
          exp
           string
            [[testudata -1 xuxu\n   \t \t\t\t  testudata 2 xuxu\n\t\t\t\t  gettop\n\t\t\t\t  return 3]]
          ,
          exp
           prefixexp
            x
         )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         exp
          prefixexp
           res1
         and
         exp
          prefixexp
           res2
        and
        exp
         exp
          prefixexp
           top
         ==
         exp
          number
           4
      )
   stat
    varlist
     var
      res1
     ,
     var
      res2
     ,
     var
      top
    =
    explist
     exp
      prefixexp
       functioncall
        T
        .
        testC
        args
         (
         explist
          exp
           string
            [[testudata -1 xuxu1\n\t\t\t    testudata 2 xuxu1\n\t\t\t    gettop\n\t\t\t    return 3]]
          ,
          exp
           prefixexp
            x
         )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         exp
          not
          exp
           prefixexp
            res1
         and
         exp
          not
          exp
           prefixexp
            res2
        and
        exp
         exp
          prefixexp
           top
         ==
         exp
          number
           4
      )
   stat
    varlist
     var
      res1
     ,
     var
      res2
     ,
     var
      top
    =
    explist
     exp
      prefixexp
       functioncall
        T
        .
        testC
        args
         (
         explist
          exp
           string
            [[testudata -1 xuxu2\n\t\t\t    testudata 2 xuxu2\n\t\t\t    gettop\n\t\t\t    return 3]]
          ,
          exp
           prefixexp
            x
         )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         exp
          not
          exp
           prefixexp
            res1
         and
         exp
          not
          exp
           prefixexp
            res2
        and
        exp
         exp
          prefixexp
           top
         ==
         exp
          number
           4
      )
   stat
    varlist
     var
      res1
     ,
     var
      res2
     ,
     var
      top
    =
    explist
     exp
      prefixexp
       functioncall
        T
        .
        testC
        args
         (
         explist
          exp
           string
            [[testudata -1 xuxu\n\t\t\t    testudata 2 xuxu\n\t\t\t    gettop\n\t\t\t    return 3]]
          ,
          exp
           prefixexp
            y
         )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         exp
          not
          exp
           prefixexp
            res1
         and
         exp
          not
          exp
           prefixexp
            res2
        and
        exp
         exp
          prefixexp
           top
         ==
         exp
          number
           4
      )
   stat
    do
    block
     stat
      local
      attnamelist
       r
       attrib
      =
      explist
       exp
        prefixexp
         functioncall
          debug
          .
          getregistry
          args
           (
           )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           exp
            prefixexp
             r
             .
             xuxu
           ==
           exp
            prefixexp
             mt_xuxu
          and
          exp
           exp
            prefixexp
             r
             .
             xuxu1
           ==
           exp
            prefixexp
             d
        )
     stat
      varlist
       var
        prefixexp
         r
        .
        xuxu
      =
      explist
       exp
        nil
     stat
      ;
     stat
      varlist
       var
        prefixexp
         r
        .
        xuxu1
      =
      explist
       exp
        nil
    end
   stat
    functioncall
     print
     args
      string
       'OK'
 <EOF>
