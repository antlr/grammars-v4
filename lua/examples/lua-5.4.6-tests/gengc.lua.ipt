start_
 chunk
  block
   stat
    functioncall
     print
     args
      (
      explist
       exp
        string
         'testing generational garbage collection'
      )
   stat
    local
    attnamelist
     debug
     attrib
    =
    explist
     exp
      prefixexp
       functioncall
        require
        args
         string
          "debug"
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        prefixexp
         functioncall
          collectgarbage
          args
           (
           explist
            exp
             string
              "isrunning"
           )
      )
   stat
    functioncall
     collectgarbage
     args
      (
      )
   stat
    local
    attnamelist
     oldmode
     attrib
    =
    explist
     exp
      prefixexp
       functioncall
        collectgarbage
        args
         (
         explist
          exp
           string
            "generational"
         )
   stat
    do
    block
     stat
      local
      attnamelist
       U
       attrib
      =
      explist
       exp
        tableconstructor
         {
         }
     stat
      functioncall
       collectgarbage
       args
        (
        )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           not
           exp
            prefixexp
             T
          or
          exp
           exp
            prefixexp
             functioncall
              T
              .
              gcage
              args
               (
               explist
                exp
                 prefixexp
                  U
               )
           ==
           exp
            string
             "old"
        )
     stat
      varlist
       var
        prefixexp
         U
        [
        exp
         number
          1
        ]
      =
      explist
       exp
        tableconstructor
         {
         fieldlist
          field
           x
           =
           exp
            tableconstructor
             {
             fieldlist
              field
               exp
                number
                 234
             }
         }
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           not
           exp
            prefixexp
             T
          or
          exp
           prefixexp
            (
            exp
             exp
              exp
               prefixexp
                functioncall
                 T
                 .
                 gcage
                 args
                  (
                  explist
                   exp
                    prefixexp
                     U
                  )
              ==
              exp
               string
                "touched1"
             and
             exp
              exp
               prefixexp
                functioncall
                 T
                 .
                 gcage
                 args
                  (
                  explist
                   exp
                    prefixexp
                     U
                     [
                     exp
                      number
                       1
                     ]
                  )
              ==
              exp
               string
                "new"
            )
        )
     stat
      functioncall
       collectgarbage
       args
        (
        explist
         exp
          string
           "step"
         ,
         exp
          number
           0
        )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           not
           exp
            prefixexp
             T
          or
          exp
           prefixexp
            (
            exp
             exp
              exp
               prefixexp
                functioncall
                 T
                 .
                 gcage
                 args
                  (
                  explist
                   exp
                    prefixexp
                     U
                  )
              ==
              exp
               string
                "touched2"
             and
             exp
              exp
               prefixexp
                functioncall
                 T
                 .
                 gcage
                 args
                  (
                  explist
                   exp
                    prefixexp
                     U
                     [
                     exp
                      number
                       1
                     ]
                  )
              ==
              exp
               string
                "survival"
            )
        )
     stat
      functioncall
       collectgarbage
       args
        (
        explist
         exp
          string
           "step"
         ,
         exp
          number
           0
        )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           not
           exp
            prefixexp
             T
          or
          exp
           prefixexp
            (
            exp
             exp
              exp
               prefixexp
                functioncall
                 T
                 .
                 gcage
                 args
                  (
                  explist
                   exp
                    prefixexp
                     U
                  )
              ==
              exp
               string
                "old"
             and
             exp
              exp
               prefixexp
                functioncall
                 T
                 .
                 gcage
                 args
                  (
                  explist
                   exp
                    prefixexp
                     U
                     [
                     exp
                      number
                       1
                     ]
                  )
              ==
              exp
               string
                "old1"
            )
        )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           prefixexp
            U
            [
            exp
             number
              1
            ]
            .
            x
            [
            exp
             number
              1
            ]
          ==
          exp
           number
            234
        )
    end
   stat
    do
    block
     stat
      local
      function
      foo
      funcbody
       (
       parlist
       )
       block
       end
     stat
      local
      attnamelist
       old
       attrib
      =
      explist
       exp
        tableconstructor
         {
         fieldlist
          field
           exp
            number
             10
         }
     stat
      functioncall
       collectgarbage
       args
        (
        )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           not
           exp
            prefixexp
             T
          or
          exp
           exp
            prefixexp
             functioncall
              T
              .
              gcage
              args
               (
               explist
                exp
                 prefixexp
                  old
               )
           ==
           exp
            string
             "old"
        )
     stat
      functioncall
       setmetatable
       args
        (
        explist
         exp
          prefixexp
           old
         ,
         exp
          tableconstructor
           {
           }
        )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           not
           exp
            prefixexp
             T
          or
          exp
           exp
            prefixexp
             functioncall
              T
              .
              gcage
              args
               (
               explist
                exp
                 prefixexp
                  functioncall
                   getmetatable
                   args
                    (
                    explist
                     exp
                      prefixexp
                       old
                    )
               )
           ==
           exp
            string
             "old0"
        )
     stat
      functioncall
       collectgarbage
       args
        (
        explist
         exp
          string
           "step"
         ,
         exp
          number
           0
        )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           not
           exp
            prefixexp
             T
          or
          exp
           exp
            prefixexp
             functioncall
              T
              .
              gcage
              args
               (
               explist
                exp
                 prefixexp
                  functioncall
                   getmetatable
                   args
                    (
                    explist
                     exp
                      prefixexp
                       old
                    )
               )
           ==
           exp
            string
             "old1"
        )
     stat
      functioncall
       setmetatable
       args
        (
        explist
         exp
          prefixexp
           functioncall
            getmetatable
            args
             (
             explist
              exp
               prefixexp
                old
             )
         ,
         exp
          tableconstructor
           {
           fieldlist
            field
             __gc
             =
             exp
              prefixexp
               foo
           }
        )
     stat
      functioncall
       collectgarbage
       args
        (
        explist
         exp
          string
           "step"
         ,
         exp
          number
           0
        )
    end
   stat
    do
    block
     stat
      local
      attnamelist
       A
       attrib
      =
      explist
       exp
        tableconstructor
         {
         }
     stat
      varlist
       var
        prefixexp
         A
        [
        exp
         number
          1
        ]
      =
      explist
       exp
        false
     stat
      local
      function
      gcf
      funcbody
       (
       parlist
        namelist
         obj
       )
       block
        stat
         varlist
          var
           prefixexp
            A
           [
           exp
            number
             1
           ]
         =
         explist
          exp
           prefixexp
            obj
        stat
         functioncall
          assert
          args
           (
           explist
            exp
             exp
              not
              exp
               prefixexp
                T
             or
             exp
              exp
               prefixexp
                functioncall
                 T
                 .
                 gcage
                 args
                  (
                  explist
                   exp
                    prefixexp
                     obj
                  )
              ==
              exp
               string
                "old1"
           )
        stat
         varlist
          var
           obj
         =
         explist
          exp
           nil
        stat
         functioncall
          collectgarbage
          args
           (
           explist
            exp
             string
              "step"
            ,
            exp
             number
              0
           )
        stat
         functioncall
          print
          args
           (
           explist
            exp
             prefixexp
              functioncall
               getmetatable
               args
                (
                explist
                 exp
                  prefixexp
                   A
                   [
                   exp
                    number
                     1
                   ]
                )
              .
              x
           )
       end
     stat
      functioncall
       collectgarbage
       args
        (
        )
     stat
      local
      attnamelist
       obj
       attrib
      =
      explist
       exp
        tableconstructor
         {
         }
     stat
      functioncall
       collectgarbage
       args
        (
        explist
         exp
          string
           "step"
         ,
         exp
          number
           0
        )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           not
           exp
            prefixexp
             T
          or
          exp
           exp
            prefixexp
             functioncall
              T
              .
              gcage
              args
               (
               explist
                exp
                 prefixexp
                  obj
               )
           ==
           exp
            string
             "survival"
        )
     stat
      functioncall
       setmetatable
       args
        (
        explist
         exp
          prefixexp
           obj
         ,
         exp
          tableconstructor
           {
           fieldlist
            field
             __gc
             =
             exp
              prefixexp
               gcf
            fieldsep
             ,
            field
             x
             =
             exp
              string
               "+"
           }
        )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           not
           exp
            prefixexp
             T
          or
          exp
           exp
            prefixexp
             functioncall
              T
              .
              gcage
              args
               (
               explist
                exp
                 prefixexp
                  functioncall
                   getmetatable
                   args
                    (
                    explist
                     exp
                      prefixexp
                       obj
                    )
               )
           ==
           exp
            string
             "new"
        )
     stat
      varlist
       var
        obj
      =
      explist
       exp
        nil
     stat
      functioncall
       collectgarbage
       args
        (
        explist
         exp
          string
           "step"
         ,
         exp
          number
           0
        )
    end
   stat
    do
    block
     stat
      local
      attnamelist
       old
       attrib
      =
      explist
       exp
        tableconstructor
         {
         fieldlist
          field
           exp
            number
             10
         }
     stat
      functioncall
       collectgarbage
       args
        (
        )
     stat
      local
      attnamelist
       co
       attrib
      =
      explist
       exp
        prefixexp
         functioncall
          coroutine
          .
          create
          args
           (
           explist
            exp
             functiondef
              function
              funcbody
               (
               parlist
               )
               block
                stat
                 local
                 attnamelist
                  x
                  attrib
                 =
                 explist
                  exp
                   nil
                stat
                 local
                 attnamelist
                  f
                  attrib
                 =
                 explist
                  exp
                   functiondef
                    function
                    funcbody
                     (
                     parlist
                     )
                     block
                      retstat
                       return
                       explist
                        exp
                         prefixexp
                          x
                          [
                          exp
                           number
                            1
                          ]
                     end
                stat
                 varlist
                  var
                   x
                 =
                 explist
                  exp
                   prefixexp
                    functioncall
                     coroutine
                     .
                     yield
                     args
                      (
                      explist
                       exp
                        prefixexp
                         f
                      )
                stat
                 functioncall
                  coroutine
                  .
                  yield
                  args
                   (
                   )
               end
           )
     stat
      local
      attnamelist
       _
       attrib
       ,
       f
       attrib
      =
      explist
       exp
        prefixexp
         functioncall
          coroutine
          .
          resume
          args
           (
           explist
            exp
             prefixexp
              co
           )
     stat
      functioncall
       collectgarbage
       args
        (
        explist
         exp
          string
           "step"
         ,
         exp
          number
           0
        )
     stat
      varlist
       var
        prefixexp
         old
        [
        exp
         number
          1
        ]
      =
      explist
       exp
        tableconstructor
         {
         fieldlist
          field
           exp
            string
             "hello"
         }
     stat
      functioncall
       coroutine
       .
       resume
       args
        (
        explist
         exp
          prefixexp
           co
         ,
         exp
          tableconstructor
           {
           fieldlist
            field
             exp
              number
               123
           }
        )
     stat
      varlist
       var
        co
      =
      explist
       exp
        nil
     stat
      functioncall
       collectgarbage
       args
        (
        explist
         exp
          string
           "step"
         ,
         exp
          number
           0
        )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           exp
            prefixexp
             functioncall
              f
              args
               (
               )
           ==
           exp
            number
             123
          and
          exp
           exp
            prefixexp
             old
             [
             exp
              number
               1
             ]
             [
             exp
              number
               1
             ]
           ==
           exp
            string
             "hello"
        )
     stat
      functioncall
       collectgarbage
       args
        (
        explist
         exp
          string
           "step"
         ,
         exp
          number
           0
        )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           exp
            prefixexp
             functioncall
              f
              args
               (
               )
           ==
           exp
            number
             123
          and
          exp
           exp
            prefixexp
             old
             [
             exp
              number
               1
             ]
             [
             exp
              number
               1
             ]
           ==
           exp
            string
             "hello"
        )
    end
   stat
    do
    block
     stat
      local
      attnamelist
       t
       attrib
      =
      explist
       exp
        prefixexp
         functioncall
          setmetatable
          args
           (
           explist
            exp
             tableconstructor
              {
              }
            ,
            exp
             tableconstructor
              {
              fieldlist
               field
                __mode
                =
                exp
                 string
                  "kv"
              }
           )
     stat
      functioncall
       collectgarbage
       args
        (
        )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           not
           exp
            prefixexp
             T
          or
          exp
           exp
            prefixexp
             functioncall
              T
              .
              gcage
              args
               (
               explist
                exp
                 prefixexp
                  t
               )
           ==
           exp
            string
             "old"
        )
     stat
      varlist
       var
        prefixexp
         t
        [
        exp
         number
          1
        ]
      =
      explist
       exp
        tableconstructor
         {
         fieldlist
          field
           exp
            number
             10
         }
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           not
           exp
            prefixexp
             T
          or
          exp
           prefixexp
            (
            exp
             exp
              exp
               prefixexp
                functioncall
                 T
                 .
                 gcage
                 args
                  (
                  explist
                   exp
                    prefixexp
                     t
                  )
              ==
              exp
               string
                "touched1"
             and
             exp
              exp
               prefixexp
                functioncall
                 T
                 .
                 gccolor
                 args
                  (
                  explist
                   exp
                    prefixexp
                     t
                  )
              ==
              exp
               string
                "gray"
            )
        )
     stat
      functioncall
       collectgarbage
       args
        (
        explist
         exp
          string
           "step"
         ,
         exp
          number
           0
        )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           not
           exp
            prefixexp
             T
          or
          exp
           prefixexp
            (
            exp
             exp
              exp
               prefixexp
                functioncall
                 T
                 .
                 gcage
                 args
                  (
                  explist
                   exp
                    prefixexp
                     t
                  )
              ==
              exp
               string
                "touched2"
             and
             exp
              exp
               prefixexp
                functioncall
                 T
                 .
                 gccolor
                 args
                  (
                  explist
                   exp
                    prefixexp
                     t
                  )
              ==
              exp
               string
                "black"
            )
        )
     stat
      functioncall
       collectgarbage
       args
        (
        explist
         exp
          string
           "step"
         ,
         exp
          number
           0
        )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           not
           exp
            prefixexp
             T
          or
          exp
           exp
            prefixexp
             functioncall
              T
              .
              gcage
              args
               (
               explist
                exp
                 prefixexp
                  t
               )
           ==
           exp
            string
             "old"
        )
     stat
      varlist
       var
        prefixexp
         t
        [
        exp
         number
          1
        ]
      =
      explist
       exp
        tableconstructor
         {
         fieldlist
          field
           exp
            number
             10
         }
     stat
      functioncall
       collectgarbage
       args
        (
        explist
         exp
          string
           "step"
         ,
         exp
          number
           0
        )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           prefixexp
            t
            [
            exp
             number
              1
            ]
          ==
          exp
           nil
        )
    end
   stat
    if
    exp
     exp
      prefixexp
       T
     ==
     exp
      nil
    then
    block
     stat
      functioncall
       (
       exp
        exp
         prefixexp
          Message
        or
        exp
         prefixexp
          print
       )
       args
        (
        explist
         exp
          string
           '\n >>> testC not active: \z\n                             skipping some generational tests <<<\n'
        )
     stat
      functioncall
       print
       args
        string
         'OK'
     retstat
      return
    end
   stat
    do
    block
     stat
      local
      attnamelist
       U
       attrib
      =
      explist
       exp
        prefixexp
         functioncall
          T
          .
          newuserdata
          args
           (
           explist
            exp
             number
              0
            ,
            exp
             number
              1
           )
     stat
      functioncall
       collectgarbage
       args
        (
        )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           prefixexp
            functioncall
             T
             .
             gcage
             args
              (
              explist
               exp
                prefixexp
                 U
              )
          ==
          exp
           string
            "old"
        )
     stat
      functioncall
       debug
       .
       setuservalue
       args
        (
        explist
         exp
          prefixexp
           U
         ,
         exp
          tableconstructor
           {
           fieldlist
            field
             x
             =
             exp
              tableconstructor
               {
               fieldlist
                field
                 exp
                  number
                   234
               }
           }
        )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           exp
            prefixexp
             functioncall
              T
              .
              gcage
              args
               (
               explist
                exp
                 prefixexp
                  U
               )
           ==
           exp
            string
             "touched1"
          and
          exp
           exp
            prefixexp
             functioncall
              T
              .
              gcage
              args
               (
               explist
                exp
                 prefixexp
                  functioncall
                   debug
                   .
                   getuservalue
                   args
                    (
                    explist
                     exp
                      prefixexp
                       U
                    )
               )
           ==
           exp
            string
             "new"
        )
     stat
      functioncall
       collectgarbage
       args
        (
        explist
         exp
          string
           "step"
         ,
         exp
          number
           0
        )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           exp
            prefixexp
             functioncall
              T
              .
              gcage
              args
               (
               explist
                exp
                 prefixexp
                  U
               )
           ==
           exp
            string
             "touched2"
          and
          exp
           exp
            prefixexp
             functioncall
              T
              .
              gcage
              args
               (
               explist
                exp
                 prefixexp
                  functioncall
                   debug
                   .
                   getuservalue
                   args
                    (
                    explist
                     exp
                      prefixexp
                       U
                    )
               )
           ==
           exp
            string
             "survival"
        )
     stat
      functioncall
       collectgarbage
       args
        (
        explist
         exp
          string
           "step"
         ,
         exp
          number
           0
        )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           exp
            prefixexp
             functioncall
              T
              .
              gcage
              args
               (
               explist
                exp
                 prefixexp
                  U
               )
           ==
           exp
            string
             "old"
          and
          exp
           exp
            prefixexp
             functioncall
              T
              .
              gcage
              args
               (
               explist
                exp
                 prefixexp
                  functioncall
                   debug
                   .
                   getuservalue
                   args
                    (
                    explist
                     exp
                      prefixexp
                       U
                    )
               )
           ==
           exp
            string
             "old1"
        )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           prefixexp
            functioncall
             debug
             .
             getuservalue
             args
              (
              explist
               exp
                prefixexp
                 U
              )
            .
            x
            [
            exp
             number
              1
            ]
          ==
          exp
           number
            234
        )
    end
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        prefixexp
         functioncall
          collectgarbage
          args
           string
            'isrunning'
      )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        prefixexp
         functioncall
          collectgarbage
          args
           string
            'isrunning'
      )
   stat
    functioncall
     collectgarbage
     args
      (
      explist
       exp
        prefixexp
         oldmode
      )
   stat
    functioncall
     print
     args
      (
      explist
       exp
        string
         'OK'
      )
 <EOF>
