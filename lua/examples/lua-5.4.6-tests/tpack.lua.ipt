start_
 chunk
  block
   stat
    local
    attnamelist
     pack
     attrib
    =
    explist
     exp
      prefixexp
       string
       .
       pack
   stat
    local
    attnamelist
     packsize
     attrib
    =
    explist
     exp
      prefixexp
       string
       .
       packsize
   stat
    local
    attnamelist
     unpack
     attrib
    =
    explist
     exp
      prefixexp
       string
       .
       unpack
   stat
    functioncall
     print
     args
      string
       "testing pack/unpack"
   stat
    local
    attnamelist
     NB
     attrib
    =
    explist
     exp
      number
       16
   stat
    local
    attnamelist
     sizeshort
     attrib
    =
    explist
     exp
      prefixexp
       functioncall
        packsize
        args
         (
         explist
          exp
           string
            "h"
         )
   stat
    local
    attnamelist
     sizeint
     attrib
    =
    explist
     exp
      prefixexp
       functioncall
        packsize
        args
         (
         explist
          exp
           string
            "i"
         )
   stat
    local
    attnamelist
     sizelong
     attrib
    =
    explist
     exp
      prefixexp
       functioncall
        packsize
        args
         (
         explist
          exp
           string
            "l"
         )
   stat
    local
    attnamelist
     sizesize_t
     attrib
    =
    explist
     exp
      prefixexp
       functioncall
        packsize
        args
         (
         explist
          exp
           string
            "T"
         )
   stat
    local
    attnamelist
     sizeLI
     attrib
    =
    explist
     exp
      prefixexp
       functioncall
        packsize
        args
         (
         explist
          exp
           string
            "j"
         )
   stat
    local
    attnamelist
     sizefloat
     attrib
    =
    explist
     exp
      prefixexp
       functioncall
        packsize
        args
         (
         explist
          exp
           string
            "f"
         )
   stat
    local
    attnamelist
     sizedouble
     attrib
    =
    explist
     exp
      prefixexp
       functioncall
        packsize
        args
         (
         explist
          exp
           string
            "d"
         )
   stat
    local
    attnamelist
     sizenumber
     attrib
    =
    explist
     exp
      prefixexp
       functioncall
        packsize
        args
         (
         explist
          exp
           string
            "n"
         )
   stat
    local
    attnamelist
     little
     attrib
    =
    explist
     exp
      prefixexp
       (
       exp
        exp
         prefixexp
          functioncall
           pack
           args
            (
            explist
             exp
              string
               "i2"
             ,
             exp
              number
               1
            )
        ==
        exp
         string
          "\1\0"
       )
   stat
    local
    attnamelist
     align
     attrib
    =
    explist
     exp
      prefixexp
       functioncall
        packsize
        args
         (
         explist
          exp
           string
            "!xXi16"
         )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         exp
          exp
           exp
            number
             1
           <=
           exp
            prefixexp
             sizeshort
          and
          exp
           exp
            prefixexp
             sizeshort
           <=
           exp
            prefixexp
             sizeint
         and
         exp
          exp
           prefixexp
            sizeint
          <=
          exp
           prefixexp
            sizelong
        and
        exp
         exp
          prefixexp
           sizefloat
         <=
         exp
          prefixexp
           sizedouble
      )
   stat
    functioncall
     print
     args
      (
      explist
       exp
        string
         "platform:"
      )
   stat
    functioncall
     print
     args
      (
      explist
       exp
        prefixexp
         functioncall
          string
          .
          format
          args
           (
           explist
            exp
             string
              "\tshort %d, int %d, long %d, size_t %d, float %d, double %d,\n\z\n   \tlua Integer %d, lua Number %d"
            ,
            exp
             prefixexp
              sizeshort
            ,
            exp
             prefixexp
              sizeint
            ,
            exp
             prefixexp
              sizelong
            ,
            exp
             prefixexp
              sizesize_t
            ,
            exp
             prefixexp
              sizefloat
            ,
            exp
             prefixexp
              sizedouble
            ,
            exp
             prefixexp
              sizeLI
            ,
            exp
             prefixexp
              sizenumber
           )
      )
   stat
    functioncall
     print
     args
      (
      explist
       exp
        exp
         string
          "\t"
        ..
        exp
         exp
          prefixexp
           (
           exp
            exp
             exp
              prefixexp
               little
             and
             exp
              string
               "little"
            or
            exp
             string
              "big"
           )
         ..
         exp
          string
           " endian"
      )
   stat
    functioncall
     print
     args
      (
      explist
       exp
        exp
         string
          "\talignment: "
        ..
        exp
         prefixexp
          align
      )
   stat
    local
    function
    checkerror
    funcbody
     (
     parlist
      namelist
       msg
       ,
       f
      ,
      ...
     )
     block
      stat
       local
       attnamelist
        status
        attrib
        ,
        err
        attrib
       =
       explist
        exp
         prefixexp
          functioncall
           pcall
           args
            (
            explist
             exp
              prefixexp
               f
             ,
             exp
              ...
            )
      stat
       functioncall
        assert
        args
         (
         explist
          exp
           exp
            not
            exp
             prefixexp
              status
           and
           exp
            prefixexp
             functioncall
              string
              .
              find
              args
               (
               explist
                exp
                 prefixexp
                  err
                ,
                exp
                 prefixexp
                  msg
               )
         )
     end
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         prefixexp
          functioncall
           unpack
           args
            (
            explist
             exp
              string
               "B"
             ,
             exp
              prefixexp
               functioncall
                pack
                args
                 (
                 explist
                  exp
                   string
                    "B"
                  ,
                  exp
                   number
                    0xff
                 )
            )
        ==
        exp
         number
          0xff
      )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         prefixexp
          functioncall
           unpack
           args
            (
            explist
             exp
              string
               "b"
             ,
             exp
              prefixexp
               functioncall
                pack
                args
                 (
                 explist
                  exp
                   string
                    "b"
                  ,
                  exp
                   number
                    0x7f
                 )
            )
        ==
        exp
         number
          0x7f
      )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         prefixexp
          functioncall
           unpack
           args
            (
            explist
             exp
              string
               "b"
             ,
             exp
              prefixexp
               functioncall
                pack
                args
                 (
                 explist
                  exp
                   string
                    "b"
                  ,
                  exp
                   -
                   exp
                    number
                     0x80
                 )
            )
        ==
        exp
         -
         exp
          number
           0x80
      )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         prefixexp
          functioncall
           unpack
           args
            (
            explist
             exp
              string
               "H"
             ,
             exp
              prefixexp
               functioncall
                pack
                args
                 (
                 explist
                  exp
                   string
                    "H"
                  ,
                  exp
                   number
                    0xffff
                 )
            )
        ==
        exp
         number
          0xffff
      )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         prefixexp
          functioncall
           unpack
           args
            (
            explist
             exp
              string
               "h"
             ,
             exp
              prefixexp
               functioncall
                pack
                args
                 (
                 explist
                  exp
                   string
                    "h"
                  ,
                  exp
                   number
                    0x7fff
                 )
            )
        ==
        exp
         number
          0x7fff
      )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         prefixexp
          functioncall
           unpack
           args
            (
            explist
             exp
              string
               "h"
             ,
             exp
              prefixexp
               functioncall
                pack
                args
                 (
                 explist
                  exp
                   string
                    "h"
                  ,
                  exp
                   -
                   exp
                    number
                     0x8000
                 )
            )
        ==
        exp
         -
         exp
          number
           0x8000
      )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         prefixexp
          functioncall
           unpack
           args
            (
            explist
             exp
              string
               "L"
             ,
             exp
              prefixexp
               functioncall
                pack
                args
                 (
                 explist
                  exp
                   string
                    "L"
                  ,
                  exp
                   number
                    0xffffffff
                 )
            )
        ==
        exp
         number
          0xffffffff
      )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         prefixexp
          functioncall
           unpack
           args
            (
            explist
             exp
              string
               "l"
             ,
             exp
              prefixexp
               functioncall
                pack
                args
                 (
                 explist
                  exp
                   string
                    "l"
                  ,
                  exp
                   number
                    0x7fffffff
                 )
            )
        ==
        exp
         number
          0x7fffffff
      )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         prefixexp
          functioncall
           unpack
           args
            (
            explist
             exp
              string
               "l"
             ,
             exp
              prefixexp
               functioncall
                pack
                args
                 (
                 explist
                  exp
                   string
                    "l"
                  ,
                  exp
                   -
                   exp
                    number
                     0x80000000
                 )
            )
        ==
        exp
         -
         exp
          number
           0x80000000
      )
   stat
    for
    i
    =
    exp
     number
      1
    ,
    exp
     prefixexp
      NB
    do
    block
     stat
      local
      attnamelist
       s
       attrib
      =
      explist
       exp
        prefixexp
         functioncall
          string
          .
          rep
          args
           (
           explist
            exp
             string
              "\xff"
            ,
            exp
             prefixexp
              i
           )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           prefixexp
            functioncall
             pack
             args
              (
              explist
               exp
                exp
                 string
                  "i"
                ..
                exp
                 prefixexp
                  i
               ,
               exp
                -
                exp
                 number
                  1
              )
          ==
          exp
           prefixexp
            s
        )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           prefixexp
            functioncall
             packsize
             args
              (
              explist
               exp
                exp
                 string
                  "i"
                ..
                exp
                 prefixexp
                  i
              )
          ==
          exp
           #
           exp
            prefixexp
             s
        )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           prefixexp
            functioncall
             unpack
             args
              (
              explist
               exp
                exp
                 string
                  "i"
                ..
                exp
                 prefixexp
                  i
               ,
               exp
                prefixexp
                 s
              )
          ==
          exp
           -
           exp
            number
             1
        )
     stat
      varlist
       var
        s
      =
      explist
       exp
        exp
         string
          "\xAA"
        ..
        exp
         prefixexp
          functioncall
           string
           .
           rep
           args
            (
            explist
             exp
              string
               "\0"
             ,
             exp
              exp
               prefixexp
                i
              -
              exp
               number
                1
            )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           prefixexp
            functioncall
             pack
             args
              (
              explist
               exp
                exp
                 string
                  "<I"
                ..
                exp
                 prefixexp
                  i
               ,
               exp
                number
                 0xAA
              )
          ==
          exp
           prefixexp
            s
        )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           prefixexp
            functioncall
             unpack
             args
              (
              explist
               exp
                exp
                 string
                  "<I"
                ..
                exp
                 prefixexp
                  i
               ,
               exp
                prefixexp
                 s
              )
          ==
          exp
           number
            0xAA
        )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           prefixexp
            functioncall
             pack
             args
              (
              explist
               exp
                exp
                 string
                  ">I"
                ..
                exp
                 prefixexp
                  i
               ,
               exp
                number
                 0xAA
              )
          ==
          exp
           prefixexp
            functioncall
             s
             :
             reverse
             args
              (
              )
        )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           prefixexp
            functioncall
             unpack
             args
              (
              explist
               exp
                exp
                 string
                  ">I"
                ..
                exp
                 prefixexp
                  i
               ,
               exp
                prefixexp
                 functioncall
                  s
                  :
                  reverse
                  args
                   (
                   )
              )
          ==
          exp
           number
            0xAA
        )
    end
   stat
    do
    block
     stat
      local
      attnamelist
       lnum
       attrib
      =
      explist
       exp
        number
         0x13121110090807060504030201
     stat
      local
      attnamelist
       s
       attrib
      =
      explist
       exp
        prefixexp
         functioncall
          pack
          args
           (
           explist
            exp
             string
              "<j"
            ,
            exp
             prefixexp
              lnum
           )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           prefixexp
            functioncall
             unpack
             args
              (
              explist
               exp
                string
                 "<j"
               ,
               exp
                prefixexp
                 s
              )
          ==
          exp
           prefixexp
            lnum
        )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           prefixexp
            functioncall
             unpack
             args
              (
              explist
               exp
                exp
                 string
                  "<i"
                ..
                exp
                 exp
                  prefixexp
                   sizeLI
                 +
                 exp
                  number
                   1
               ,
               exp
                exp
                 prefixexp
                  s
                ..
                exp
                 string
                  "\0"
              )
          ==
          exp
           prefixexp
            lnum
        )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           prefixexp
            functioncall
             unpack
             args
              (
              explist
               exp
                exp
                 string
                  "<i"
                ..
                exp
                 exp
                  prefixexp
                   sizeLI
                 +
                 exp
                  number
                   1
               ,
               exp
                exp
                 prefixexp
                  s
                ..
                exp
                 string
                  "\0"
              )
          ==
          exp
           prefixexp
            lnum
        )
     stat
      for
      i
      =
      exp
       exp
        prefixexp
         sizeLI
       +
       exp
        number
         1
      ,
      exp
       prefixexp
        NB
      do
      block
       stat
        local
        attnamelist
         s
         attrib
        =
        explist
         exp
          prefixexp
           functioncall
            pack
            args
             (
             explist
              exp
               string
                "<j"
              ,
              exp
               -
               exp
                prefixexp
                 lnum
             )
       stat
        functioncall
         assert
         args
          (
          explist
           exp
            exp
             prefixexp
              functioncall
               unpack
               args
                (
                explist
                 exp
                  string
                   "<j"
                 ,
                 exp
                  prefixexp
                   s
                )
            ==
            exp
             -
             exp
              prefixexp
               lnum
          )
       stat
        functioncall
         assert
         args
          (
          explist
           exp
            exp
             prefixexp
              functioncall
               unpack
               args
                (
                explist
                 exp
                  exp
                   string
                    "<i"
                  ..
                  exp
                   prefixexp
                    i
                 ,
                 exp
                  exp
                   prefixexp
                    s
                  ..
                  exp
                   prefixexp
                    functioncall
                     (
                     exp
                      string
                       "\xFF"
                     )
                     :
                     rep
                     args
                      (
                      explist
                       exp
                        exp
                         prefixexp
                          i
                        -
                        exp
                         prefixexp
                          sizeLI
                      )
                )
            ==
            exp
             -
             exp
              prefixexp
               lnum
          )
       stat
        functioncall
         assert
         args
          (
          explist
           exp
            exp
             prefixexp
              functioncall
               unpack
               args
                (
                explist
                 exp
                  exp
                   string
                    ">i"
                  ..
                  exp
                   prefixexp
                    i
                 ,
                 exp
                  exp
                   prefixexp
                    functioncall
                     (
                     exp
                      string
                       "\xFF"
                     )
                     :
                     rep
                     args
                      (
                      explist
                       exp
                        exp
                         prefixexp
                          i
                        -
                        exp
                         prefixexp
                          sizeLI
                      )
                  ..
                  exp
                   prefixexp
                    functioncall
                     s
                     :
                     reverse
                     args
                      (
                      )
                )
            ==
            exp
             -
             exp
              prefixexp
               lnum
          )
       stat
        functioncall
         assert
         args
          (
          explist
           exp
            exp
             prefixexp
              functioncall
               unpack
               args
                (
                explist
                 exp
                  exp
                   string
                    "<I"
                  ..
                  exp
                   prefixexp
                    i
                 ,
                 exp
                  exp
                   prefixexp
                    s
                  ..
                  exp
                   prefixexp
                    functioncall
                     (
                     exp
                      string
                       "\0"
                     )
                     :
                     rep
                     args
                      (
                      explist
                       exp
                        exp
                         prefixexp
                          i
                        -
                        exp
                         prefixexp
                          sizeLI
                      )
                )
            ==
            exp
             -
             exp
              prefixexp
               lnum
          )
       stat
        functioncall
         checkerror
         args
          (
          explist
           exp
            string
             "does not fit"
           ,
           exp
            prefixexp
             unpack
           ,
           exp
            exp
             string
              "<I"
            ..
            exp
             prefixexp
              i
           ,
           exp
            exp
             prefixexp
              functioncall
               (
               exp
                string
                 "\x00"
               )
               :
               rep
               args
                (
                explist
                 exp
                  exp
                   prefixexp
                    i
                  -
                  exp
                   number
                    1
                )
            ..
            exp
             string
              "\1"
          )
       stat
        functioncall
         checkerror
         args
          (
          explist
           exp
            string
             "does not fit"
           ,
           exp
            prefixexp
             unpack
           ,
           exp
            exp
             string
              ">i"
            ..
            exp
             prefixexp
              i
           ,
           exp
            exp
             string
              "\1"
            ..
            exp
             prefixexp
              functioncall
               (
               exp
                string
                 "\x00"
               )
               :
               rep
               args
                (
                explist
                 exp
                  exp
                   prefixexp
                    i
                  -
                  exp
                   number
                    1
                )
          )
      end
    end
   stat
    for
    i
    =
    exp
     number
      1
    ,
    exp
     prefixexp
      sizeLI
    do
    block
     stat
      local
      attnamelist
       lstr
       attrib
      =
      explist
       exp
        string
         "\1\2\3\4\5\6\7\8\9\10\11\12\13"
     stat
      local
      attnamelist
       lnum
       attrib
      =
      explist
       exp
        number
         0x13121110090807060504030201
     stat
      local
      attnamelist
       n
       attrib
      =
      explist
       exp
        exp
         prefixexp
          lnum
        &
        exp
         prefixexp
          (
          exp
           ~
           exp
            prefixexp
             (
             exp
              exp
               -
               exp
                number
                 1
              <<
              exp
               prefixexp
                (
                exp
                 exp
                  prefixexp
                   i
                 *
                 exp
                  number
                   8
                )
             )
          )
     stat
      local
      attnamelist
       s
       attrib
      =
      explist
       exp
        prefixexp
         functioncall
          string
          .
          sub
          args
           (
           explist
            exp
             prefixexp
              lstr
            ,
            exp
             number
              1
            ,
            exp
             prefixexp
              i
           )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           prefixexp
            functioncall
             pack
             args
              (
              explist
               exp
                exp
                 string
                  "<i"
                ..
                exp
                 prefixexp
                  i
               ,
               exp
                prefixexp
                 n
              )
          ==
          exp
           prefixexp
            s
        )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           prefixexp
            functioncall
             pack
             args
              (
              explist
               exp
                exp
                 string
                  ">i"
                ..
                exp
                 prefixexp
                  i
               ,
               exp
                prefixexp
                 n
              )
          ==
          exp
           prefixexp
            functioncall
             s
             :
             reverse
             args
              (
              )
        )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           prefixexp
            functioncall
             unpack
             args
              (
              explist
               exp
                exp
                 string
                  ">i"
                ..
                exp
                 prefixexp
                  i
               ,
               exp
                prefixexp
                 functioncall
                  s
                  :
                  reverse
                  args
                   (
                   )
              )
          ==
          exp
           prefixexp
            n
        )
    end
   stat
    do
    block
     stat
      local
      attnamelist
       u
       attrib
      =
      explist
       exp
        number
         0xf0
     stat
      for
      i
      =
      exp
       number
        1
      ,
      exp
       exp
        prefixexp
         sizeLI
       -
       exp
        number
         1
      do
      block
       stat
        functioncall
         assert
         args
          (
          explist
           exp
            exp
             prefixexp
              functioncall
               unpack
               args
                (
                explist
                 exp
                  exp
                   string
                    "<i"
                  ..
                  exp
                   prefixexp
                    i
                 ,
                 exp
                  exp
                   string
                    "\xf0"
                  ..
                  exp
                   prefixexp
                    functioncall
                     (
                     exp
                      string
                       "\xff"
                     )
                     :
                     rep
                     args
                      (
                      explist
                       exp
                        exp
                         prefixexp
                          i
                        -
                        exp
                         number
                          1
                      )
                )
            ==
            exp
             -
             exp
              number
               16
          )
       stat
        functioncall
         assert
         args
          (
          explist
           exp
            exp
             prefixexp
              functioncall
               unpack
               args
                (
                explist
                 exp
                  exp
                   string
                    ">I"
                  ..
                  exp
                   prefixexp
                    i
                 ,
                 exp
                  exp
                   string
                    "\xf0"
                  ..
                  exp
                   prefixexp
                    functioncall
                     (
                     exp
                      string
                       "\xff"
                     )
                     :
                     rep
                     args
                      (
                      explist
                       exp
                        exp
                         prefixexp
                          i
                        -
                        exp
                         number
                          1
                      )
                )
            ==
            exp
             prefixexp
              u
          )
       stat
        varlist
         var
          u
        =
        explist
         exp
          exp
           exp
            prefixexp
             u
           *
           exp
            number
             256
          +
          exp
           number
            0xff
      end
    end
   stat
    do
    block
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           prefixexp
            functioncall
             pack
             args
              (
              explist
               exp
                string
                 ">i2 <i2"
               ,
               exp
                number
                 10
               ,
               exp
                number
                 20
              )
          ==
          exp
           string
            "\0\10\20\0"
        )
     stat
      local
      attnamelist
       a
       attrib
       ,
       b
       attrib
      =
      explist
       exp
        prefixexp
         functioncall
          unpack
          args
           (
           explist
            exp
             string
              "<i2 >i2"
            ,
            exp
             string
              "\10\0\0\20"
           )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           exp
            prefixexp
             a
           ==
           exp
            number
             10
          and
          exp
           exp
            prefixexp
             b
           ==
           exp
            number
             20
        )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           prefixexp
            functioncall
             pack
             args
              (
              explist
               exp
                string
                 "=i4"
               ,
               exp
                number
                 2001
              )
          ==
          exp
           prefixexp
            functioncall
             pack
             args
              (
              explist
               exp
                string
                 "i4"
               ,
               exp
                number
                 2001
              )
        )
    end
   stat
    functioncall
     print
     args
      (
      explist
       exp
        string
         "testing invalid formats"
      )
   stat
    functioncall
     checkerror
     args
      (
      explist
       exp
        string
         "out of limits"
       ,
       exp
        prefixexp
         pack
       ,
       exp
        string
         "i0"
       ,
       exp
        number
         0
      )
   stat
    functioncall
     checkerror
     args
      (
      explist
       exp
        string
         "out of limits"
       ,
       exp
        prefixexp
         pack
       ,
       exp
        exp
         string
          "i"
        ..
        exp
         exp
          prefixexp
           NB
         +
         exp
          number
           1
       ,
       exp
        number
         0
      )
   stat
    functioncall
     checkerror
     args
      (
      explist
       exp
        string
         "out of limits"
       ,
       exp
        prefixexp
         pack
       ,
       exp
        exp
         string
          "!"
        ..
        exp
         exp
          prefixexp
           NB
         +
         exp
          number
           1
       ,
       exp
        number
         0
      )
   stat
    functioncall
     checkerror
     args
      (
      explist
       exp
        string
         "%(17%) out of limits %[1,16%]"
       ,
       exp
        prefixexp
         pack
       ,
       exp
        exp
         string
          "Xi"
        ..
        exp
         exp
          prefixexp
           NB
         +
         exp
          number
           1
      )
   stat
    functioncall
     checkerror
     args
      (
      explist
       exp
        string
         "invalid format option 'r'"
       ,
       exp
        prefixexp
         pack
       ,
       exp
        string
         "i3r"
       ,
       exp
        number
         0
      )
   stat
    functioncall
     checkerror
     args
      (
      explist
       exp
        string
         "16%-byte integer"
       ,
       exp
        prefixexp
         unpack
       ,
       exp
        string
         "i16"
       ,
       exp
        prefixexp
         functioncall
          string
          .
          rep
          args
           (
           explist
            exp
             string
              '\3'
            ,
            exp
             number
              16
           )
      )
   stat
    functioncall
     checkerror
     args
      (
      explist
       exp
        string
         "not power of 2"
       ,
       exp
        prefixexp
         pack
       ,
       exp
        string
         "!4i3"
       ,
       exp
        number
         0
      )
   stat
    ;
   stat
    functioncall
     checkerror
     args
      (
      explist
       exp
        string
         "missing size"
       ,
       exp
        prefixexp
         pack
       ,
       exp
        string
         "c"
       ,
       exp
        string
         ""
      )
   stat
    functioncall
     checkerror
     args
      (
      explist
       exp
        string
         "variable%-length format"
       ,
       exp
        prefixexp
         packsize
       ,
       exp
        string
         "s"
      )
   stat
    functioncall
     checkerror
     args
      (
      explist
       exp
        string
         "variable%-length format"
       ,
       exp
        prefixexp
         packsize
       ,
       exp
        string
         "z"
      )
   stat
    functioncall
     checkerror
     args
      (
      explist
       exp
        string
         "invalid format"
       ,
       exp
        prefixexp
         packsize
       ,
       exp
        exp
         string
          "c1"
        ..
        exp
         prefixexp
          functioncall
           string
           .
           rep
           args
            (
            explist
             exp
              string
               "0"
             ,
             exp
              number
               40
            )
      )
   stat
    if
    exp
     exp
      prefixexp
       functioncall
        packsize
        args
         (
         explist
          exp
           string
            "i"
         )
     ==
     exp
      number
       4
    then
    block
     stat
      local
      attnamelist
       s
       attrib
      =
      explist
       exp
        prefixexp
         functioncall
          string
          .
          rep
          args
           (
           explist
            exp
             string
              "c268435456"
            ,
            exp
             exp
              number
               2
             ^
             exp
              number
               3
           )
     stat
      functioncall
       checkerror
       args
        (
        explist
         exp
          string
           "too large"
         ,
         exp
          prefixexp
           packsize
         ,
         exp
          prefixexp
           s
        )
     stat
      varlist
       var
        s
      =
      explist
       exp
        exp
         prefixexp
          functioncall
           string
           .
           rep
           args
            (
            explist
             exp
              string
               "c268435456"
             ,
             exp
              exp
               exp
                number
                 2
               ^
               exp
                number
                 3
              -
              exp
               number
                1
            )
        ..
        exp
         string
          "c268435455"
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           prefixexp
            functioncall
             packsize
             args
              (
              explist
               exp
                prefixexp
                 s
              )
          ==
          exp
           number
            0x7fffffff
        )
    end
   stat
    for
    i
    =
    exp
     number
      1
    ,
    exp
     exp
      prefixexp
       sizeLI
     -
     exp
      number
       1
    do
    block
     stat
      local
      attnamelist
       umax
       attrib
      =
      explist
       exp
        exp
         prefixexp
          (
          exp
           exp
            number
             1
           <<
           exp
            prefixexp
             (
             exp
              exp
               prefixexp
                i
              *
              exp
               number
                8
             )
          )
        -
        exp
         number
          1
     stat
      local
      attnamelist
       max
       attrib
      =
      explist
       exp
        exp
         prefixexp
          umax
        >>
        exp
         number
          1
     stat
      local
      attnamelist
       min
       attrib
      =
      explist
       exp
        ~
        exp
         prefixexp
          max
     stat
      functioncall
       checkerror
       args
        (
        explist
         exp
          string
           "overflow"
         ,
         exp
          prefixexp
           pack
         ,
         exp
          exp
           string
            "<I"
          ..
          exp
           prefixexp
            i
         ,
         exp
          -
          exp
           number
            1
        )
     stat
      functioncall
       checkerror
       args
        (
        explist
         exp
          string
           "overflow"
         ,
         exp
          prefixexp
           pack
         ,
         exp
          exp
           string
            "<I"
          ..
          exp
           prefixexp
            i
         ,
         exp
          prefixexp
           min
        )
     stat
      functioncall
       checkerror
       args
        (
        explist
         exp
          string
           "overflow"
         ,
         exp
          prefixexp
           pack
         ,
         exp
          exp
           string
            ">I"
          ..
          exp
           prefixexp
            i
         ,
         exp
          exp
           prefixexp
            umax
          +
          exp
           number
            1
        )
     stat
      functioncall
       checkerror
       args
        (
        explist
         exp
          string
           "overflow"
         ,
         exp
          prefixexp
           pack
         ,
         exp
          exp
           string
            ">i"
          ..
          exp
           prefixexp
            i
         ,
         exp
          prefixexp
           umax
        )
     stat
      functioncall
       checkerror
       args
        (
        explist
         exp
          string
           "overflow"
         ,
         exp
          prefixexp
           pack
         ,
         exp
          exp
           string
            ">i"
          ..
          exp
           prefixexp
            i
         ,
         exp
          exp
           prefixexp
            max
          +
          exp
           number
            1
        )
     stat
      functioncall
       checkerror
       args
        (
        explist
         exp
          string
           "overflow"
         ,
         exp
          prefixexp
           pack
         ,
         exp
          exp
           string
            "<i"
          ..
          exp
           prefixexp
            i
         ,
         exp
          exp
           prefixexp
            min
          -
          exp
           number
            1
        )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           prefixexp
            functioncall
             unpack
             args
              (
              explist
               exp
                exp
                 string
                  ">i"
                ..
                exp
                 prefixexp
                  i
               ,
               exp
                prefixexp
                 functioncall
                  pack
                  args
                   (
                   explist
                    exp
                     exp
                      string
                       ">i"
                     ..
                     exp
                      prefixexp
                       i
                    ,
                    exp
                     prefixexp
                      max
                   )
              )
          ==
          exp
           prefixexp
            max
        )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           prefixexp
            functioncall
             unpack
             args
              (
              explist
               exp
                exp
                 string
                  "<i"
                ..
                exp
                 prefixexp
                  i
               ,
               exp
                prefixexp
                 functioncall
                  pack
                  args
                   (
                   explist
                    exp
                     exp
                      string
                       "<i"
                     ..
                     exp
                      prefixexp
                       i
                    ,
                    exp
                     prefixexp
                      min
                   )
              )
          ==
          exp
           prefixexp
            min
        )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           prefixexp
            functioncall
             unpack
             args
              (
              explist
               exp
                exp
                 string
                  ">I"
                ..
                exp
                 prefixexp
                  i
               ,
               exp
                prefixexp
                 functioncall
                  pack
                  args
                   (
                   explist
                    exp
                     exp
                      string
                       ">I"
                     ..
                     exp
                      prefixexp
                       i
                    ,
                    exp
                     prefixexp
                      umax
                   )
              )
          ==
          exp
           prefixexp
            umax
        )
    end
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         prefixexp
          functioncall
           unpack
           args
            (
            explist
             exp
              string
               ">j"
             ,
             exp
              prefixexp
               functioncall
                pack
                args
                 (
                 explist
                  exp
                   string
                    ">j"
                  ,
                  exp
                   prefixexp
                    math
                    .
                    maxinteger
                 )
            )
        ==
        exp
         prefixexp
          math
          .
          maxinteger
      )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         prefixexp
          functioncall
           unpack
           args
            (
            explist
             exp
              string
               "<j"
             ,
             exp
              prefixexp
               functioncall
                pack
                args
                 (
                 explist
                  exp
                   string
                    "<j"
                  ,
                  exp
                   prefixexp
                    math
                    .
                    mininteger
                 )
            )
        ==
        exp
         prefixexp
          math
          .
          mininteger
      )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         prefixexp
          functioncall
           unpack
           args
            (
            explist
             exp
              string
               "<J"
             ,
             exp
              prefixexp
               functioncall
                pack
                args
                 (
                 explist
                  exp
                   string
                    "<j"
                  ,
                  exp
                   -
                   exp
                    number
                     1
                 )
            )
        ==
        exp
         -
         exp
          number
           1
      )
   stat
    if
    exp
     prefixexp
      little
    then
    block
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           prefixexp
            functioncall
             pack
             args
              (
              explist
               exp
                string
                 "f"
               ,
               exp
                number
                 24
              )
          ==
          exp
           prefixexp
            functioncall
             pack
             args
              (
              explist
               exp
                string
                 "<f"
               ,
               exp
                number
                 24
              )
        )
    else
    block
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           prefixexp
            functioncall
             pack
             args
              (
              explist
               exp
                string
                 "f"
               ,
               exp
                number
                 24
              )
          ==
          exp
           prefixexp
            functioncall
             pack
             args
              (
              explist
               exp
                string
                 ">f"
               ,
               exp
                number
                 24
              )
        )
    end
   stat
    functioncall
     print
     args
      string
       "testing pack/unpack of floating-point numbers"
   stat
    for
    namelist
     _
     ,
     n
    in
    explist
     exp
      prefixexp
       functioncall
        ipairs
        args
         tableconstructor
          {
          fieldlist
           field
            exp
             number
              0
           fieldsep
            ,
           field
            exp
             -
             exp
              number
               1.1
           fieldsep
            ,
           field
            exp
             number
              1.9
           fieldsep
            ,
           field
            exp
             exp
              number
               1
             /
             exp
              number
               0
           fieldsep
            ,
           field
            exp
             exp
              -
              exp
               number
                1
             /
             exp
              number
               0
           fieldsep
            ,
           field
            exp
             number
              1e20
           fieldsep
            ,
           field
            exp
             -
             exp
              number
               1e20
           fieldsep
            ,
           field
            exp
             number
              0.1
           fieldsep
            ,
           field
            exp
             number
              2000.7
          }
    do
    block
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           prefixexp
            functioncall
             unpack
             args
              (
              explist
               exp
                string
                 "n"
               ,
               exp
                prefixexp
                 functioncall
                  pack
                  args
                   (
                   explist
                    exp
                     string
                      "n"
                    ,
                    exp
                     prefixexp
                      n
                   )
              )
          ==
          exp
           prefixexp
            n
        )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           prefixexp
            functioncall
             unpack
             args
              (
              explist
               exp
                string
                 "<n"
               ,
               exp
                prefixexp
                 functioncall
                  pack
                  args
                   (
                   explist
                    exp
                     string
                      "<n"
                    ,
                    exp
                     prefixexp
                      n
                   )
              )
          ==
          exp
           prefixexp
            n
        )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           prefixexp
            functioncall
             unpack
             args
              (
              explist
               exp
                string
                 ">n"
               ,
               exp
                prefixexp
                 functioncall
                  pack
                  args
                   (
                   explist
                    exp
                     string
                      ">n"
                    ,
                    exp
                     prefixexp
                      n
                   )
              )
          ==
          exp
           prefixexp
            n
        )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           prefixexp
            functioncall
             pack
             args
              (
              explist
               exp
                string
                 "<f"
               ,
               exp
                prefixexp
                 n
              )
          ==
          exp
           prefixexp
            functioncall
             functioncall
              pack
              args
               (
               explist
                exp
                 string
                  ">f"
                ,
                exp
                 prefixexp
                  n
               )
             :
             reverse
             args
              (
              )
        )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           prefixexp
            functioncall
             pack
             args
              (
              explist
               exp
                string
                 ">d"
               ,
               exp
                prefixexp
                 n
              )
          ==
          exp
           prefixexp
            functioncall
             functioncall
              pack
              args
               (
               explist
                exp
                 string
                  "<d"
                ,
                exp
                 prefixexp
                  n
               )
             :
             reverse
             args
              (
              )
        )
    end
   stat
    for
    namelist
     _
     ,
     n
    in
    explist
     exp
      prefixexp
       functioncall
        ipairs
        args
         tableconstructor
          {
          fieldlist
           field
            exp
             number
              0
           fieldsep
            ,
           field
            exp
             -
             exp
              number
               1.5
           fieldsep
            ,
           field
            exp
             exp
              number
               1
             /
             exp
              number
               0
           fieldsep
            ,
           field
            exp
             exp
              -
              exp
               number
                1
             /
             exp
              number
               0
           fieldsep
            ,
           field
            exp
             number
              1e10
           fieldsep
            ,
           field
            exp
             -
             exp
              number
               1e9
           fieldsep
            ,
           field
            exp
             number
              0.5
           fieldsep
            ,
           field
            exp
             number
              2000.25
          }
    do
    block
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           prefixexp
            functioncall
             unpack
             args
              (
              explist
               exp
                string
                 "<f"
               ,
               exp
                prefixexp
                 functioncall
                  pack
                  args
                   (
                   explist
                    exp
                     string
                      "<f"
                    ,
                    exp
                     prefixexp
                      n
                   )
              )
          ==
          exp
           prefixexp
            n
        )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           prefixexp
            functioncall
             unpack
             args
              (
              explist
               exp
                string
                 ">f"
               ,
               exp
                prefixexp
                 functioncall
                  pack
                  args
                   (
                   explist
                    exp
                     string
                      ">f"
                    ,
                    exp
                     prefixexp
                      n
                   )
              )
          ==
          exp
           prefixexp
            n
        )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           prefixexp
            functioncall
             unpack
             args
              (
              explist
               exp
                string
                 "<d"
               ,
               exp
                prefixexp
                 functioncall
                  pack
                  args
                   (
                   explist
                    exp
                     string
                      "<d"
                    ,
                    exp
                     prefixexp
                      n
                   )
              )
          ==
          exp
           prefixexp
            n
        )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           prefixexp
            functioncall
             unpack
             args
              (
              explist
               exp
                string
                 ">d"
               ,
               exp
                prefixexp
                 functioncall
                  pack
                  args
                   (
                   explist
                    exp
                     string
                      ">d"
                    ,
                    exp
                     prefixexp
                      n
                   )
              )
          ==
          exp
           prefixexp
            n
        )
    end
   stat
    functioncall
     print
     args
      string
       "testing pack/unpack of strings"
   stat
    do
    block
     stat
      local
      attnamelist
       s
       attrib
      =
      explist
       exp
        prefixexp
         functioncall
          string
          .
          rep
          args
           (
           explist
            exp
             string
              "abc"
            ,
            exp
             number
              1000
           )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           prefixexp
            functioncall
             pack
             args
              (
              explist
               exp
                string
                 "zB"
               ,
               exp
                prefixexp
                 s
               ,
               exp
                number
                 247
              )
          ==
          exp
           exp
            prefixexp
             s
           ..
           exp
            string
             "\0\xF7"
        )
     stat
      local
      attnamelist
       s1
       attrib
       ,
       b
       attrib
      =
      explist
       exp
        prefixexp
         functioncall
          unpack
          args
           (
           explist
            exp
             string
              "zB"
            ,
            exp
             exp
              prefixexp
               s
             ..
             exp
              string
               "\0\xF9"
           )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           exp
            prefixexp
             b
           ==
           exp
            number
             249
          and
          exp
           exp
            prefixexp
             s1
           ==
           exp
            prefixexp
             s
        )
     stat
      varlist
       var
        s1
      =
      explist
       exp
        prefixexp
         functioncall
          pack
          args
           (
           explist
            exp
             string
              "s"
            ,
            exp
             prefixexp
              s
           )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           prefixexp
            functioncall
             unpack
             args
              (
              explist
               exp
                string
                 "s"
               ,
               exp
                prefixexp
                 s1
              )
          ==
          exp
           prefixexp
            s
        )
     stat
      functioncall
       checkerror
       args
        (
        explist
         exp
          string
           "does not fit"
         ,
         exp
          prefixexp
           pack
         ,
         exp
          string
           "s1"
         ,
         exp
          prefixexp
           s
        )
     stat
      functioncall
       checkerror
       args
        (
        explist
         exp
          string
           "contains zeros"
         ,
         exp
          prefixexp
           pack
         ,
         exp
          string
           "z"
         ,
         exp
          string
           "alo\0"
        )
     stat
      ;
     stat
      functioncall
       checkerror
       args
        (
        explist
         exp
          string
           "unfinished string"
         ,
         exp
          prefixexp
           unpack
         ,
         exp
          string
           "zc10000000"
         ,
         exp
          string
           "alo"
        )
     stat
      for
      i
      =
      exp
       number
        2
      ,
      exp
       prefixexp
        NB
      do
      block
       stat
        local
        attnamelist
         s1
         attrib
        =
        explist
         exp
          prefixexp
           functioncall
            pack
            args
             (
             explist
              exp
               exp
                string
                 "s"
               ..
               exp
                prefixexp
                 i
              ,
              exp
               prefixexp
                s
             )
       stat
        functioncall
         assert
         args
          (
          explist
           exp
            exp
             exp
              prefixexp
               functioncall
                unpack
                args
                 (
                 explist
                  exp
                   exp
                    string
                     "s"
                   ..
                   exp
                    prefixexp
                     i
                  ,
                  exp
                   prefixexp
                    s1
                 )
             ==
             exp
              prefixexp
               s
            and
            exp
             exp
              #
              exp
               prefixexp
                s1
             ==
             exp
              exp
               #
               exp
                prefixexp
                 s
              +
              exp
               prefixexp
                i
          )
      end
    end
   stat
    do
    block
     stat
      local
      attnamelist
       x
       attrib
      =
      explist
       exp
        prefixexp
         functioncall
          pack
          args
           (
           explist
            exp
             string
              "s"
            ,
            exp
             string
              "alo"
           )
     stat
      functioncall
       checkerror
       args
        (
        explist
         exp
          string
           "too short"
         ,
         exp
          prefixexp
           unpack
         ,
         exp
          string
           "s"
         ,
         exp
          prefixexp
           functioncall
            x
            :
            sub
            args
             (
             explist
              exp
               number
                1
              ,
              exp
               -
               exp
                number
                 2
             )
        )
     stat
      functioncall
       checkerror
       args
        (
        explist
         exp
          string
           "too short"
         ,
         exp
          prefixexp
           unpack
         ,
         exp
          string
           "c5"
         ,
         exp
          string
           "abcd"
        )
     stat
      functioncall
       checkerror
       args
        (
        explist
         exp
          string
           "out of limits"
         ,
         exp
          prefixexp
           pack
         ,
         exp
          string
           "s100"
         ,
         exp
          string
           "alo"
        )
    end
   stat
    do
    block
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           prefixexp
            functioncall
             pack
             args
              (
              explist
               exp
                string
                 "c0"
               ,
               exp
                string
                 ""
              )
          ==
          exp
           string
            ""
        )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           prefixexp
            functioncall
             packsize
             args
              (
              explist
               exp
                string
                 "c0"
              )
          ==
          exp
           number
            0
        )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           prefixexp
            functioncall
             unpack
             args
              (
              explist
               exp
                string
                 "c0"
               ,
               exp
                string
                 ""
              )
          ==
          exp
           string
            ""
        )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           prefixexp
            functioncall
             pack
             args
              (
              explist
               exp
                string
                 "<! c3"
               ,
               exp
                string
                 "abc"
              )
          ==
          exp
           string
            "abc"
        )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           prefixexp
            functioncall
             packsize
             args
              (
              explist
               exp
                string
                 "<! c3"
              )
          ==
          exp
           number
            3
        )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           prefixexp
            functioncall
             pack
             args
              (
              explist
               exp
                string
                 ">!4 c6"
               ,
               exp
                string
                 "abcdef"
              )
          ==
          exp
           string
            "abcdef"
        )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           prefixexp
            functioncall
             pack
             args
              (
              explist
               exp
                string
                 "c3"
               ,
               exp
                string
                 "123"
              )
          ==
          exp
           string
            "123"
        )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           prefixexp
            functioncall
             pack
             args
              (
              explist
               exp
                string
                 "c0"
               ,
               exp
                string
                 ""
              )
          ==
          exp
           string
            ""
        )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           prefixexp
            functioncall
             pack
             args
              (
              explist
               exp
                string
                 "c8"
               ,
               exp
                string
                 "123456"
              )
          ==
          exp
           string
            "123456\0\0"
        )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           prefixexp
            functioncall
             pack
             args
              (
              explist
               exp
                string
                 "c88"
               ,
               exp
                string
                 ""
              )
          ==
          exp
           prefixexp
            functioncall
             string
             .
             rep
             args
              (
              explist
               exp
                string
                 "\0"
               ,
               exp
                number
                 88
              )
        )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           prefixexp
            functioncall
             pack
             args
              (
              explist
               exp
                string
                 "c188"
               ,
               exp
                string
                 "ab"
              )
          ==
          exp
           exp
            string
             "ab"
           ..
           exp
            prefixexp
             functioncall
              string
              .
              rep
              args
               (
               explist
                exp
                 string
                  "\0"
                ,
                exp
                 exp
                  number
                   188
                 -
                 exp
                  number
                   2
               )
        )
     stat
      local
      attnamelist
       a
       attrib
       ,
       b
       attrib
       ,
       c
       attrib
      =
      explist
       exp
        prefixexp
         functioncall
          unpack
          args
           (
           explist
            exp
             string
              "!4 z c3"
            ,
            exp
             string
              "abcdefghi\0xyz"
           )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           exp
            exp
             prefixexp
              a
            ==
            exp
             string
              "abcdefghi"
           and
           exp
            exp
             prefixexp
              b
            ==
            exp
             string
              "xyz"
          and
          exp
           exp
            prefixexp
             c
           ==
           exp
            number
             14
        )
     stat
      functioncall
       checkerror
       args
        (
        explist
         exp
          string
           "longer than"
         ,
         exp
          prefixexp
           pack
         ,
         exp
          string
           "c3"
         ,
         exp
          string
           "1234"
        )
    end
   stat
    do
    block
     stat
      local
      attnamelist
       x
       attrib
      =
      explist
       exp
        prefixexp
         functioncall
          pack
          args
           (
           explist
            exp
             string
              "<b h b f d f n i"
            ,
            exp
             number
              1
            ,
            exp
             number
              2
            ,
            exp
             number
              3
            ,
            exp
             number
              4
            ,
            exp
             number
              5
            ,
            exp
             number
              6
            ,
            exp
             number
              7
            ,
            exp
             number
              8
           )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           #
           exp
            prefixexp
             x
          ==
          exp
           prefixexp
            functioncall
             packsize
             args
              (
              explist
               exp
                string
                 "<b h b f d f n i"
              )
        )
     stat
      local
      attnamelist
       a
       attrib
       ,
       b
       attrib
       ,
       c
       attrib
       ,
       d
       attrib
       ,
       e
       attrib
       ,
       f
       attrib
       ,
       g
       attrib
       ,
       h
       attrib
      =
      explist
       exp
        prefixexp
         functioncall
          unpack
          args
           (
           explist
            exp
             string
              "<b h b f d f n i"
            ,
            exp
             prefixexp
              x
           )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           exp
            exp
             exp
              exp
               exp
                exp
                 exp
                  prefixexp
                   a
                 ==
                 exp
                  number
                   1
                and
                exp
                 exp
                  prefixexp
                   b
                 ==
                 exp
                  number
                   2
               and
               exp
                exp
                 prefixexp
                  c
                ==
                exp
                 number
                  3
              and
              exp
               exp
                prefixexp
                 d
               ==
               exp
                number
                 4
             and
             exp
              exp
               prefixexp
                e
              ==
              exp
               number
                5
            and
            exp
             exp
              prefixexp
               f
             ==
             exp
              number
               6
           and
           exp
            exp
             prefixexp
              g
            ==
            exp
             number
              7
          and
          exp
           exp
            prefixexp
             h
           ==
           exp
            number
             8
        )
    end
   stat
    functioncall
     print
     args
      string
       "testing alignment"
   stat
    do
    block
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           prefixexp
            functioncall
             pack
             args
              (
              explist
               exp
                string
                 " < i1 i2 "
               ,
               exp
                number
                 2
               ,
               exp
                number
                 3
              )
          ==
          exp
           string
            "\2\3\0"
        )
     stat
      local
      attnamelist
       x
       attrib
      =
      explist
       exp
        prefixexp
         functioncall
          pack
          args
           (
           explist
            exp
             string
              ">!8 b Xh i4 i8 c1 Xi8"
            ,
            exp
             -
             exp
              number
               12
            ,
            exp
             number
              100
            ,
            exp
             number
              200
            ,
            exp
             string
              "\xEC"
           )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           #
           exp
            prefixexp
             x
          ==
          exp
           prefixexp
            functioncall
             packsize
             args
              (
              explist
               exp
                string
                 ">!8 b Xh i4 i8 c1 Xi8"
              )
        )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           prefixexp
            x
          ==
          exp
           exp
            string
             "\xf4"
           ..
           exp
            exp
             string
              "\0\0\0"
            ..
            exp
             exp
              string
               "\0\0\0\100"
             ..
             exp
              exp
               string
                "\0\0\0\0\0\0\0\xC8"
              ..
              exp
               exp
                string
                 "\xEC"
               ..
               exp
                string
                 "\0\0\0\0\0\0\0"
        )
     stat
      local
      attnamelist
       a
       attrib
       ,
       b
       attrib
       ,
       c
       attrib
       ,
       d
       attrib
       ,
       pos
       attrib
      =
      explist
       exp
        prefixexp
         functioncall
          unpack
          args
           (
           explist
            exp
             string
              ">!8 c1 Xh i4 i8 b Xi8 XI XH"
            ,
            exp
             prefixexp
              x
           )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           exp
            exp
             exp
              exp
               prefixexp
                a
              ==
              exp
               string
                "\xF4"
             and
             exp
              exp
               prefixexp
                b
              ==
              exp
               number
                100
            and
            exp
             exp
              prefixexp
               c
             ==
             exp
              number
               200
           and
           exp
            exp
             prefixexp
              d
            ==
            exp
             -
             exp
              number
               20
          and
          exp
           exp
            prefixexp
             (
             exp
              exp
               prefixexp
                pos
              -
              exp
               number
                1
             )
           ==
           exp
            #
            exp
             prefixexp
              x
        )
     stat
      varlist
       var
        x
      =
      explist
       exp
        prefixexp
         functioncall
          pack
          args
           (
           explist
            exp
             string
              ">!4 c3 c4 c2 z i4 c5 c2 Xi4"
            ,
            exp
             string
              "abc"
            ,
            exp
             string
              "abcd"
            ,
            exp
             string
              "xz"
            ,
            exp
             string
              "hello"
            ,
            exp
             number
              5
            ,
            exp
             string
              "world"
            ,
            exp
             string
              "xy"
           )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           prefixexp
            x
          ==
          exp
           string
            "abcabcdxzhello\0\0\0\0\0\5worldxy\0"
        )
     stat
      local
      attnamelist
       a
       attrib
       ,
       b
       attrib
       ,
       c
       attrib
       ,
       d
       attrib
       ,
       e
       attrib
       ,
       f
       attrib
       ,
       g
       attrib
       ,
       pos
       attrib
      =
      explist
       exp
        prefixexp
         functioncall
          unpack
          args
           (
           explist
            exp
             string
              ">!4 c3 c4 c2 z i4 c5 c2 Xh Xi4"
            ,
            exp
             prefixexp
              x
           )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           exp
            exp
             exp
              exp
               exp
                exp
                 exp
                  prefixexp
                   a
                 ==
                 exp
                  string
                   "abc"
                and
                exp
                 exp
                  prefixexp
                   b
                 ==
                 exp
                  string
                   "abcd"
               and
               exp
                exp
                 prefixexp
                  c
                ==
                exp
                 string
                  "xz"
              and
              exp
               exp
                prefixexp
                 d
               ==
               exp
                string
                 "hello"
             and
             exp
              exp
               prefixexp
                e
              ==
              exp
               number
                5
            and
            exp
             exp
              prefixexp
               f
             ==
             exp
              string
               "world"
           and
           exp
            exp
             prefixexp
              g
            ==
            exp
             string
              "xy"
          and
          exp
           exp
            exp
             prefixexp
              (
              exp
               exp
                prefixexp
                 pos
               -
               exp
                number
                 1
              )
            %
            exp
             number
              4
           ==
           exp
            number
             0
        )
     stat
      varlist
       var
        x
      =
      explist
       exp
        prefixexp
         functioncall
          pack
          args
           (
           explist
            exp
             string
              " b b Xd b Xb x"
            ,
            exp
             number
              1
            ,
            exp
             number
              2
            ,
            exp
             number
              3
           )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           prefixexp
            functioncall
             packsize
             args
              (
              explist
               exp
                string
                 " b b Xd b Xb x"
              )
          ==
          exp
           number
            4
        )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           prefixexp
            x
          ==
          exp
           string
            "\1\2\3\0"
        )
     stat
      varlist
       var
        a
       ,
       var
        b
       ,
       var
        c
       ,
       var
        pos
      =
      explist
       exp
        prefixexp
         functioncall
          unpack
          args
           (
           explist
            exp
             string
              "bbXdb"
            ,
            exp
             prefixexp
              x
           )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           exp
            exp
             exp
              prefixexp
               a
             ==
             exp
              number
               1
            and
            exp
             exp
              prefixexp
               b
             ==
             exp
              number
               2
           and
           exp
            exp
             prefixexp
              c
            ==
            exp
             number
              3
          and
          exp
           exp
            prefixexp
             pos
           ==
           exp
            #
            exp
             prefixexp
              x
        )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           prefixexp
            functioncall
             packsize
             args
              (
              explist
               exp
                string
                 "!8 xXi8"
              )
          ==
          exp
           number
            8
        )
     stat
      local
      attnamelist
       pos
       attrib
      =
      explist
       exp
        prefixexp
         functioncall
          unpack
          args
           (
           explist
            exp
             string
              "!8 xXi8"
            ,
            exp
             string
              "0123456701234567"
           )
     stat
      ;
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           prefixexp
            pos
          ==
          exp
           number
            9
        )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           prefixexp
            functioncall
             packsize
             args
              (
              explist
               exp
                string
                 "!8 xXi2"
              )
          ==
          exp
           number
            2
        )
     stat
      local
      attnamelist
       pos
       attrib
      =
      explist
       exp
        prefixexp
         functioncall
          unpack
          args
           (
           explist
            exp
             string
              "!8 xXi2"
            ,
            exp
             string
              "0123456701234567"
           )
     stat
      ;
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           prefixexp
            pos
          ==
          exp
           number
            3
        )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           prefixexp
            functioncall
             packsize
             args
              (
              explist
               exp
                string
                 "!2 xXi2"
              )
          ==
          exp
           number
            2
        )
     stat
      local
      attnamelist
       pos
       attrib
      =
      explist
       exp
        prefixexp
         functioncall
          unpack
          args
           (
           explist
            exp
             string
              "!2 xXi2"
            ,
            exp
             string
              "0123456701234567"
           )
     stat
      ;
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           prefixexp
            pos
          ==
          exp
           number
            3
        )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           prefixexp
            functioncall
             packsize
             args
              (
              explist
               exp
                string
                 "!2 xXi8"
              )
          ==
          exp
           number
            2
        )
     stat
      local
      attnamelist
       pos
       attrib
      =
      explist
       exp
        prefixexp
         functioncall
          unpack
          args
           (
           explist
            exp
             string
              "!2 xXi8"
            ,
            exp
             string
              "0123456701234567"
           )
     stat
      ;
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           prefixexp
            pos
          ==
          exp
           number
            3
        )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           prefixexp
            functioncall
             packsize
             args
              (
              explist
               exp
                string
                 "!16 xXi16"
              )
          ==
          exp
           number
            16
        )
     stat
      local
      attnamelist
       pos
       attrib
      =
      explist
       exp
        prefixexp
         functioncall
          unpack
          args
           (
           explist
            exp
             string
              "!16 xXi16"
            ,
            exp
             string
              "0123456701234567"
           )
     stat
      ;
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           prefixexp
            pos
          ==
          exp
           number
            17
        )
     stat
      functioncall
       checkerror
       args
        (
        explist
         exp
          string
           "invalid next option"
         ,
         exp
          prefixexp
           pack
         ,
         exp
          string
           "X"
        )
     stat
      functioncall
       checkerror
       args
        (
        explist
         exp
          string
           "invalid next option"
         ,
         exp
          prefixexp
           unpack
         ,
         exp
          string
           "XXi"
         ,
         exp
          string
           ""
        )
     stat
      functioncall
       checkerror
       args
        (
        explist
         exp
          string
           "invalid next option"
         ,
         exp
          prefixexp
           unpack
         ,
         exp
          string
           "X i"
         ,
         exp
          string
           ""
        )
     stat
      functioncall
       checkerror
       args
        (
        explist
         exp
          string
           "invalid next option"
         ,
         exp
          prefixexp
           pack
         ,
         exp
          string
           "Xc1"
        )
    end
   stat
    do
    block
     stat
      local
      attnamelist
       x
       attrib
      =
      explist
       exp
        prefixexp
         functioncall
          pack
          args
           (
           explist
            exp
             string
              "i4i4i4i4"
            ,
            exp
             number
              1
            ,
            exp
             number
              2
            ,
            exp
             number
              3
            ,
            exp
             number
              4
           )
     stat
      for
      pos
      =
      exp
       number
        1
      ,
      exp
       number
        16
      ,
      exp
       number
        4
      do
      block
       stat
        local
        attnamelist
         i
         attrib
         ,
         p
         attrib
        =
        explist
         exp
          prefixexp
           functioncall
            unpack
            args
             (
             explist
              exp
               string
                "i4"
              ,
              exp
               prefixexp
                x
              ,
              exp
               prefixexp
                pos
             )
       stat
        functioncall
         assert
         args
          (
          explist
           exp
            exp
             exp
              prefixexp
               i
             ==
             exp
              exp
               exp
                prefixexp
                 pos
               //
               exp
                number
                 4
              +
              exp
               number
                1
            and
            exp
             exp
              prefixexp
               p
             ==
             exp
              exp
               prefixexp
                pos
              +
              exp
               number
                4
          )
      end
     stat
      for
      pos
      =
      exp
       number
        0
      ,
      exp
       number
        12
      do
      block
       stat
        local
        attnamelist
         i
         attrib
         ,
         p
         attrib
        =
        explist
         exp
          prefixexp
           functioncall
            unpack
            args
             (
             explist
              exp
               string
                "!4 i4"
              ,
              exp
               prefixexp
                x
              ,
              exp
               exp
                prefixexp
                 pos
               +
               exp
                number
                 1
             )
       stat
        functioncall
         assert
         args
          (
          explist
           exp
            exp
             exp
              prefixexp
               i
             ==
             exp
              exp
               exp
                prefixexp
                 (
                 exp
                  exp
                   prefixexp
                    pos
                  +
                  exp
                   number
                    3
                 )
               //
               exp
                number
                 4
              +
              exp
               number
                1
            and
            exp
             exp
              prefixexp
               p
             ==
             exp
              exp
               exp
                prefixexp
                 i
               *
               exp
                number
                 4
              +
              exp
               number
                1
          )
      end
     stat
      local
      attnamelist
       i
       attrib
       ,
       p
       attrib
      =
      explist
       exp
        prefixexp
         functioncall
          unpack
          args
           (
           explist
            exp
             string
              "!4 i4"
            ,
            exp
             prefixexp
              x
            ,
            exp
             -
             exp
              number
               4
           )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           exp
            prefixexp
             i
           ==
           exp
            number
             4
          and
          exp
           exp
            prefixexp
             p
           ==
           exp
            number
             17
        )
     stat
      local
      attnamelist
       i
       attrib
       ,
       p
       attrib
      =
      explist
       exp
        prefixexp
         functioncall
          unpack
          args
           (
           explist
            exp
             string
              "!4 i4"
            ,
            exp
             prefixexp
              x
            ,
            exp
             -
             exp
              number
               7
           )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           exp
            prefixexp
             i
           ==
           exp
            number
             4
          and
          exp
           exp
            prefixexp
             p
           ==
           exp
            number
             17
        )
     stat
      local
      attnamelist
       i
       attrib
       ,
       p
       attrib
      =
      explist
       exp
        prefixexp
         functioncall
          unpack
          args
           (
           explist
            exp
             string
              "!4 i4"
            ,
            exp
             prefixexp
              x
            ,
            exp
             -
             exp
              #
              exp
               prefixexp
                x
           )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           exp
            prefixexp
             i
           ==
           exp
            number
             1
          and
          exp
           exp
            prefixexp
             p
           ==
           exp
            number
             5
        )
     stat
      for
      i
      =
      exp
       number
        1
      ,
      exp
       exp
        #
        exp
         prefixexp
          x
       +
       exp
        number
         1
      do
      block
       stat
        functioncall
         assert
         args
          (
          explist
           exp
            exp
             prefixexp
              functioncall
               unpack
               args
                (
                explist
                 exp
                  string
                   "c0"
                 ,
                 exp
                  prefixexp
                   x
                 ,
                 exp
                  prefixexp
                   i
                )
            ==
            exp
             string
              ""
          )
      end
     stat
      functioncall
       checkerror
       args
        (
        explist
         exp
          string
           "out of string"
         ,
         exp
          prefixexp
           unpack
         ,
         exp
          string
           "c0"
         ,
         exp
          prefixexp
           x
         ,
         exp
          exp
           #
           exp
            prefixexp
             x
          +
          exp
           number
            2
        )
    end
   stat
    functioncall
     print
     args
      string
       "OK"
 <EOF>
