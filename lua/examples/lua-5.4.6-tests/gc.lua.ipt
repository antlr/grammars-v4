start_
 chunk
  block
   stat
    functioncall
     print
     args
      (
      explist
       exp
        string
         'testing incremental garbage collection'
      )
   stat
    local
    attnamelist
     debug
     attrib
    =
    explist
     exp
      prefixexp
       functioncall
        require
        args
         string
          "debug"
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        prefixexp
         functioncall
          collectgarbage
          args
           (
           explist
            exp
             string
              "isrunning"
           )
      )
   stat
    functioncall
     collectgarbage
     args
      (
      )
   stat
    local
    attnamelist
     oldmode
     attrib
    =
    explist
     exp
      prefixexp
       functioncall
        collectgarbage
        args
         (
         explist
          exp
           string
            "incremental"
         )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         prefixexp
          functioncall
           collectgarbage
           args
            (
            explist
             exp
              string
               "generational"
            )
        ==
        exp
         string
          "incremental"
      )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         prefixexp
          functioncall
           collectgarbage
           args
            (
            explist
             exp
              string
               "generational"
            )
        ==
        exp
         string
          "generational"
      )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         prefixexp
          functioncall
           collectgarbage
           args
            (
            explist
             exp
              string
               "incremental"
            )
        ==
        exp
         string
          "generational"
      )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         prefixexp
          functioncall
           collectgarbage
           args
            (
            explist
             exp
              string
               "incremental"
            )
        ==
        exp
         string
          "incremental"
      )
   stat
    local
    function
    nop
    funcbody
     (
     parlist
     )
     block
     end
   stat
    local
    function
    gcinfo
    funcbody
     (
     parlist
     )
     block
      retstat
       return
       explist
        exp
         exp
          prefixexp
           functioncall
            collectgarbage
            args
             string
              "count"
         *
         exp
          number
           1024
     end
   stat
    do
    block
     stat
      local
      attnamelist
       a
       attrib
      =
      explist
       exp
        prefixexp
         functioncall
          collectgarbage
          args
           (
           explist
            exp
             string
              "setpause"
            ,
            exp
             number
              200
           )
     stat
      local
      attnamelist
       b
       attrib
      =
      explist
       exp
        prefixexp
         functioncall
          collectgarbage
          args
           (
           explist
            exp
             string
              "setstepmul"
            ,
            exp
             number
              200
           )
     stat
      local
      attnamelist
       t
       attrib
      =
      explist
       exp
        tableconstructor
         {
         fieldlist
          field
           exp
            number
             0
          fieldsep
           ,
          field
           exp
            number
             2
          fieldsep
           ,
          field
           exp
            number
             10
          fieldsep
           ,
          field
           exp
            number
             90
          fieldsep
           ,
          field
           exp
            number
             500
          fieldsep
           ,
          field
           exp
            number
             5000
          fieldsep
           ,
          field
           exp
            number
             30000
          fieldsep
           ,
          field
           exp
            number
             0x7ffffffe
         }
     stat
      for
      i
      =
      exp
       number
        1
      ,
      exp
       #
       exp
        prefixexp
         t
      do
      block
       stat
        local
        attnamelist
         p
         attrib
        =
        explist
         exp
          prefixexp
           t
           [
           exp
            prefixexp
             i
           ]
       stat
        for
        j
        =
        exp
         number
          1
        ,
        exp
         #
         exp
          prefixexp
           t
        do
        block
         stat
          local
          attnamelist
           m
           attrib
          =
          explist
           exp
            prefixexp
             t
             [
             exp
              prefixexp
               j
             ]
         stat
          functioncall
           collectgarbage
           args
            (
            explist
             exp
              string
               "setpause"
             ,
             exp
              prefixexp
               p
            )
         stat
          functioncall
           collectgarbage
           args
            (
            explist
             exp
              string
               "setstepmul"
             ,
             exp
              prefixexp
               m
            )
         stat
          functioncall
           collectgarbage
           args
            (
            explist
             exp
              string
               "step"
             ,
             exp
              number
               0
            )
         stat
          functioncall
           collectgarbage
           args
            (
            explist
             exp
              string
               "step"
             ,
             exp
              number
               10000
            )
        end
      end
     stat
      functioncall
       collectgarbage
       args
        (
        explist
         exp
          string
           "setpause"
         ,
         exp
          prefixexp
           a
        )
     stat
      functioncall
       collectgarbage
       args
        (
        explist
         exp
          string
           "setstepmul"
         ,
         exp
          prefixexp
           b
        )
     stat
      functioncall
       collectgarbage
       args
        (
        )
    end
   stat
    varlist
     var
      prefixexp
       _G
      [
      exp
       string
        "while"
      ]
    =
    explist
     exp
      number
       234
   stat
    local
    function
    GC1
    funcbody
     (
     parlist
     )
     block
      stat
       local
       attnamelist
        u
        attrib
      stat
       local
       attnamelist
        b
        attrib
      stat
       local
       attnamelist
        finish
        attrib
       =
       explist
        exp
         false
      stat
       varlist
        var
         u
       =
       explist
        exp
         prefixexp
          functioncall
           setmetatable
           args
            (
            explist
             exp
              tableconstructor
               {
               }
             ,
             exp
              tableconstructor
               {
               fieldlist
                field
                 __gc
                 =
                 exp
                  functiondef
                   function
                   funcbody
                    (
                    parlist
                    )
                    block
                     stat
                      varlist
                       var
                        finish
                      =
                      explist
                       exp
                        true
                    end
               }
            )
      stat
       varlist
        var
         b
       =
       explist
        exp
         tableconstructor
          {
          fieldlist
           field
            exp
             number
              34
          }
      stat
       repeat
       block
        stat
         varlist
          var
           u
         =
         explist
          exp
           tableconstructor
            {
            }
       until
       exp
        prefixexp
         finish
      stat
       functioncall
        assert
        args
         (
         explist
          exp
           exp
            prefixexp
             b
             [
             exp
              number
               1
             ]
           ==
           exp
            number
             34
         )
      stat
       varlist
        var
         finish
       =
       explist
        exp
         false
      stat
       ;
      stat
       local
       attnamelist
        i
        attrib
       =
       explist
        exp
         number
          1
      stat
       varlist
        var
         u
       =
       explist
        exp
         prefixexp
          functioncall
           setmetatable
           args
            (
            explist
             exp
              tableconstructor
               {
               }
             ,
             exp
              tableconstructor
               {
               fieldlist
                field
                 __gc
                 =
                 exp
                  functiondef
                   function
                   funcbody
                    (
                    parlist
                    )
                    block
                     stat
                      varlist
                       var
                        finish
                      =
                      explist
                       exp
                        true
                    end
               }
            )
      stat
       repeat
       block
        stat
         varlist
          var
           i
         =
         explist
          exp
           exp
            prefixexp
             i
           +
           exp
            number
             1
        stat
         ;
        stat
         varlist
          var
           u
         =
         explist
          exp
           exp
            prefixexp
             functioncall
              tostring
              args
               (
               explist
                exp
                 prefixexp
                  i
               )
           ..
           exp
            prefixexp
             functioncall
              tostring
              args
               (
               explist
                exp
                 prefixexp
                  i
               )
       until
       exp
        prefixexp
         finish
      stat
       functioncall
        assert
        args
         (
         explist
          exp
           exp
            prefixexp
             b
             [
             exp
              number
               1
             ]
           ==
           exp
            number
             34
         )
      stat
       varlist
        var
         finish
       =
       explist
        exp
         false
      stat
       varlist
        var
         u
       =
       explist
        exp
         prefixexp
          functioncall
           setmetatable
           args
            (
            explist
             exp
              tableconstructor
               {
               }
             ,
             exp
              tableconstructor
               {
               fieldlist
                field
                 __gc
                 =
                 exp
                  functiondef
                   function
                   funcbody
                    (
                    parlist
                    )
                    block
                     stat
                      varlist
                       var
                        finish
                      =
                      explist
                       exp
                        true
                    end
               }
            )
      stat
       repeat
       block
        stat
         local
         attnamelist
          i
          attrib
        stat
         ;
        stat
         varlist
          var
           u
         =
         explist
          exp
           functiondef
            function
            funcbody
             (
             parlist
             )
             block
              retstat
               return
               explist
                exp
                 prefixexp
                  i
             end
       until
       exp
        prefixexp
         finish
      stat
       functioncall
        assert
        args
         (
         explist
          exp
           exp
            prefixexp
             b
             [
             exp
              number
               1
             ]
           ==
           exp
            number
             34
         )
     end
   stat
    local
    function
    GC2
    funcbody
     (
     parlist
     )
     block
      stat
       local
       attnamelist
        u
        attrib
      stat
       local
       attnamelist
        finish
        attrib
       =
       explist
        exp
         false
      stat
       varlist
        var
         u
       =
       explist
        exp
         tableconstructor
          {
          fieldlist
           field
            exp
             prefixexp
              functioncall
               setmetatable
               args
                (
                explist
                 exp
                  tableconstructor
                   {
                   }
                 ,
                 exp
                  tableconstructor
                   {
                   fieldlist
                    field
                     __gc
                     =
                     exp
                      functiondef
                       function
                       funcbody
                        (
                        parlist
                        )
                        block
                         stat
                          varlist
                           var
                            finish
                          =
                          explist
                           exp
                            true
                        end
                   }
                )
          }
      stat
       local
       attnamelist
        b
        attrib
       =
       explist
        exp
         tableconstructor
          {
          fieldlist
           field
            exp
             number
              34
          }
      stat
       repeat
       block
        stat
         varlist
          var
           u
         =
         explist
          exp
           tableconstructor
            {
            fieldlist
             field
              exp
               tableconstructor
                {
                }
            }
       until
       exp
        prefixexp
         finish
      stat
       functioncall
        assert
        args
         (
         explist
          exp
           exp
            prefixexp
             b
             [
             exp
              number
               1
             ]
           ==
           exp
            number
             34
         )
      stat
       varlist
        var
         finish
       =
       explist
        exp
         false
      stat
       ;
      stat
       local
       attnamelist
        i
        attrib
       =
       explist
        exp
         number
          1
      stat
       varlist
        var
         u
       =
       explist
        exp
         tableconstructor
          {
          fieldlist
           field
            exp
             prefixexp
              functioncall
               setmetatable
               args
                (
                explist
                 exp
                  tableconstructor
                   {
                   }
                 ,
                 exp
                  tableconstructor
                   {
                   fieldlist
                    field
                     __gc
                     =
                     exp
                      functiondef
                       function
                       funcbody
                        (
                        parlist
                        )
                        block
                         stat
                          varlist
                           var
                            finish
                          =
                          explist
                           exp
                            true
                        end
                   }
                )
          }
      stat
       repeat
       block
        stat
         varlist
          var
           i
         =
         explist
          exp
           exp
            prefixexp
             i
           +
           exp
            number
             1
        stat
         ;
        stat
         varlist
          var
           u
         =
         explist
          exp
           tableconstructor
            {
            fieldlist
             field
              exp
               exp
                prefixexp
                 functioncall
                  tostring
                  args
                   (
                   explist
                    exp
                     prefixexp
                      i
                   )
               ..
               exp
                prefixexp
                 functioncall
                  tostring
                  args
                   (
                   explist
                    exp
                     prefixexp
                      i
                   )
            }
       until
       exp
        prefixexp
         finish
      stat
       functioncall
        assert
        args
         (
         explist
          exp
           exp
            prefixexp
             b
             [
             exp
              number
               1
             ]
           ==
           exp
            number
             34
         )
      stat
       varlist
        var
         finish
       =
       explist
        exp
         false
      stat
       varlist
        var
         u
       =
       explist
        exp
         tableconstructor
          {
          fieldlist
           field
            exp
             prefixexp
              functioncall
               setmetatable
               args
                (
                explist
                 exp
                  tableconstructor
                   {
                   }
                 ,
                 exp
                  tableconstructor
                   {
                   fieldlist
                    field
                     __gc
                     =
                     exp
                      functiondef
                       function
                       funcbody
                        (
                        parlist
                        )
                        block
                         stat
                          varlist
                           var
                            finish
                          =
                          explist
                           exp
                            true
                        end
                   }
                )
          }
      stat
       repeat
       block
        stat
         local
         attnamelist
          i
          attrib
        stat
         ;
        stat
         varlist
          var
           u
         =
         explist
          exp
           tableconstructor
            {
            fieldlist
             field
              exp
               functiondef
                function
                funcbody
                 (
                 parlist
                 )
                 block
                  retstat
                   return
                   explist
                    exp
                     prefixexp
                      i
                 end
            }
       until
       exp
        prefixexp
         finish
      stat
       functioncall
        assert
        args
         (
         explist
          exp
           exp
            prefixexp
             b
             [
             exp
              number
               1
             ]
           ==
           exp
            number
             34
         )
     end
   stat
    local
    function
    GC
    funcbody
     (
     parlist
     )
     block
      stat
       functioncall
        GC1
        args
         (
         )
      stat
       ;
      stat
       functioncall
        GC2
        args
         (
         )
     end
   stat
    do
    block
     stat
      functioncall
       print
       args
        (
        explist
         exp
          string
           "creating many objects"
        )
     stat
      local
      attnamelist
       limit
       attrib
      =
      explist
       exp
        number
         5000
     stat
      for
      i
      =
      exp
       number
        1
      ,
      exp
       prefixexp
        limit
      do
      block
       stat
        local
        attnamelist
         a
         attrib
        =
        explist
         exp
          tableconstructor
           {
           }
       stat
        ;
       stat
        varlist
         var
          a
        =
        explist
         exp
          nil
      end
     stat
      local
      attnamelist
       a
       attrib
      =
      explist
       exp
        string
         "a"
     stat
      for
      i
      =
      exp
       number
        1
      ,
      exp
       prefixexp
        limit
      do
      block
       stat
        varlist
         var
          a
        =
        explist
         exp
          exp
           prefixexp
            i
          ..
          exp
           string
            "b"
       stat
        ;
       stat
        varlist
         var
          a
        =
        explist
         exp
          prefixexp
           functioncall
            string
            .
            gsub
            args
             (
             explist
              exp
               prefixexp
                a
              ,
              exp
               string
                '(%d%d*)'
              ,
              exp
               string
                "%1 %1"
             )
       stat
        varlist
         var
          a
        =
        explist
         exp
          string
           "a"
      end
     stat
      varlist
       var
        a
      =
      explist
       exp
        tableconstructor
         {
         }
     stat
      function
      funcname
       a
       :
       test
      funcbody
       (
       parlist
       )
       block
        stat
         for
         i
         =
         exp
          number
           1
         ,
         exp
          prefixexp
           limit
         do
         block
          stat
           functioncall
            functioncall
             load
             args
              (
              explist
               exp
                prefixexp
                 functioncall
                  string
                  .
                  format
                  args
                   (
                   explist
                    exp
                     string
                      "function temp(a) return 'a%d' end"
                    ,
                    exp
                     prefixexp
                      i
                   )
               ,
               exp
                string
                 ""
              )
            args
             (
             )
          stat
           functioncall
            assert
            args
             (
             explist
              exp
               exp
                prefixexp
                 functioncall
                  temp
                  args
                   (
                   )
               ==
               exp
                prefixexp
                 functioncall
                  string
                  .
                  format
                  args
                   (
                   explist
                    exp
                     string
                      'a%d'
                    ,
                    exp
                     prefixexp
                      i
                   )
             )
         end
       end
     stat
      functioncall
       a
       :
       test
       args
        (
        )
     stat
      varlist
       var
        prefixexp
         _G
        .
        temp
      =
      explist
       exp
        nil
    end
   stat
    do
    block
     stat
      local
      attnamelist
       f
       attrib
      =
      explist
       exp
        functiondef
         function
         funcbody
          (
          parlist
          )
          block
          end
    end
   stat
    functioncall
     print
     args
      (
      explist
       exp
        string
         "functions with errors"
      )
   stat
    local
    attnamelist
     prog
     attrib
    =
    explist
     exp
      string
       [[\ndo\n  a = 10;\n  function foo(x,y)\n    a = sin(a+0.456-0.23e-12);\n    return function (z) return sin(%x+z) end\n  end\n  local x = function (w) a=a+w; end\nend\n]]
   stat
    do
    block
     stat
      local
      attnamelist
       step
       attrib
      =
      explist
       exp
        number
         1
     stat
      if
      exp
       prefixexp
        _soft
      then
      block
       stat
        varlist
         var
          step
        =
        explist
         exp
          number
           13
      end
     stat
      for
      i
      =
      exp
       number
        1
      ,
      exp
       prefixexp
        functioncall
         string
         .
         len
         args
          (
          explist
           exp
            prefixexp
             prog
          )
      ,
      exp
       prefixexp
        step
      do
      block
       stat
        for
        j
        =
        exp
         prefixexp
          i
        ,
        exp
         prefixexp
          functioncall
           string
           .
           len
           args
            (
            explist
             exp
              prefixexp
               prog
            )
        ,
        exp
         prefixexp
          step
        do
        block
         stat
          functioncall
           pcall
           args
            (
            explist
             exp
              prefixexp
               functioncall
                load
                args
                 (
                 explist
                  exp
                   prefixexp
                    functioncall
                     string
                     .
                     sub
                     args
                      (
                      explist
                       exp
                        prefixexp
                         prog
                       ,
                       exp
                        prefixexp
                         i
                       ,
                       exp
                        prefixexp
                         j
                      )
                  ,
                  exp
                   string
                    ""
                 )
            )
        end
      end
    end
   stat
    functioncall
     rawset
     args
      (
      explist
       exp
        prefixexp
         _G
       ,
       exp
        string
         "a"
       ,
       exp
        nil
      )
   stat
    varlist
     var
      prefixexp
       _G
      .
      x
    =
    explist
     exp
      nil
   stat
    do
    block
     stat
      varlist
       var
        foo
      =
      explist
       exp
        nil
     stat
      functioncall
       print
       args
        (
        explist
         exp
          string
           'long strings'
        )
     stat
      local
      attnamelist
       x
       attrib
      =
      explist
       exp
        string
         "01234567890123456789012345678901234567890123456789012345678901234567890123456789"
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           prefixexp
            functioncall
             string
             .
             len
             args
              (
              explist
               exp
                prefixexp
                 x
              )
          ==
          exp
           number
            80
        )
     stat
      local
      attnamelist
       s
       attrib
      =
      explist
       exp
        string
         ''
     stat
      local
      attnamelist
       k
       attrib
      =
      explist
       exp
        prefixexp
         functioncall
          math
          .
          min
          args
           (
           explist
            exp
             number
              300
            ,
            exp
             exp
              prefixexp
               (
               exp
                exp
                 prefixexp
                  math
                  .
                  maxinteger
                //
                exp
                 number
                  80
               )
             //
             exp
              number
               2
           )
     stat
      for
      n
      =
      exp
       number
        1
      ,
      exp
       prefixexp
        k
      do
      block
       stat
        varlist
         var
          s
        =
        explist
         exp
          exp
           prefixexp
            s
          ..
          exp
           prefixexp
            x
       stat
        ;
       stat
        local
        attnamelist
         j
         attrib
        =
        explist
         exp
          prefixexp
           functioncall
            tostring
            args
             (
             explist
              exp
               prefixexp
                n
             )
      end
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           prefixexp
            functioncall
             string
             .
             len
             args
              (
              explist
               exp
                prefixexp
                 s
              )
          ==
          exp
           exp
            prefixexp
             k
           *
           exp
            number
             80
        )
     stat
      varlist
       var
        s
      =
      explist
       exp
        prefixexp
         functioncall
          string
          .
          sub
          args
           (
           explist
            exp
             prefixexp
              s
            ,
            exp
             number
              1
            ,
            exp
             number
              10000
           )
     stat
      local
      attnamelist
       s
       attrib
       ,
       i
       attrib
      =
      explist
       exp
        prefixexp
         functioncall
          string
          .
          gsub
          args
           (
           explist
            exp
             prefixexp
              s
            ,
            exp
             string
              '(%d%d%d%d)'
            ,
            exp
             string
              ''
           )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           prefixexp
            i
          ==
          exp
           exp
            number
             10000
           //
           exp
            number
             4
        )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           prefixexp
            _G
            [
            exp
             string
              "while"
            ]
          ==
          exp
           number
            234
        )
     stat
      varlist
       var
        prefixexp
         _G
        [
        exp
         string
          "while"
        ]
      =
      explist
       exp
        nil
    end
   stat
    do
    block
     stat
      functioncall
       print
       args
        (
        explist
         exp
          string
           "steps"
        )
     stat
      functioncall
       print
       args
        (
        explist
         exp
          string
           "steps (2)"
        )
     stat
      local
      function
      dosteps
      funcbody
       (
       parlist
        namelist
         siz
       )
       block
        stat
         functioncall
          collectgarbage
          args
           (
           )
        stat
         local
         attnamelist
          a
          attrib
         =
         explist
          exp
           tableconstructor
            {
            }
        stat
         for
         i
         =
         exp
          number
           1
         ,
         exp
          number
           100
         do
         block
          stat
           varlist
            var
             prefixexp
              a
             [
             exp
              prefixexp
               i
             ]
           =
           explist
            exp
             tableconstructor
              {
              fieldlist
               field
                exp
                 tableconstructor
                  {
                  }
              }
          stat
           ;
          stat
           local
           attnamelist
            b
            attrib
           =
           explist
            exp
             tableconstructor
              {
              }
         end
        stat
         local
         attnamelist
          x
          attrib
         =
         explist
          exp
           prefixexp
            functioncall
             gcinfo
             args
              (
              )
        stat
         local
         attnamelist
          i
          attrib
         =
         explist
          exp
           number
            0
        stat
         repeat
         block
          stat
           varlist
            var
             i
           =
           explist
            exp
             exp
              prefixexp
               i
             +
             exp
              number
               1
         until
         exp
          prefixexp
           functioncall
            collectgarbage
            args
             (
             explist
              exp
               string
                "step"
              ,
              exp
               prefixexp
                siz
             )
        stat
         functioncall
          assert
          args
           (
           explist
            exp
             exp
              prefixexp
               functioncall
                gcinfo
                args
                 (
                 )
             <
             exp
              prefixexp
               x
           )
        retstat
         return
         explist
          exp
           prefixexp
            i
       end
     stat
      functioncall
       collectgarbage
       args
        string
         "stop"
     stat
      if
      exp
       not
       exp
        prefixexp
         _port
      then
      block
       stat
        functioncall
         assert
         args
          (
          explist
           exp
            exp
             prefixexp
              functioncall
               dosteps
               args
                (
                explist
                 exp
                  number
                   10
                )
            <
            exp
             prefixexp
              functioncall
               dosteps
               args
                (
                explist
                 exp
                  number
                   2
                )
          )
      end
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           prefixexp
            functioncall
             dosteps
             args
              (
              explist
               exp
                number
                 20000
              )
          ==
          exp
           number
            1
        )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           prefixexp
            functioncall
             collectgarbage
             args
              (
              explist
               exp
                string
                 "step"
               ,
               exp
                number
                 20000
              )
          ==
          exp
           true
        )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           prefixexp
            functioncall
             collectgarbage
             args
              (
              explist
               exp
                string
                 "step"
               ,
               exp
                number
                 20000
              )
          ==
          exp
           true
        )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          not
          exp
           prefixexp
            functioncall
             collectgarbage
             args
              (
              explist
               exp
                string
                 "isrunning"
              )
        )
     stat
      functioncall
       collectgarbage
       args
        string
         "restart"
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          prefixexp
           functioncall
            collectgarbage
            args
             (
             explist
              exp
               string
                "isrunning"
             )
        )
    end
   stat
    if
    exp
     not
     exp
      prefixexp
       _port
    then
    block
     stat
      functioncall
       collectgarbage
       args
        (
        )
     stat
      ;
     stat
      functioncall
       collectgarbage
       args
        (
        )
     stat
      local
      attnamelist
       x
       attrib
      =
      explist
       exp
        prefixexp
         functioncall
          gcinfo
          args
           (
           )
     stat
      functioncall
       collectgarbage
       args
        string
         "stop"
     stat
      repeat
      block
       stat
        local
        attnamelist
         a
         attrib
        =
        explist
         exp
          tableconstructor
           {
           }
      until
      exp
       exp
        prefixexp
         functioncall
          gcinfo
          args
           (
           )
       >
       exp
        exp
         number
          3
        *
        exp
         prefixexp
          x
     stat
      functioncall
       collectgarbage
       args
        string
         "restart"
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          prefixexp
           functioncall
            collectgarbage
            args
             (
             explist
              exp
               string
                "isrunning"
             )
        )
     stat
      repeat
      block
       stat
        local
        attnamelist
         a
         attrib
        =
        explist
         exp
          tableconstructor
           {
           }
      until
      exp
       exp
        prefixexp
         functioncall
          gcinfo
          args
           (
           )
       <=
       exp
        exp
         prefixexp
          x
        *
        exp
         number
          2
    end
   stat
    functioncall
     print
     args
      (
      explist
       exp
        string
         "clearing tables"
      )
   stat
    local
    attnamelist
     lim
     attrib
    =
    explist
     exp
      number
       15
   stat
    local
    attnamelist
     a
     attrib
    =
    explist
     exp
      tableconstructor
       {
       }
   stat
    for
    i
    =
    exp
     number
      1
    ,
    exp
     prefixexp
      lim
    do
    block
     stat
      varlist
       var
        prefixexp
         a
        [
        exp
         tableconstructor
          {
          }
        ]
      =
      explist
       exp
        prefixexp
         i
    end
   stat
    varlist
     var
      b
    =
    explist
     exp
      tableconstructor
       {
       }
   stat
    for
    namelist
     k
     ,
     v
    in
    explist
     exp
      prefixexp
       functioncall
        pairs
        args
         (
         explist
          exp
           prefixexp
            a
         )
    do
    block
     stat
      varlist
       var
        prefixexp
         b
        [
        exp
         prefixexp
          k
        ]
      =
      explist
       exp
        prefixexp
         v
    end
   stat
    for
    namelist
     n
    in
    explist
     exp
      prefixexp
       functioncall
        pairs
        args
         (
         explist
          exp
           prefixexp
            b
         )
    do
    block
     stat
      varlist
       var
        prefixexp
         a
        [
        exp
         prefixexp
          n
        ]
      =
      explist
       exp
        prefixexp
         undef
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           exp
            prefixexp
             functioncall
              type
              args
               (
               explist
                exp
                 prefixexp
                  n
               )
           ==
           exp
            string
             'table'
          and
          exp
           exp
            prefixexp
             functioncall
              next
              args
               (
               explist
                exp
                 prefixexp
                  n
               )
           ==
           exp
            nil
        )
     stat
      functioncall
       collectgarbage
       args
        (
        )
    end
   stat
    varlist
     var
      b
    =
    explist
     exp
      nil
   stat
    functioncall
     collectgarbage
     args
      (
      )
   stat
    for
    namelist
     n
    in
    explist
     exp
      prefixexp
       functioncall
        pairs
        args
         (
         explist
          exp
           prefixexp
            a
         )
    do
    block
     stat
      functioncall
       error
       args
        string
         'cannot be here'
    end
   stat
    for
    i
    =
    exp
     number
      1
    ,
    exp
     prefixexp
      lim
    do
    block
     stat
      varlist
       var
        prefixexp
         a
        [
        exp
         prefixexp
          i
        ]
      =
      explist
       exp
        prefixexp
         i
    end
   stat
    for
    i
    =
    exp
     number
      1
    ,
    exp
     prefixexp
      lim
    do
    block
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           prefixexp
            a
            [
            exp
             prefixexp
              i
            ]
          ==
          exp
           prefixexp
            i
        )
    end
   stat
    functioncall
     print
     args
      (
      explist
       exp
        string
         'weak tables'
      )
   stat
    varlist
     var
      a
    =
    explist
     exp
      tableconstructor
       {
       }
   stat
    ;
   stat
    functioncall
     setmetatable
     args
      (
      explist
       exp
        prefixexp
         a
       ,
       exp
        tableconstructor
         {
         fieldlist
          field
           __mode
           =
           exp
            string
             'k'
         }
      )
   stat
    ;
   stat
    for
    i
    =
    exp
     number
      1
    ,
    exp
     prefixexp
      lim
    do
    block
     stat
      varlist
       var
        prefixexp
         a
        [
        exp
         tableconstructor
          {
          }
        ]
      =
      explist
       exp
        prefixexp
         i
    end
   stat
    for
    i
    =
    exp
     number
      1
    ,
    exp
     prefixexp
      lim
    do
    block
     stat
      varlist
       var
        prefixexp
         a
        [
        exp
         prefixexp
          i
        ]
      =
      explist
       exp
        prefixexp
         i
    end
   stat
    for
    i
    =
    exp
     number
      1
    ,
    exp
     prefixexp
      lim
    do
    block
     stat
      local
      attnamelist
       s
       attrib
      =
      explist
       exp
        prefixexp
         functioncall
          string
          .
          rep
          args
           (
           explist
            exp
             string
              '@'
            ,
            exp
             prefixexp
              i
           )
     stat
      ;
     stat
      varlist
       var
        prefixexp
         a
        [
        exp
         prefixexp
          s
        ]
      =
      explist
       exp
        exp
         prefixexp
          s
        ..
        exp
         string
          '#'
    end
   stat
    functioncall
     collectgarbage
     args
      (
      )
   stat
    local
    attnamelist
     i
     attrib
    =
    explist
     exp
      number
       0
   stat
    for
    namelist
     k
     ,
     v
    in
    explist
     exp
      prefixexp
       functioncall
        pairs
        args
         (
         explist
          exp
           prefixexp
            a
         )
    do
    block
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           exp
            prefixexp
             k
           ==
           exp
            prefixexp
             v
          or
          exp
           exp
            exp
             prefixexp
              k
            ..
            exp
             string
              '#'
           ==
           exp
            prefixexp
             v
        )
     stat
      ;
     stat
      varlist
       var
        i
      =
      explist
       exp
        exp
         prefixexp
          i
        +
        exp
         number
          1
    end
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         prefixexp
          i
        ==
        exp
         exp
          number
           2
         *
         exp
          prefixexp
           lim
      )
   stat
    varlist
     var
      a
    =
    explist
     exp
      tableconstructor
       {
       }
   stat
    ;
   stat
    functioncall
     setmetatable
     args
      (
      explist
       exp
        prefixexp
         a
       ,
       exp
        tableconstructor
         {
         fieldlist
          field
           __mode
           =
           exp
            string
             'v'
         }
      )
   stat
    ;
   stat
    varlist
     var
      prefixexp
       a
      [
      exp
       number
        1
      ]
    =
    explist
     exp
      prefixexp
       functioncall
        string
        .
        rep
        args
         (
         explist
          exp
           string
            'b'
          ,
          exp
           number
            21
         )
   stat
    functioncall
     collectgarbage
     args
      (
      )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        prefixexp
         a
         [
         exp
          number
           1
         ]
      )
   stat
    varlist
     var
      prefixexp
       a
      [
      exp
       number
        1
      ]
    =
    explist
     exp
      prefixexp
       undef
   stat
    for
    i
    =
    exp
     number
      1
    ,
    exp
     prefixexp
      lim
    do
    block
     stat
      varlist
       var
        prefixexp
         a
        [
        exp
         prefixexp
          i
        ]
      =
      explist
       exp
        tableconstructor
         {
         }
    end
   stat
    for
    i
    =
    exp
     number
      1
    ,
    exp
     prefixexp
      lim
    do
    block
     stat
      varlist
       var
        prefixexp
         a
        [
        exp
         exp
          prefixexp
           i
         ..
         exp
          string
           'x'
        ]
      =
      explist
       exp
        tableconstructor
         {
         }
    end
   stat
    for
    i
    =
    exp
     number
      1
    ,
    exp
     prefixexp
      lim
    do
    block
     stat
      local
      attnamelist
       t
       attrib
      =
      explist
       exp
        tableconstructor
         {
         }
     stat
      ;
     stat
      varlist
       var
        prefixexp
         a
        [
        exp
         prefixexp
          t
        ]
      =
      explist
       exp
        prefixexp
         t
    end
   stat
    for
    i
    =
    exp
     number
      1
    ,
    exp
     prefixexp
      lim
    do
    block
     stat
      varlist
       var
        prefixexp
         a
        [
        exp
         exp
          prefixexp
           i
         +
         exp
          prefixexp
           lim
        ]
      =
      explist
       exp
        exp
         prefixexp
          i
        ..
        exp
         string
          'x'
    end
   stat
    functioncall
     collectgarbage
     args
      (
      )
   stat
    local
    attnamelist
     i
     attrib
    =
    explist
     exp
      number
       0
   stat
    for
    namelist
     k
     ,
     v
    in
    explist
     exp
      prefixexp
       functioncall
        pairs
        args
         (
         explist
          exp
           prefixexp
            a
         )
    do
    block
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           exp
            prefixexp
             k
           ==
           exp
            prefixexp
             v
          or
          exp
           exp
            exp
             exp
              prefixexp
               k
             -
             exp
              prefixexp
               lim
            ..
            exp
             string
              'x'
           ==
           exp
            prefixexp
             v
        )
     stat
      ;
     stat
      varlist
       var
        i
      =
      explist
       exp
        exp
         prefixexp
          i
        +
        exp
         number
          1
    end
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         prefixexp
          i
        ==
        exp
         exp
          number
           2
         *
         exp
          prefixexp
           lim
      )
   stat
    varlist
     var
      a
    =
    explist
     exp
      tableconstructor
       {
       }
   stat
    ;
   stat
    functioncall
     setmetatable
     args
      (
      explist
       exp
        prefixexp
         a
       ,
       exp
        tableconstructor
         {
         fieldlist
          field
           __mode
           =
           exp
            string
             'kv'
         }
      )
   stat
    ;
   stat
    local
    attnamelist
     x
     attrib
     ,
     y
     attrib
     ,
     z
     attrib
    =
    explist
     exp
      tableconstructor
       {
       }
     ,
     exp
      tableconstructor
       {
       }
     ,
     exp
      tableconstructor
       {
       }
   stat
    varlist
     var
      prefixexp
       a
      [
      exp
       number
        1
      ]
     ,
     var
      prefixexp
       a
      [
      exp
       number
        2
      ]
     ,
     var
      prefixexp
       a
      [
      exp
       number
        3
      ]
    =
    explist
     exp
      prefixexp
       x
     ,
     exp
      prefixexp
       y
     ,
     exp
      prefixexp
       z
   stat
    varlist
     var
      prefixexp
       a
      [
      exp
       prefixexp
        functioncall
         string
         .
         rep
         args
          (
          explist
           exp
            string
             '$'
           ,
           exp
            number
             11
          )
      ]
    =
    explist
     exp
      prefixexp
       functioncall
        string
        .
        rep
        args
         (
         explist
          exp
           string
            '$'
          ,
          exp
           number
            11
         )
   stat
    for
    i
    =
    exp
     number
      4
    ,
    exp
     prefixexp
      lim
    do
    block
     stat
      varlist
       var
        prefixexp
         a
        [
        exp
         prefixexp
          i
        ]
      =
      explist
       exp
        tableconstructor
         {
         }
    end
   stat
    for
    i
    =
    exp
     number
      1
    ,
    exp
     prefixexp
      lim
    do
    block
     stat
      varlist
       var
        prefixexp
         a
        [
        exp
         tableconstructor
          {
          }
        ]
      =
      explist
       exp
        prefixexp
         i
    end
   stat
    for
    i
    =
    exp
     number
      1
    ,
    exp
     prefixexp
      lim
    do
    block
     stat
      local
      attnamelist
       t
       attrib
      =
      explist
       exp
        tableconstructor
         {
         }
     stat
      ;
     stat
      varlist
       var
        prefixexp
         a
        [
        exp
         prefixexp
          t
        ]
      =
      explist
       exp
        prefixexp
         t
    end
   stat
    functioncall
     collectgarbage
     args
      (
      )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         prefixexp
          functioncall
           next
           args
            (
            explist
             exp
              prefixexp
               a
            )
        ~=
        exp
         nil
      )
   stat
    local
    attnamelist
     i
     attrib
    =
    explist
     exp
      number
       0
   stat
    for
    namelist
     k
     ,
     v
    in
    explist
     exp
      prefixexp
       functioncall
        pairs
        args
         (
         explist
          exp
           prefixexp
            a
         )
    do
    block
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           exp
            exp
             prefixexp
              (
              exp
               exp
                exp
                 prefixexp
                  k
                ==
                exp
                 number
                  1
               and
               exp
                exp
                 prefixexp
                  v
                ==
                exp
                 prefixexp
                  x
              )
            or
            exp
             prefixexp
              (
              exp
               exp
                exp
                 prefixexp
                  k
                ==
                exp
                 number
                  2
               and
               exp
                exp
                 prefixexp
                  v
                ==
                exp
                 prefixexp
                  y
              )
           or
           exp
            prefixexp
             (
             exp
              exp
               exp
                prefixexp
                 k
               ==
               exp
                number
                 3
              and
              exp
               exp
                prefixexp
                 v
               ==
               exp
                prefixexp
                 z
             )
          or
          exp
           exp
            prefixexp
             k
           ==
           exp
            prefixexp
             v
        )
     stat
      ;
     stat
      varlist
       var
        i
      =
      explist
       exp
        exp
         prefixexp
          i
        +
        exp
         number
          1
    end
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         prefixexp
          i
        ==
        exp
         number
          4
      )
   stat
    varlist
     var
      x
     ,
     var
      y
     ,
     var
      z
    =
    explist
     exp
      nil
   stat
    functioncall
     collectgarbage
     args
      (
      )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         prefixexp
          functioncall
           next
           args
            (
            explist
             exp
              prefixexp
               a
            )
        ==
        exp
         prefixexp
          functioncall
           string
           .
           rep
           args
            (
            explist
             exp
              string
               '$'
             ,
             exp
              number
               11
            )
      )
   stat
    varlist
     var
      a
    =
    explist
     exp
      tableconstructor
       {
       }
   stat
    local
    attnamelist
     t
     attrib
    =
    explist
     exp
      tableconstructor
       {
       fieldlist
        field
         x
         =
         exp
          number
           10
       }
   stat
    local
    attnamelist
     C
     attrib
    =
    explist
     exp
      prefixexp
       functioncall
        setmetatable
        args
         (
         explist
          exp
           tableconstructor
            {
            fieldlist
             field
              key
              =
              exp
               prefixexp
                t
            }
          ,
          exp
           tableconstructor
            {
            fieldlist
             field
              __mode
              =
              exp
               string
                'v'
            }
         )
   stat
    local
    attnamelist
     C1
     attrib
    =
    explist
     exp
      prefixexp
       functioncall
        setmetatable
        args
         (
         explist
          exp
           tableconstructor
            {
            fieldlist
             field
              [
              exp
               prefixexp
                t
              ]
              =
              exp
               number
                1
            }
          ,
          exp
           tableconstructor
            {
            fieldlist
             field
              __mode
              =
              exp
               string
                'k'
            }
         )
   stat
    varlist
     var
      prefixexp
       a
      .
      x
    =
    explist
     exp
      prefixexp
       t
   stat
    functioncall
     setmetatable
     args
      (
      explist
       exp
        prefixexp
         a
       ,
       exp
        tableconstructor
         {
         fieldlist
          field
           __gc
           =
           exp
            functiondef
             function
             funcbody
              (
              parlist
               namelist
                u
              )
              block
               stat
                functioncall
                 assert
                 args
                  (
                  explist
                   exp
                    exp
                     prefixexp
                      C
                      .
                      key
                    ==
                    exp
                     nil
                  )
               stat
                functioncall
                 assert
                 args
                  (
                  explist
                   exp
                    exp
                     prefixexp
                      functioncall
                       type
                       args
                        (
                        explist
                         exp
                          prefixexp
                           functioncall
                            next
                            args
                             (
                             explist
                              exp
                               prefixexp
                                C1
                             )
                        )
                    ==
                    exp
                     string
                      'table'
                  )
              end
         }
      )
   stat
    varlist
     var
      a
     ,
     var
      t
    =
    explist
     exp
      nil
   stat
    functioncall
     collectgarbage
     args
      (
      )
   stat
    functioncall
     collectgarbage
     args
      (
      )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         exp
          prefixexp
           functioncall
            next
            args
             (
             explist
              exp
               prefixexp
                C
             )
         ==
         exp
          nil
        and
        exp
         exp
          prefixexp
           functioncall
            next
            args
             (
             explist
              exp
               prefixexp
                C1
             )
         ==
         exp
          nil
      )
   stat
    varlist
     var
      C
     ,
     var
      C1
    =
    explist
     exp
      nil
   stat
    local
    attnamelist
     mt
     attrib
    =
    explist
     exp
      tableconstructor
       {
       fieldlist
        field
         __mode
         =
         exp
          string
           'k'
       }
   stat
    varlist
     var
      a
    =
    explist
     exp
      tableconstructor
       {
       fieldlist
        field
         exp
          tableconstructor
           {
           fieldlist
            field
             exp
              number
               10
           }
        fieldsep
         ,
        field
         exp
          tableconstructor
           {
           fieldlist
            field
             exp
              number
               20
           }
        fieldsep
         ,
        field
         exp
          tableconstructor
           {
           fieldlist
            field
             exp
              number
               30
           }
        fieldsep
         ,
        field
         exp
          tableconstructor
           {
           fieldlist
            field
             exp
              number
               40
           }
       }
   stat
    ;
   stat
    functioncall
     setmetatable
     args
      (
      explist
       exp
        prefixexp
         a
       ,
       exp
        prefixexp
         mt
      )
   stat
    varlist
     var
      x
    =
    explist
     exp
      nil
   stat
    for
    i
    =
    exp
     number
      1
    ,
    exp
     number
      100
    do
    block
     stat
      local
      attnamelist
       n
       attrib
      =
      explist
       exp
        tableconstructor
         {
         }
     stat
      ;
     stat
      varlist
       var
        prefixexp
         a
        [
        exp
         prefixexp
          n
        ]
      =
      explist
       exp
        tableconstructor
         {
         fieldlist
          field
           k
           =
           exp
            tableconstructor
             {
             fieldlist
              field
               exp
                prefixexp
                 x
             }
         }
     stat
      ;
     stat
      varlist
       var
        x
      =
      explist
       exp
        prefixexp
         n
    end
   stat
    functioncall
     GC
     args
      (
      )
   stat
    local
    attnamelist
     n
     attrib
    =
    explist
     exp
      prefixexp
       x
   stat
    local
    attnamelist
     i
     attrib
    =
    explist
     exp
      number
       0
   stat
    while
    exp
     prefixexp
      n
    do
    block
     stat
      varlist
       var
        n
      =
      explist
       exp
        prefixexp
         a
         [
         exp
          prefixexp
           n
         ]
         .
         k
         [
         exp
          number
           1
         ]
     stat
      ;
     stat
      varlist
       var
        i
      =
      explist
       exp
        exp
         prefixexp
          i
        +
        exp
         number
          1
    end
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         prefixexp
          i
        ==
        exp
         number
          100
      )
   stat
    varlist
     var
      x
    =
    explist
     exp
      nil
   stat
    functioncall
     GC
     args
      (
      )
   stat
    for
    i
    =
    exp
     number
      1
    ,
    exp
     number
      4
    do
    block
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           prefixexp
            a
            [
            exp
             prefixexp
              i
            ]
            [
            exp
             number
              1
            ]
          ==
          exp
           exp
            prefixexp
             i
           *
           exp
            number
             10
        )
     stat
      ;
     stat
      varlist
       var
        prefixexp
         a
        [
        exp
         prefixexp
          i
        ]
      =
      explist
       exp
        prefixexp
         undef
    end
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         prefixexp
          functioncall
           next
           args
            (
            explist
             exp
              prefixexp
               a
            )
        ==
        exp
         nil
      )
   stat
    local
    attnamelist
     K
     attrib
    =
    explist
     exp
      tableconstructor
       {
       }
   stat
    varlist
     var
      prefixexp
       a
      [
      exp
       prefixexp
        K
      ]
    =
    explist
     exp
      tableconstructor
       {
       }
   stat
    for
    i
    =
    exp
     number
      1
    ,
    exp
     number
      10
    do
    block
     stat
      varlist
       var
        prefixexp
         a
         [
         exp
          prefixexp
           K
         ]
        [
        exp
         prefixexp
          i
        ]
      =
      explist
       exp
        tableconstructor
         {
         }
     stat
      ;
     stat
      varlist
       var
        prefixexp
         a
        [
        exp
         prefixexp
          a
          [
          exp
           prefixexp
            K
          ]
          [
          exp
           prefixexp
            i
          ]
        ]
      =
      explist
       exp
        prefixexp
         functioncall
          setmetatable
          args
           (
           explist
            exp
             tableconstructor
              {
              }
            ,
            exp
             prefixexp
              mt
           )
    end
   stat
    varlist
     var
      x
    =
    explist
     exp
      nil
   stat
    local
    attnamelist
     k
     attrib
    =
    explist
     exp
      number
       1
   stat
    for
    j
    =
    exp
     number
      1
    ,
    exp
     number
      100
    do
    block
     stat
      local
      attnamelist
       n
       attrib
      =
      explist
       exp
        tableconstructor
         {
         }
     stat
      ;
     stat
      local
      attnamelist
       nk
       attrib
      =
      explist
       exp
        exp
         exp
          prefixexp
           k
         %
         exp
          number
           10
        +
        exp
         number
          1
     stat
      varlist
       var
        prefixexp
         a
         [
         exp
          prefixexp
           a
           [
           exp
            prefixexp
             K
           ]
           [
           exp
            prefixexp
             nk
           ]
         ]
        [
        exp
         prefixexp
          n
        ]
      =
      explist
       exp
        tableconstructor
         {
         fieldlist
          field
           exp
            prefixexp
             x
          fieldsep
           ,
          field
           k
           =
           exp
            prefixexp
             k
         }
     stat
      ;
     stat
      varlist
       var
        x
      =
      explist
       exp
        prefixexp
         n
     stat
      ;
     stat
      varlist
       var
        k
      =
      explist
       exp
        prefixexp
         nk
    end
   stat
    functioncall
     GC
     args
      (
      )
   stat
    local
    attnamelist
     n
     attrib
    =
    explist
     exp
      prefixexp
       x
   stat
    local
    attnamelist
     i
     attrib
    =
    explist
     exp
      number
       0
   stat
    while
    exp
     prefixexp
      n
    do
    block
     stat
      local
      attnamelist
       t
       attrib
      =
      explist
       exp
        prefixexp
         a
         [
         exp
          prefixexp
           a
           [
           exp
            prefixexp
             K
           ]
           [
           exp
            prefixexp
             k
           ]
         ]
         [
         exp
          prefixexp
           n
         ]
     stat
      ;
     stat
      varlist
       var
        n
      =
      explist
       exp
        prefixexp
         t
         [
         exp
          number
           1
         ]
     stat
      ;
     stat
      varlist
       var
        k
      =
      explist
       exp
        prefixexp
         t
         .
         k
     stat
      ;
     stat
      varlist
       var
        i
      =
      explist
       exp
        exp
         prefixexp
          i
        +
        exp
         number
          1
    end
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         prefixexp
          i
        ==
        exp
         number
          100
      )
   stat
    varlist
     var
      K
    =
    explist
     exp
      nil
   stat
    functioncall
     GC
     args
      (
      )
   stat
    if
    exp
     prefixexp
      T
    then
    block
     stat
      functioncall
       collectgarbage
       args
        (
        explist
         exp
          string
           "stop"
        )
     stat
      local
      attnamelist
       u
       attrib
      =
      explist
       exp
        tableconstructor
         {
         }
     stat
      local
      attnamelist
       s
       attrib
      =
      explist
       exp
        tableconstructor
         {
         }
     stat
      ;
     stat
      functioncall
       setmetatable
       args
        (
        explist
         exp
          prefixexp
           s
         ,
         exp
          tableconstructor
           {
           fieldlist
            field
             __mode
             =
             exp
              string
               'k'
           }
        )
     stat
      functioncall
       setmetatable
       args
        (
        explist
         exp
          prefixexp
           u
         ,
         exp
          tableconstructor
           {
           fieldlist
            field
             __gc
             =
             exp
              functiondef
               function
               funcbody
                (
                parlist
                 namelist
                  o
                )
                block
                 stat
                  local
                  attnamelist
                   i
                   attrib
                  =
                  explist
                   exp
                    prefixexp
                     s
                     [
                     exp
                      prefixexp
                       o
                     ]
                 stat
                  varlist
                   var
                    prefixexp
                     s
                    [
                    exp
                     prefixexp
                      i
                    ]
                  =
                  explist
                   exp
                    true
                 stat
                  functioncall
                   assert
                   args
                    (
                    explist
                     exp
                      not
                      exp
                       prefixexp
                        s
                        [
                        exp
                         exp
                          prefixexp
                           i
                         -
                         exp
                          number
                           1
                        ]
                    )
                 stat
                  if
                  exp
                   exp
                    prefixexp
                     i
                   ==
                   exp
                    number
                     8
                  then
                  block
                   stat
                    functioncall
                     error
                     args
                      (
                      explist
                       exp
                        string
                         "@expected@"
                      )
                  end
                end
           }
        )
     stat
      for
      i
      =
      exp
       number
        6
      ,
      exp
       number
        10
      do
      block
       stat
        local
        attnamelist
         n
         attrib
        =
        explist
         exp
          prefixexp
           functioncall
            setmetatable
            args
             (
             explist
              exp
               tableconstructor
                {
                }
              ,
              exp
               prefixexp
                functioncall
                 getmetatable
                 args
                  (
                  explist
                   exp
                    prefixexp
                     u
                  )
             )
       stat
        varlist
         var
          prefixexp
           s
          [
          exp
           prefixexp
            n
          ]
        =
        explist
         exp
          prefixexp
           i
      end
     stat
      functioncall
       warn
       args
        (
        explist
         exp
          string
           "@on"
        )
     stat
      ;
     stat
      functioncall
       warn
       args
        (
        explist
         exp
          string
           "@store"
        )
     stat
      functioncall
       collectgarbage
       args
        (
        )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          prefixexp
           functioncall
            string
            .
            find
            args
             (
             explist
              exp
               prefixexp
                _WARN
              ,
              exp
               string
                "error in __gc"
             )
        )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           prefixexp
            functioncall
             string
             .
             match
             args
              (
              explist
               exp
                prefixexp
                 _WARN
               ,
               exp
                string
                 "@(.-)@"
              )
          ==
          exp
           string
            "expected"
        )
     stat
      ;
     stat
      varlist
       var
        _WARN
      =
      explist
       exp
        false
     stat
      for
      i
      =
      exp
       number
        8
      ,
      exp
       number
        10
      do
      block
       stat
        functioncall
         assert
         args
          (
          explist
           exp
            prefixexp
             s
             [
             exp
              prefixexp
               i
             ]
          )
      end
     stat
      for
      i
      =
      exp
       number
        1
      ,
      exp
       number
        5
      do
      block
       stat
        local
        attnamelist
         n
         attrib
        =
        explist
         exp
          prefixexp
           functioncall
            setmetatable
            args
             (
             explist
              exp
               tableconstructor
                {
                }
              ,
              exp
               prefixexp
                functioncall
                 getmetatable
                 args
                  (
                  explist
                   exp
                    prefixexp
                     u
                  )
             )
       stat
        varlist
         var
          prefixexp
           s
          [
          exp
           prefixexp
            n
          ]
        =
        explist
         exp
          prefixexp
           i
      end
     stat
      functioncall
       collectgarbage
       args
        (
        )
     stat
      for
      i
      =
      exp
       number
        1
      ,
      exp
       number
        10
      do
      block
       stat
        functioncall
         assert
         args
          (
          explist
           exp
            prefixexp
             s
             [
             exp
              prefixexp
               i
             ]
          )
      end
     stat
      varlist
       var
        prefixexp
         functioncall
          getmetatable
          args
           (
           explist
            exp
             prefixexp
              u
           )
        .
        __gc
      =
      explist
       exp
        nil
     stat
      functioncall
       warn
       args
        (
        explist
         exp
          string
           "@normal"
        )
    end
   stat
    functioncall
     print
     args
      string
       '+'
   stat
    if
    exp
     exp
      prefixexp
       T
     ==
     exp
      nil
    then
    block
     stat
      functioncall
       (
       exp
        exp
         prefixexp
          Message
        or
        exp
         prefixexp
          print
       )
       args
        (
        explist
         exp
          string
           '\n >>> testC not active: skipping userdata GC tests <<<\n'
        )
    else
    block
     stat
      local
      function
      newproxy
      funcbody
       (
       parlist
        namelist
         u
       )
       block
        retstat
         return
         explist
          exp
           prefixexp
            functioncall
             debug
             .
             setmetatable
             args
              (
              explist
               exp
                prefixexp
                 functioncall
                  T
                  .
                  newuserdata
                  args
                   (
                   explist
                    exp
                     number
                      0
                   )
               ,
               exp
                prefixexp
                 functioncall
                  debug
                  .
                  getmetatable
                  args
                   (
                   explist
                    exp
                     prefixexp
                      u
                   )
              )
       end
     stat
      functioncall
       collectgarbage
       args
        (
        explist
         exp
          string
           "stop"
        )
     stat
      local
      attnamelist
       u
       attrib
      =
      explist
       exp
        prefixexp
         functioncall
          newproxy
          args
           (
           explist
            exp
             nil
           )
     stat
      functioncall
       debug
       .
       setmetatable
       args
        (
        explist
         exp
          prefixexp
           u
         ,
         exp
          tableconstructor
           {
           fieldlist
            field
             __gc
             =
             exp
              true
           }
        )
     stat
      local
      attnamelist
       s
       attrib
      =
      explist
       exp
        number
         0
     stat
      local
      attnamelist
       a
       attrib
      =
      explist
       exp
        tableconstructor
         {
         fieldlist
          field
           [
           exp
            prefixexp
             u
           ]
           =
           exp
            number
             0
         }
     stat
      ;
     stat
      functioncall
       setmetatable
       args
        (
        explist
         exp
          prefixexp
           a
         ,
         exp
          tableconstructor
           {
           fieldlist
            field
             __mode
             =
             exp
              string
               'vk'
           }
        )
     stat
      for
      i
      =
      exp
       number
        1
      ,
      exp
       number
        10
      do
      block
       stat
        varlist
         var
          prefixexp
           a
          [
          exp
           prefixexp
            functioncall
             newproxy
             args
              (
              explist
               exp
                prefixexp
                 u
              )
          ]
        =
        explist
         exp
          prefixexp
           i
      end
     stat
      for
      namelist
       k
      in
      explist
       exp
        prefixexp
         functioncall
          pairs
          args
           (
           explist
            exp
             prefixexp
              a
           )
      do
      block
       stat
        functioncall
         assert
         args
          (
          explist
           exp
            exp
             prefixexp
              functioncall
               getmetatable
               args
                (
                explist
                 exp
                  prefixexp
                   k
                )
            ==
            exp
             prefixexp
              functioncall
               getmetatable
               args
                (
                explist
                 exp
                  prefixexp
                   u
                )
          )
      end
     stat
      local
      attnamelist
       a1
       attrib
      =
      explist
       exp
        tableconstructor
         {
         }
     stat
      ;
     stat
      for
      namelist
       k
       ,
       v
      in
      explist
       exp
        prefixexp
         functioncall
          pairs
          args
           (
           explist
            exp
             prefixexp
              a
           )
      do
      block
       stat
        varlist
         var
          prefixexp
           a1
          [
          exp
           prefixexp
            k
          ]
        =
        explist
         exp
          prefixexp
           v
      end
     stat
      for
      namelist
       k
       ,
       v
      in
      explist
       exp
        prefixexp
         functioncall
          pairs
          args
           (
           explist
            exp
             prefixexp
              a1
           )
      do
      block
       stat
        varlist
         var
          prefixexp
           a
          [
          exp
           prefixexp
            v
          ]
        =
        explist
         exp
          prefixexp
           k
      end
     stat
      for
      i
      =
      exp
       number
        1
      ,
      exp
       number
        10
      do
      block
       stat
        functioncall
         assert
         args
          (
          explist
           exp
            prefixexp
             a
             [
             exp
              prefixexp
               i
             ]
          )
      end
     stat
      varlist
       var
        prefixexp
         functioncall
          getmetatable
          args
           (
           explist
            exp
             prefixexp
              u
           )
        .
        a
      =
      explist
       exp
        prefixexp
         a1
     stat
      varlist
       var
        prefixexp
         functioncall
          getmetatable
          args
           (
           explist
            exp
             prefixexp
              u
           )
        .
        u
      =
      explist
       exp
        prefixexp
         u
     stat
      do
      block
       stat
        local
        attnamelist
         u
         attrib
        =
        explist
         exp
          prefixexp
           u
       stat
        varlist
         var
          prefixexp
           functioncall
            getmetatable
            args
             (
             explist
              exp
               prefixexp
                u
             )
          .
          __gc
        =
        explist
         exp
          functiondef
           function
           funcbody
            (
            parlist
             namelist
              o
            )
            block
             stat
              functioncall
               assert
               args
                (
                explist
                 exp
                  exp
                   prefixexp
                    a
                    [
                    exp
                     prefixexp
                      o
                    ]
                  ==
                  exp
                   exp
                    number
                     10
                   -
                   exp
                    prefixexp
                     s
                )
             stat
              functioncall
               assert
               args
                (
                explist
                 exp
                  exp
                   prefixexp
                    a
                    [
                    exp
                     exp
                      number
                       10
                     -
                     exp
                      prefixexp
                       s
                    ]
                  ==
                  exp
                   prefixexp
                    undef
                )
             stat
              functioncall
               assert
               args
                (
                explist
                 exp
                  exp
                   prefixexp
                    functioncall
                     getmetatable
                     args
                      (
                      explist
                       exp
                        prefixexp
                         o
                      )
                  ==
                  exp
                   prefixexp
                    functioncall
                     getmetatable
                     args
                      (
                      explist
                       exp
                        prefixexp
                         u
                      )
                )
             stat
              functioncall
               assert
               args
                (
                explist
                 exp
                  exp
                   prefixexp
                    functioncall
                     getmetatable
                     args
                      (
                      explist
                       exp
                        prefixexp
                         o
                      )
                    .
                    a
                    [
                    exp
                     prefixexp
                      o
                    ]
                  ==
                  exp
                   exp
                    number
                     10
                   -
                   exp
                    prefixexp
                     s
                )
             stat
              varlist
               var
                s
              =
              explist
               exp
                exp
                 prefixexp
                  s
                +
                exp
                 number
                  1
            end
      end
     stat
      varlist
       var
        a1
       ,
       var
        u
      =
      explist
       exp
        nil
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           prefixexp
            functioncall
             next
             args
              (
              explist
               exp
                prefixexp
                 a
              )
          ~=
          exp
           nil
        )
     stat
      functioncall
       collectgarbage
       args
        (
        )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           prefixexp
            s
          ==
          exp
           number
            11
        )
     stat
      functioncall
       collectgarbage
       args
        (
        )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           prefixexp
            functioncall
             next
             args
              (
              explist
               exp
                prefixexp
                 a
              )
          ==
          exp
           nil
        )
    end
   stat
    local
    attnamelist
     u
     attrib
    =
    explist
     exp
      prefixexp
       functioncall
        setmetatable
        args
         (
         explist
          exp
           tableconstructor
            {
            }
          ,
          exp
           tableconstructor
            {
            fieldlist
             field
              __gc
              =
              exp
               true
            }
         )
   stat
    functioncall
     setmetatable
     args
      (
      explist
       exp
        prefixexp
         functioncall
          getmetatable
          args
           (
           explist
            exp
             prefixexp
              u
           )
       ,
       exp
        tableconstructor
         {
         fieldlist
          field
           __mode
           =
           exp
            string
             "v"
         }
      )
   stat
    varlist
     var
      prefixexp
       functioncall
        getmetatable
        args
         (
         explist
          exp
           prefixexp
            u
         )
      .
      __gc
    =
    explist
     exp
      functiondef
       function
       funcbody
        (
        parlist
         namelist
          o
        )
        block
         stat
          functioncall
           os
           .
           exit
           args
            (
            explist
             exp
              number
               1
            )
        end
   stat
    varlist
     var
      u
    =
    explist
     exp
      nil
   stat
    functioncall
     collectgarbage
     args
      (
      )
   stat
    local
    attnamelist
     u
     attrib
    =
    explist
     exp
      prefixexp
       functioncall
        setmetatable
        args
         (
         explist
          exp
           tableconstructor
            {
            }
          ,
          exp
           tableconstructor
            {
            fieldlist
             field
              __gc
              =
              exp
               true
            }
         )
   stat
    local
    attnamelist
     m
     attrib
    =
    explist
     exp
      prefixexp
       functioncall
        getmetatable
        args
         (
         explist
          exp
           prefixexp
            u
         )
   stat
    varlist
     var
      prefixexp
       m
      .
      x
    =
    explist
     exp
      tableconstructor
       {
       fieldlist
        field
         [
         exp
          tableconstructor
           {
           fieldlist
            field
             exp
              number
               0
           }
         ]
         =
         exp
          number
           1
        fieldsep
         ;
        field
         [
         exp
          number
           0
         ]
         =
         exp
          tableconstructor
           {
           fieldlist
            field
             exp
              number
               1
           }
       }
   stat
    ;
   stat
    functioncall
     setmetatable
     args
      (
      explist
       exp
        prefixexp
         m
         .
         x
       ,
       exp
        tableconstructor
         {
         fieldlist
          field
           __mode
           =
           exp
            string
             "kv"
         }
      )
   stat
    ;
   stat
    varlist
     var
      prefixexp
       m
      .
      __gc
    =
    explist
     exp
      functiondef
       function
       funcbody
        (
        parlist
         namelist
          o
        )
        block
         stat
          functioncall
           assert
           args
            (
            explist
             exp
              exp
               prefixexp
                functioncall
                 next
                 args
                  (
                  explist
                   exp
                    prefixexp
                     functioncall
                      getmetatable
                      args
                       (
                       explist
                        exp
                         prefixexp
                          o
                       )
                     .
                     x
                  )
              ==
              exp
               nil
            )
         stat
          varlist
           var
            m
          =
          explist
           exp
            number
             10
        end
   stat
    varlist
     var
      u
     ,
     var
      m
    =
    explist
     exp
      nil
   stat
    functioncall
     collectgarbage
     args
      (
      )
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        exp
         prefixexp
          m
        ==
        exp
         number
          10
      )
   stat
    do
    block
     stat
      functioncall
       collectgarbage
       args
        (
        )
     stat
      ;
     stat
      functioncall
       collectgarbage
       args
        (
        )
     stat
      local
      attnamelist
       m
       attrib
      =
      explist
       exp
        prefixexp
         functioncall
          collectgarbage
          args
           (
           explist
            exp
             string
              "count"
           )
     stat
      local
      attnamelist
       a
       attrib
      =
      explist
       exp
        prefixexp
         functioncall
          setmetatable
          args
           (
           explist
            exp
             tableconstructor
              {
              }
            ,
            exp
             tableconstructor
              {
              fieldlist
               field
                __mode
                =
                exp
                 string
                  "kv"
              }
           )
     stat
      varlist
       var
        prefixexp
         a
        [
        exp
         prefixexp
          functioncall
           string
           .
           rep
           args
            (
            explist
             exp
              string
               "a"
             ,
             exp
              exp
               number
                2
              ^
              exp
               number
                22
            )
        ]
      =
      explist
       exp
        number
         25
     stat
      varlist
       var
        prefixexp
         a
        [
        exp
         prefixexp
          functioncall
           string
           .
           rep
           args
            (
            explist
             exp
              string
               "b"
             ,
             exp
              exp
               number
                2
              ^
              exp
               number
                22
            )
        ]
      =
      explist
       exp
        tableconstructor
         {
         }
     stat
      varlist
       var
        prefixexp
         a
        [
        exp
         tableconstructor
          {
          }
        ]
      =
      explist
       exp
        number
         14
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           prefixexp
            functioncall
             collectgarbage
             args
              (
              explist
               exp
                string
                 "count"
              )
          >
          exp
           exp
            prefixexp
             m
           +
           exp
            exp
             number
              2
            ^
            exp
             number
              13
        )
     stat
      functioncall
       collectgarbage
       args
        (
        )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           exp
            prefixexp
             functioncall
              collectgarbage
              args
               (
               explist
                exp
                 string
                  "count"
               )
           >=
           exp
            exp
             prefixexp
              m
            +
            exp
             exp
              number
               2
             ^
             exp
              number
               12
          and
          exp
           exp
            prefixexp
             functioncall
              collectgarbage
              args
               (
               explist
                exp
                 string
                  "count"
               )
           <
           exp
            exp
             prefixexp
              m
            +
            exp
             exp
              number
               2
             ^
             exp
              number
               13
        )
     stat
      local
      attnamelist
       k
       attrib
       ,
       v
       attrib
      =
      explist
       exp
        prefixexp
         functioncall
          next
          args
           (
           explist
            exp
             prefixexp
              a
           )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           exp
            prefixexp
             k
           ==
           exp
            prefixexp
             functioncall
              string
              .
              rep
              args
               (
               explist
                exp
                 string
                  "a"
                ,
                exp
                 exp
                  number
                   2
                 ^
                 exp
                  number
                   22
               )
          and
          exp
           exp
            prefixexp
             v
           ==
           exp
            number
             25
        )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           prefixexp
            functioncall
             next
             args
              (
              explist
               exp
                prefixexp
                 a
               ,
               exp
                prefixexp
                 k
              )
          ==
          exp
           nil
        )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           prefixexp
            a
            [
            exp
             prefixexp
              functioncall
               string
               .
               rep
               args
                (
                explist
                 exp
                  string
                   "b"
                 ,
                 exp
                  exp
                   number
                    2
                  ^
                  exp
                   number
                    22
                )
            ]
          ==
          exp
           prefixexp
            undef
        )
     stat
      varlist
       var
        prefixexp
         a
        [
        exp
         prefixexp
          k
        ]
      =
      explist
       exp
        prefixexp
         undef
     stat
      varlist
       var
        k
      =
      explist
       exp
        nil
     stat
      functioncall
       collectgarbage
       args
        (
        )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           prefixexp
            functioncall
             next
             args
              (
              explist
               exp
                prefixexp
                 a
              )
          ==
          exp
           nil
        )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           prefixexp
            a
            [
            exp
             prefixexp
              functioncall
               string
               .
               rep
               args
                (
                explist
                 exp
                  string
                   "b"
                 ,
                 exp
                  number
                   100
                )
            ]
          ==
          exp
           prefixexp
            undef
        )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           prefixexp
            functioncall
             collectgarbage
             args
              (
              explist
               exp
                string
                 "count"
              )
          <=
          exp
           exp
            prefixexp
             m
           +
           exp
            number
             1
        )
    end
   stat
    if
    exp
     prefixexp
      T
    then
    block
     stat
      functioncall
       warn
       args
        (
        explist
         exp
          string
           "@store"
        )
     stat
      varlist
       var
        u
      =
      explist
       exp
        prefixexp
         functioncall
          setmetatable
          args
           (
           explist
            exp
             tableconstructor
              {
              }
            ,
            exp
             tableconstructor
              {
              fieldlist
               field
                __gc
                =
                exp
                 functiondef
                  function
                  funcbody
                   (
                   parlist
                   )
                   block
                    stat
                     functioncall
                      error
                      args
                       string
                        "@expected error"
                   end
              }
           )
     stat
      varlist
       var
        u
      =
      explist
       exp
        nil
     stat
      functioncall
       collectgarbage
       args
        (
        )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          prefixexp
           functioncall
            string
            .
            find
            args
             (
             explist
              exp
               prefixexp
                _WARN
              ,
              exp
               string
                "@expected error"
             )
        )
     stat
      ;
     stat
      varlist
       var
        _WARN
      =
      explist
       exp
        false
     stat
      functioncall
       warn
       args
        (
        explist
         exp
          string
           "@normal"
        )
    end
   stat
    if
    exp
     not
     exp
      prefixexp
       _soft
    then
    block
     stat
      functioncall
       print
       args
        (
        explist
         exp
          string
           "long list"
        )
     stat
      local
      attnamelist
       a
       attrib
      =
      explist
       exp
        tableconstructor
         {
         }
     stat
      for
      i
      =
      exp
       number
        1
      ,
      exp
       number
        200000
      do
      block
       stat
        varlist
         var
          a
        =
        explist
         exp
          tableconstructor
           {
           fieldlist
            field
             next
             =
             exp
              prefixexp
               a
           }
      end
     stat
      varlist
       var
        a
      =
      explist
       exp
        nil
     stat
      functioncall
       collectgarbage
       args
        (
        )
    end
   stat
    functioncall
     print
     args
      (
      explist
       exp
        string
         "self-referenced threads"
      )
   stat
    local
    attnamelist
     thread_id
     attrib
    =
    explist
     exp
      number
       0
   stat
    local
    attnamelist
     threads
     attrib
    =
    explist
     exp
      tableconstructor
       {
       }
   stat
    local
    function
    fn
    funcbody
     (
     parlist
      namelist
       thread
     )
     block
      stat
       local
       attnamelist
        x
        attrib
       =
       explist
        exp
         tableconstructor
          {
          }
      stat
       varlist
        var
         prefixexp
          threads
         [
         exp
          prefixexp
           thread_id
         ]
       =
       explist
        exp
         functiondef
          function
          funcbody
           (
           parlist
           )
           block
            stat
             varlist
              var
               thread
             =
             explist
              exp
               prefixexp
                x
           end
      stat
       functioncall
        coroutine
        .
        yield
        args
         (
         )
     end
   stat
    while
    exp
     exp
      prefixexp
       thread_id
     <
     exp
      number
       1000
    do
    block
     stat
      local
      attnamelist
       thread
       attrib
      =
      explist
       exp
        prefixexp
         functioncall
          coroutine
          .
          create
          args
           (
           explist
            exp
             prefixexp
              fn
           )
     stat
      functioncall
       coroutine
       .
       resume
       args
        (
        explist
         exp
          prefixexp
           thread
         ,
         exp
          prefixexp
           thread
        )
     stat
      varlist
       var
        thread_id
      =
      explist
       exp
        exp
         prefixexp
          thread_id
        +
        exp
         number
          1
    end
   stat
    do
    block
     stat
      local
      attnamelist
       collected
       attrib
      =
      explist
       exp
        false
     stat
      functioncall
       collectgarbage
       args
        (
        )
     stat
      ;
     stat
      functioncall
       collectgarbage
       args
        (
        explist
         exp
          string
           "stop"
        )
     stat
      do
      block
       stat
        local
        function
        f
        funcbody
         (
         parlist
          namelist
           param
         )
         block
          stat
           ;
          stat
           functioncall
            (
            exp
             functiondef
              function
              funcbody
               (
               parlist
               )
               block
                stat
                 functioncall
                  assert
                  args
                   (
                   explist
                    exp
                     exp
                      exp
                       prefixexp
                        functioncall
                         type
                         args
                          (
                          explist
                           exp
                            prefixexp
                             f
                          )
                      ==
                      exp
                       string
                        'function'
                     and
                     exp
                      exp
                       prefixexp
                        functioncall
                         type
                         args
                          (
                          explist
                           exp
                            prefixexp
                             param
                          )
                      ==
                      exp
                       string
                        'thread'
                   )
                stat
                 varlist
                  var
                   param
                 =
                 explist
                  exp
                   tableconstructor
                    {
                    fieldlist
                     field
                      exp
                       prefixexp
                        param
                     fieldsep
                      ,
                     field
                      exp
                       prefixexp
                        f
                    }
                stat
                 functioncall
                  setmetatable
                  args
                   (
                   explist
                    exp
                     prefixexp
                      param
                    ,
                    exp
                     tableconstructor
                      {
                      fieldlist
                       field
                        __gc
                        =
                        exp
                         functiondef
                          function
                          funcbody
                           (
                           parlist
                           )
                           block
                            stat
                             varlist
                              var
                               collected
                             =
                             explist
                              exp
                               true
                           end
                      }
                   )
                stat
                 functioncall
                  coroutine
                  .
                  yield
                  args
                   (
                   explist
                    exp
                     number
                      100
                   )
               end
            )
            args
             (
             )
         end
       stat
        local
        attnamelist
         co
         attrib
        =
        explist
         exp
          prefixexp
           functioncall
            coroutine
            .
            create
            args
             (
             explist
              exp
               prefixexp
                f
             )
       stat
        functioncall
         assert
         args
          (
          explist
           exp
            prefixexp
             functioncall
              coroutine
              .
              resume
              args
               (
               explist
                exp
                 prefixexp
                  co
                ,
                exp
                 prefixexp
                  co
               )
          )
      end
     stat
      functioncall
       collectgarbage
       args
        (
        )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          prefixexp
           collected
        )
     stat
      functioncall
       collectgarbage
       args
        (
        explist
         exp
          string
           "restart"
        )
    end
   stat
    do
    block
     stat
      functioncall
       collectgarbage
       args
        (
        )
     stat
      functioncall
       collectgarbage
       args
        string
         "stop"
     stat
      functioncall
       collectgarbage
       args
        (
        explist
         exp
          string
           "step"
         ,
         exp
          number
           0
        )
     stat
      local
      attnamelist
       x
       attrib
      =
      explist
       exp
        prefixexp
         functioncall
          gcinfo
          args
           (
           )
     stat
      repeat
      block
       stat
        for
        i
        =
        exp
         number
          1
        ,
        exp
         number
          1000
        do
        block
         stat
          varlist
           var
            prefixexp
             _ENV
            .
            a
          =
          explist
           exp
            tableconstructor
             {
             }
        end
      until
      exp
       exp
        prefixexp
         functioncall
          gcinfo
          args
           (
           )
       >
       exp
        exp
         number
          2
        *
        exp
         prefixexp
          x
     stat
      functioncall
       collectgarbage
       args
        string
         "restart"
     stat
      varlist
       var
        prefixexp
         _ENV
        .
        a
      =
      explist
       exp
        nil
    end
   stat
    if
    exp
     prefixexp
      T
    then
    block
     stat
      local
      function
      foo
      funcbody
       (
       parlist
       )
       block
        stat
         local
         attnamelist
          a
          attrib
         =
         explist
          exp
           tableconstructor
            {
            fieldlist
             field
              x
              =
              exp
               number
                20
            }
        stat
         functioncall
          coroutine
          .
          yield
          args
           (
           explist
            exp
             functiondef
              function
              funcbody
               (
               parlist
               )
               block
                retstat
                 return
                 explist
                  exp
                   prefixexp
                    a
                    .
                    x
               end
           )
        stat
         functioncall
          assert
          args
           (
           explist
            exp
             exp
              prefixexp
               a
               .
               x
             ==
             exp
              number
               20
           )
        stat
         varlist
          var
           a
         =
         explist
          exp
           tableconstructor
            {
            fieldlist
             field
              x
              =
              exp
               number
                30
            }
        stat
         functioncall
          assert
          args
           (
           explist
            exp
             exp
              prefixexp
               functioncall
                T
                .
                gccolor
                args
                 (
                 explist
                  exp
                   prefixexp
                    a
                 )
             ==
             exp
              string
               "white"
           )
        stat
         functioncall
          coroutine
          .
          yield
          args
           (
           explist
            exp
             number
              100
           )
       end
     stat
      local
      attnamelist
       t
       attrib
      =
      explist
       exp
        prefixexp
         functioncall
          setmetatable
          args
           (
           explist
            exp
             tableconstructor
              {
              }
            ,
            exp
             tableconstructor
              {
              fieldlist
               field
                __mode
                =
                exp
                 string
                  "kv"
              }
           )
     stat
      functioncall
       collectgarbage
       args
        (
        )
     stat
      ;
     stat
      functioncall
       collectgarbage
       args
        (
        explist
         exp
          string
           'stop'
        )
     stat
      varlist
       var
        prefixexp
         t
        .
        co
      =
      explist
       exp
        prefixexp
         functioncall
          coroutine
          .
          wrap
          args
           (
           explist
            exp
             prefixexp
              foo
           )
     stat
      local
      attnamelist
       f
       attrib
      =
      explist
       exp
        prefixexp
         functioncall
          t
          .
          co
          args
           (
           )
     stat
      functioncall
       T
       .
       gcstate
       args
        (
        explist
         exp
          string
           "atomic"
        )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           prefixexp
            functioncall
             T
             .
             gcstate
             args
              (
              )
          ==
          exp
           string
            "atomic"
        )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           prefixexp
            functioncall
             t
             .
             co
             args
              (
              )
          ==
          exp
           number
            100
        )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           prefixexp
            functioncall
             T
             .
             gccolor
             args
              (
              explist
               exp
                prefixexp
                 t
                 .
                 co
              )
          ==
          exp
           string
            "white"
        )
     stat
      functioncall
       T
       .
       gcstate
       args
        (
        explist
         exp
          string
           "pause"
        )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           exp
            prefixexp
             t
             .
             co
           ==
           exp
            nil
          and
          exp
           exp
            prefixexp
             functioncall
              f
              args
               (
               )
           ==
           exp
            number
             30
        )
     stat
      functioncall
       collectgarbage
       args
        (
        explist
         exp
          string
           "restart"
        )
     stat
      local
      attnamelist
       u
       attrib
      =
      explist
       exp
        prefixexp
         functioncall
          T
          .
          newuserdata
          args
           (
           explist
            exp
             number
              0
            ,
            exp
             number
              1
           )
     stat
      functioncall
       collectgarbage
       args
        (
        )
     stat
      functioncall
       collectgarbage
       args
        string
         "stop"
     stat
      local
      attnamelist
       a
       attrib
      =
      explist
       exp
        tableconstructor
         {
         }
     stat
      functioncall
       T
       .
       gcstate
       args
        string
         "atomic"
     stat
      functioncall
       T
       .
       gcstate
       args
        string
         "sweepallgc"
     stat
      local
      attnamelist
       x
       attrib
      =
      explist
       exp
        tableconstructor
         {
         }
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           prefixexp
            functioncall
             T
             .
             gccolor
             args
              (
              explist
               exp
                prefixexp
                 u
              )
          ==
          exp
           string
            "black"
        )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           prefixexp
            functioncall
             T
             .
             gccolor
             args
              (
              explist
               exp
                prefixexp
                 x
              )
          ==
          exp
           string
            "white"
        )
     stat
      functioncall
       debug
       .
       setuservalue
       args
        (
        explist
         exp
          prefixexp
           u
         ,
         exp
          prefixexp
           x
        )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           prefixexp
            functioncall
             T
             .
             gccolor
             args
              (
              explist
               exp
                prefixexp
                 u
              )
          ==
          exp
           string
            "gray"
        )
     stat
      functioncall
       collectgarbage
       args
        string
         "restart"
     stat
      functioncall
       print
       args
        string
         "+"
    end
   stat
    if
    exp
     prefixexp
      T
    then
    block
     stat
      local
      attnamelist
       debug
       attrib
      =
      explist
       exp
        prefixexp
         functioncall
          require
          args
           string
            "debug"
     stat
      functioncall
       collectgarbage
       args
        (
        explist
         exp
          string
           "stop"
        )
     stat
      local
      attnamelist
       x
       attrib
      =
      explist
       exp
        prefixexp
         functioncall
          T
          .
          newuserdata
          args
           (
           explist
            exp
             number
              0
           )
     stat
      local
      attnamelist
       y
       attrib
      =
      explist
       exp
        prefixexp
         functioncall
          T
          .
          newuserdata
          args
           (
           explist
            exp
             number
              0
           )
     stat
      functioncall
       debug
       .
       setmetatable
       args
        (
        explist
         exp
          prefixexp
           y
         ,
         exp
          tableconstructor
           {
           fieldlist
            field
             __gc
             =
             exp
              prefixexp
               nop
           }
        )
     stat
      functioncall
       debug
       .
       setmetatable
       args
        (
        explist
         exp
          prefixexp
           x
         ,
         exp
          tableconstructor
           {
           fieldlist
            field
             __gc
             =
             exp
              prefixexp
               nop
           }
        )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           prefixexp
            functioncall
             T
             .
             gccolor
             args
              (
              explist
               exp
                prefixexp
                 y
              )
          ==
          exp
           string
            "white"
        )
     stat
      functioncall
       T
       .
       checkmemory
       args
        (
        )
     stat
      functioncall
       collectgarbage
       args
        (
        explist
         exp
          string
           "restart"
        )
    end
   stat
    if
    exp
     prefixexp
      T
    then
    block
     stat
      functioncall
       print
       args
        (
        explist
         exp
          string
           "emergency collections"
        )
     stat
      functioncall
       collectgarbage
       args
        (
        )
     stat
      functioncall
       collectgarbage
       args
        (
        )
     stat
      functioncall
       T
       .
       totalmem
       args
        (
        explist
         exp
          exp
           prefixexp
            functioncall
             T
             .
             totalmem
             args
              (
              )
          +
          exp
           number
            200
        )
     stat
      for
      i
      =
      exp
       number
        1
      ,
      exp
       number
        200
      do
      block
       stat
        local
        attnamelist
         a
         attrib
        =
        explist
         exp
          tableconstructor
           {
           }
      end
     stat
      functioncall
       T
       .
       totalmem
       args
        (
        explist
         exp
          number
           0
        )
     stat
      functioncall
       collectgarbage
       args
        (
        )
     stat
      local
      attnamelist
       t
       attrib
      =
      explist
       exp
        prefixexp
         functioncall
          T
          .
          totalmem
          args
           (
           explist
            exp
             string
              "table"
           )
     stat
      local
      attnamelist
       a
       attrib
      =
      explist
       exp
        tableconstructor
         {
         fieldlist
          field
           exp
            tableconstructor
             {
             }
          fieldsep
           ,
          field
           exp
            tableconstructor
             {
             }
          fieldsep
           ,
          field
           exp
            tableconstructor
             {
             }
         }
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           prefixexp
            functioncall
             T
             .
             totalmem
             args
              (
              explist
               exp
                string
                 "table"
              )
          ==
          exp
           exp
            prefixexp
             t
           +
           exp
            number
             4
        )
     stat
      varlist
       var
        t
      =
      explist
       exp
        prefixexp
         functioncall
          T
          .
          totalmem
          args
           (
           explist
            exp
             string
              "function"
           )
     stat
      varlist
       var
        a
      =
      explist
       exp
        functiondef
         function
         funcbody
          (
          parlist
          )
          block
          end
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           prefixexp
            functioncall
             T
             .
             totalmem
             args
              (
              explist
               exp
                string
                 "function"
              )
          ==
          exp
           exp
            prefixexp
             t
           +
           exp
            number
             1
        )
     stat
      varlist
       var
        t
      =
      explist
       exp
        prefixexp
         functioncall
          T
          .
          totalmem
          args
           (
           explist
            exp
             string
              "thread"
           )
     stat
      varlist
       var
        a
      =
      explist
       exp
        prefixexp
         functioncall
          coroutine
          .
          create
          args
           (
           explist
            exp
             functiondef
              function
              funcbody
               (
               parlist
               )
               block
               end
           )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          exp
           prefixexp
            functioncall
             T
             .
             totalmem
             args
              (
              explist
               exp
                string
                 "thread"
              )
          ==
          exp
           exp
            prefixexp
             t
           +
           exp
            number
             1
        )
    end
   stat
    do
    block
     stat
      local
      attnamelist
       setmetatable
       attrib
       ,
       assert
       attrib
       ,
       type
       attrib
       ,
       print
       attrib
       ,
       getmetatable
       attrib
      =
      explist
       exp
        prefixexp
         setmetatable
       ,
       exp
        prefixexp
         assert
       ,
       exp
        prefixexp
         type
       ,
       exp
        prefixexp
         print
       ,
       exp
        prefixexp
         getmetatable
     stat
      local
      attnamelist
       tt
       attrib
      =
      explist
       exp
        tableconstructor
         {
         }
     stat
      varlist
       var
        prefixexp
         tt
        .
        __gc
      =
      explist
       exp
        functiondef
         function
         funcbody
          (
          parlist
           namelist
            o
          )
          block
           stat
            functioncall
             assert
             args
              (
              explist
               exp
                exp
                 prefixexp
                  functioncall
                   getmetatable
                   args
                    (
                    explist
                     exp
                      prefixexp
                       o
                    )
                ==
                exp
                 prefixexp
                  tt
              )
           stat
            local
            attnamelist
             a
             attrib
            =
            explist
             exp
              exp
               string
                'xuxu'
              ..
              exp
               exp
                prefixexp
                 (
                 exp
                  exp
                   number
                    10
                  +
                  exp
                   number
                    3
                 )
               ..
               exp
                string
                 'joao'
             ,
             exp
              tableconstructor
               {
               }
           stat
            varlist
             var
              ___Glob
            =
            explist
             exp
              prefixexp
               o
           stat
            functioncall
             setmetatable
             args
              (
              explist
               exp
                tableconstructor
                 {
                 }
               ,
               exp
                prefixexp
                 tt
              )
           stat
            functioncall
             print
             args
              (
              explist
               exp
                exp
                 string
                  ">>> closing state "
                ..
                exp
                 string
                  "<<<\n"
              )
          end
     stat
      local
      attnamelist
       u
       attrib
      =
      explist
       exp
        prefixexp
         functioncall
          setmetatable
          args
           (
           explist
            exp
             tableconstructor
              {
              }
            ,
            exp
             prefixexp
              tt
           )
     stat
      varlist
       var
        ___Glob
      =
      explist
       exp
        tableconstructor
         {
         fieldlist
          field
           exp
            prefixexp
             u
         }
    end
   stat
    if
    exp
     prefixexp
      T
    then
    block
     stat
      local
      attnamelist
       error
       attrib
       ,
       assert
       attrib
       ,
       find
       attrib
       ,
       warn
       attrib
      =
      explist
       exp
        prefixexp
         error
       ,
       exp
        prefixexp
         assert
       ,
       exp
        prefixexp
         string
         .
         find
       ,
       exp
        prefixexp
         warn
     stat
      local
      attnamelist
       n
       attrib
      =
      explist
       exp
        number
         0
     stat
      local
      attnamelist
       lastmsg
       attrib
     stat
      local
      attnamelist
       mt
       attrib
      =
      explist
       exp
        tableconstructor
         {
         fieldlist
          field
           __gc
           =
           exp
            functiondef
             function
             funcbody
              (
              parlist
               namelist
                o
              )
              block
               stat
                varlist
                 var
                  n
                =
                explist
                 exp
                  exp
                   prefixexp
                    n
                  +
                  exp
                   number
                    1
               stat
                functioncall
                 assert
                 args
                  (
                  explist
                   exp
                    exp
                     prefixexp
                      n
                    ==
                    exp
                     prefixexp
                      o
                      [
                      exp
                       number
                        1
                      ]
                  )
               stat
                if
                exp
                 exp
                  prefixexp
                   n
                 ==
                 exp
                  number
                   1
                then
                block
                 stat
                  varlist
                   var
                    _WARN
                  =
                  explist
                   exp
                    false
                elseif
                exp
                 exp
                  prefixexp
                   n
                 ==
                 exp
                  number
                   2
                then
                block
                 stat
                  functioncall
                   assert
                   args
                    (
                    explist
                     exp
                      prefixexp
                       functioncall
                        find
                        args
                         (
                         explist
                          exp
                           prefixexp
                            _WARN
                          ,
                          exp
                           string
                            "@expected warning"
                         )
                    )
                 stat
                  varlist
                   var
                    lastmsg
                  =
                  explist
                   exp
                    prefixexp
                     _WARN
                else
                block
                 stat
                  functioncall
                   assert
                   args
                    (
                    explist
                     exp
                      exp
                       prefixexp
                        lastmsg
                      ==
                      exp
                       prefixexp
                        _WARN
                    )
                end
               stat
                functioncall
                 warn
                 args
                  (
                  explist
                   exp
                    string
                     "@store"
                  )
               stat
                ;
               stat
                varlist
                 var
                  _WARN
                =
                explist
                 exp
                  false
               stat
                functioncall
                 error
                 args
                  string
                   "@expected warning"
              end
         }
     stat
      for
      i
      =
      exp
       number
        10
      ,
      exp
       number
        1
      ,
      exp
       -
       exp
        number
         1
      do
      block
       stat
        functioncall
         table
         .
         insert
         args
          (
          explist
           exp
            prefixexp
             ___Glob
           ,
           exp
            prefixexp
             functioncall
              setmetatable
              args
               (
               explist
                exp
                 tableconstructor
                  {
                  fieldlist
                   field
                    exp
                     prefixexp
                      i
                  }
                ,
                exp
                 prefixexp
                  mt
               )
          )
      end
    end
   stat
    functioncall
     assert
     args
      (
      explist
       exp
        prefixexp
         functioncall
          collectgarbage
          args
           string
            'isrunning'
      )
   stat
    do
    block
     stat
      local
      attnamelist
       res
       attrib
      =
      explist
       exp
        true
     stat
      functioncall
       setmetatable
       args
        (
        explist
         exp
          tableconstructor
           {
           }
         ,
         exp
          tableconstructor
           {
           fieldlist
            field
             __gc
             =
             exp
              functiondef
               function
               funcbody
                (
                parlist
                )
                block
                 stat
                  varlist
                   var
                    res
                  =
                  explist
                   exp
                    prefixexp
                     functioncall
                      collectgarbage
                      args
                       (
                       )
                end
           }
        )
     stat
      functioncall
       collectgarbage
       args
        (
        )
     stat
      functioncall
       assert
       args
        (
        explist
         exp
          not
          exp
           prefixexp
            res
        )
    end
   stat
    functioncall
     collectgarbage
     args
      (
      explist
       exp
        prefixexp
         oldmode
      )
   stat
    functioncall
     print
     args
      (
      explist
       exp
        string
         'OK'
      )
 <EOF>
