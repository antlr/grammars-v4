file_
 resource
  resource
  resourcetype
   "aws_s3_bucket"
  name
   "a"
  blockbody
   {
   argument
    identifier
     identifierchain
      bucket
    =
    expression
     section
      val
       string
        "test_bucket"
   }
 resource
  resource
  resourcetype
   "aws_s3_bucket_policy"
  name
   "b"
  blockbody
   {
   argument
    identifier
     identifierchain
      bucket
    =
    expression
     section
      val
       identifier
        identifierchain
         aws_s3_bucket
         .
         identifierchain
          a
          .
          identifierchain
           id
   argument
    identifier
     identifierchain
      policy
    =
    expression
     section
      val
       functioncall
        jsonencode
        (
        {
        "Version"
        :
        "2012-10-17"
        ,
        "Id"
        :
        "my_policy"
        ,
        "Statement"
        :
        [
        {
        "Sid"
        :
        "IPAllow"
        ,
        "Effect"
        :
        "Deny"
        ,
        "Principal"
        :
        "*"
        ,
        "Action"
        :
        "s3:*"
        ,
        "Resource"
        :
        "arn:aws:s3:::test_bucket/*"
        ,
        "Condition"
        :
        {
        "IpAddress"
        :
        {
        "aws:SourceIp"
        :
        "1.2.3.4/32"
        }
        }
        }
        ]
        }
        )
   }
 resource
  resource
  resourcetype
   "aws_s3_bucket"
  name
   "d"
  blockbody
   {
   argument
    identifier
     identifierchain
      bucket
    =
    expression
     section
      val
       string
        "test_bucket"
   }
 <EOF>
