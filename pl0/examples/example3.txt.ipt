program
 block
  vars_
   VAR
   ident
    x
   ,
   ident
    y
   ,
   ident
    z
   ,
   ident
    q
   ,
   ident
    r
   ,
   ident
    n
   ,
   ident
    f
   ;
  procedure
   PROCEDURE
   ident
    multiply
   ;
   block
    vars_
     VAR
     ident
      a
     ,
     ident
      b
     ;
    statement
     beginstmt
      BEGIN
      statement
       assignstmt
        ident
         a
        :=
        expression
         term
          factor
           ident
            x
      ;
      statement
       assignstmt
        ident
         b
        :=
        expression
         term
          factor
           ident
            Y
      ;
      statement
       assignstmt
        ident
         z
        :=
        expression
         term
          factor
           number
            0
      ;
      statement
       whilestmt
        WHILE
        condition
         expression
          term
           factor
            ident
             b
         >
         expression
          term
           factor
            number
             0
        DO
        statement
         beginstmt
          BEGIN
          statement
           ifstmt
            IF
            condition
             ODD
             expression
              term
               factor
                ident
                 b
            THEN
            statement
             assignstmt
              ident
               z
              :=
              expression
               term
                factor
                 ident
                  z
               +
               term
                factor
                 ident
                  a
          ;
          statement
           assignstmt
            ident
             a
            :=
            expression
             term
              factor
               number
                2
              *
              factor
               ident
                a
          ;
          statement
           assignstmt
            ident
             b
            :=
            expression
             term
              factor
               ident
                b
              /
              factor
               number
                2
          END
      END
   ;
  procedure
   PROCEDURE
   ident
    divide
   ;
   block
    vars_
     VAR
     ident
      w
     ;
    statement
     beginstmt
      BEGIN
      statement
       assignstmt
        ident
         r
        :=
        expression
         term
          factor
           ident
            x
      ;
      statement
       assignstmt
        ident
         q
        :=
        expression
         term
          factor
           number
            0
      ;
      statement
       assignstmt
        ident
         w
        :=
        expression
         term
          factor
           ident
            y
      ;
      statement
       whilestmt
        WHILE
        condition
         expression
          term
           factor
            ident
             w
         <=
         expression
          term
           factor
            ident
             r
        DO
        statement
         assignstmt
          ident
           w
          :=
          expression
           term
            factor
             number
              2
            *
            factor
             ident
              w
      ;
      statement
       whilestmt
        WHILE
        condition
         expression
          term
           factor
            ident
             w
         >
         expression
          term
           factor
            ident
             y
        DO
        statement
         beginstmt
          BEGIN
          statement
           assignstmt
            ident
             q
            :=
            expression
             term
              factor
               number
                2
              *
              factor
               ident
                q
          ;
          statement
           assignstmt
            ident
             w
            :=
            expression
             term
              factor
               ident
                w
              /
              factor
               number
                2
          ;
          statement
           ifstmt
            IF
            condition
             expression
              term
               factor
                ident
                 w
             <=
             expression
              term
               factor
                ident
                 r
            THEN
            statement
             beginstmt
              BEGIN
              statement
               assignstmt
                ident
                 r
                :=
                expression
                 term
                  factor
                   ident
                    r
                 -
                 term
                  factor
                   ident
                    w
              ;
              statement
               assignstmt
                ident
                 q
                :=
                expression
                 term
                  factor
                   ident
                    q
                 +
                 term
                  factor
                   number
                    1
              END
          END
      END
   ;
  procedure
   PROCEDURE
   ident
    gcd
   ;
   block
    vars_
     VAR
     ident
      f
     ,
     ident
      g
     ;
    statement
     beginstmt
      BEGIN
      statement
       assignstmt
        ident
         f
        :=
        expression
         term
          factor
           ident
            x
      ;
      statement
       assignstmt
        ident
         g
        :=
        expression
         term
          factor
           ident
            y
      ;
      statement
       whilestmt
        WHILE
        condition
         expression
          term
           factor
            ident
             f
         #
         expression
          term
           factor
            ident
             g
        DO
        statement
         beginstmt
          BEGIN
          statement
           ifstmt
            IF
            condition
             expression
              term
               factor
                ident
                 f
             <
             expression
              term
               factor
                ident
                 g
            THEN
            statement
             assignstmt
              ident
               g
              :=
              expression
               term
                factor
                 ident
                  g
               -
               term
                factor
                 ident
                  f
          ;
          statement
           ifstmt
            IF
            condition
             expression
              term
               factor
                ident
                 g
             <
             expression
              term
               factor
                ident
                 f
            THEN
            statement
             assignstmt
              ident
               f
              :=
              expression
               term
                factor
                 ident
                  f
               -
               term
                factor
                 ident
                  g
          END
      ;
      statement
       assignstmt
        ident
         z
        :=
        expression
         term
          factor
           ident
            f
      END
   ;
  procedure
   PROCEDURE
   ident
    fact
   ;
   block
    statement
     beginstmt
      BEGIN
      statement
       ifstmt
        IF
        condition
         expression
          term
           factor
            ident
             n
         >
         expression
          term
           factor
            number
             1
        THEN
        statement
         beginstmt
          BEGIN
          statement
           assignstmt
            ident
             f
            :=
            expression
             term
              factor
               ident
                n
              *
              factor
               ident
                f
          ;
          statement
           assignstmt
            ident
             n
            :=
            expression
             term
              factor
               ident
                n
             -
             term
              factor
               number
                1
          ;
          statement
           callstmt
            CALL
            ident
             fact
          END
      END
   ;
  statement
   beginstmt
    BEGIN
    statement
     qstmt
      ?
      ident
       x
    ;
    statement
     qstmt
      ?
      ident
       y
    ;
    statement
     callstmt
      CALL
      ident
       multiply
    ;
    statement
     bangstmt
      !
      expression
       term
        factor
         ident
          z
    ;
    statement
     qstmt
      ?
      ident
       x
    ;
    statement
     qstmt
      ?
      ident
       y
    ;
    statement
     callstmt
      CALL
      ident
       divide
    ;
    statement
     bangstmt
      !
      expression
       term
        factor
         ident
          q
    ;
    statement
     bangstmt
      !
      expression
       term
        factor
         ident
          r
    ;
    statement
     qstmt
      ?
      ident
       x
    ;
    statement
     qstmt
      ?
      ident
       y
    ;
    statement
     callstmt
      CALL
      ident
       gcd
    ;
    statement
     bangstmt
      !
      expression
       term
        factor
         ident
          z
    ;
    statement
     qstmt
      ?
      ident
       n
    ;
    statement
     assignstmt
      ident
       f
      :=
      expression
       term
        factor
         number
          1
    ;
    statement
     callstmt
      CALL
      ident
       fact
    ;
    statement
     bangstmt
      !
      expression
       term
        factor
         ident
          f
    END
 .
 <EOF>
