acmeCompUnit
 acmeImportDeclaration
  import
  filename
   TieredFam
   .
   acme
  ;
 acmeFamilyDeclaration
  Family
  identifier
   ThreeTieredFam
  extends
  acmeFamilyRef
   identifier
    TieredFam
  with
  acmeFamilyBody
   {
   acmePropertyTypeDeclaration
    Property
    Type
    identifier
     TierPropT
    =
    acmePropertyTypeEnum
     Enum
     {
     identifier
      client
     ,
     identifier
      logic
     ,
     identifier
      data
     }
    ;
   acmeComponentTypeDeclaration
    Component
    Type
    identifier
     ClientNodeT
    extends
    acmeComponentTypeRef
     identifier
      TierNodeT
    with
    acmeComponentBody
     {
     acmePropertyDeclaration
      Property
      identifier
       tier
      :
      acmePropertyTypeRef
       acmePropertyTypeDeclarationRef
        identifier
         TierPropT
      =
      acmePropertyValueDeclaration
       enumidentifier
        client
      ;
     }
   acmeComponentTypeDeclaration
    Component
    Type
    identifier
     LogicNodeT
    extends
    acmeComponentTypeRef
     identifier
      TierNodeT
    with
    acmeComponentBody
     {
     acmePropertyDeclaration
      Property
      identifier
       tier
      :
      acmePropertyTypeRef
       acmePropertyTypeDeclarationRef
        identifier
         TierPropT
      =
      acmePropertyValueDeclaration
       enumidentifier
        logic
      ;
     }
   acmeComponentTypeDeclaration
    Component
    Type
    identifier
     DataNodeT
    extends
    acmeComponentTypeRef
     identifier
      TierNodeT
    with
    acmeComponentBody
     {
     acmePropertyDeclaration
      Property
      identifier
       tier
      :
      acmePropertyTypeRef
       acmePropertyTypeDeclarationRef
        identifier
         TierPropT
      =
      acmePropertyValueDeclaration
       enumidentifier
        data
      ;
     }
   designRule
    invariant
    designRuleExpression
     aSTDRImpliesExpression
      dRIffExpression
       dRAndExpression
        dRNegateExpression
         dREqualityExpression
          dRRelationalExpression
           dRAdditiveExpression
            dRMultiplicativeExpression
             dRNegativeExpression
              primitiveExpression
               quantifiedExpression
                Forall
                variableSetDeclaration
                 identifier
                  n1
                 :
                 acmeTypeRef
                  reference
                   identifier
                    TierNodeT
                 in
                 reference
                  identifier
                   self
                  .
                  setReference
                   components
                |
                designRuleExpression
                 aSTDRImpliesExpression
                  dRIffExpression
                   dRAndExpression
                    dRNegateExpression
                     dREqualityExpression
                      dRRelationalExpression
                       dRAdditiveExpression
                        dRMultiplicativeExpression
                         dRNegativeExpression
                          primitiveExpression
                           quantifiedExpression
                            Forall
                            variableSetDeclaration
                             identifier
                              n2
                             :
                             acmeTypeRef
                              reference
                               identifier
                                TierNodeT
                             in
                             reference
                              identifier
                               self
                              .
                              setReference
                               components
                            |
                            designRuleExpression
                             aSTDRImpliesExpression
                              dRIffExpression
                               dRAndExpression
                                dRNegateExpression
                                 dREqualityExpression
                                  dRRelationalExpression
                                   dRAdditiveExpression
                                    dRMultiplicativeExpression
                                     dRNegativeExpression
                                      primitiveExpression
                                       reference
                                        identifier
                                         connected
                                        actualParams
                                         (
                                         designRuleExpression
                                          aSTDRImpliesExpression
                                           dRIffExpression
                                            dRAndExpression
                                             dRNegateExpression
                                              dREqualityExpression
                                               dRRelationalExpression
                                                dRAdditiveExpression
                                                 dRMultiplicativeExpression
                                                  dRNegativeExpression
                                                   primitiveExpression
                                                    reference
                                                     identifier
                                                      n1
                                         ,
                                         designRuleExpression
                                          aSTDRImpliesExpression
                                           dRIffExpression
                                            dRAndExpression
                                             dRNegateExpression
                                              dREqualityExpression
                                               dRRelationalExpression
                                                dRAdditiveExpression
                                                 dRMultiplicativeExpression
                                                  dRNegativeExpression
                                                   primitiveExpression
                                                    reference
                                                     identifier
                                                      n2
                                         )
                              ->
                              dRIffExpression
                               dRAndExpression
                                dRNegateExpression
                                 dREqualityExpression
                                  dRRelationalExpression
                                   dRAdditiveExpression
                                    dRMultiplicativeExpression
                                     dRNegativeExpression
                                      primitiveExpression
                                       parentheticalExpression
                                        (
                                        designRuleExpression
                                         aSTDRImpliesExpression
                                          dRIffExpression
                                           dRAndExpression
                                            dRNegateExpression
                                             dREqualityExpression
                                              dRRelationalExpression
                                               dRAdditiveExpression
                                                dRMultiplicativeExpression
                                                 dRNegativeExpression
                                                  primitiveExpression
                                                   reference
                                                    identifier
                                                     n1
                                                    .
                                                    identifier
                                                     tier
                                              ==
                                              dRRelationalExpression
                                               dRAdditiveExpression
                                                dRMultiplicativeExpression
                                                 dRNegativeExpression
                                                  primitiveExpression
                                                   reference
                                                    identifier
                                                     logic
                                         OR
                                         aSTDRImpliesExpression
                                          dRIffExpression
                                           dRAndExpression
                                            dRNegateExpression
                                             dREqualityExpression
                                              dRRelationalExpression
                                               dRAdditiveExpression
                                                dRMultiplicativeExpression
                                                 dRNegativeExpression
                                                  primitiveExpression
                                                   reference
                                                    identifier
                                                     n2
                                                    .
                                                    identifier
                                                     tier
                                              ==
                                              dRRelationalExpression
                                               dRAdditiveExpression
                                                dRMultiplicativeExpression
                                                 dRNegativeExpression
                                                  primitiveExpression
                                                   reference
                                                    identifier
                                                     logic
                                        )
    acmePropertyBlock
     <<
     acmePropertyBlockEntry
      identifier
       label
      :
      acmePropertyTypeRef
       acmePropertyTypeStructure
        acmePropertyTypeString
         string
      =
      acmePropertyValueDeclaration
       "One in every two connected tier component is in the logic tier."
      ;
     acmePropertyBlockEntry
      identifier
       errMsg
      :
      acmePropertyTypeRef
       acmePropertyTypeStructure
        acmePropertyTypeString
         string
      =
      acmePropertyValueDeclaration
       "Detected two connected tier components neither of which is in the logic tier!"
      ;
     >>
    ;
   }
 <EOF>
