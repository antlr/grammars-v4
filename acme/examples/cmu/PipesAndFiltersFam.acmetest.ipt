acmeCompUnit
 acmeFamilyDeclaration
  Family
  identifier
   PipesAndFiltersFam
  =
  acmeFamilyBody
   {
   acmePropertyTypeDeclaration
    Property
    Type
    identifier
     flowpathRecT
    =
    acmePropertyTypeRecord
     Record
     [
     acmePropertyRecordFieldDescription
      identifier
       fromPt
      :
      acmePropertyTypeRef
       acmePropertyTypeStructure
        acmePropertyTypeString
         string
      ;
     acmePropertyRecordFieldDescription
      identifier
       toPt
      :
      acmePropertyTypeRef
       acmePropertyTypeStructure
        acmePropertyTypeString
         string
      ;
     ]
    ;
   acmePortTypeDeclaration
    Port
    Type
    identifier
     inputT
    =
    acmePortBody
     {
     acmePropertyDeclaration
      Property
      identifier
       protocol
      :
      acmePropertyTypeRef
       acmePropertyTypeStructure
        acmePropertyTypeString
         string
      =
      acmePropertyValueDeclaration
       "char input"
      ;
     }
   acmePortTypeDeclaration
    Port
    Type
    identifier
     outputT
    =
    acmePortBody
     {
     acmePropertyDeclaration
      Property
      identifier
       protocol
      :
      acmePropertyTypeRef
       acmePropertyTypeStructure
        acmePropertyTypeString
         string
      =
      acmePropertyValueDeclaration
       "char output"
      ;
     }
   acmeRoleTypeDeclaration
    Role
    Type
    identifier
     sourceT
    =
    acmeRoleBody
     {
     acmePropertyDeclaration
      Property
      identifier
       protocol
      :
      acmePropertyTypeRef
       acmePropertyTypeStructure
        acmePropertyTypeString
         string
      =
      acmePropertyValueDeclaration
       "char source"
      ;
     }
   acmeRoleTypeDeclaration
    Role
    Type
    identifier
     sinkT
    =
    acmeRoleBody
     {
     acmePropertyDeclaration
      Property
      identifier
       protocol
      :
      acmePropertyTypeRef
       acmePropertyTypeStructure
        acmePropertyTypeString
         string
      =
      acmePropertyValueDeclaration
       "char sink"
      ;
     }
   acmeComponentTypeDeclaration
    Component
    Type
    identifier
     Filter
    =
    acmeComponentBody
     {
     acmePortDeclaration
      Port
      identifier
       input
      :
      acmePortTypeRef
       identifier
        inputT
      =
      new
      acmePortInstantiatedTypeRef
       identifier
        inputT
      extended
      with
      acmePortBody
       {
       acmePropertyDeclaration
        Property
        identifier
         protocol
        :
        acmePropertyTypeRef
         acmePropertyTypeStructure
          acmePropertyTypeString
           string
        =
        acmePropertyValueDeclaration
         "char input"
        ;
       }
      ;
     acmePortDeclaration
      Port
      identifier
       output
      :
      acmePortTypeRef
       identifier
        outputT
      =
      new
      acmePortInstantiatedTypeRef
       identifier
        outputT
      extended
      with
      acmePortBody
       {
       acmePropertyDeclaration
        Property
        identifier
         protocol
        :
        acmePropertyTypeRef
         acmePropertyTypeStructure
          acmePropertyTypeString
           string
        =
        acmePropertyValueDeclaration
         "char output"
        ;
       }
      ;
     acmePropertyDeclaration
      Property
      identifier
       function
      :
      acmePropertyTypeRef
       acmePropertyTypeStructure
        acmePropertyTypeString
         string
      ;
     acmePropertyDeclaration
      Property
      identifier
       flowPaths
      :
      acmePropertyTypeRef
       acmePropertyTypeStructure
        acmePropertyTypeSet
         Set
         {
         acmeTypeRef
          reference
           identifier
            flowpathRecT
         }
      acmePropertyBlock
       <<
       acmePropertyBlockEntry
        identifier
         default
        :
        acmePropertyTypeRef
         acmePropertyTypeStructure
          acmePropertyTypeSet
           Set
           {
           acmeTypeRef
            reference
             identifier
              flowpathRecT
           }
        =
        acmePropertyValueDeclaration
         acmePropertySet
          {
          acmePropertyValueDeclaration
           acmePropertyRecord
            [
            acmePropertyRecordEntry
             identifier
              fromPt
             :
             acmePropertyTypeRef
              acmePropertyTypeStructure
               acmePropertyTypeString
                string
             =
             acmePropertyValueDeclaration
              "input"
            ;
            acmePropertyRecordEntry
             identifier
              toPt
             :
             acmePropertyTypeRef
              acmePropertyTypeStructure
               acmePropertyTypeString
                string
             =
             acmePropertyValueDeclaration
              "output"
            ]
          }
        ;
       >>
      ;
     designRule
      invariant
      designRuleExpression
       aSTDRImpliesExpression
        dRIffExpression
         dRAndExpression
          dRNegateExpression
           dREqualityExpression
            dRRelationalExpression
             dRAdditiveExpression
              dRMultiplicativeExpression
               dRNegativeExpression
                primitiveExpression
                 quantifiedExpression
                  Forall
                  variableSetDeclaration
                   identifier
                    p
                   :
                   acmeTypeRef
                    port
                   in
                   reference
                    identifier
                     self
                    .
                    setReference
                     Ports
                  |
                  designRuleExpression
                   aSTDRImpliesExpression
                    dRIffExpression
                     dRAndExpression
                      dRNegateExpression
                       dREqualityExpression
                        dRRelationalExpression
                         dRAdditiveExpression
                          dRMultiplicativeExpression
                           dRNegativeExpression
                            primitiveExpression
                             reference
                              identifier
                               satisfiesType
                              actualParams
                               (
                               designRuleExpression
                                aSTDRImpliesExpression
                                 dRIffExpression
                                  dRAndExpression
                                   dRNegateExpression
                                    dREqualityExpression
                                     dRRelationalExpression
                                      dRAdditiveExpression
                                       dRMultiplicativeExpression
                                        dRNegativeExpression
                                         primitiveExpression
                                          reference
                                           identifier
                                            p
                               ,
                               designRuleExpression
                                aSTDRImpliesExpression
                                 dRIffExpression
                                  dRAndExpression
                                   dRNegateExpression
                                    dREqualityExpression
                                     dRRelationalExpression
                                      dRAdditiveExpression
                                       dRMultiplicativeExpression
                                        dRNegativeExpression
                                         primitiveExpression
                                          reference
                                           identifier
                                            inputT
                               )
                   OR
                   aSTDRImpliesExpression
                    dRIffExpression
                     dRAndExpression
                      dRNegateExpression
                       dREqualityExpression
                        dRRelationalExpression
                         dRAdditiveExpression
                          dRMultiplicativeExpression
                           dRNegativeExpression
                            primitiveExpression
                             reference
                              identifier
                               satisfiesType
                              actualParams
                               (
                               designRuleExpression
                                aSTDRImpliesExpression
                                 dRIffExpression
                                  dRAndExpression
                                   dRNegateExpression
                                    dREqualityExpression
                                     dRRelationalExpression
                                      dRAdditiveExpression
                                       dRMultiplicativeExpression
                                        dRNegativeExpression
                                         primitiveExpression
                                          reference
                                           identifier
                                            p
                               ,
                               designRuleExpression
                                aSTDRImpliesExpression
                                 dRIffExpression
                                  dRAndExpression
                                   dRNegateExpression
                                    dREqualityExpression
                                     dRRelationalExpression
                                      dRAdditiveExpression
                                       dRMultiplicativeExpression
                                        dRNegativeExpression
                                         primitiveExpression
                                          reference
                                           identifier
                                            outputT
                               )
      acmePropertyBlock
       <<
       acmePropertyBlockEntry
        identifier
         label
        :
        acmePropertyTypeRef
         acmePropertyTypeStructure
          acmePropertyTypeString
           string
        =
        acmePropertyValueDeclaration
         "Only ports of type inputT or outputT are allowed"
        ;
       >>
      ;
     }
   acmeComponentTypeDeclaration
    Component
    Type
    identifier
     BinaryFilter
    extends
    acmeComponentTypeRef
     identifier
      Filter
    with
    acmeComponentBody
     {
     acmePropertyDeclaration
      Property
      identifier
       binary
      :
      acmePropertyTypeRef
       acmePropertyTypeStructure
        acmePropertyTypeString
         string
      ;
     }
   acmeComponentTypeDeclaration
    Component
    Type
    identifier
     DataSource
    =
    acmeComponentBody
     {
     acmePortDeclaration
      Port
      identifier
       output
      :
      acmePortTypeRef
       identifier
        outputT
      =
      new
      acmePortInstantiatedTypeRef
       identifier
        outputT
      extended
      with
      acmePortBody
       {
       acmePropertyDeclaration
        Property
        identifier
         protocol
        :
        acmePropertyTypeRef
         acmePropertyTypeStructure
          acmePropertyTypeString
           string
        =
        acmePropertyValueDeclaration
         "char output"
        ;
       }
      ;
     }
   acmeComponentTypeDeclaration
    Component
    Type
    identifier
     DataSink
    =
    acmeComponentBody
     {
     acmePortDeclaration
      Port
      identifier
       input
      :
      acmePortTypeRef
       identifier
        inputT
      =
      new
      acmePortInstantiatedTypeRef
       identifier
        inputT
      extended
      with
      acmePortBody
       {
       acmePropertyDeclaration
        Property
        identifier
         protocol
        :
        acmePropertyTypeRef
         acmePropertyTypeStructure
          acmePropertyTypeString
           string
        =
        acmePropertyValueDeclaration
         "char input"
        ;
       }
      ;
     }
   acmeConnectorTypeDeclaration
    Connector
    Type
    identifier
     Pipe
    =
    acmeConnectorBody
     {
     acmeRoleDeclaration
      Role
      identifier
       source
      :
      acmeRoleTypeRef
       identifier
        sourceT
      =
      new
      acmeRoleInstantiatedTypeRef
       identifier
        sourceT
      extended
      with
      acmeRoleBody
       {
       acmePropertyDeclaration
        Property
        identifier
         protocol
        :
        acmePropertyTypeRef
         acmePropertyTypeStructure
          acmePropertyTypeString
           string
        =
        acmePropertyValueDeclaration
         "char source"
        ;
       }
      ;
     acmeRoleDeclaration
      Role
      identifier
       sink
      :
      acmeRoleTypeRef
       identifier
        sinkT
      =
      new
      acmeRoleInstantiatedTypeRef
       identifier
        sinkT
      extended
      with
      acmeRoleBody
       {
       acmePropertyDeclaration
        Property
        identifier
         protocol
        :
        acmePropertyTypeRef
         acmePropertyTypeStructure
          acmePropertyTypeString
           string
        =
        acmePropertyValueDeclaration
         "char sink"
        ;
       }
      ;
     acmePropertyDeclaration
      Property
      identifier
       bufferSize
      :
      acmePropertyTypeRef
       acmePropertyTypeStructure
        acmePropertyTypeInt
         int
      acmePropertyBlock
       <<
       acmePropertyBlockEntry
        identifier
         default
        :
        acmePropertyTypeRef
         acmePropertyTypeStructure
          acmePropertyTypeInt
           int
        =
        acmePropertyValueDeclaration
         0
        ;
       >>
      ;
     acmePropertyDeclaration
      Property
      identifier
       flowPaths
      :
      acmePropertyTypeRef
       acmePropertyTypeStructure
        acmePropertyTypeSet
         Set
         {
         acmeTypeRef
          reference
           identifier
            flowpathRecT
         }
      =
      acmePropertyValueDeclaration
       acmePropertySet
        {
        acmePropertyValueDeclaration
         acmePropertyRecord
          [
          acmePropertyRecordEntry
           identifier
            fromPt
           :
           acmePropertyTypeRef
            acmePropertyTypeStructure
             acmePropertyTypeString
              string
           =
           acmePropertyValueDeclaration
            "source"
          ;
          acmePropertyRecordEntry
           identifier
            toPt
           :
           acmePropertyTypeRef
            acmePropertyTypeStructure
             acmePropertyTypeString
              string
           =
           acmePropertyValueDeclaration
            "sink"
          ]
        }
      ;
     designRule
      invariant
      designRuleExpression
       aSTDRImpliesExpression
        dRIffExpression
         dRAndExpression
          dRNegateExpression
           dREqualityExpression
            dRRelationalExpression
             dRAdditiveExpression
              dRMultiplicativeExpression
               dRNegativeExpression
                primitiveExpression
                 reference
                  identifier
                   size
                  actualParams
                   (
                   designRuleExpression
                    aSTDRImpliesExpression
                     dRIffExpression
                      dRAndExpression
                       dRNegateExpression
                        dREqualityExpression
                         dRRelationalExpression
                          dRAdditiveExpression
                           dRMultiplicativeExpression
                            dRNegativeExpression
                             primitiveExpression
                              reference
                               identifier
                                self
                               .
                               setReference
                                roles
                   )
            ==
            dRRelationalExpression
             dRAdditiveExpression
              dRMultiplicativeExpression
               dRNegativeExpression
                primitiveExpression
                 literalConstant
                  2
      acmePropertyBlock
       <<
       acmePropertyBlockEntry
        identifier
         label
        :
        acmePropertyTypeRef
         acmePropertyTypeStructure
          acmePropertyTypeString
           string
        =
        acmePropertyValueDeclaration
         "A pipe can only have two roles"
        ;
       >>
      ;
     designRule
      invariant
      designRuleExpression
       aSTDRImpliesExpression
        dRIffExpression
         dRAndExpression
          dRNegateExpression
           dREqualityExpression
            dRRelationalExpression
             dRAdditiveExpression
              dRMultiplicativeExpression
               dRNegativeExpression
                primitiveExpression
                 reference
                  identifier
                   self
                  .
                  identifier
                   bufferSize
             >=
             dRAdditiveExpression
              dRMultiplicativeExpression
               dRNegativeExpression
                primitiveExpression
                 literalConstant
                  0
      acmePropertyBlock
       <<
       acmePropertyBlockEntry
        identifier
         label
        :
        acmePropertyTypeRef
         acmePropertyTypeStructure
          acmePropertyTypeString
           string
        =
        acmePropertyValueDeclaration
         "The bufferSize is specified\t"
        ;
       acmePropertyBlockEntry
        identifier
         errMsg
        :
        acmePropertyTypeRef
         acmePropertyTypeStructure
          acmePropertyTypeString
           string
        =
        acmePropertyValueDeclaration
         "The buffersize must be specified, and be >=0"
        ;
       >>
      ;
     designRule
      invariant
      designRuleExpression
       aSTDRImpliesExpression
        dRIffExpression
         dRAndExpression
          dRNegateExpression
           dREqualityExpression
            dRRelationalExpression
             dRAdditiveExpression
              dRMultiplicativeExpression
               dRNegativeExpression
                primitiveExpression
                 quantifiedExpression
                  Forall
                  variableSetDeclaration
                   identifier
                    r
                   :
                   acmeTypeRef
                    role
                   in
                   reference
                    identifier
                     self
                    .
                    setReference
                     roles
                  |
                  designRuleExpression
                   aSTDRImpliesExpression
                    dRIffExpression
                     dRAndExpression
                      dRNegateExpression
                       dREqualityExpression
                        dRRelationalExpression
                         dRAdditiveExpression
                          dRMultiplicativeExpression
                           dRNegativeExpression
                            primitiveExpression
                             reference
                              identifier
                               size
                              actualParams
                               (
                               designRuleExpression
                                aSTDRImpliesExpression
                                 dRIffExpression
                                  dRAndExpression
                                   dRNegateExpression
                                    dREqualityExpression
                                     dRRelationalExpression
                                      dRAdditiveExpression
                                       dRMultiplicativeExpression
                                        dRNegativeExpression
                                         primitiveExpression
                                          reference
                                           identifier
                                            r
                                           .
                                           setReference
                                            attachedPorts
                               )
                         >
                         dRAdditiveExpression
                          dRMultiplicativeExpression
                           dRNegativeExpression
                            primitiveExpression
                             literalConstant
                              0
      acmePropertyBlock
       <<
       acmePropertyBlockEntry
        identifier
         label
        :
        acmePropertyTypeRef
         acmePropertyTypeStructure
          acmePropertyTypeString
           string
        =
        acmePropertyValueDeclaration
         "All roles are attached"
        ;
       acmePropertyBlockEntry
        identifier
         errMsg
        :
        acmePropertyTypeRef
         acmePropertyTypeStructure
          acmePropertyTypeString
           string
        =
        acmePropertyValueDeclaration
         "There are dangling roles"
        ;
       >>
      ;
     }
   designRule
    invariant
    designRuleExpression
     aSTDRImpliesExpression
      dRIffExpression
       dRAndExpression
        dRNegateExpression
         dREqualityExpression
          dRRelationalExpression
           dRAdditiveExpression
            dRMultiplicativeExpression
             dRNegativeExpression
              primitiveExpression
               quantifiedExpression
                Forall
                variableSetDeclaration
                 identifier
                  comp
                 :
                 acmeTypeRef
                  component
                 in
                 reference
                  identifier
                   self
                  .
                  setReference
                   components
                |
                designRuleExpression
                 aSTDRImpliesExpression
                  dRIffExpression
                   dRAndExpression
                    dRNegateExpression
                     dREqualityExpression
                      dRRelationalExpression
                       dRAdditiveExpression
                        dRMultiplicativeExpression
                         dRNegativeExpression
                          primitiveExpression
                           quantifiedExpression
                            Forall
                            variableSetDeclaration
                             identifier
                              conn
                             :
                             acmeTypeRef
                              connector
                             in
                             reference
                              identifier
                               self
                              .
                              setReference
                               connectors
                            |
                            designRuleExpression
                             aSTDRImpliesExpression
                              dRIffExpression
                               dRAndExpression
                                dRNegateExpression
                                 dREqualityExpression
                                  dRRelationalExpression
                                   dRAdditiveExpression
                                    dRMultiplicativeExpression
                                     dRNegativeExpression
                                      primitiveExpression
                                       quantifiedExpression
                                        Forall
                                        variableSetDeclaration
                                         identifier
                                          p
                                         :
                                         acmeTypeRef
                                          port
                                         in
                                         reference
                                          identifier
                                           comp
                                          .
                                          setReference
                                           ports
                                        |
                                        designRuleExpression
                                         aSTDRImpliesExpression
                                          dRIffExpression
                                           dRAndExpression
                                            dRNegateExpression
                                             dREqualityExpression
                                              dRRelationalExpression
                                               dRAdditiveExpression
                                                dRMultiplicativeExpression
                                                 dRNegativeExpression
                                                  primitiveExpression
                                                   quantifiedExpression
                                                    Forall
                                                    variableSetDeclaration
                                                     identifier
                                                      r
                                                     :
                                                     acmeTypeRef
                                                      role
                                                     in
                                                     reference
                                                      identifier
                                                       conn
                                                      .
                                                      setReference
                                                       Roles
                                                    |
                                                    designRuleExpression
                                                     aSTDRImpliesExpression
                                                      dRIffExpression
                                                       dRAndExpression
                                                        dRNegateExpression
                                                         dREqualityExpression
                                                          dRRelationalExpression
                                                           dRAdditiveExpression
                                                            dRMultiplicativeExpression
                                                             dRNegativeExpression
                                                              primitiveExpression
                                                               reference
                                                                identifier
                                                                 attached
                                                                actualParams
                                                                 (
                                                                 designRuleExpression
                                                                  aSTDRImpliesExpression
                                                                   dRIffExpression
                                                                    dRAndExpression
                                                                     dRNegateExpression
                                                                      dREqualityExpression
                                                                       dRRelationalExpression
                                                                        dRAdditiveExpression
                                                                         dRMultiplicativeExpression
                                                                          dRNegativeExpression
                                                                           primitiveExpression
                                                                            reference
                                                                             identifier
                                                                              p
                                                                 ,
                                                                 designRuleExpression
                                                                  aSTDRImpliesExpression
                                                                   dRIffExpression
                                                                    dRAndExpression
                                                                     dRNegateExpression
                                                                      dREqualityExpression
                                                                       dRRelationalExpression
                                                                        dRAdditiveExpression
                                                                         dRMultiplicativeExpression
                                                                          dRNegativeExpression
                                                                           primitiveExpression
                                                                            reference
                                                                             identifier
                                                                              r
                                                                 )
                                                      ->
                                                      dRIffExpression
                                                       dRAndExpression
                                                        dRNegateExpression
                                                         dREqualityExpression
                                                          dRRelationalExpression
                                                           dRAdditiveExpression
                                                            dRMultiplicativeExpression
                                                             dRNegativeExpression
                                                              primitiveExpression
                                                               parentheticalExpression
                                                                (
                                                                designRuleExpression
                                                                 aSTDRImpliesExpression
                                                                  dRIffExpression
                                                                   dRAndExpression
                                                                    dRNegateExpression
                                                                     dREqualityExpression
                                                                      dRRelationalExpression
                                                                       dRAdditiveExpression
                                                                        dRMultiplicativeExpression
                                                                         dRNegativeExpression
                                                                          primitiveExpression
                                                                           parentheticalExpression
                                                                            (
                                                                            designRuleExpression
                                                                             aSTDRImpliesExpression
                                                                              dRIffExpression
                                                                               dRAndExpression
                                                                                dRNegateExpression
                                                                                 dREqualityExpression
                                                                                  dRRelationalExpression
                                                                                   dRAdditiveExpression
                                                                                    dRMultiplicativeExpression
                                                                                     dRNegativeExpression
                                                                                      primitiveExpression
                                                                                       reference
                                                                                        identifier
                                                                                         satisfiesType
                                                                                        actualParams
                                                                                         (
                                                                                         designRuleExpression
                                                                                          aSTDRImpliesExpression
                                                                                           dRIffExpression
                                                                                            dRAndExpression
                                                                                             dRNegateExpression
                                                                                              dREqualityExpression
                                                                                               dRRelationalExpression
                                                                                                dRAdditiveExpression
                                                                                                 dRMultiplicativeExpression
                                                                                                  dRNegativeExpression
                                                                                                   primitiveExpression
                                                                                                    reference
                                                                                                     identifier
                                                                                                      p
                                                                                         ,
                                                                                         designRuleExpression
                                                                                          aSTDRImpliesExpression
                                                                                           dRIffExpression
                                                                                            dRAndExpression
                                                                                             dRNegateExpression
                                                                                              dREqualityExpression
                                                                                               dRRelationalExpression
                                                                                                dRAdditiveExpression
                                                                                                 dRMultiplicativeExpression
                                                                                                  dRNegativeExpression
                                                                                                   primitiveExpression
                                                                                                    reference
                                                                                                     identifier
                                                                                                      outputT
                                                                                         )
                                                                                AND
                                                                                dRNegateExpression
                                                                                 dREqualityExpression
                                                                                  dRRelationalExpression
                                                                                   dRAdditiveExpression
                                                                                    dRMultiplicativeExpression
                                                                                     dRNegativeExpression
                                                                                      primitiveExpression
                                                                                       reference
                                                                                        identifier
                                                                                         satisfiesType
                                                                                        actualParams
                                                                                         (
                                                                                         designRuleExpression
                                                                                          aSTDRImpliesExpression
                                                                                           dRIffExpression
                                                                                            dRAndExpression
                                                                                             dRNegateExpression
                                                                                              dREqualityExpression
                                                                                               dRRelationalExpression
                                                                                                dRAdditiveExpression
                                                                                                 dRMultiplicativeExpression
                                                                                                  dRNegativeExpression
                                                                                                   primitiveExpression
                                                                                                    reference
                                                                                                     identifier
                                                                                                      r
                                                                                         ,
                                                                                         designRuleExpression
                                                                                          aSTDRImpliesExpression
                                                                                           dRIffExpression
                                                                                            dRAndExpression
                                                                                             dRNegateExpression
                                                                                              dREqualityExpression
                                                                                               dRRelationalExpression
                                                                                                dRAdditiveExpression
                                                                                                 dRMultiplicativeExpression
                                                                                                  dRNegativeExpression
                                                                                                   primitiveExpression
                                                                                                    reference
                                                                                                     identifier
                                                                                                      sinkT
                                                                                         )
                                                                            )
                                                                 OR
                                                                 aSTDRImpliesExpression
                                                                  dRIffExpression
                                                                   dRAndExpression
                                                                    dRNegateExpression
                                                                     dREqualityExpression
                                                                      dRRelationalExpression
                                                                       dRAdditiveExpression
                                                                        dRMultiplicativeExpression
                                                                         dRNegativeExpression
                                                                          primitiveExpression
                                                                           parentheticalExpression
                                                                            (
                                                                            designRuleExpression
                                                                             aSTDRImpliesExpression
                                                                              dRIffExpression
                                                                               dRAndExpression
                                                                                dRNegateExpression
                                                                                 dREqualityExpression
                                                                                  dRRelationalExpression
                                                                                   dRAdditiveExpression
                                                                                    dRMultiplicativeExpression
                                                                                     dRNegativeExpression
                                                                                      primitiveExpression
                                                                                       reference
                                                                                        identifier
                                                                                         satisfiesType
                                                                                        actualParams
                                                                                         (
                                                                                         designRuleExpression
                                                                                          aSTDRImpliesExpression
                                                                                           dRIffExpression
                                                                                            dRAndExpression
                                                                                             dRNegateExpression
                                                                                              dREqualityExpression
                                                                                               dRRelationalExpression
                                                                                                dRAdditiveExpression
                                                                                                 dRMultiplicativeExpression
                                                                                                  dRNegativeExpression
                                                                                                   primitiveExpression
                                                                                                    reference
                                                                                                     identifier
                                                                                                      p
                                                                                         ,
                                                                                         designRuleExpression
                                                                                          aSTDRImpliesExpression
                                                                                           dRIffExpression
                                                                                            dRAndExpression
                                                                                             dRNegateExpression
                                                                                              dREqualityExpression
                                                                                               dRRelationalExpression
                                                                                                dRAdditiveExpression
                                                                                                 dRMultiplicativeExpression
                                                                                                  dRNegativeExpression
                                                                                                   primitiveExpression
                                                                                                    reference
                                                                                                     identifier
                                                                                                      inputT
                                                                                         )
                                                                                AND
                                                                                dRNegateExpression
                                                                                 dREqualityExpression
                                                                                  dRRelationalExpression
                                                                                   dRAdditiveExpression
                                                                                    dRMultiplicativeExpression
                                                                                     dRNegativeExpression
                                                                                      primitiveExpression
                                                                                       reference
                                                                                        identifier
                                                                                         satisfiesType
                                                                                        actualParams
                                                                                         (
                                                                                         designRuleExpression
                                                                                          aSTDRImpliesExpression
                                                                                           dRIffExpression
                                                                                            dRAndExpression
                                                                                             dRNegateExpression
                                                                                              dREqualityExpression
                                                                                               dRRelationalExpression
                                                                                                dRAdditiveExpression
                                                                                                 dRMultiplicativeExpression
                                                                                                  dRNegativeExpression
                                                                                                   primitiveExpression
                                                                                                    reference
                                                                                                     identifier
                                                                                                      r
                                                                                         ,
                                                                                         designRuleExpression
                                                                                          aSTDRImpliesExpression
                                                                                           dRIffExpression
                                                                                            dRAndExpression
                                                                                             dRNegateExpression
                                                                                              dREqualityExpression
                                                                                               dRRelationalExpression
                                                                                                dRAdditiveExpression
                                                                                                 dRMultiplicativeExpression
                                                                                                  dRNegativeExpression
                                                                                                   primitiveExpression
                                                                                                    reference
                                                                                                     identifier
                                                                                                      sourceT
                                                                                         )
                                                                            )
                                                                )
    acmePropertyBlock
     <<
     acmePropertyBlockEntry
      identifier
       label
      :
      acmePropertyTypeRef
       acmePropertyTypeStructure
        acmePropertyTypeString
         string
      =
      acmePropertyValueDeclaration
       "Only attach ports of type inputT to roles of type sourceT, ports of type outputT to roles of type sinkT"
      ;
     >>
    ;
   designRule
    invariant
    designRuleExpression
     aSTDRImpliesExpression
      dRIffExpression
       dRAndExpression
        dRNegateExpression
         dREqualityExpression
          dRRelationalExpression
           dRAdditiveExpression
            dRMultiplicativeExpression
             dRNegativeExpression
              primitiveExpression
               quantifiedExpression
                Forall
                variableSetDeclaration
                 identifier
                  conn
                 :
                 acmeTypeRef
                  connector
                 in
                 reference
                  identifier
                   self
                  .
                  setReference
                   connectors
                |
                designRuleExpression
                 aSTDRImpliesExpression
                  dRIffExpression
                   dRAndExpression
                    dRNegateExpression
                     dREqualityExpression
                      dRRelationalExpression
                       dRAdditiveExpression
                        dRMultiplicativeExpression
                         dRNegativeExpression
                          primitiveExpression
                           quantifiedExpression
                            Forall
                            variableSetDeclaration
                             identifier
                              r
                             :
                             acmeTypeRef
                              role
                             in
                             reference
                              identifier
                               conn
                              .
                              setReference
                               Roles
                            |
                            designRuleExpression
                             aSTDRImpliesExpression
                              dRIffExpression
                               dRAndExpression
                                dRNegateExpression
                                 dREqualityExpression
                                  dRRelationalExpression
                                   dRAdditiveExpression
                                    dRMultiplicativeExpression
                                     dRNegativeExpression
                                      primitiveExpression
                                       quantifiedExpression
                                        Exists
                                        variableSetDeclaration
                                         identifier
                                          comp
                                         :
                                         acmeTypeRef
                                          component
                                         in
                                         reference
                                          identifier
                                           self
                                          .
                                          setReference
                                           components
                                        |
                                        designRuleExpression
                                         aSTDRImpliesExpression
                                          dRIffExpression
                                           dRAndExpression
                                            dRNegateExpression
                                             dREqualityExpression
                                              dRRelationalExpression
                                               dRAdditiveExpression
                                                dRMultiplicativeExpression
                                                 dRNegativeExpression
                                                  primitiveExpression
                                                   quantifiedExpression
                                                    Exists
                                                    variableSetDeclaration
                                                     identifier
                                                      p
                                                     :
                                                     acmeTypeRef
                                                      port
                                                     in
                                                     reference
                                                      identifier
                                                       comp
                                                      .
                                                      setReference
                                                       Ports
                                                    |
                                                    designRuleExpression
                                                     aSTDRImpliesExpression
                                                      dRIffExpression
                                                       dRAndExpression
                                                        dRNegateExpression
                                                         dREqualityExpression
                                                          dRRelationalExpression
                                                           dRAdditiveExpression
                                                            dRMultiplicativeExpression
                                                             dRNegativeExpression
                                                              primitiveExpression
                                                               reference
                                                                identifier
                                                                 attached
                                                                actualParams
                                                                 (
                                                                 designRuleExpression
                                                                  aSTDRImpliesExpression
                                                                   dRIffExpression
                                                                    dRAndExpression
                                                                     dRNegateExpression
                                                                      dREqualityExpression
                                                                       dRRelationalExpression
                                                                        dRAdditiveExpression
                                                                         dRMultiplicativeExpression
                                                                          dRNegativeExpression
                                                                           primitiveExpression
                                                                            reference
                                                                             identifier
                                                                              p
                                                                 ,
                                                                 designRuleExpression
                                                                  aSTDRImpliesExpression
                                                                   dRIffExpression
                                                                    dRAndExpression
                                                                     dRNegateExpression
                                                                      dREqualityExpression
                                                                       dRRelationalExpression
                                                                        dRAdditiveExpression
                                                                         dRMultiplicativeExpression
                                                                          dRNegativeExpression
                                                                           primitiveExpression
                                                                            reference
                                                                             identifier
                                                                              r
                                                                 )
    acmePropertyBlock
     <<
     acmePropertyBlockEntry
      identifier
       label
      :
      acmePropertyTypeRef
       acmePropertyTypeStructure
        acmePropertyTypeString
         string
      =
      acmePropertyValueDeclaration
       "All roles are attached"
      ;
     acmePropertyBlockEntry
      identifier
       errMsg
      :
      acmePropertyTypeRef
       acmePropertyTypeStructure
        acmePropertyTypeString
         string
      =
      acmePropertyValueDeclaration
       "There are dangling roles"
      ;
     >>
    ;
   designRule
    heuristic
    designRuleExpression
     aSTDRImpliesExpression
      dRIffExpression
       dRAndExpression
        dRNegateExpression
         dREqualityExpression
          dRRelationalExpression
           dRAdditiveExpression
            dRMultiplicativeExpression
             dRNegativeExpression
              primitiveExpression
               quantifiedExpression
                Forall
                variableSetDeclaration
                 identifier
                  comp
                 :
                 acmeTypeRef
                  component
                 in
                 reference
                  identifier
                   self
                  .
                  setReference
                   components
                |
                designRuleExpression
                 aSTDRImpliesExpression
                  dRIffExpression
                   dRAndExpression
                    dRNegateExpression
                     dREqualityExpression
                      dRRelationalExpression
                       dRAdditiveExpression
                        dRMultiplicativeExpression
                         dRNegativeExpression
                          primitiveExpression
                           quantifiedExpression
                            Forall
                            variableSetDeclaration
                             identifier
                              p
                             :
                             acmeTypeRef
                              port
                             in
                             reference
                              identifier
                               comp
                              .
                              setReference
                               Ports
                            |
                            designRuleExpression
                             aSTDRImpliesExpression
                              dRIffExpression
                               dRAndExpression
                                dRNegateExpression
                                 dREqualityExpression
                                  dRRelationalExpression
                                   dRAdditiveExpression
                                    dRMultiplicativeExpression
                                     dRNegativeExpression
                                      primitiveExpression
                                       quantifiedExpression
                                        Exists
                                        variableSetDeclaration
                                         identifier
                                          conn
                                         :
                                         acmeTypeRef
                                          connector
                                         in
                                         reference
                                          identifier
                                           self
                                          .
                                          setReference
                                           Connectors
                                        |
                                        designRuleExpression
                                         aSTDRImpliesExpression
                                          dRIffExpression
                                           dRAndExpression
                                            dRNegateExpression
                                             dREqualityExpression
                                              dRRelationalExpression
                                               dRAdditiveExpression
                                                dRMultiplicativeExpression
                                                 dRNegativeExpression
                                                  primitiveExpression
                                                   quantifiedExpression
                                                    Exists
                                                    variableSetDeclaration
                                                     identifier
                                                      r
                                                     :
                                                     acmeTypeRef
                                                      role
                                                     in
                                                     reference
                                                      identifier
                                                       conn
                                                      .
                                                      setReference
                                                       Roles
                                                    |
                                                    designRuleExpression
                                                     aSTDRImpliesExpression
                                                      dRIffExpression
                                                       dRAndExpression
                                                        dRNegateExpression
                                                         dREqualityExpression
                                                          dRRelationalExpression
                                                           dRAdditiveExpression
                                                            dRMultiplicativeExpression
                                                             dRNegativeExpression
                                                              primitiveExpression
                                                               reference
                                                                identifier
                                                                 attached
                                                                actualParams
                                                                 (
                                                                 designRuleExpression
                                                                  aSTDRImpliesExpression
                                                                   dRIffExpression
                                                                    dRAndExpression
                                                                     dRNegateExpression
                                                                      dREqualityExpression
                                                                       dRRelationalExpression
                                                                        dRAdditiveExpression
                                                                         dRMultiplicativeExpression
                                                                          dRNegativeExpression
                                                                           primitiveExpression
                                                                            reference
                                                                             identifier
                                                                              p
                                                                 ,
                                                                 designRuleExpression
                                                                  aSTDRImpliesExpression
                                                                   dRIffExpression
                                                                    dRAndExpression
                                                                     dRNegateExpression
                                                                      dREqualityExpression
                                                                       dRRelationalExpression
                                                                        dRAdditiveExpression
                                                                         dRMultiplicativeExpression
                                                                          dRNegativeExpression
                                                                           primitiveExpression
                                                                            reference
                                                                             identifier
                                                                              r
                                                                 )
    acmePropertyBlock
     <<
     acmePropertyBlockEntry
      identifier
       label
      :
      acmePropertyTypeRef
       acmePropertyTypeStructure
        acmePropertyTypeString
         string
      =
      acmePropertyValueDeclaration
       "There are no dangling ports"
      ;
     acmePropertyBlockEntry
      identifier
       errMsg
      :
      acmePropertyTypeRef
       acmePropertyTypeStructure
        acmePropertyTypeString
         string
      =
      acmePropertyValueDeclaration
       "Some ports are unattached"
      ;
     >>
    ;
   }
 <EOF>
