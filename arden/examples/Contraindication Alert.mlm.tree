(mlm (maintenanceCategory maintenance : (titleSlot title : (slotText  Check for penicillin allergy) ;;) (mlmNameSlot mlmname : pen_allergy ;;) (ardenVersionSlot arden : version 3 ;;) (versionSlot version : (slotText  1.00) ;;) (institutionSlot institution: (slotText  Columbia-Presbyterian Medical Center) ;;) (authorSlot author : (slotText  George Hripcsak, M.D.) ;;) (specialistSlot specialist : (slotText  ) ;;) (dateSlot date : 1991-03-18 ;;) (validationSlot validation : testing ;;)) (libraryCategory library : (purposeSlot purpose : (slotText \nWhen a penicillin is prescribed, check for an allergy. (This MLM\ndemonstrates checking for contraindications.)) ;;) (explanationSlot explanation : (slotText \nThis MLM is evoked when a penicillin medication is ordered. An\nalert is generated because the patient has an allergy to penicillin\nrecorded.) ;;) (keywordsSlot keywords : (slotText  penicillin ;  allergy) ;;) (citationsSlot citations : (slotText  ) ;;)) (knowledgeCategory knowledge : (typeSlot type : data-driven ;;) (dataSlot data : (dataStatement penicillin_order := (dataIdentifierAssign event (mappingFactor { medication_order where\nclass = penicillin }))) ; (dataStatement penicillin_allergy := (dataIdentifierAssign read (readPhrase (fromOfFuncOp last) (mappingFactor { allergy where\nagent_class = penicillin })))) ; ;;) (evokeSlot evoke : (evokeStatement (simpleTrigger (eventOr penicillin_order))) ; ;;) (logicSlot logic : (logicStatement if (expr (exprMerge (exprSort (exprAddList (exprRemoveList (exprWhere (exprOr (exprAnd (exprRange (exprNot (exprComparison (exprString (exprPlus (exprMul (exprPower (exprAtTime (exprBefore (exprAgo (exprFunction (ofReadFuncOp exist) (exprFunction (exprNegation (exprDuration (exprFactor (exprAtom ( (expr (exprMerge (exprSort (exprAddList (exprRemoveList (exprWhere (exprOr (exprAnd (exprRange (exprNot (exprComparison (exprString (exprPlus (exprMul (exprPower (exprAtTime (exprBefore (exprAgo (exprFunction (exprNegation (exprDuration (exprFactor (exprAtom penicillin_allergy))))))))))))))))))))))) ))))))))))))))))))))))))) then (logicStatement conclude (expr (exprMerge (exprSort (exprAddList (exprRemoveList (exprWhere (exprOr (exprAnd (exprRange (exprNot (exprComparison (exprString (exprPlus (exprMul (exprPower (exprAtTime (exprBefore (exprAgo (exprFunction (exprNegation (exprDuration (exprFactor (exprAtom true)))))))))))))))))))))))) ; (logicElseIf endif)) ; ;;) (actionSlot action : (actionStatement write (expr (exprMerge (exprSort (exprAddList (exprRemoveList (exprWhere (exprOr (exprAnd (exprRange (exprNot (exprComparison (exprString (exprString (exprPlus (exprMul (exprPower (exprAtTime (exprBefore (exprAgo (exprFunction (exprNegation (exprDuration (exprFactor (exprAtom "Caution, the patient has the following allergy to penicillin\ndocumented:")))))))))))) || (exprPlus (exprMul (exprPower (exprAtTime (exprBefore (exprAgo (exprFunction (exprNegation (exprDuration (exprFactor (exprAtom penicillin_allergy)))))))))))))))))))))))) ; ;;) (urgencySlot urgency : 50 ;;)) (resourcesCategory resources : (defaultSlot default: en ;;) (languageSlot language : en ;;)) end : <EOF>)