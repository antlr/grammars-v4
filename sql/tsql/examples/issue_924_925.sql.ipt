tsql_file
 batch
  batch_level_statement
   create_or_alter_function
    CREATE
    FUNCTION
    func_proc_name_schema
     id_
      [Report]
     .
     id_
      [DataSet]
    (
    procedure_param
     @Monat
     data_type
      id_
       keyword
        TINYINT
    ,
    procedure_param
     @Jahr
     data_type
      id_
       keyword
        SMALLINT
    )
    func_body_returns_table
     RETURNS
     @xxx
     table_type_definition
      TABLE
      (
      column_def_table_constraints
       column_def_table_constraint
        column_definition
         id_
          [AUSLASTUNGSBETRAG_STICHTAG]
         data_type
          id_
           DECIMAL
          (
          28
          ,
          4
          )
       ,
       column_def_table_constraint
        column_definition
         id_
          [AUSLASTUNGSBETRAG_VERGLEICHSSTICHTAG]
         data_type
          id_
           DECIMAL
          (
          28
          ,
          4
          )
       ,
       column_def_table_constraint
        column_definition
         id_
          RATINGNOTE
         data_type
          id_
           keyword
            INT
      )
     AS
     BEGIN
     sql_clauses
      dml_clause
       insert_statement
        INSERT
        INTO
        ddl_object
         @xxx
        (
        insert_column_name_list
         insert_column_id
          id_
           AUSLASTUNGSBETRAG_STICHTAG
         ,
         insert_column_id
          id_
           AUSLASTUNGSBETRAG_VERGLEICHSSTICHTAG
         ,
         insert_column_id
          id_
           RATINGNOTE
        )
        insert_statement_value
         derived_table
          subquery
           select_statement
            query_expression
             query_specification
              SELECT
              select_list
               select_list_elem
                expression_elem
                 column_alias
                  id_
                   [AUSLASTUNGSBETRAG_STICHTAG]
                 =
                 expression
                  function_call
                   aggregate_windowed_function
                    SUM
                    (
                    all_distinct_expression
                     expression
                      full_column_name
                       full_table_name
                        id_
                         Stichtage
                       .
                       id_
                        [Auslastungsbetrag zum Stichtag]
                    )
               ,
               select_list_elem
                expression_elem
                 column_alias
                  id_
                   [AUSLASTUNGSBETRAG_VERGLEICHSSTICHTAG]
                 =
                 expression
                  function_call
                   aggregate_windowed_function
                    SUM
                    (
                    all_distinct_expression
                     expression
                      full_column_name
                       full_table_name
                        id_
                         Stichtage
                       .
                       id_
                        [Auslastungsbetrag zum Vergleichsstichtag]
                    )
               ,
               select_list_elem
                expression_elem
                 column_alias
                  id_
                   RATINGNOTE
                 =
                 expression
                  function_call
                   built_in_functions
                    ISNULL
                    (
                    expression
                     function_call
                      built_in_functions
                       CAST
                       (
                       expression
                        full_column_name
                         full_table_name
                          id_
                           RATING
                         .
                         id_
                          RATINGNOTE_KURZ
                       AS
                       data_type
                        id_
                         keyword
                          INT
                       )
                    ,
                    expression
                     unary_operator_expression
                      -
                      expression
                       primitive_expression
                        primitive_constant
                         1
                    )
              FROM
              table_sources
               table_source
                table_source_item
                 full_table_name
                  id_
                   aaa
                  .
                  id_
                   bbb
            ;
     RETURN
     ;
     END
     ;
 <EOF>
