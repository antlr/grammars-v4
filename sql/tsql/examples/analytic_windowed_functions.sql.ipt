tsql_file
 batch
  sql_clauses
   another_statement
    use_statement
     USE
     id_
      AdventureWorks2012
   ;
  go_statement
   GO
 batch
  sql_clauses
   dml_clause
    select_statement_standalone
     select_statement
      query_expression
       query_specification
        SELECT
        select_list
         select_list_elem
          expression_elem
           expression
            function_call
             analytic_windowed_function
              FIRST_VALUE
              (
              expression
               full_column_name
                id_
                 SalesOrderNumber
              )
              over_clause
               OVER
               (
               PARTITION
               BY
               expression_list_
                expression
                 full_column_name
                  id_
                   CustomerID
               order_by_clause
                ORDER
                BY
                order_by_expression
                 expression
                  full_column_name
                   id_
                    OrderDate
               )
           as_column_alias
            AS
            column_alias
             id_
              FirstSONumberPerCustomer
        FROM
        table_sources
         table_source
          table_source_item
           full_table_name
            id_
             Sales
            .
            id_
             SalesOrderHeader
      ;
  sql_clauses
   dml_clause
    select_statement_standalone
     select_statement
      query_expression
       query_specification
        SELECT
        select_list
         select_list_elem
          expression_elem
           expression
            function_call
             analytic_windowed_function
              LAST_VALUE
              (
              expression
               full_column_name
                id_
                 SalesOrderNumber
              )
              over_clause
               OVER
               (
               PARTITION
               BY
               expression_list_
                expression
                 full_column_name
                  id_
                   CustomerID
               order_by_clause
                ORDER
                BY
                order_by_expression
                 expression
                  full_column_name
                   id_
                    OrderDate
               row_or_range_clause
                ROWS
                window_frame_extent
                 window_frame_preceding
                  UNBOUNDED
                  PRECEDING
               )
           as_column_alias
            AS
            column_alias
             id_
              FirstSONumberPerCustomer
        FROM
        table_sources
         table_source
          table_source_item
           full_table_name
            id_
             Sales
            .
            id_
             SalesOrderHeader
      ;
  sql_clauses
   dml_clause
    select_statement_standalone
     select_statement
      query_expression
       query_specification
        SELECT
        select_list
         select_list_elem
          expression_elem
           expression
            function_call
             analytic_windowed_function
              LAG
              (
              expression
               full_column_name
                id_
                 PurchaseOrderNumber
              ,
              expression
               primitive_expression
                primitive_constant
                 2
              )
              over_clause
               OVER
               (
               PARTITION
               BY
               expression_list_
                expression
                 full_column_name
                  id_
                   CustomerID
               order_by_clause
                ORDER
                BY
                order_by_expression
                 expression
                  full_column_name
                   id_
                    OrderDate
               )
           as_column_alias
            AS
            column_alias
             id_
              PrevPONumberOffset2
        FROM
        table_sources
         table_source
          table_source_item
           full_table_name
            id_
             sales
            .
            id_
             SalesOrderHeader
      ;
  sql_clauses
   dml_clause
    select_statement_standalone
     select_statement
      query_expression
       query_specification
        SELECT
        select_list
         select_list_elem
          expression_elem
           expression
            function_call
             analytic_windowed_function
              LEAD
              (
              expression
               full_column_name
                id_
                 PurchaseOrderNumber
              )
              over_clause
               OVER
               (
               PARTITION
               BY
               expression_list_
                expression
                 full_column_name
                  id_
                   CustomerID
               order_by_clause
                ORDER
                BY
                order_by_expression
                 expression
                  full_column_name
                   id_
                    OrderDate
               )
           as_column_alias
            AS
            column_alias
             id_
              NextPONumber
        FROM
        table_sources
         table_source
          table_source_item
           full_table_name
            id_
             sales
            .
            id_
             SalesOrderHeader
      ;
  sql_clauses
   dml_clause
    select_statement_standalone
     select_statement
      query_expression
       query_specification
        SELECT
        select_list
         select_list_elem
          expression_elem
           expression
            full_column_name
             id_
              Department
         ,
         select_list_elem
          expression_elem
           expression
            full_column_name
             id_
              LastName
         ,
         select_list_elem
          expression_elem
           expression
            full_column_name
             id_
              Rate
         ,
         select_list_elem
          expression_elem
           expression
            function_call
             analytic_windowed_function
              CUME_DIST
              (
              )
              OVER
              (
              PARTITION
              BY
              expression_list_
               expression
                full_column_name
                 id_
                  Department
              order_by_clause
               ORDER
               BY
               order_by_expression
                expression
                 full_column_name
                  id_
                   Rate
              )
           as_column_alias
            AS
            column_alias
             id_
              CumeDist
         ,
         select_list_elem
          expression_elem
           expression
            function_call
             analytic_windowed_function
              PERCENT_RANK
              (
              )
              OVER
              (
              PARTITION
              BY
              expression_list_
               expression
                full_column_name
                 id_
                  Department
              order_by_clause
               ORDER
               BY
               order_by_expression
                expression
                 full_column_name
                  id_
                   Rate
              )
           as_column_alias
            AS
            column_alias
             id_
              PctRank
        FROM
        table_sources
         table_source
          table_source_item
           full_table_name
            id_
             HumanResources
            .
            id_
             vEmployeeDepartmentHistory
           as_table_alias
            AS
            table_alias
             id_
              edh
          join_part
           join_on
            INNER
            JOIN
            table_source
             table_source_item
              full_table_name
               id_
                HumanResources
               .
               id_
                EmployeePayHistory
              as_table_alias
               AS
               table_alias
                id_
                 e
            ON
            search_condition
             predicate
              expression
               full_column_name
                full_table_name
                 id_
                  e
                .
                id_
                 BusinessEntityID
              comparison_operator
               =
              expression
               full_column_name
                full_table_name
                 id_
                  edh
                .
                id_
                 BusinessEntityID
        WHERE
        search_condition
         predicate
          expression
           full_column_name
            id_
             Department
          IN
          (
          expression_list_
           expression
            primitive_expression
             primitive_constant
              N'Information Services'
           ,
           expression
            primitive_expression
             primitive_constant
              N'Document Control'
          )
       select_order_by_clause
        order_by_clause
         ORDER
         BY
         order_by_expression
          expression
           full_column_name
            id_
             Department
         ,
         order_by_expression
          expression
           full_column_name
            id_
             Rate
          DESC
      ;
  sql_clauses
   dml_clause
    select_statement_standalone
     select_statement
      query_expression
       query_specification
        SELECT
        DISTINCT
        select_list
         select_list_elem
          expression_elem
           expression
            full_column_name
             id_
              keyword
               Name
           as_column_alias
            AS
            column_alias
             id_
              DepartmentName
         ,
         select_list_elem
          expression_elem
           expression
            function_call
             analytic_windowed_function
              PERCENTILE_CONT
              (
              expression
               primitive_expression
                primitive_constant
                 0.5
              )
              WITHIN
              GROUP
              (
              order_by_clause
               ORDER
               BY
               order_by_expression
                expression
                 full_column_name
                  full_table_name
                   id_
                    ph
                  .
                  id_
                   Rate
              )
              OVER
              (
              PARTITION
              BY
              expression_list_
               expression
                full_column_name
                 id_
                  keyword
                   Name
              )
           as_column_alias
            AS
            column_alias
             id_
              MedianCont
         ,
         select_list_elem
          expression_elem
           expression
            function_call
             analytic_windowed_function
              PERCENTILE_DISC
              (
              expression
               primitive_expression
                primitive_constant
                 0.5
              )
              WITHIN
              GROUP
              (
              order_by_clause
               ORDER
               BY
               order_by_expression
                expression
                 full_column_name
                  full_table_name
                   id_
                    ph
                  .
                  id_
                   Rate
              )
              OVER
              (
              PARTITION
              BY
              expression_list_
               expression
                full_column_name
                 id_
                  keyword
                   Name
              )
           as_column_alias
            AS
            column_alias
             id_
              MedianDisc
        FROM
        table_sources
         table_source
          table_source_item
           full_table_name
            id_
             HumanResources
            .
            id_
             Department
           as_table_alias
            AS
            table_alias
             id_
              keyword
               d
          join_part
           join_on
            INNER
            JOIN
            table_source
             table_source_item
              full_table_name
               id_
                HumanResources
               .
               id_
                EmployeeDepartmentHistory
              as_table_alias
               AS
               table_alias
                id_
                 dh
            ON
            search_condition
             predicate
              expression
               full_column_name
                full_table_name
                 id_
                  dh
                .
                id_
                 DepartmentID
              comparison_operator
               =
              expression
               full_column_name
                full_table_name
                 id_
                  keyword
                   d
                .
                id_
                 DepartmentID
          join_part
           join_on
            INNER
            JOIN
            table_source
             table_source_item
              full_table_name
               id_
                HumanResources
               .
               id_
                EmployeePayHistory
              as_table_alias
               AS
               table_alias
                id_
                 ph
            ON
            search_condition
             predicate
              expression
               full_column_name
                full_table_name
                 id_
                  ph
                .
                id_
                 BusinessEntityID
              comparison_operator
               =
              expression
               full_column_name
                full_table_name
                 id_
                  dh
                .
                id_
                 BusinessEntityID
        WHERE
        search_condition
         predicate
          expression
           full_column_name
            full_table_name
             id_
              dh
            .
            id_
             EndDate
          IS
          null_notnull
           NULL
      ;
  sql_clauses
   dml_clause
    select_statement_standalone
     select_statement
      query_expression
       query_specification
        SELECT
        DISTINCT
        select_list
         select_list_elem
          expression_elem
           expression
            full_column_name
             id_
              keyword
               Name
           as_column_alias
            AS
            column_alias
             id_
              DepartmentName
         ,
         select_list_elem
          expression_elem
           expression
            function_call
             analytic_windowed_function
              PERCENTILE_CONT
              (
              expression
               primitive_expression
                primitive_constant
                 0.5
              )
              WITHIN
              GROUP
              (
              order_by_clause
               ORDER
               BY
               order_by_expression
                expression
                 full_column_name
                  full_table_name
                   id_
                    ph
                  .
                  id_
                   Rate
              )
              OVER
              (
              PARTITION
              BY
              expression_list_
               expression
                full_column_name
                 id_
                  keyword
                   Name
              )
           as_column_alias
            AS
            column_alias
             id_
              MedianCont
         ,
         select_list_elem
          expression_elem
           expression
            function_call
             analytic_windowed_function
              PERCENTILE_DISC
              (
              expression
               primitive_expression
                primitive_constant
                 0.5
              )
              WITHIN
              GROUP
              (
              order_by_clause
               ORDER
               BY
               order_by_expression
                expression
                 full_column_name
                  full_table_name
                   id_
                    ph
                  .
                  id_
                   Rate
              )
              OVER
              (
              PARTITION
              BY
              expression_list_
               expression
                full_column_name
                 id_
                  keyword
                   Name
              )
           as_column_alias
            AS
            column_alias
             id_
              MedianDisc
        FROM
        table_sources
         table_source
          table_source_item
           full_table_name
            id_
             HumanResources
            .
            id_
             Department
           as_table_alias
            AS
            table_alias
             id_
              keyword
               d
          join_part
           join_on
            INNER
            JOIN
            table_source
             table_source_item
              full_table_name
               id_
                HumanResources
               .
               id_
                EmployeeDepartmentHistory
              as_table_alias
               AS
               table_alias
                id_
                 dh
            ON
            search_condition
             predicate
              expression
               full_column_name
                full_table_name
                 id_
                  dh
                .
                id_
                 DepartmentID
              comparison_operator
               =
              expression
               full_column_name
                full_table_name
                 id_
                  keyword
                   d
                .
                id_
                 DepartmentID
          join_part
           join_on
            INNER
            JOIN
            table_source
             table_source_item
              full_table_name
               id_
                HumanResources
               .
               id_
                EmployeePayHistory
              as_table_alias
               AS
               table_alias
                id_
                 ph
            ON
            search_condition
             predicate
              expression
               full_column_name
                full_table_name
                 id_
                  ph
                .
                id_
                 BusinessEntityID
              comparison_operator
               =
              expression
               full_column_name
                full_table_name
                 id_
                  dh
                .
                id_
                 BusinessEntityID
        WHERE
        search_condition
         predicate
          expression
           full_column_name
            full_table_name
             id_
              dh
            .
            id_
             EndDate
          IS
          null_notnull
           NULL
      ;
  sql_clauses
   dml_clause
    select_statement_standalone
     select_statement
      query_expression
       query_specification
        SELECT
        select_list
         select_list_elem
          expression_elem
           expression
            full_column_name
             id_
              Department
         ,
         select_list_elem
          expression_elem
           expression
            full_column_name
             id_
              LastName
         ,
         select_list_elem
          expression_elem
           expression
            full_column_name
             id_
              Rate
         ,
         select_list_elem
          expression_elem
           expression
            function_call
             analytic_windowed_function
              CUME_DIST
              (
              )
              OVER
              (
              PARTITION
              BY
              expression_list_
               expression
                full_column_name
                 id_
                  Department
              order_by_clause
               ORDER
               BY
               order_by_expression
                expression
                 full_column_name
                  id_
                   Rate
              )
           as_column_alias
            AS
            column_alias
             id_
              CumeDist
         ,
         select_list_elem
          expression_elem
           expression
            function_call
             analytic_windowed_function
              PERCENT_RANK
              (
              )
              OVER
              (
              PARTITION
              BY
              expression_list_
               expression
                full_column_name
                 id_
                  Department
              order_by_clause
               ORDER
               BY
               order_by_expression
                expression
                 full_column_name
                  id_
                   Rate
              )
           as_column_alias
            AS
            column_alias
             id_
              PctRank
        FROM
        table_sources
         table_source
          table_source_item
           full_table_name
            id_
             HumanResources
            .
            id_
             vEmployeeDepartmentHistory
           as_table_alias
            AS
            table_alias
             id_
              edh
          join_part
           join_on
            INNER
            JOIN
            table_source
             table_source_item
              full_table_name
               id_
                HumanResources
               .
               id_
                EmployeePayHistory
              as_table_alias
               AS
               table_alias
                id_
                 e
            ON
            search_condition
             predicate
              expression
               full_column_name
                full_table_name
                 id_
                  e
                .
                id_
                 BusinessEntityID
              comparison_operator
               =
              expression
               full_column_name
                full_table_name
                 id_
                  edh
                .
                id_
                 BusinessEntityID
        WHERE
        search_condition
         predicate
          expression
           full_column_name
            id_
             Department
          IN
          (
          expression_list_
           expression
            primitive_expression
             primitive_constant
              N'Information Services'
           ,
           expression
            primitive_expression
             primitive_constant
              N'Document Control'
          )
       select_order_by_clause
        order_by_clause
         ORDER
         BY
         order_by_expression
          expression
           full_column_name
            id_
             Department
         ,
         order_by_expression
          expression
           full_column_name
            id_
             Rate
          DESC
      ;
 <EOF>
