sql_script
 unit_statement
  create_analytic_view
   CREATE
   OR
   REPLACE
   ANALYTIC
   VIEW
   id_expression
    regular_id
     sales_av
   cav_using_clause
    USING
    id_expression
     regular_id
      sales_fact
   dim_by_clause
    DIMENSION
    BY
    (
    dim_key
     dim_ref
      id_expression
       regular_id
        time_attr_dim
     KEY
     column_name
      identifier
       id_expression
        regular_id
         month_id
     REFERENCES
     attribute_name
      identifier
       id_expression
        regular_id
         month_id
     HIERARCHIES
     (
     hier_ref
      id_expression
       regular_id
        time_hier
      DEFAULT
     )
    ,
    dim_key
     dim_ref
      id_expression
       regular_id
        product_attr_dim
     KEY
     column_name
      identifier
       id_expression
        regular_id
         category_id
     REFERENCES
     attribute_name
      identifier
       id_expression
        regular_id
         category_id
     HIERARCHIES
     (
     hier_ref
      id_expression
       regular_id
        product_hier
      DEFAULT
     )
    ,
    dim_key
     dim_ref
      id_expression
       regular_id
        geography_attr_dim
     KEY
     column_name
      identifier
       id_expression
        regular_id
         state_province_id
     REFERENCES
     attribute_name
      identifier
       id_expression
        regular_id
         state_province_id
     HIERARCHIES
     (
     hier_ref
      id_expression
       regular_id
        geography_hier
      DEFAULT
     )
    )
   measures_clause
    MEASURES
    (
    av_measure
     id_expression
      regular_id
       sales
     base_meas_clause
      FACT
      id_expression
       regular_id
        sales
    ,
    av_measure
     id_expression
      regular_id
       units
     base_meas_clause
      FACT
      id_expression
       regular_id
        units
    ,
    av_measure
     id_expression
      regular_id
       sales_prior_period
     calc_meas_clause
      AS
      (
      expression
       logical_expression
        unary_logical_expression
         multiset_expression
          relational_expression
           compound_expression
            concatenation
             model_expression
              unary_expression
               standard_function
                other_function
                 LAG
                 function_argument_analytic
                  (
                  argument
                   expression
                    logical_expression
                     unary_logical_expression
                      multiset_expression
                       relational_expression
                        compound_expression
                         concatenation
                          model_expression
                           unary_expression
                            atom
                             general_element
                              general_element_part
                               id_expression
                                regular_id
                                 sales
                  )
                 over_clause
                  OVER
                  (
                  HIERARCHY
                  id_expression
                   regular_id
                    time_hier
                  OFFSET
                  numeric
                   1
                  )
      )
    ,
    av_measure
     id_expression
      regular_id
       sales_year_ago
     calc_meas_clause
      AS
      (
      expression
       logical_expression
        unary_logical_expression
         multiset_expression
          relational_expression
           compound_expression
            concatenation
             model_expression
              unary_expression
               standard_function
                other_function
                 LAG
                 function_argument_analytic
                  (
                  argument
                   expression
                    logical_expression
                     unary_logical_expression
                      multiset_expression
                       relational_expression
                        compound_expression
                         concatenation
                          model_expression
                           unary_expression
                            atom
                             general_element
                              general_element_part
                               id_expression
                                regular_id
                                 sales
                  )
                 over_clause
                  OVER
                  (
                  HIERARCHY
                  id_expression
                   regular_id
                    time_hier
                  OFFSET
                  numeric
                   1
                  ACROSS
                  ANCESTOR
                  AT
                  LEVEL
                  id_expression
                   regular_id
                    non_reserved_keywords_pre12c
                     year
                  )
      )
    ,
    av_measure
     id_expression
      regular_id
       chg_sales_year_ago
     calc_meas_clause
      AS
      (
      expression
       logical_expression
        unary_logical_expression
         multiset_expression
          relational_expression
           compound_expression
            concatenation
             model_expression
              unary_expression
               standard_function
                other_function
                 over_clause_keyword
                  LAG_DIFF
                 function_argument_analytic
                  (
                  argument
                   expression
                    logical_expression
                     unary_logical_expression
                      multiset_expression
                       relational_expression
                        compound_expression
                         concatenation
                          model_expression
                           unary_expression
                            atom
                             general_element
                              general_element_part
                               id_expression
                                regular_id
                                 sales
                  )
                 over_clause
                  OVER
                  (
                  HIERARCHY
                  id_expression
                   regular_id
                    time_hier
                  OFFSET
                  numeric
                   1
                  ACROSS
                  ANCESTOR
                  AT
                  LEVEL
                  id_expression
                   regular_id
                    non_reserved_keywords_pre12c
                     year
                  )
      )
    ,
    av_measure
     id_expression
      regular_id
       pct_chg_sales_year_ago
     calc_meas_clause
      AS
      (
      expression
       logical_expression
        unary_logical_expression
         multiset_expression
          relational_expression
           compound_expression
            concatenation
             model_expression
              unary_expression
               standard_function
                other_function
                 over_clause_keyword
                  LAG_DIFF_PERCENT
                 function_argument_analytic
                  (
                  argument
                   expression
                    logical_expression
                     unary_logical_expression
                      multiset_expression
                       relational_expression
                        compound_expression
                         concatenation
                          model_expression
                           unary_expression
                            atom
                             general_element
                              general_element_part
                               id_expression
                                regular_id
                                 sales
                  )
                 over_clause
                  OVER
                  (
                  HIERARCHY
                  id_expression
                   regular_id
                    time_hier
                  OFFSET
                  numeric
                   1
                  ACROSS
                  ANCESTOR
                  AT
                  LEVEL
                  id_expression
                   regular_id
                    non_reserved_keywords_pre12c
                     year
                  )
      )
    ,
    av_measure
     id_expression
      regular_id
       sales_qtr_ago
     calc_meas_clause
      AS
      (
      expression
       logical_expression
        unary_logical_expression
         multiset_expression
          relational_expression
           compound_expression
            concatenation
             model_expression
              unary_expression
               standard_function
                other_function
                 LAG
                 function_argument_analytic
                  (
                  argument
                   expression
                    logical_expression
                     unary_logical_expression
                      multiset_expression
                       relational_expression
                        compound_expression
                         concatenation
                          model_expression
                           unary_expression
                            atom
                             general_element
                              general_element_part
                               id_expression
                                regular_id
                                 sales
                  )
                 over_clause
                  OVER
                  (
                  HIERARCHY
                  id_expression
                   regular_id
                    time_hier
                  OFFSET
                  numeric
                   1
                  ACROSS
                  ANCESTOR
                  AT
                  LEVEL
                  id_expression
                   regular_id
                    quarter
                  )
      )
    ,
    av_measure
     id_expression
      regular_id
       chg_sales_qtr_ago
     calc_meas_clause
      AS
      (
      expression
       logical_expression
        unary_logical_expression
         multiset_expression
          relational_expression
           compound_expression
            concatenation
             model_expression
              unary_expression
               standard_function
                other_function
                 over_clause_keyword
                  LAG_DIFF
                 function_argument_analytic
                  (
                  argument
                   expression
                    logical_expression
                     unary_logical_expression
                      multiset_expression
                       relational_expression
                        compound_expression
                         concatenation
                          model_expression
                           unary_expression
                            atom
                             general_element
                              general_element_part
                               id_expression
                                regular_id
                                 sales
                  )
                 over_clause
                  OVER
                  (
                  HIERARCHY
                  id_expression
                   regular_id
                    time_hier
                  OFFSET
                  numeric
                   1
                  ACROSS
                  ANCESTOR
                  AT
                  LEVEL
                  id_expression
                   regular_id
                    quarter
                  )
      )
    ,
    av_measure
     id_expression
      regular_id
       pct_chg_sales_qtr_ago
     calc_meas_clause
      AS
      (
      expression
       logical_expression
        unary_logical_expression
         multiset_expression
          relational_expression
           compound_expression
            concatenation
             model_expression
              unary_expression
               standard_function
                other_function
                 over_clause_keyword
                  LAG_DIFF_PERCENT
                 function_argument_analytic
                  (
                  argument
                   expression
                    logical_expression
                     unary_logical_expression
                      multiset_expression
                       relational_expression
                        compound_expression
                         concatenation
                          model_expression
                           unary_expression
                            atom
                             general_element
                              general_element_part
                               id_expression
                                regular_id
                                 sales
                  )
                 over_clause
                  OVER
                  (
                  HIERARCHY
                  id_expression
                   regular_id
                    time_hier
                  OFFSET
                  numeric
                   1
                  ACROSS
                  ANCESTOR
                  AT
                  LEVEL
                  id_expression
                   regular_id
                    quarter
                  )
      )
    )
   default_measure_clause
    DEFAULT
    MEASURE
    id_expression
     regular_id
      SALES
 ;
 unit_statement
  create_analytic_view
   CREATE
   OR
   REPLACE
   ANALYTIC
   VIEW
   id_expression
    regular_id
     sales_av
   cav_using_clause
    USING
    schema_name
     identifier
      id_expression
       regular_id
        av
    .
    id_expression
     regular_id
      sales_fact
   dim_by_clause
    DIMENSION
    BY
    (
    dim_key
     dim_ref
      id_expression
       regular_id
        time_attr_dim
     KEY
     column_name
      identifier
       id_expression
        regular_id
         month_id
     REFERENCES
     attribute_name
      identifier
       id_expression
        regular_id
         month_id
     HIERARCHIES
     (
     hier_ref
      id_expression
       regular_id
        time_hier
      DEFAULT
     )
    ,
    dim_key
     dim_ref
      id_expression
       regular_id
        product_attr_dim
     KEY
     column_name
      identifier
       id_expression
        regular_id
         category_id
     REFERENCES
     attribute_name
      identifier
       id_expression
        regular_id
         category_id
     HIERARCHIES
     (
     hier_ref
      id_expression
       regular_id
        product_hier
      DEFAULT
     )
    ,
    dim_key
     dim_ref
      id_expression
       regular_id
        geography_attr_dim
     KEY
     column_name
      identifier
       id_expression
        regular_id
         state_province_id
     REFERENCES
     attribute_name
      identifier
       id_expression
        regular_id
         state_province_id
     HIERARCHIES
     (
     hier_ref
      id_expression
       regular_id
        geography_hier
      DEFAULT
     )
    )
   measures_clause
    MEASURES
    (
    av_measure
     id_expression
      regular_id
       sales
     base_meas_clause
      FACT
      id_expression
       regular_id
        sales
    ,
    av_measure
     id_expression
      regular_id
       sales_year_ago
     calc_meas_clause
      AS
      (
      expression
       logical_expression
        unary_logical_expression
         multiset_expression
          relational_expression
           compound_expression
            concatenation
             model_expression
              unary_expression
               standard_function
                other_function
                 LAG
                 function_argument_analytic
                  (
                  argument
                   expression
                    logical_expression
                     unary_logical_expression
                      multiset_expression
                       relational_expression
                        compound_expression
                         concatenation
                          model_expression
                           unary_expression
                            atom
                             general_element
                              general_element_part
                               id_expression
                                regular_id
                                 sales
                  )
                 over_clause
                  OVER
                  (
                  HIERARCHY
                  id_expression
                   regular_id
                    time_hier
                  OFFSET
                  numeric
                   1
                  ACROSS
                  ANCESTOR
                  AT
                  LEVEL
                  id_expression
                   regular_id
                    non_reserved_keywords_pre12c
                     year
                  )
      )
    ,
    av_measure
     id_expression
      regular_id
       sales_pct_chg_year_ago
     calc_meas_clause
      AS
      (
      expression
       logical_expression
        unary_logical_expression
         multiset_expression
          relational_expression
           compound_expression
            concatenation
             model_expression
              unary_expression
               standard_function
                numeric_function_wrapper
                 numeric_function
                  ROUND
                  (
                  expression
                   logical_expression
                    unary_logical_expression
                     multiset_expression
                      relational_expression
                       compound_expression
                        concatenation
                         model_expression
                          unary_expression
                           standard_function
                            other_function
                             over_clause_keyword
                              LAG_DIFF_PERCENT
                             function_argument_analytic
                              (
                              argument
                               expression
                                logical_expression
                                 unary_logical_expression
                                  multiset_expression
                                   relational_expression
                                    compound_expression
                                     concatenation
                                      model_expression
                                       unary_expression
                                        atom
                                         general_element
                                          general_element_part
                                           id_expression
                                            regular_id
                                             sales
                              )
                             over_clause
                              OVER
                              (
                              HIERARCHY
                              id_expression
                               regular_id
                                time_hier
                              OFFSET
                              numeric
                               1
                              ACROSS
                              ANCESTOR
                              AT
                              LEVEL
                              id_expression
                               regular_id
                                non_reserved_keywords_pre12c
                                 year
                              )
                  ,
                  2
                  )
      )
    ,
    av_measure
     id_expression
      regular_id
       units
     base_meas_clause
      FACT
      id_expression
       regular_id
        units
    )
   default_measure_clause
    DEFAULT
    MEASURE
    id_expression
     regular_id
      SALES
 ;
 unit_statement
  create_analytic_view
   CREATE
   OR
   REPLACE
   ANALYTIC
   VIEW
   id_expression
    regular_id
     sales_av
   cav_using_clause
    USING
    schema_name
     identifier
      id_expression
       regular_id
        av
    .
    id_expression
     regular_id
      sales_fact
   dim_by_clause
    DIMENSION
    BY
    (
    dim_key
     dim_ref
      id_expression
       regular_id
        time_attr_dim
     KEY
     column_name
      identifier
       id_expression
        regular_id
         month_id
     REFERENCES
     attribute_name
      identifier
       id_expression
        regular_id
         month_id
     HIERARCHIES
     (
     hier_ref
      id_expression
       regular_id
        time_hier
      DEFAULT
     )
    )
   measures_clause
    MEASURES
    (
    av_measure
     id_expression
      regular_id
       sales
     base_meas_clause
      FACT
      id_expression
       regular_id
        sales
    ,
    av_measure
     id_expression
      regular_id
       avg_sales
     base_meas_clause
      FACT
      id_expression
       regular_id
        sales
      meas_aggregate_clause
       AGGREGATE
       BY
       aggregate_function_name
        identifier
         id_expression
          regular_id
           non_reserved_keywords_pre12c
            AVG
    ,
    av_measure
     id_expression
      regular_id
       count_sales
     base_meas_clause
      FACT
      id_expression
       regular_id
        sales
      meas_aggregate_clause
       AGGREGATE
       BY
       aggregate_function_name
        identifier
         id_expression
          regular_id
           non_reserved_keywords_pre12c
            COUNT
    ,
    av_measure
     id_expression
      regular_id
       max_sales
     base_meas_clause
      FACT
      id_expression
       regular_id
        sales
      meas_aggregate_clause
       AGGREGATE
       BY
       aggregate_function_name
        identifier
         id_expression
          regular_id
           non_reserved_keywords_pre12c
            MAX
    ,
    av_measure
     id_expression
      regular_id
       min_sales
     base_meas_clause
      FACT
      id_expression
       regular_id
        sales
      meas_aggregate_clause
       AGGREGATE
       BY
       aggregate_function_name
        identifier
         id_expression
          regular_id
           non_reserved_keywords_pre12c
            MIN
    ,
    av_measure
     id_expression
      regular_id
       stddev_sales
     base_meas_clause
      FACT
      id_expression
       regular_id
        sales
      meas_aggregate_clause
       AGGREGATE
       BY
       aggregate_function_name
        identifier
         id_expression
          regular_id
           non_reserved_keywords_pre12c
            STDDEV
    ,
    av_measure
     id_expression
      regular_id
       variance_sales
     base_meas_clause
      FACT
      id_expression
       regular_id
        sales
      meas_aggregate_clause
       AGGREGATE
       BY
       aggregate_function_name
        identifier
         id_expression
          regular_id
           non_reserved_keywords_pre12c
            VARIANCE
    ,
    av_measure
     id_expression
      regular_id
       units
     base_meas_clause
      FACT
      id_expression
       regular_id
        units
    ,
    av_measure
     id_expression
      regular_id
       avg_units
     base_meas_clause
      FACT
      id_expression
       regular_id
        units
      meas_aggregate_clause
       AGGREGATE
       BY
       aggregate_function_name
        identifier
         id_expression
          regular_id
           non_reserved_keywords_pre12c
            AVG
    )
   default_measure_clause
    DEFAULT
    MEASURE
    id_expression
     regular_id
      SALES
   default_aggregate_clause
    DEFAULT
    AGGREGATE
    BY
    aggregate_function_name
     identifier
      id_expression
       regular_id
        non_reserved_keywords_pre12c
         SUM
 ;
 <EOF>
