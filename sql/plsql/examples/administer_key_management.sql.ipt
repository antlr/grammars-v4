sql_script
 unit_statement
  administer_key_management
   ADMINISTER
   KEY
   MANAGEMENT
   key_management_clauses
    move_keys
     MOVE
     KEYS
     TO
     NEW
     KEYSTORE
     '$ORACLE_BASE/admin/orcl/wallet'
     IDENTIFIED
     BY
     keystore_password
      "pass"
     FROM
     FORCE
     KEYSTORE
     IDENTIFIED
     BY
     keystore_password
      "pass"
     WITH
     IDENTIFIER
     IN
     subquery
      subquery_basic_elements
       (
       subquery
        subquery_basic_elements
         query_block
          SELECT
          selected_list
           select_list_elements
            expression
             logical_expression
              unary_logical_expression
               multiset_expression
                relational_expression
                 compound_expression
                  concatenation
                   model_expression
                    unary_expression
                     atom
                      general_element
                       general_element_part
                        id_expression
                         regular_id
                          KEY_ID
          from_clause
           FROM
           table_ref_list
            table_ref
             table_ref_aux
              table_ref_aux_internal
               dml_table_expression_clause
                tableview_name
                 identifier
                  id_expression
                   regular_id
                    V$ENCRYPTION_KEYS
          where_clause
           WHERE
           condition
            expression
             logical_expression
              unary_logical_expression
               multiset_expression
                relational_expression
                 relational_expression
                  compound_expression
                   concatenation
                    model_expression
                     unary_expression
                      atom
                       general_element
                        general_element_part
                         id_expression
                          regular_id
                           non_reserved_keywords_pre12c
                            ROWNUM
                 relational_operator
                  <
                 relational_expression
                  compound_expression
                   concatenation
                    model_expression
                     unary_expression
                      atom
                       constant
                        numeric
                         2
       )
 ;
 unit_statement
  administer_key_management
   ADMINISTER
   KEY
   MANAGEMENT
   zero_downtime_software_patching_clauses
    SWITCHOVER
    TO
    LIBRARY
    path
     'updated_fully_qualified_file_name_of_library'
    FOR
    ALL
    CONTAINERS
 ;
 unit_statement
  administer_key_management
   ADMINISTER
   KEY
   MANAGEMENT
   keystore_management_clauses
    create_keystore
     CREATE
     KEYSTORE
     '/etc/ORACLE/WALLETS/orcl'
     IDENTIFIED
     BY
     keystore_password
      "pass"
 ;
 unit_statement
  administer_key_management
   ADMINISTER
   KEY
   MANAGEMENT
   keystore_management_clauses
    create_keystore
     CREATE
     AUTO_LOGIN
     KEYSTORE
     FROM
     KEYSTORE
     '/etc/ORACLE/WALLETS/orcl'
     IDENTIFIED
     BY
     keystore_password
      "pass"
 ;
 unit_statement
  administer_key_management
   ADMINISTER
   KEY
   MANAGEMENT
   keystore_management_clauses
    open_keystore
     SET
     KEYSTORE
     OPEN
     identified_by_store
      IDENTIFIED
      BY
      keystore_password
       "pass"
 ;
 unit_statement
  administer_key_management
   ADMINISTER
   KEY
   MANAGEMENT
   keystore_management_clauses
    open_keystore
     SET
     KEYSTORE
     OPEN
     identified_by_store
      IDENTIFIED
      BY
      keystore_password
       "pass"
     container_clause
      CONTAINER
      =
      CURRENT
 ;
 unit_statement
  administer_key_management
   ADMINISTER
   KEY
   MANAGEMENT
   keystore_management_clauses
    open_keystore
     SET
     KEYSTORE
     OPEN
     identified_by_store
      IDENTIFIED
      BY
      keystore_password
       "user_id:password"
 ;
 unit_statement
  administer_key_management
   ADMINISTER
   KEY
   MANAGEMENT
   keystore_management_clauses
    open_keystore
     SET
     KEYSTORE
     OPEN
     identified_by_store
      IDENTIFIED
      BY
      EXTERNAL
      STORE
 ;
 unit_statement
  administer_key_management
   ADMINISTER
   KEY
   MANAGEMENT
   keystore_management_clauses
    close_keystore
     SET
     KEYSTORE
     CLOSE
     identified_by_store
      IDENTIFIED
      BY
      keystore_password
       "pass"
 ;
 unit_statement
  administer_key_management
   ADMINISTER
   KEY
   MANAGEMENT
   keystore_management_clauses
    close_keystore
     SET
     KEYSTORE
     CLOSE
 ;
 unit_statement
  administer_key_management
   ADMINISTER
   KEY
   MANAGEMENT
   keystore_management_clauses
    close_keystore
     SET
     KEYSTORE
     CLOSE
     identified_by_store
      IDENTIFIED
      BY
      keystore_password
       "user_id:password"
 ;
 unit_statement
  administer_key_management
   ADMINISTER
   KEY
   MANAGEMENT
   keystore_management_clauses
    close_keystore
     SET
     KEYSTORE
     CLOSE
     identified_by_store
      IDENTIFIED
      BY
      EXTERNAL
      STORE
 ;
 unit_statement
  administer_key_management
   ADMINISTER
   KEY
   MANAGEMENT
   keystore_management_clauses
    backup_keystore
     BACKUP
     KEYSTORE
     USING
     'hr.emp_keystore'
     identified_by_store
      IDENTIFIED
      BY
      keystore_password
       "password"
     TO
     '/etc/ORACLE/KEYSTORE/DB1/'
 ;
 unit_statement
  administer_key_management
   ADMINISTER
   KEY
   MANAGEMENT
   keystore_management_clauses
    alter_keystore_password
     ALTER
     KEYSTORE
     PASSWORD
     IDENTIFIED
     BY
     keystore_password
      "old_password"
     SET
     keystore_password
      "new_password"
     with_backup_clause
      WITH
      BACKUP
      USING
      'pwd_change'
 ;
 unit_statement
  administer_key_management
   ADMINISTER
   KEY
   MANAGEMENT
   keystore_management_clauses
    merge_into_new_keystore
     MERGE
     KEYSTORE
     '/etc/ORACLE/KEYSTORE/DB1'
     AND
     KEYSTORE
     '/etc/ORACLE/KEYSTORE/DB2'
     identified_by_password_clause
      IDENTIFIED
      BY
      keystore_password
       "old-pass"
     INTO
     NEW
     KEYSTORE
     '/etc/ORACLE/KEYSTORE/DB3'
     identified_by_password_clause
      IDENTIFIED
      BY
      keystore_password
       "new-pass"
 ;
 unit_statement
  administer_key_management
   ADMINISTER
   KEY
   MANAGEMENT
   keystore_management_clauses
    merge_into_existing_keystore
     MERGE
     KEYSTORE
     '/etc/ORACLE/KEYSTORE/DB1'
     INTO
     EXISTING
     KEYSTORE
     '/etc/ORACLE/KEYSTORE/DB2'
     identified_by_password_clause
      IDENTIFIED
      BY
      keystore_password
       "pass"
     with_backup_clause
      WITH
      BACKUP
 ;
 unit_statement
  administer_key_management
   ADMINISTER
   KEY
   MANAGEMENT
   key_management_clauses
    set_key
     SET
     KEY
     using_algorithm_clause
      USING
      ALGORITHM
      'SEED128'
     identified_by_store
      IDENTIFIED
      BY
      keystore_password
       "pass"
     with_backup_clause
      WITH
      BACKUP
 ;
 unit_statement
  administer_key_management
   ADMINISTER
   KEY
   MANAGEMENT
   key_management_clauses
    create_key
     CREATE
     KEY
     using_tag_clause
      USING
      TAG
      'mykey1'
     identified_by_store
      IDENTIFIED
      BY
      keystore_password
       "pass"
     with_backup_clause
      WITH
      BACKUP
 ;
 unit_statement
  administer_key_management
   ADMINISTER
   KEY
   MANAGEMENT
   key_management_clauses
    use_key
     USE
     KEY
     'ARgEtzPxpE/Nv8WdPu8LJJUAAAAAAAAAAAAAAAAAAAAAAAAAAAAA'
     identified_by_store
      IDENTIFIED
      BY
      keystore_password
       "pass"
     with_backup_clause
      WITH
      BACKUP
 ;
 unit_statement
  administer_key_management
   ADMINISTER
   KEY
   MANAGEMENT
   key_management_clauses
    set_key_tag
     SET
     TAG
     'mykey2'
     FOR
     'ARgEtzPxpE/Nv8WdPu8LJJUAAAAAAAAAAAAAAAAAAAAAAAAAAAAA'
     force_keystore
      FORCE
      KEYSTORE
     identified_by_store
      IDENTIFIED
      BY
      keystore_password
       "pass"
     with_backup_clause
      WITH
      BACKUP
 ;
 unit_statement
  administer_key_management
   ADMINISTER
   KEY
   MANAGEMENT
   key_management_clauses
    export_keys
     EXPORT
     KEYS
     WITH
     SECRET
     secret
      "my_secret"
     TO
     filename
      '/etc/TDE/export.exp'
     identified_by_store
      IDENTIFIED
      BY
      keystore_password
       "password"
     WITH
     IDENTIFIER
     IN
     'AdoxnJ0uH08cv7xkz83ovwsAAAAAAAAAAAAAAAAAAAAAAAAAAAAA'
     ,
     'AW5z3CoyKE/yv3cNT5CWCXUAAAAAAAAAAAAAAAAAAAAAAAAAAAAA'
 ;
 unit_statement
  administer_key_management
   ADMINISTER
   KEY
   MANAGEMENT
   key_management_clauses
    export_keys
     EXPORT
     KEYS
     WITH
     SECRET
     secret
      "my_secret"
     TO
     filename
      '/etc/TDE/export.exp'
     identified_by_store
      IDENTIFIED
      BY
      keystore_password
       "pass"
     WITH
     IDENTIFIER
     IN
     (
     subquery
      subquery_basic_elements
       query_block
        SELECT
        selected_list
         select_list_elements
          expression
           logical_expression
            unary_logical_expression
             multiset_expression
              relational_expression
               compound_expression
                concatenation
                 model_expression
                  unary_expression
                   atom
                    general_element
                     general_element_part
                      id_expression
                       regular_id
                        KEY_ID
        from_clause
         FROM
         table_ref_list
          table_ref
           table_ref_aux
            table_ref_aux_internal
             dml_table_expression_clause
              tableview_name
               identifier
                id_expression
                 regular_id
                  V$ENCRYPTION_KEYS
        where_clause
         WHERE
         condition
          expression
           logical_expression
            unary_logical_expression
             multiset_expression
              relational_expression
               compound_expression
                concatenation
                 model_expression
                  unary_expression
                   atom
                    general_element
                     general_element_part
                      id_expression
                       regular_id
                        non_reserved_keywords_in_12c
                         TAG
                IN
                in_elements
                 (
                 concatenation
                  model_expression
                   unary_expression
                    atom
                     constant
                      quoted_string
                       'mytag1'
                 ,
                 concatenation
                  model_expression
                   unary_expression
                    atom
                     constant
                      quoted_string
                       'mytag2'
                 )
     )
 ;
 unit_statement
  administer_key_management
   ADMINISTER
   KEY
   MANAGEMENT
   key_management_clauses
    export_keys
     EXPORT
     KEYS
     WITH
     SECRET
     secret
      "my_secret"
     TO
     filename
      '/etc/TDE/export.exp'
     identified_by_store
      IDENTIFIED
      BY
      keystore_password
       "pass"
 ;
 unit_statement
  administer_key_management
   ADMINISTER
   KEY
   MANAGEMENT
   key_management_clauses
    import_keys
     IMPORT
     KEYS
     WITH
     SECRET
     secret
      "my_secret"
     FROM
     filename
      '/etc/TDE/export.exp'
     identified_by_store
      IDENTIFIED
      BY
      keystore_password
       "pass"
     with_backup_clause
      WITH
      BACKUP
 ;
 unit_statement
  administer_key_management
   ADMINISTER
   KEY
   MANAGEMENT
   key_management_clauses
    reverse_migrate_keys
     SET
     ENCRYPTION
     KEY
     IDENTIFIED
     BY
     secret
      "software_keystore_password"
     REVERSE
     MIGRATE
     USING
     secret
      "user_id:password"
 ;
 unit_statement
  administer_key_management
   ADMINISTER
   KEY
   MANAGEMENT
   secret_management_clauses
    add_update_secret
     ADD
     SECRET
     'secret1'
     FOR
     CLIENT
     'client1'
     using_tag_clause
      USING
      TAG
      'My first secret'
     identified_by_store
      IDENTIFIED
      BY
      keystore_password
       "pass"
     with_backup_clause
      WITH
      BACKUP
 ;
 unit_statement
  administer_key_management
   ADMINISTER
   KEY
   MANAGEMENT
   secret_management_clauses
    add_update_secret
     ADD
     SECRET
     'secret2'
     FOR
     CLIENT
     'client2'
     using_tag_clause
      USING
      TAG
      'My second secret'
     identified_by_store
      IDENTIFIED
      BY
      keystore_password
       "user_id:password"
 ;
 <EOF>
